import{s as Ot,f as i,a as g,l as re,g as c,h as p,c as y,O as F,d as h,m as ne,j as f,i as fe,x as l,M as Ee,E as Ke,o as qt,n as ye,W as $e,R as Se,y as Qe,S as et,T as Xe,J as He}from"./scheduler.4c62dcfe.js";import{S as Lt,i as Bt,b as Ue,d as Re,m as je,g as ze,t as De,c as We,a as Ce,e as Oe}from"./index.da97ccc5.js";import{b as jt,e as Te,E as Ht,n as Ge,S as Mt,F as Ft}from"./2.16ed5d35.js";import{i as Me}from"./theme.ddae6d24.js";import{D as Yt}from"./download.b268edce.js";import{U as zt}from"./upload.feb69a61.js";import{X as Ze}from"./circle-x.89d5d528.js";function tt(a,e,t){const r=a.slice();return r[64]=e[t][0],r[65]=e[t][1],r}function lt(a,e,t){const r=a.slice();return r[57]=e[t],r}function st(a,e,t){const r=a.slice();return r[64]=e[t][0],r[65]=e[t][1],r}function rt(a,e,t){const r=a.slice();return r[51]=e[t],r}function nt(a,e,t){const r=a.slice();return r[54]=e[t],r}function ot(a,e,t){const r=a.slice();return r[57]=e[t],r}function at(a,e,t){const r=a.slice();return r[1]=e[t],r}function it(a,e,t){const r=a.slice();return r[51]=e[t],r}function ct(a,e,t){const r=a.slice();return r[54]=e[t],r}function dt(a){let e,t,r,u,n,s,o=a[3].has_policy?"Policy Active":"No Policy",v,_,d,m,E=a[3].total_rules+"",O,W,C,x,D,I=a[3].version+"",j;return{c(){e=i("div"),t=i("div"),r=i("div"),n=g(),s=i("span"),v=re(o),_=g(),d=i("div"),m=i("span"),O=re(E),W=re(" rules"),C=g(),x=i("div"),D=re("v"),j=re(I),this.h()},l(T){e=c(T,"DIV",{class:!0});var oe=p(e);t=c(oe,"DIV",{class:!0});var $=p(t);r=c($,"DIV",{class:!0}),p(r).forEach(h),n=y($),s=c($,"SPAN",{});var V=p(s);v=ne(V,o),V.forEach(h),$.forEach(h),_=y(oe),d=c(oe,"DIV",{class:!0});var N=p(d);m=c(N,"SPAN",{class:!0});var me=p(m);O=ne(me,E),me.forEach(h),W=ne(N," rules"),N.forEach(h),C=y(oe),x=c(oe,"DIV",{class:!0});var q=p(x);D=ne(q,"v"),j=ne(q,I),q.forEach(h),oe.forEach(h),this.h()},h(){f(r,"class",u="w-2 h-2 rounded-full "+(a[3].has_policy?"bg-green-400":"bg-red-400")),f(t,"class","flex items-center space-x-2"),f(m,"class","text-blue-400"),f(d,"class","text-gray-300"),f(x,"class","text-gray-300"),f(e,"class","flex items-center space-x-4 text-sm")},m(T,oe){fe(T,e,oe),l(e,t),l(t,r),l(t,n),l(t,s),l(s,v),l(e,_),l(e,d),l(d,m),l(m,O),l(d,W),l(e,C),l(e,x),l(x,D),l(x,j)},p(T,oe){oe[0]&8&&u!==(u="w-2 h-2 rounded-full "+(T[3].has_policy?"bg-green-400":"bg-red-400"))&&f(r,"class",u),oe[0]&8&&o!==(o=T[3].has_policy?"Policy Active":"No Policy")&&ye(v,o),oe[0]&8&&E!==(E=T[3].total_rules+"")&&ye(O,E),oe[0]&8&&I!==(I=T[3].version+"")&&ye(j,I)},d(T){T&&h(e)}}}function ut(a){let e,t;return{c(){e=i("div"),t=re(a[1]),this.h()},l(r){e=c(r,"DIV",{class:!0});var u=p(e);t=ne(u,a[1]),u.forEach(h),this.h()},h(){f(e,"class","bg-red-600/20 border border-red-500/30 text-red-200 p-3 m-4 rounded-lg")},m(r,u){fe(r,e,u),l(e,t)},p(r,u){u[0]&2&&ye(t,r[1])},d(r){r&&h(e)}}}function ft(a){let e,t;return{c(){e=i("div"),t=re(a[0]),this.h()},l(r){e=c(r,"DIV",{class:!0});var u=p(e);t=ne(u,a[0]),u.forEach(h),this.h()},h(){f(e,"class","bg-green-600/20 border border-green-500/30 text-green-200 p-3 m-4 rounded-lg")},m(r,u){fe(r,e,u),l(e,t)},p(r,u){u[0]&1&&ye(t,r[0])},d(r){r&&h(e)}}}function Wt(a){let e,t,r,u,n="User Context",s,o,v,_,d="Current User",m,E,O,W,C,x="Set",D,I,j,T="Session Context",oe,$,V,N,me,q,ae,K,ge="Add",ue,A=Object.keys(a[15]).length>0,U,te,he='<h4 class="font-medium mb-4">Context Variables</h4> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm"><div><div class="font-medium text-purple-300 mb-2">User Context</div> <div class="space-y-1 text-gray-300"><div>• user_id</div> <div>• user_role</div> <div>• user_groups</div> <div>• mfa_verified</div></div></div> <div><div class="font-medium text-blue-300 mb-2">System Context</div> <div class="space-y-1 text-gray-300"><div>• pq_available</div> <div>• network_trust</div> <div>• sensitivity_level</div> <div>• time_of_day</div></div></div> <div><div class="font-medium text-cyan-300 mb-2">Resource Context</div> <div class="space-y-1 text-gray-300"><div>• resource_id</div> <div>• resource_path</div> <div>• file_size</div> <div>• source_url</div></div></div></div>',le,M,Y=A&&vt(a);return{c(){e=i("div"),t=i("div"),r=i("div"),u=i("h4"),u.textContent=n,s=g(),o=i("div"),v=i("div"),_=i("label"),_.textContent=d,m=g(),E=i("div"),O=i("input"),W=g(),C=i("button"),C.textContent=x,D=g(),I=i("div"),j=i("h4"),j.textContent=T,oe=g(),$=i("div"),V=i("div"),N=i("input"),me=g(),q=i("input"),ae=g(),K=i("button"),K.textContent=ge,ue=g(),Y&&Y.c(),U=g(),te=i("div"),te.innerHTML=he,this.h()},l(R){e=c(R,"DIV",{class:!0});var B=p(e);t=c(B,"DIV",{class:!0});var ie=p(t);r=c(ie,"DIV",{class:!0});var _e=p(r);u=c(_e,"H4",{class:!0,"data-svelte-h":!0}),F(u)!=="svelte-1oincio"&&(u.textContent=n),s=y(_e),o=c(_e,"DIV",{class:!0});var P=p(o);v=c(P,"DIV",{});var Q=p(v);_=c(Q,"LABEL",{class:!0,"data-svelte-h":!0}),F(_)!=="svelte-t52j7a"&&(_.textContent=d),m=y(Q),E=c(Q,"DIV",{class:!0});var se=p(E);O=c(se,"INPUT",{type:!0,placeholder:!0,class:!0}),W=y(se),C=c(se,"BUTTON",{class:!0,"data-svelte-h":!0}),F(C)!=="svelte-4myyng"&&(C.textContent=x),se.forEach(h),Q.forEach(h),P.forEach(h),_e.forEach(h),D=y(ie),I=c(ie,"DIV",{class:!0});var xe=p(I);j=c(xe,"H4",{class:!0,"data-svelte-h":!0}),F(j)!=="svelte-mfq0mj"&&(j.textContent=T),oe=y(xe),$=c(xe,"DIV",{class:!0});var ee=p($);V=c(ee,"DIV",{class:!0});var ce=p(V);N=c(ce,"INPUT",{type:!0,placeholder:!0,class:!0}),me=y(ce),q=c(ce,"INPUT",{type:!0,placeholder:!0,class:!0}),ae=y(ce),K=c(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),F(K)!=="svelte-vt70s1"&&(K.textContent=ge),ce.forEach(h),ue=y(ee),Y&&Y.l(ee),ee.forEach(h),xe.forEach(h),ie.forEach(h),U=y(B),te=c(B,"DIV",{class:!0,"data-svelte-h":!0}),F(te)!=="svelte-1q8gafc"&&(te.innerHTML=he),B.forEach(h),this.h()},h(){f(u,"class","font-medium mb-4"),f(_,"class","block text-sm font-medium text-gray-300 mb-2"),f(O,"type","text"),f(O,"placeholder","User ID"),f(O,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),f(C,"class","px-4 py-2 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 transition-colors"),f(E,"class","flex space-x-2"),f(o,"class","space-y-3"),f(r,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-4"),f(j,"class","font-medium mb-4"),f(N,"type","text"),f(N,"placeholder","Context Key"),f(N,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),f(q,"type","text"),f(q,"placeholder","Context Value"),f(q,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),f(K,"class","px-4 py-2 bg-cyan-600/20 border border-cyan-500/30 rounded-lg hover:bg-cyan-600/30 transition-colors"),f(V,"class","flex space-x-2"),f($,"class","space-y-3"),f(I,"class","bg-black/40 backdrop-blur-sm border border-cyan-500/30 rounded-lg p-4"),f(t,"class","grid grid-cols-1 lg:grid-cols-2 gap-6"),f(te,"class","bg-black/40 backdrop-blur-sm border border-purple-500/30 rounded-lg p-4"),f(e,"class","p-6 space-y-6")},m(R,B){fe(R,e,B),l(e,t),l(t,r),l(r,u),l(r,s),l(r,o),l(o,v),l(v,_),l(v,m),l(v,E),l(E,O),Se(O,a[14]),l(E,W),l(E,C),l(t,D),l(t,I),l(I,j),l(I,oe),l(I,$),l($,V),l(V,N),Se(N,a[12]),l(V,me),l(V,q),Se(q,a[13]),l(V,ae),l(V,K),l($,ue),Y&&Y.m($,null),l(e,U),l(e,te),le||(M=[Ee(O,"input",a[46]),Ee(C,"click",a[22]),Ee(N,"input",a[47]),Ee(q,"input",a[48]),Ee(K,"click",a[23])],le=!0)},p(R,B){B[0]&16384&&O.value!==R[14]&&Se(O,R[14]),B[0]&4096&&N.value!==R[12]&&Se(N,R[12]),B[0]&8192&&q.value!==R[13]&&Se(q,R[13]),B[0]&32768&&(A=Object.keys(R[15]).length>0),A?Y?Y.p(R,B):(Y=vt(R),Y.c(),Y.m($,null)):Y&&(Y.d(1),Y=null)},i:Qe,o:Qe,d(R){R&&h(e),Y&&Y.d(),le=!1,Ke(M)}}}function Qt(a){let e,t,r,u="Policy Tester",n,s,o,v="Resource",_,d,m,E,O,W="Action",C,x,D,I,j,T="Test Context",oe,$,V,N,me,q,ae,K,ge="Add",ue,A=Object.keys(a[11]).length>0,U,te,he,le=a[8]?"Running...":"Dry Run Test",M,Y,R,B=a[8]?"Testing...":"Test Access",ie,_e,P,Q,se,xe,ee,ce=Te(a[16]),X=[];for(let b=0;b<ce.length;b+=1)X[b]=_t(nt(a,ce,b));let be=Te(a[17]),w=[];for(let b=0;b<be.length;b+=1)w[b]=pt(rt(a,be,b));let H=A&&bt(a),S=a[6]&&gt(a),J=a[7]&&kt(a);return{c(){e=i("div"),t=i("div"),r=i("h3"),r.textContent=u,n=g(),s=i("div"),o=i("label"),o.textContent=v,_=g(),d=i("select");for(let b=0;b<X.length;b+=1)X[b].c();m=g(),E=i("div"),O=i("label"),O.textContent=W,C=g(),x=i("select");for(let b=0;b<w.length;b+=1)w[b].c();D=g(),I=i("div"),j=i("label"),j.textContent=T,oe=g(),$=i("div"),V=i("div"),N=i("input"),me=g(),q=i("input"),ae=g(),K=i("button"),K.textContent=ge,ue=g(),H&&H.c(),U=g(),te=i("div"),he=i("button"),M=re(le),Y=g(),R=i("button"),ie=re(B),_e=g(),P=i("div"),S&&S.c(),Q=g(),J&&J.c(),this.h()},l(b){e=c(b,"DIV",{class:!0});var L=p(e);t=c(L,"DIV",{class:!0});var k=p(t);r=c(k,"H3",{class:!0,"data-svelte-h":!0}),F(r)!=="svelte-1of2s4"&&(r.textContent=u),n=y(k),s=c(k,"DIV",{});var ve=p(s);o=c(ve,"LABEL",{class:!0,"data-svelte-h":!0}),F(o)!=="svelte-13yzv4y"&&(o.textContent=v),_=y(ve),d=c(ve,"SELECT",{class:!0});var Ve=p(d);for(let Ie=0;Ie<X.length;Ie+=1)X[Ie].l(Ve);Ve.forEach(h),ve.forEach(h),m=y(k),E=c(k,"DIV",{});var G=p(E);O=c(G,"LABEL",{class:!0,"data-svelte-h":!0}),F(O)!=="svelte-46c3r0"&&(O.textContent=W),C=y(G),x=c(G,"SELECT",{class:!0});var pe=p(x);for(let Ie=0;Ie<w.length;Ie+=1)w[Ie].l(pe);pe.forEach(h),G.forEach(h),D=y(k),I=c(k,"DIV",{});var de=p(I);j=c(de,"LABEL",{class:!0,"data-svelte-h":!0}),F(j)!=="svelte-s8zdl9"&&(j.textContent=T),oe=y(de),$=c(de,"DIV",{class:!0});var z=p($);V=c(z,"DIV",{class:!0});var ke=p(V);N=c(ke,"INPUT",{type:!0,placeholder:!0,class:!0}),me=y(ke),q=c(ke,"INPUT",{type:!0,placeholder:!0,class:!0}),ae=y(ke),K=c(ke,"BUTTON",{class:!0,"data-svelte-h":!0}),F(K)!=="svelte-k3v1qt"&&(K.textContent=ge),ke.forEach(h),ue=y(z),H&&H.l(z),z.forEach(h),de.forEach(h),U=y(k),te=c(k,"DIV",{class:!0});var Z=p(te);he=c(Z,"BUTTON",{class:!0});var we=p(he);M=ne(we,le),we.forEach(h),Y=y(Z),R=c(Z,"BUTTON",{class:!0});var Ne=p(R);ie=ne(Ne,B),Ne.forEach(h),Z.forEach(h),k.forEach(h),_e=y(L),P=c(L,"DIV",{class:!0});var Pe=p(P);S&&S.l(Pe),Q=y(Pe),J&&J.l(Pe),Pe.forEach(h),L.forEach(h),this.h()},h(){f(r,"class","text-lg font-semibold"),f(o,"class","block text-sm font-medium text-gray-300 mb-2"),f(d,"class","w-full px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),a[9]===void 0&&et(()=>a[41].call(d)),f(O,"class","block text-sm font-medium text-gray-300 mb-2"),f(x,"class","w-full px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),a[10]===void 0&&et(()=>a[42].call(x)),f(j,"class","block text-sm font-medium text-gray-300 mb-2"),f(N,"type","text"),f(N,"placeholder","Key"),f(N,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none text-sm"),f(q,"type","text"),f(q,"placeholder","Value"),f(q,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none text-sm"),f(K,"class","px-3 py-2 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 transition-colors text-sm"),f(V,"class","flex space-x-2"),f($,"class","space-y-2"),he.disabled=a[8],f(he,"class","w-full py-2 bg-yellow-600/20 border border-yellow-500/30 rounded-lg hover:bg-yellow-600/30 disabled:opacity-50 transition-colors"),R.disabled=a[8],f(R,"class","w-full py-2 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 disabled:opacity-50 transition-colors"),f(te,"class","space-y-2"),f(t,"class","w-96 border-r border-blue-500/20 bg-black/20 backdrop-blur-sm p-4 space-y-4"),f(P,"class","flex-1 p-6 space-y-6 overflow-y-auto"),f(e,"class","flex h-full")},m(b,L){fe(b,e,L),l(e,t),l(t,r),l(t,n),l(t,s),l(s,o),l(s,_),l(s,d);for(let k=0;k<X.length;k+=1)X[k]&&X[k].m(d,null);Xe(d,a[9],!0),l(t,m),l(t,E),l(E,O),l(E,C),l(E,x);for(let k=0;k<w.length;k+=1)w[k]&&w[k].m(x,null);Xe(x,a[10],!0),l(t,D),l(t,I),l(I,j),l(I,oe),l(I,$),l($,V),l(V,N),Se(N,a[12]),l(V,me),l(V,q),Se(q,a[13]),l(V,ae),l(V,K),l($,ue),H&&H.m($,null),l(t,U),l(t,te),l(te,he),l(he,M),l(te,Y),l(te,R),l(R,ie),l(e,_e),l(e,P),S&&S.m(P,null),l(P,Q),J&&J.m(P,null),se=!0,xe||(ee=[Ee(d,"change",a[41]),Ee(x,"change",a[42]),Ee(N,"input",a[43]),Ee(q,"input",a[44]),Ee(K,"click",a[24]),Ee(he,"click",a[20]),Ee(R,"click",a[21])],xe=!0)},p(b,L){if(L[0]&65536){ce=Te(b[16]);let k;for(k=0;k<ce.length;k+=1){const ve=nt(b,ce,k);X[k]?X[k].p(ve,L):(X[k]=_t(ve),X[k].c(),X[k].m(d,null))}for(;k<X.length;k+=1)X[k].d(1);X.length=ce.length}if(L[0]&66048&&Xe(d,b[9]),L[0]&131072){be=Te(b[17]);let k;for(k=0;k<be.length;k+=1){const ve=rt(b,be,k);w[k]?w[k].p(ve,L):(w[k]=pt(ve),w[k].c(),w[k].m(x,null))}for(;k<w.length;k+=1)w[k].d(1);w.length=be.length}L[0]&132096&&Xe(x,b[10]),L[0]&4096&&N.value!==b[12]&&Se(N,b[12]),L[0]&8192&&q.value!==b[13]&&Se(q,b[13]),L[0]&2048&&(A=Object.keys(b[11]).length>0),A?H?H.p(b,L):(H=bt(b),H.c(),H.m($,null)):H&&(H.d(1),H=null),(!se||L[0]&256)&&le!==(le=b[8]?"Running...":"Dry Run Test")&&ye(M,le),(!se||L[0]&256)&&(he.disabled=b[8]),(!se||L[0]&256)&&B!==(B=b[8]?"Testing...":"Test Access")&&ye(ie,B),(!se||L[0]&256)&&(R.disabled=b[8]),b[6]?S?(S.p(b,L),L[0]&64&&Ce(S,1)):(S=gt(b),S.c(),Ce(S,1),S.m(P,Q)):S&&(ze(),De(S,1,1,()=>{S=null}),We()),b[7]?J?(J.p(b,L),L[0]&128&&Ce(J,1)):(J=kt(b),J.c(),Ce(J,1),J.m(P,null)):J&&(ze(),De(J,1,1,()=>{J=null}),We())},i(b){se||(Ce(S),Ce(J),se=!0)},o(b){De(S),De(J),se=!1},d(b){b&&h(e),He(X,b),He(w,b),H&&H.d(),S&&S.d(),J&&J.d(),xe=!1,Ke(ee)}}}function Jt(a){let e,t,r,u,n,s="Policy Editor",o,v,_,d,m,E,O="Export",W,C,x,D,I,j="Import",T,oe,$,V,N,me,q,ae=a[8]?"Validating...":"Validate",K,ge,ue,A,U,te,he=a[8]?"Loading...":"Load Policy",le,M,Y,R,B,ie,_e,P,Q,se="Templates",xe,ee,ce,X='<div class="font-medium">Restrictive</div> <div class="text-gray-400 text-xs">High security</div>',be,w,H='<div class="font-medium">Development</div> <div class="text-gray-400 text-xs">Permissive</div>',S,J,b='<div class="font-medium">Balanced</div> <div class="text-gray-400 text-xs">Security + usability</div>',L,k,ve,Ve;d=new Yt({props:{class:"w-4 h-4"}}),x=new zt({props:{class:"w-4 h-4"}}),N=new Ht({props:{class:"w-4 h-4"}}),A=new Ge({props:{class:"w-4 h-4"}});let G=a[5]&&It(a);return{c(){e=i("div"),t=i("div"),r=i("div"),u=i("div"),n=i("h3"),n.textContent=s,o=g(),v=i("div"),_=i("button"),Ue(d.$$.fragment),m=g(),E=i("span"),E.textContent=O,W=g(),C=i("label"),Ue(x.$$.fragment),D=g(),I=i("span"),I.textContent=j,T=g(),oe=i("input"),$=g(),V=i("button"),Ue(N.$$.fragment),me=g(),q=i("span"),K=re(ae),ge=g(),ue=i("button"),Ue(A.$$.fragment),U=g(),te=i("span"),le=re(he),Y=g(),R=i("div"),B=i("textarea"),ie=g(),_e=i("div"),P=i("div"),Q=i("h4"),Q.textContent=se,xe=g(),ee=i("div"),ce=i("button"),ce.innerHTML=X,be=g(),w=i("button"),w.innerHTML=H,S=g(),J=i("button"),J.innerHTML=b,L=g(),G&&G.c(),this.h()},l(pe){e=c(pe,"DIV",{class:!0});var de=p(e);t=c(de,"DIV",{class:!0});var z=p(t);r=c(z,"DIV",{class:!0});var ke=p(r);u=c(ke,"DIV",{class:!0});var Z=p(u);n=c(Z,"H3",{class:!0,"data-svelte-h":!0}),F(n)!=="svelte-pto2q6"&&(n.textContent=s),o=y(Z),v=c(Z,"DIV",{class:!0});var we=p(v);_=c(we,"BUTTON",{class:!0});var Ne=p(_);Re(d.$$.fragment,Ne),m=y(Ne),E=c(Ne,"SPAN",{"data-svelte-h":!0}),F(E)!=="svelte-l90c7o"&&(E.textContent=O),Ne.forEach(h),W=y(we),C=c(we,"LABEL",{class:!0});var Pe=p(C);Re(x.$$.fragment,Pe),D=y(Pe),I=c(Pe,"SPAN",{"data-svelte-h":!0}),F(I)!=="svelte-1pfbzu3"&&(I.textContent=j),T=y(Pe),oe=c(Pe,"INPUT",{type:!0,accept:!0,class:!0}),Pe.forEach(h),$=y(we),V=c(we,"BUTTON",{class:!0});var Ie=p(V);Re(N.$$.fragment,Ie),me=y(Ie),q=c(Ie,"SPAN",{});var Fe=p(q);K=ne(Fe,ae),Fe.forEach(h),Ie.forEach(h),ge=y(we),ue=c(we,"BUTTON",{class:!0});var qe=p(ue);Re(A.$$.fragment,qe),U=y(qe),te=c(qe,"SPAN",{});var Ye=p(te);le=ne(Ye,he),Ye.forEach(h),qe.forEach(h),we.forEach(h),Z.forEach(h),ke.forEach(h),Y=y(z),R=c(z,"DIV",{class:!0});var Je=p(R);B=c(Je,"TEXTAREA",{placeholder:!0,class:!0}),p(B).forEach(h),Je.forEach(h),z.forEach(h),ie=y(de),_e=c(de,"DIV",{class:!0});var Le=p(_e);P=c(Le,"DIV",{class:!0});var Be=p(P);Q=c(Be,"H4",{class:!0,"data-svelte-h":!0}),F(Q)!=="svelte-1tsqs1s"&&(Q.textContent=se),xe=y(Be),ee=c(Be,"DIV",{class:!0});var Ae=p(ee);ce=c(Ae,"BUTTON",{class:!0,"data-svelte-h":!0}),F(ce)!=="svelte-jguh2"&&(ce.innerHTML=X),be=y(Ae),w=c(Ae,"BUTTON",{class:!0,"data-svelte-h":!0}),F(w)!=="svelte-9ujzcp"&&(w.innerHTML=H),S=y(Ae),J=c(Ae,"BUTTON",{class:!0,"data-svelte-h":!0}),F(J)!=="svelte-1fgo7nm"&&(J.innerHTML=b),Ae.forEach(h),Be.forEach(h),L=y(Le),G&&G.l(Le),Le.forEach(h),de.forEach(h),this.h()},h(){f(n,"class","text-lg font-semibold"),f(_,"class","flex items-center space-x-2 px-3 py-2 bg-gray-600/20 border border-gray-500/30 rounded-lg hover:bg-gray-600/30 transition-colors text-sm"),f(oe,"type","file"),f(oe,"accept",".toml,.txt"),f(oe,"class","hidden"),f(C,"class","flex items-center space-x-2 px-3 py-2 bg-gray-600/20 border border-gray-500/30 rounded-lg hover:bg-gray-600/30 transition-colors text-sm cursor-pointer"),V.disabled=a[8],f(V,"class","flex items-center space-x-2 px-3 py-2 bg-yellow-600/20 border border-yellow-500/30 rounded-lg hover:bg-yellow-600/30 disabled:opacity-50 transition-colors text-sm"),ue.disabled=M=a[8]||!a[5]?.valid,f(ue,"class","flex items-center space-x-2 px-3 py-2 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 disabled:opacity-50 transition-colors text-sm"),f(v,"class","flex items-center space-x-2"),f(u,"class","flex items-center justify-between"),f(r,"class","border-b border-blue-500/20 p-4"),f(B,"placeholder","Enter your TOML policy configuration here..."),f(B,"class","w-full h-full bg-gray-900/50 border border-gray-600/50 rounded-lg p-4 font-mono text-sm focus:border-blue-500 focus:outline-none resize-none"),f(R,"class","flex-1 p-4"),f(t,"class","flex-1 flex flex-col"),f(Q,"class","font-medium mb-3"),f(ce,"class","w-full p-3 bg-red-600/20 border border-red-500/30 rounded-lg hover:bg-red-600/30 transition-colors text-left text-sm"),f(w,"class","w-full p-3 bg-green-600/20 border border-green-500/30 rounded-lg hover:bg-green-600/30 transition-colors text-left text-sm"),f(J,"class","w-full p-3 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 transition-colors text-left text-sm"),f(ee,"class","space-y-2"),f(P,"class","border-b border-blue-500/20 p-4"),f(_e,"class","w-80 border-l border-blue-500/20 bg-black/20 backdrop-blur-sm"),f(e,"class","flex h-full")},m(pe,de){fe(pe,e,de),l(e,t),l(t,r),l(r,u),l(u,n),l(u,o),l(u,v),l(v,_),je(d,_,null),l(_,m),l(_,E),l(v,W),l(v,C),je(x,C,null),l(C,D),l(C,I),l(C,T),l(C,oe),l(v,$),l(v,V),je(N,V,null),l(V,me),l(V,q),l(q,K),l(v,ge),l(v,ue),je(A,ue,null),l(ue,U),l(ue,te),l(te,le),l(t,Y),l(t,R),l(R,B),Se(B,a[4]),l(e,ie),l(e,_e),l(_e,P),l(P,Q),l(P,xe),l(P,ee),l(ee,ce),l(ee,be),l(ee,w),l(ee,S),l(ee,J),l(_e,L),G&&G.m(_e,null),k=!0,ve||(Ve=[Ee(_,"click",a[28]),Ee(oe,"change",a[29]),Ee(V,"click",a[18]),Ee(ue,"click",a[19]),Ee(B,"input",a[37]),Ee(ce,"click",a[38]),Ee(w,"click",a[39]),Ee(J,"click",a[40])],ve=!0)},p(pe,de){(!k||de[0]&256)&&ae!==(ae=pe[8]?"Validating...":"Validate")&&ye(K,ae),(!k||de[0]&256)&&(V.disabled=pe[8]),(!k||de[0]&256)&&he!==(he=pe[8]?"Loading...":"Load Policy")&&ye(le,he),(!k||de[0]&288&&M!==(M=pe[8]||!pe[5]?.valid))&&(ue.disabled=M),de[0]&16&&Se(B,pe[4]),pe[5]?G?(G.p(pe,de),de[0]&32&&Ce(G,1)):(G=It(pe),G.c(),Ce(G,1),G.m(_e,null)):G&&(ze(),De(G,1,1,()=>{G=null}),We())},i(pe){k||(Ce(d.$$.fragment,pe),Ce(x.$$.fragment,pe),Ce(N.$$.fragment,pe),Ce(A.$$.fragment,pe),Ce(G),k=!0)},o(pe){De(d.$$.fragment,pe),De(x.$$.fragment,pe),De(N.$$.fragment,pe),De(A.$$.fragment,pe),De(G),k=!1},d(pe){pe&&h(e),Oe(d),Oe(x),Oe(N),Oe(A),G&&G.d(),ve=!1,Ke(Ve)}}}function Kt(a){let e,t,r,u,n="Quick Actions",s,o,v,_,d,m,E="Restrictive Policy",O,W,C="High security, minimal permissions",x,D,I,j,T,oe="Development Policy",$,V,N="Permissive for development",me,q,ae,K,ge,ue="Balanced Policy",A,U,te="Security with usability",he,le,M,Y="Policy Engine Features",R,B,ie,_e,P="Resources",Q,se,xe,ee,ce,X="Actions",be,w,H,S,J="...and more",b,L,k,ve=a[3]&&St(a);_=new jt({props:{class:"w-6 h-6 text-red-400 mb-2"}}),I=new Mt({props:{class:"w-6 h-6 text-green-400 mb-2"}}),ae=new Ft({props:{class:"w-6 h-6 text-blue-400 mb-2"}});let Ve=Te(a[16]),G=[];for(let z=0;z<Ve.length;z+=1)G[z]=Ut(ct(a,Ve,z));let pe=Te(a[17].slice(0,10)),de=[];for(let z=0;z<pe.length;z+=1)de[z]=Rt(it(a,pe,z));return{c(){e=i("div"),ve&&ve.c(),t=g(),r=i("div"),u=i("h3"),u.textContent=n,s=g(),o=i("div"),v=i("button"),Ue(_.$$.fragment),d=g(),m=i("div"),m.textContent=E,O=g(),W=i("div"),W.textContent=C,x=g(),D=i("button"),Ue(I.$$.fragment),j=g(),T=i("div"),T.textContent=oe,$=g(),V=i("div"),V.textContent=N,me=g(),q=i("button"),Ue(ae.$$.fragment),K=g(),ge=i("div"),ge.textContent=ue,A=g(),U=i("div"),U.textContent=te,he=g(),le=i("div"),M=i("h3"),M.textContent=Y,R=g(),B=i("div"),ie=i("div"),_e=i("h4"),_e.textContent=P,Q=g(),se=i("div");for(let z=0;z<G.length;z+=1)G[z].c();xe=g(),ee=i("div"),ce=i("h4"),ce.textContent=X,be=g(),w=i("div");for(let z=0;z<de.length;z+=1)de[z].c();H=g(),S=i("div"),S.textContent=J,this.h()},l(z){e=c(z,"DIV",{class:!0});var ke=p(e);ve&&ve.l(ke),t=y(ke),r=c(ke,"DIV",{class:!0});var Z=p(r);u=c(Z,"H3",{class:!0,"data-svelte-h":!0}),F(u)!=="svelte-11279rj"&&(u.textContent=n),s=y(Z),o=c(Z,"DIV",{class:!0});var we=p(o);v=c(we,"BUTTON",{class:!0});var Ne=p(v);Re(_.$$.fragment,Ne),d=y(Ne),m=c(Ne,"DIV",{class:!0,"data-svelte-h":!0}),F(m)!=="svelte-1h95xb4"&&(m.textContent=E),O=y(Ne),W=c(Ne,"DIV",{class:!0,"data-svelte-h":!0}),F(W)!=="svelte-11owj1w"&&(W.textContent=C),Ne.forEach(h),x=y(we),D=c(we,"BUTTON",{class:!0});var Pe=p(D);Re(I.$$.fragment,Pe),j=y(Pe),T=c(Pe,"DIV",{class:!0,"data-svelte-h":!0}),F(T)!=="svelte-3ypag7"&&(T.textContent=oe),$=y(Pe),V=c(Pe,"DIV",{class:!0,"data-svelte-h":!0}),F(V)!=="svelte-jrxx14"&&(V.textContent=N),Pe.forEach(h),me=y(we),q=c(we,"BUTTON",{class:!0});var Ie=p(q);Re(ae.$$.fragment,Ie),K=y(Ie),ge=c(Ie,"DIV",{class:!0,"data-svelte-h":!0}),F(ge)!=="svelte-6lfjow"&&(ge.textContent=ue),A=y(Ie),U=c(Ie,"DIV",{class:!0,"data-svelte-h":!0}),F(U)!=="svelte-zo1ja1"&&(U.textContent=te),Ie.forEach(h),we.forEach(h),Z.forEach(h),he=y(ke),le=c(ke,"DIV",{class:!0});var Fe=p(le);M=c(Fe,"H3",{class:!0,"data-svelte-h":!0}),F(M)!=="svelte-1xuy9hs"&&(M.textContent=Y),R=y(Fe),B=c(Fe,"DIV",{class:!0});var qe=p(B);ie=c(qe,"DIV",{});var Ye=p(ie);_e=c(Ye,"H4",{class:!0,"data-svelte-h":!0}),F(_e)!=="svelte-1xhxn0h"&&(_e.textContent=P),Q=y(Ye),se=c(Ye,"DIV",{class:!0});var Je=p(se);for(let Ae=0;Ae<G.length;Ae+=1)G[Ae].l(Je);Je.forEach(h),Ye.forEach(h),xe=y(qe),ee=c(qe,"DIV",{});var Le=p(ee);ce=c(Le,"H4",{class:!0,"data-svelte-h":!0}),F(ce)!=="svelte-1jj0e1k"&&(ce.textContent=X),be=y(Le),w=c(Le,"DIV",{class:!0});var Be=p(w);for(let Ae=0;Ae<de.length;Ae+=1)de[Ae].l(Be);H=y(Be),S=c(Be,"DIV",{class:!0,"data-svelte-h":!0}),F(S)!=="svelte-wugh2n"&&(S.textContent=J),Be.forEach(h),Le.forEach(h),qe.forEach(h),Fe.forEach(h),ke.forEach(h),this.h()},h(){f(u,"class","text-lg font-semibold mb-4"),f(m,"class","font-medium"),f(W,"class","text-sm text-gray-400"),f(v,"class","p-4 bg-red-600/20 border border-red-500/30 rounded-lg hover:bg-red-600/30 transition-colors text-left"),f(T,"class","font-medium"),f(V,"class","text-sm text-gray-400"),f(D,"class","p-4 bg-green-600/20 border border-green-500/30 rounded-lg hover:bg-green-600/30 transition-colors text-left"),f(ge,"class","font-medium"),f(U,"class","text-sm text-gray-400"),f(q,"class","p-4 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 transition-colors text-left"),f(o,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"),f(r,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-6"),f(M,"class","text-lg font-semibold mb-4"),f(_e,"class","font-medium text-blue-300 mb-2"),f(se,"class","space-y-1 text-sm text-gray-300"),f(ce,"class","font-medium text-cyan-300 mb-2"),f(S,"class","text-gray-400"),f(w,"class","space-y-1 text-sm text-gray-300"),f(B,"class","grid grid-cols-1 md:grid-cols-2 gap-6"),f(le,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-6"),f(e,"class","p-6 space-y-6")},m(z,ke){fe(z,e,ke),ve&&ve.m(e,null),l(e,t),l(e,r),l(r,u),l(r,s),l(r,o),l(o,v),je(_,v,null),l(v,d),l(v,m),l(v,O),l(v,W),l(o,x),l(o,D),je(I,D,null),l(D,j),l(D,T),l(D,$),l(D,V),l(o,me),l(o,q),je(ae,q,null),l(q,K),l(q,ge),l(q,A),l(q,U),l(e,he),l(e,le),l(le,M),l(le,R),l(le,B),l(B,ie),l(ie,_e),l(ie,Q),l(ie,se);for(let Z=0;Z<G.length;Z+=1)G[Z]&&G[Z].m(se,null);l(B,xe),l(B,ee),l(ee,ce),l(ee,be),l(ee,w);for(let Z=0;Z<de.length;Z+=1)de[Z]&&de[Z].m(w,null);l(w,H),l(w,S),b=!0,L||(k=[Ee(v,"click",a[34]),Ee(D,"click",a[35]),Ee(q,"click",a[36])],L=!0)},p(z,ke){if(z[3]?ve?ve.p(z,ke):(ve=St(z),ve.c(),ve.m(e,t)):ve&&(ve.d(1),ve=null),ke[0]&65536){Ve=Te(z[16]);let Z;for(Z=0;Z<Ve.length;Z+=1){const we=ct(z,Ve,Z);G[Z]?G[Z].p(we,ke):(G[Z]=Ut(we),G[Z].c(),G[Z].m(se,null))}for(;Z<G.length;Z+=1)G[Z].d(1);G.length=Ve.length}if(ke[0]&131072){pe=Te(z[17].slice(0,10));let Z;for(Z=0;Z<pe.length;Z+=1){const we=it(z,pe,Z);de[Z]?de[Z].p(we,ke):(de[Z]=Rt(we),de[Z].c(),de[Z].m(w,H))}for(;Z<de.length;Z+=1)de[Z].d(1);de.length=pe.length}},i(z){b||(Ce(_.$$.fragment,z),Ce(I.$$.fragment,z),Ce(ae.$$.fragment,z),b=!0)},o(z){De(_.$$.fragment,z),De(I.$$.fragment,z),De(ae.$$.fragment,z),b=!1},d(z){z&&h(e),ve&&ve.d(),Oe(_),Oe(I),Oe(ae),He(G,z),He(de,z),L=!1,Ke(k)}}}function vt(a){let e,t,r="Active Context:",u,n=Te(Object.entries(a[15])),s=[];for(let o=0;o<n.length;o+=1)s[o]=ht(tt(a,n,o));return{c(){e=i("div"),t=i("div"),t.textContent=r,u=g();for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=c(o,"DIV",{class:!0});var v=p(e);t=c(v,"DIV",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-15e1g6q"&&(t.textContent=r),u=y(v);for(let _=0;_<s.length;_+=1)s[_].l(v);v.forEach(h),this.h()},h(){f(t,"class","text-sm font-medium text-gray-300"),f(e,"class","space-y-2")},m(o,v){fe(o,e,v),l(e,t),l(e,u);for(let _=0;_<s.length;_+=1)s[_]&&s[_].m(e,null)},p(o,v){if(v[0]&32768){n=Te(Object.entries(o[15]));let _;for(_=0;_<n.length;_+=1){const d=tt(o,n,_);s[_]?s[_].p(d,v):(s[_]=ht(d),s[_].c(),s[_].m(e,null))}for(;_<s.length;_+=1)s[_].d(1);s.length=n.length}},d(o){o&&h(e),He(s,o)}}}function ht(a){let e,t,r=a[64]+"",u,n,s=a[65]+"",o,v;return{c(){e=i("div"),t=i("span"),u=re(r),n=re(" = "),o=re(s),v=g(),this.h()},l(_){e=c(_,"DIV",{class:!0});var d=p(e);t=c(d,"SPAN",{class:!0});var m=p(t);u=ne(m,r),n=ne(m," = "),o=ne(m,s),m.forEach(h),v=y(d),d.forEach(h),this.h()},h(){f(t,"class","font-mono"),f(e,"class","flex items-center justify-between bg-gray-800/30 p-2 rounded text-sm")},m(_,d){fe(_,e,d),l(e,t),l(t,u),l(t,n),l(t,o),l(e,v)},p(_,d){d[0]&32768&&r!==(r=_[64]+"")&&ye(u,r),d[0]&32768&&s!==(s=_[65]+"")&&ye(o,s)},d(_){_&&h(e)}}}function _t(a){let e,t=a[54]+"",r;return{c(){e=i("option"),r=re(t),this.h()},l(u){e=c(u,"OPTION",{});var n=p(e);r=ne(n,t),n.forEach(h),this.h()},h(){e.__value=a[54],Se(e,e.__value)},m(u,n){fe(u,e,n),l(e,r)},p:Qe,d(u){u&&h(e)}}}function pt(a){let e,t=a[51]+"",r;return{c(){e=i("option"),r=re(t),this.h()},l(u){e=c(u,"OPTION",{});var n=p(e);r=ne(n,t),n.forEach(h),this.h()},h(){e.__value=a[51],Se(e,e.__value)},m(u,n){fe(u,e,n),l(e,r)},p:Qe,d(u){u&&h(e)}}}function bt(a){let e,t=Te(Object.entries(a[11])),r=[];for(let u=0;u<t.length;u+=1)r[u]=mt(st(a,t,u));return{c(){e=i("div");for(let u=0;u<r.length;u+=1)r[u].c();this.h()},l(u){e=c(u,"DIV",{class:!0});var n=p(e);for(let s=0;s<r.length;s+=1)r[s].l(n);n.forEach(h),this.h()},h(){f(e,"class","space-y-1")},m(u,n){fe(u,e,n);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(e,null)},p(u,n){if(n[0]&33556480){t=Te(Object.entries(u[11]));let s;for(s=0;s<t.length;s+=1){const o=st(u,t,s);r[s]?r[s].p(o,n):(r[s]=mt(o),r[s].c(),r[s].m(e,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=t.length}},d(u){u&&h(e),He(r,u)}}}function mt(a){let e,t,r=a[64]+"",u,n,s=a[65]+"",o,v,_,d="✕",m,E,O;function W(){return a[45](a[64])}return{c(){e=i("div"),t=i("span"),u=re(r),n=re(" = "),o=re(s),v=g(),_=i("button"),_.textContent=d,m=g(),this.h()},l(C){e=c(C,"DIV",{class:!0});var x=p(e);t=c(x,"SPAN",{class:!0});var D=p(t);u=ne(D,r),n=ne(D," = "),o=ne(D,s),D.forEach(h),v=y(x),_=c(x,"BUTTON",{class:!0,"data-svelte-h":!0}),F(_)!=="svelte-1xs48ac"&&(_.textContent=d),m=y(x),x.forEach(h),this.h()},h(){f(t,"class","font-mono"),f(_,"class","text-red-400 hover:text-red-300"),f(e,"class","flex items-center justify-between bg-gray-800/30 p-2 rounded text-sm")},m(C,x){fe(C,e,x),l(e,t),l(t,u),l(t,n),l(t,o),l(e,v),l(e,_),l(e,m),E||(O=Ee(_,"click",W),E=!0)},p(C,x){a=C,x[0]&2048&&r!==(r=a[64]+"")&&ye(u,r),x[0]&2048&&s!==(s=a[65]+"")&&ye(o,s)},d(C){C&&h(e),E=!1,O()}}}function gt(a){let e,t,r="Dry Run Results",u,n,s,o,v,_,d,m,E,O="Evaluated Rules:",W,C,x=a[6].evaluated_rules+"",D,I,j,T,oe="Requires Justification:",$,V,N=a[6].decision.requires_justification?"Yes":"No",me,q,ae,K,ge="Mask Preview:",ue,A,U=a[6].decision.mask_preview?"Yes":"No",te,he,le,M,Y="Quarantine File:",R,B,ie=a[6].decision.quarantine_file?"Yes":"No",_e,P,Q,se;const xe=[Gt,Xt],ee=[];function ce(w,H){return w[6].decision.allowed?0:1}o=ce(a),v=ee[o]=xe[o](a);let X=a[6].decision.warning_message&&yt(a),be=a[6].warnings.length>0&&xt(a);return{c(){e=i("div"),t=i("h4"),t.textContent=r,u=g(),n=i("div"),s=i("div"),v.c(),_=g(),d=i("div"),m=i("div"),E=i("span"),E.textContent=O,W=g(),C=i("span"),D=re(x),I=g(),j=i("div"),T=i("span"),T.textContent=oe,$=g(),V=i("span"),me=re(N),q=g(),ae=i("div"),K=i("span"),K.textContent=ge,ue=g(),A=i("span"),te=re(U),he=g(),le=i("div"),M=i("span"),M.textContent=Y,R=g(),B=i("span"),_e=re(ie),P=g(),X&&X.c(),Q=g(),be&&be.c(),this.h()},l(w){e=c(w,"DIV",{class:!0});var H=p(e);t=c(H,"H4",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-1k79t4b"&&(t.textContent=r),u=y(H),n=c(H,"DIV",{class:!0});var S=p(n);s=c(S,"DIV",{class:!0});var J=p(s);v.l(J),J.forEach(h),_=y(S),d=c(S,"DIV",{class:!0});var b=p(d);m=c(b,"DIV",{});var L=p(m);E=c(L,"SPAN",{class:!0,"data-svelte-h":!0}),F(E)!=="svelte-193k7sl"&&(E.textContent=O),W=y(L),C=c(L,"SPAN",{class:!0});var k=p(C);D=ne(k,x),k.forEach(h),L.forEach(h),I=y(b),j=c(b,"DIV",{});var ve=p(j);T=c(ve,"SPAN",{class:!0,"data-svelte-h":!0}),F(T)!=="svelte-a7bxpp"&&(T.textContent=oe),$=y(ve),V=c(ve,"SPAN",{class:!0});var Ve=p(V);me=ne(Ve,N),Ve.forEach(h),ve.forEach(h),q=y(b),ae=c(b,"DIV",{});var G=p(ae);K=c(G,"SPAN",{class:!0,"data-svelte-h":!0}),F(K)!=="svelte-h1g6of"&&(K.textContent=ge),ue=y(G),A=c(G,"SPAN",{class:!0});var pe=p(A);te=ne(pe,U),pe.forEach(h),G.forEach(h),he=y(b),le=c(b,"DIV",{});var de=p(le);M=c(de,"SPAN",{class:!0,"data-svelte-h":!0}),F(M)!=="svelte-4z2vfl"&&(M.textContent=Y),R=y(de),B=c(de,"SPAN",{class:!0});var z=p(B);_e=ne(z,ie),z.forEach(h),de.forEach(h),b.forEach(h),P=y(S),X&&X.l(S),Q=y(S),be&&be.l(S),S.forEach(h),H.forEach(h),this.h()},h(){f(t,"class","font-medium text-yellow-300 mb-3"),f(s,"class","flex items-center space-x-2"),f(E,"class","text-gray-400"),f(C,"class","text-white ml-2"),f(T,"class","text-gray-400"),f(V,"class","text-white ml-2"),f(K,"class","text-gray-400"),f(A,"class","text-white ml-2"),f(M,"class","text-gray-400"),f(B,"class","text-white ml-2"),f(d,"class","grid grid-cols-2 gap-4 text-sm"),f(n,"class","space-y-3"),f(e,"class","bg-black/40 backdrop-blur-sm border border-yellow-500/30 rounded-lg p-4")},m(w,H){fe(w,e,H),l(e,t),l(e,u),l(e,n),l(n,s),ee[o].m(s,null),l(n,_),l(n,d),l(d,m),l(m,E),l(m,W),l(m,C),l(C,D),l(d,I),l(d,j),l(j,T),l(j,$),l(j,V),l(V,me),l(d,q),l(d,ae),l(ae,K),l(ae,ue),l(ae,A),l(A,te),l(d,he),l(d,le),l(le,M),l(le,R),l(le,B),l(B,_e),l(n,P),X&&X.m(n,null),l(n,Q),be&&be.m(n,null),se=!0},p(w,H){let S=o;o=ce(w),o!==S&&(ze(),De(ee[S],1,1,()=>{ee[S]=null}),We(),v=ee[o],v||(v=ee[o]=xe[o](w),v.c()),Ce(v,1),v.m(s,null)),(!se||H[0]&64)&&x!==(x=w[6].evaluated_rules+"")&&ye(D,x),(!se||H[0]&64)&&N!==(N=w[6].decision.requires_justification?"Yes":"No")&&ye(me,N),(!se||H[0]&64)&&U!==(U=w[6].decision.mask_preview?"Yes":"No")&&ye(te,U),(!se||H[0]&64)&&ie!==(ie=w[6].decision.quarantine_file?"Yes":"No")&&ye(_e,ie),w[6].decision.warning_message?X?X.p(w,H):(X=yt(w),X.c(),X.m(n,Q)):X&&(X.d(1),X=null),w[6].warnings.length>0?be?be.p(w,H):(be=xt(w),be.c(),be.m(n,null)):be&&(be.d(1),be=null)},i(w){se||(Ce(v),se=!0)},o(w){De(v),se=!1},d(w){w&&h(e),ee[o].d(),X&&X.d(),be&&be.d()}}}function Xt(a){let e,t,r,u="Access Denied",n;return e=new Ze({props:{class:"w-5 h-5 text-red-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){Re(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),F(r)!=="svelte-1y0llmf"&&(r.textContent=u),this.h()},h(){f(r,"class","text-red-300")},m(s,o){je(e,s,o),fe(s,t,o),fe(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Oe(e,s)}}}function Gt(a){let e,t,r,u="Access Allowed",n;return e=new Ge({props:{class:"w-5 h-5 text-green-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){Re(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),F(r)!=="svelte-fs36s8"&&(r.textContent=u),this.h()},h(){f(r,"class","text-green-300")},m(s,o){je(e,s,o),fe(s,t,o),fe(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Oe(e,s)}}}function yt(a){let e,t,r=a[6].decision.warning_message+"",u;return{c(){e=i("div"),t=i("div"),u=re(r),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);t=c(s,"DIV",{class:!0});var o=p(t);u=ne(o,r),o.forEach(h),s.forEach(h),this.h()},h(){f(t,"class","text-sm text-yellow-200"),f(e,"class","bg-yellow-600/20 border border-yellow-500/30 p-3 rounded")},m(n,s){fe(n,e,s),l(e,t),l(t,u)},p(n,s){s[0]&64&&r!==(r=n[6].decision.warning_message+"")&&ye(u,r)},d(n){n&&h(e)}}}function xt(a){let e,t,r="Warnings:",u,n,s=Te(a[6].warnings),o=[];for(let v=0;v<s.length;v+=1)o[v]=Ct(lt(a,s,v));return{c(){e=i("div"),t=i("div"),t.textContent=r,u=g(),n=i("div");for(let v=0;v<o.length;v+=1)o[v].c();this.h()},l(v){e=c(v,"DIV",{});var _=p(e);t=c(_,"DIV",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-93q19v"&&(t.textContent=r),u=y(_),n=c(_,"DIV",{class:!0});var d=p(n);for(let m=0;m<o.length;m+=1)o[m].l(d);d.forEach(h),_.forEach(h),this.h()},h(){f(t,"class","text-sm font-medium text-yellow-300 mb-2"),f(n,"class","space-y-1")},m(v,_){fe(v,e,_),l(e,t),l(e,u),l(e,n);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(v,_){if(_[0]&64){s=Te(v[6].warnings);let d;for(d=0;d<s.length;d+=1){const m=lt(v,s,d);o[d]?o[d].p(m,_):(o[d]=Ct(m),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(v){v&&h(e),He(o,v)}}}function Ct(a){let e,t=a[57]+"",r,u;return{c(){e=i("div"),r=re(t),u=g(),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);r=ne(s,t),u=y(s),s.forEach(h),this.h()},h(){f(e,"class","text-xs text-yellow-200 bg-yellow-600/20 p-2 rounded")},m(n,s){fe(n,e,s),l(e,r),l(e,u)},p(n,s){s[0]&64&&t!==(t=n[57]+"")&&ye(r,t)},d(n){n&&h(e)}}}function kt(a){let e,t,r="Access Test Results",u,n,s,o,v,_,d,m,E,O="Requires Justification:",W,C,x=a[7].requires_justification?"Yes":"No",D,I,j,T,oe="Audit Required:",$,V,N=a[7].audit_required?"Yes":"No",me,q,ae,K,ge="Mask Preview:",ue,A,U=a[7].mask_preview?"Yes":"No",te,he,le,M,Y="Quarantine File:",R,B,ie=a[7].quarantine_file?"Yes":"No",_e,P,Q,se,xe,ee;const ce=[$t,Zt],X=[];function be(b,L){return b[7].allowed?0:1}o=be(a),v=X[o]=ce[o](a);let w=a[7].auto_clear_clipboard_ms&&wt(a),H=a[7].time_limit_ms&&Et(a),S=a[7].warning_message&&Dt(a),J=a[7].policy_rule_id&&Vt(a);return{c(){e=i("div"),t=i("h4"),t.textContent=r,u=g(),n=i("div"),s=i("div"),v.c(),_=g(),d=i("div"),m=i("div"),E=i("span"),E.textContent=O,W=g(),C=i("span"),D=re(x),I=g(),j=i("div"),T=i("span"),T.textContent=oe,$=g(),V=i("span"),me=re(N),q=g(),ae=i("div"),K=i("span"),K.textContent=ge,ue=g(),A=i("span"),te=re(U),he=g(),le=i("div"),M=i("span"),M.textContent=Y,R=g(),B=i("span"),_e=re(ie),P=g(),w&&w.c(),Q=g(),H&&H.c(),se=g(),S&&S.c(),xe=g(),J&&J.c(),this.h()},l(b){e=c(b,"DIV",{class:!0});var L=p(e);t=c(L,"H4",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-2achcp"&&(t.textContent=r),u=y(L),n=c(L,"DIV",{class:!0});var k=p(n);s=c(k,"DIV",{class:!0});var ve=p(s);v.l(ve),ve.forEach(h),_=y(k),d=c(k,"DIV",{class:!0});var Ve=p(d);m=c(Ve,"DIV",{});var G=p(m);E=c(G,"SPAN",{class:!0,"data-svelte-h":!0}),F(E)!=="svelte-a7bxpp"&&(E.textContent=O),W=y(G),C=c(G,"SPAN",{class:!0});var pe=p(C);D=ne(pe,x),pe.forEach(h),G.forEach(h),I=y(Ve),j=c(Ve,"DIV",{});var de=p(j);T=c(de,"SPAN",{class:!0,"data-svelte-h":!0}),F(T)!=="svelte-wc001f"&&(T.textContent=oe),$=y(de),V=c(de,"SPAN",{class:!0});var z=p(V);me=ne(z,N),z.forEach(h),de.forEach(h),q=y(Ve),ae=c(Ve,"DIV",{});var ke=p(ae);K=c(ke,"SPAN",{class:!0,"data-svelte-h":!0}),F(K)!=="svelte-h1g6of"&&(K.textContent=ge),ue=y(ke),A=c(ke,"SPAN",{class:!0});var Z=p(A);te=ne(Z,U),Z.forEach(h),ke.forEach(h),he=y(Ve),le=c(Ve,"DIV",{});var we=p(le);M=c(we,"SPAN",{class:!0,"data-svelte-h":!0}),F(M)!=="svelte-4z2vfl"&&(M.textContent=Y),R=y(we),B=c(we,"SPAN",{class:!0});var Ne=p(B);_e=ne(Ne,ie),Ne.forEach(h),we.forEach(h),Ve.forEach(h),P=y(k),w&&w.l(k),Q=y(k),H&&H.l(k),se=y(k),S&&S.l(k),xe=y(k),J&&J.l(k),k.forEach(h),L.forEach(h),this.h()},h(){f(t,"class","font-medium text-blue-300 mb-3"),f(s,"class","flex items-center space-x-2"),f(E,"class","text-gray-400"),f(C,"class","text-white ml-2"),f(T,"class","text-gray-400"),f(V,"class","text-white ml-2"),f(K,"class","text-gray-400"),f(A,"class","text-white ml-2"),f(M,"class","text-gray-400"),f(B,"class","text-white ml-2"),f(d,"class","grid grid-cols-2 gap-4 text-sm"),f(n,"class","space-y-3"),f(e,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-4")},m(b,L){fe(b,e,L),l(e,t),l(e,u),l(e,n),l(n,s),X[o].m(s,null),l(n,_),l(n,d),l(d,m),l(m,E),l(m,W),l(m,C),l(C,D),l(d,I),l(d,j),l(j,T),l(j,$),l(j,V),l(V,me),l(d,q),l(d,ae),l(ae,K),l(ae,ue),l(ae,A),l(A,te),l(d,he),l(d,le),l(le,M),l(le,R),l(le,B),l(B,_e),l(n,P),w&&w.m(n,null),l(n,Q),H&&H.m(n,null),l(n,se),S&&S.m(n,null),l(n,xe),J&&J.m(n,null),ee=!0},p(b,L){let k=o;o=be(b),o!==k&&(ze(),De(X[k],1,1,()=>{X[k]=null}),We(),v=X[o],v||(v=X[o]=ce[o](b),v.c()),Ce(v,1),v.m(s,null)),(!ee||L[0]&128)&&x!==(x=b[7].requires_justification?"Yes":"No")&&ye(D,x),(!ee||L[0]&128)&&N!==(N=b[7].audit_required?"Yes":"No")&&ye(me,N),(!ee||L[0]&128)&&U!==(U=b[7].mask_preview?"Yes":"No")&&ye(te,U),(!ee||L[0]&128)&&ie!==(ie=b[7].quarantine_file?"Yes":"No")&&ye(_e,ie),b[7].auto_clear_clipboard_ms?w?w.p(b,L):(w=wt(b),w.c(),w.m(n,Q)):w&&(w.d(1),w=null),b[7].time_limit_ms?H?H.p(b,L):(H=Et(b),H.c(),H.m(n,se)):H&&(H.d(1),H=null),b[7].warning_message?S?S.p(b,L):(S=Dt(b),S.c(),S.m(n,xe)):S&&(S.d(1),S=null),b[7].policy_rule_id?J?J.p(b,L):(J=Vt(b),J.c(),J.m(n,null)):J&&(J.d(1),J=null)},i(b){ee||(Ce(v),ee=!0)},o(b){De(v),ee=!1},d(b){b&&h(e),X[o].d(),w&&w.d(),H&&H.d(),S&&S.d(),J&&J.d()}}}function Zt(a){let e,t,r,u="Access Denied",n;return e=new Ze({props:{class:"w-5 h-5 text-red-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){Re(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),F(r)!=="svelte-1y0llmf"&&(r.textContent=u),this.h()},h(){f(r,"class","text-red-300")},m(s,o){je(e,s,o),fe(s,t,o),fe(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Oe(e,s)}}}function $t(a){let e,t,r,u="Access Allowed",n;return e=new Ge({props:{class:"w-5 h-5 text-green-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){Re(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),F(r)!=="svelte-fs36s8"&&(r.textContent=u),this.h()},h(){f(r,"class","text-green-300")},m(s,o){je(e,s,o),fe(s,t,o),fe(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Oe(e,s)}}}function wt(a){let e,t,r="Auto-clear Clipboard:",u,n,s=a[7].auto_clear_clipboard_ms/1e3+"",o,v;return{c(){e=i("div"),t=i("span"),t.textContent=r,u=g(),n=i("span"),o=re(s),v=re("s"),this.h()},l(_){e=c(_,"DIV",{class:!0});var d=p(e);t=c(d,"SPAN",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-2c4ku2"&&(t.textContent=r),u=y(d),n=c(d,"SPAN",{class:!0});var m=p(n);o=ne(m,s),v=ne(m,"s"),m.forEach(h),d.forEach(h),this.h()},h(){f(t,"class","text-gray-400"),f(n,"class","text-white ml-2"),f(e,"class","text-sm")},m(_,d){fe(_,e,d),l(e,t),l(e,u),l(e,n),l(n,o),l(n,v)},p(_,d){d[0]&128&&s!==(s=_[7].auto_clear_clipboard_ms/1e3+"")&&ye(o,s)},d(_){_&&h(e)}}}function Et(a){let e,t,r="Time Limit:",u,n,s=a[7].time_limit_ms/1e3+"",o,v;return{c(){e=i("div"),t=i("span"),t.textContent=r,u=g(),n=i("span"),o=re(s),v=re("s"),this.h()},l(_){e=c(_,"DIV",{class:!0});var d=p(e);t=c(d,"SPAN",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-k8s06h"&&(t.textContent=r),u=y(d),n=c(d,"SPAN",{class:!0});var m=p(n);o=ne(m,s),v=ne(m,"s"),m.forEach(h),d.forEach(h),this.h()},h(){f(t,"class","text-gray-400"),f(n,"class","text-white ml-2"),f(e,"class","text-sm")},m(_,d){fe(_,e,d),l(e,t),l(e,u),l(e,n),l(n,o),l(n,v)},p(_,d){d[0]&128&&s!==(s=_[7].time_limit_ms/1e3+"")&&ye(o,s)},d(_){_&&h(e)}}}function Dt(a){let e,t,r=a[7].warning_message+"",u;return{c(){e=i("div"),t=i("div"),u=re(r),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);t=c(s,"DIV",{class:!0});var o=p(t);u=ne(o,r),o.forEach(h),s.forEach(h),this.h()},h(){f(t,"class","text-sm text-yellow-200"),f(e,"class","bg-yellow-600/20 border border-yellow-500/30 p-3 rounded")},m(n,s){fe(n,e,s),l(e,t),l(t,u)},p(n,s){s[0]&128&&r!==(r=n[7].warning_message+"")&&ye(u,r)},d(n){n&&h(e)}}}function Vt(a){let e,t,r="Matched Rule:",u,n,s=a[7].policy_rule_id+"",o;return{c(){e=i("div"),t=i("span"),t.textContent=r,u=g(),n=i("span"),o=re(s),this.h()},l(v){e=c(v,"DIV",{class:!0});var _=p(e);t=c(_,"SPAN",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-2f9b35"&&(t.textContent=r),u=y(_),n=c(_,"SPAN",{class:!0});var d=p(n);o=ne(d,s),d.forEach(h),_.forEach(h),this.h()},h(){f(t,"class","text-gray-400"),f(n,"class","text-white ml-2 font-mono"),f(e,"class","text-sm")},m(v,_){fe(v,e,_),l(e,t),l(e,u),l(e,n),l(n,o)},p(v,_){_[0]&128&&s!==(s=v[7].policy_rule_id+"")&&ye(o,s)},d(v){v&&h(e)}}}function It(a){let e,t,r="Validation Results",u,n,s,o,v,_,d,m;const E=[tl,el],O=[];function W(D,I){return D[5].valid?0:1}o=W(a),v=O[o]=E[o](a);let C=a[5].errors.length>0&&Pt(a),x=a[5].warnings.length>0&&Nt(a);return{c(){e=i("div"),t=i("h4"),t.textContent=r,u=g(),n=i("div"),s=i("div"),v.c(),_=g(),C&&C.c(),d=g(),x&&x.c(),this.h()},l(D){e=c(D,"DIV",{class:!0});var I=p(e);t=c(I,"H4",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-1ddqk88"&&(t.textContent=r),u=y(I),n=c(I,"DIV",{class:!0});var j=p(n);s=c(j,"DIV",{class:!0});var T=p(s);v.l(T),T.forEach(h),_=y(j),C&&C.l(j),d=y(j),x&&x.l(j),j.forEach(h),I.forEach(h),this.h()},h(){f(t,"class","font-medium mb-3"),f(s,"class","flex items-center space-x-2"),f(n,"class","space-y-3"),f(e,"class","p-4")},m(D,I){fe(D,e,I),l(e,t),l(e,u),l(e,n),l(n,s),O[o].m(s,null),l(n,_),C&&C.m(n,null),l(n,d),x&&x.m(n,null),m=!0},p(D,I){let j=o;o=W(D),o!==j&&(ze(),De(O[j],1,1,()=>{O[j]=null}),We(),v=O[o],v||(v=O[o]=E[o](D),v.c()),Ce(v,1),v.m(s,null)),D[5].errors.length>0?C?C.p(D,I):(C=Pt(D),C.c(),C.m(n,d)):C&&(C.d(1),C=null),D[5].warnings.length>0?x?x.p(D,I):(x=Nt(D),x.c(),x.m(n,null)):x&&(x.d(1),x=null)},i(D){m||(Ce(v),m=!0)},o(D){De(v),m=!1},d(D){D&&h(e),O[o].d(),C&&C.d(),x&&x.d()}}}function el(a){let e,t,r,u="Invalid Policy",n;return e=new Ze({props:{class:"w-5 h-5 text-red-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){Re(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),F(r)!=="svelte-1l5d5pf"&&(r.textContent=u),this.h()},h(){f(r,"class","text-red-300")},m(s,o){je(e,s,o),fe(s,t,o),fe(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Oe(e,s)}}}function tl(a){let e,t,r,u="Valid Policy",n;return e=new Ge({props:{class:"w-5 h-5 text-green-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){Re(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),F(r)!=="svelte-yompue"&&(r.textContent=u),this.h()},h(){f(r,"class","text-green-300")},m(s,o){je(e,s,o),fe(s,t,o),fe(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Oe(e,s)}}}function Pt(a){let e,t,r="Errors:",u,n,s=Te(a[5].errors),o=[];for(let v=0;v<s.length;v+=1)o[v]=Tt(at(a,s,v));return{c(){e=i("div"),t=i("div"),t.textContent=r,u=g(),n=i("div");for(let v=0;v<o.length;v+=1)o[v].c();this.h()},l(v){e=c(v,"DIV",{});var _=p(e);t=c(_,"DIV",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-60o2ai"&&(t.textContent=r),u=y(_),n=c(_,"DIV",{class:!0});var d=p(n);for(let m=0;m<o.length;m+=1)o[m].l(d);d.forEach(h),_.forEach(h),this.h()},h(){f(t,"class","text-sm font-medium text-red-300 mb-2"),f(n,"class","space-y-1")},m(v,_){fe(v,e,_),l(e,t),l(e,u),l(e,n);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(v,_){if(_[0]&32){s=Te(v[5].errors);let d;for(d=0;d<s.length;d+=1){const m=at(v,s,d);o[d]?o[d].p(m,_):(o[d]=Tt(m),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(v){v&&h(e),He(o,v)}}}function Tt(a){let e,t=a[1]+"",r,u;return{c(){e=i("div"),r=re(t),u=g(),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);r=ne(s,t),u=y(s),s.forEach(h),this.h()},h(){f(e,"class","text-xs text-red-200 bg-red-600/20 p-2 rounded border border-red-500/30")},m(n,s){fe(n,e,s),l(e,r),l(e,u)},p(n,s){s[0]&32&&t!==(t=n[1]+"")&&ye(r,t)},d(n){n&&h(e)}}}function Nt(a){let e,t,r="Warnings:",u,n,s=Te(a[5].warnings),o=[];for(let v=0;v<s.length;v+=1)o[v]=At(ot(a,s,v));return{c(){e=i("div"),t=i("div"),t.textContent=r,u=g(),n=i("div");for(let v=0;v<o.length;v+=1)o[v].c();this.h()},l(v){e=c(v,"DIV",{});var _=p(e);t=c(_,"DIV",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-93q19v"&&(t.textContent=r),u=y(_),n=c(_,"DIV",{class:!0});var d=p(n);for(let m=0;m<o.length;m+=1)o[m].l(d);d.forEach(h),_.forEach(h),this.h()},h(){f(t,"class","text-sm font-medium text-yellow-300 mb-2"),f(n,"class","space-y-1")},m(v,_){fe(v,e,_),l(e,t),l(e,u),l(e,n);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(v,_){if(_[0]&32){s=Te(v[5].warnings);let d;for(d=0;d<s.length;d+=1){const m=ot(v,s,d);o[d]?o[d].p(m,_):(o[d]=At(m),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(v){v&&h(e),He(o,v)}}}function At(a){let e,t=a[57]+"",r,u;return{c(){e=i("div"),r=re(t),u=g(),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);r=ne(s,t),u=y(s),s.forEach(h),this.h()},h(){f(e,"class","text-xs text-yellow-200 bg-yellow-600/20 p-2 rounded border border-yellow-500/30")},m(n,s){fe(n,e,s),l(e,r),l(e,u)},p(n,s){s[0]&32&&t!==(t=n[57]+"")&&ye(r,t)},d(n){n&&h(e)}}}function St(a){let e,t,r,u,n,s,o,v,_="Policy Status",d,m,E=a[3].has_policy?"Active":"Inactive",O,W,C,x,D=a[3].total_rules+"",I,j,T,oe="Active Rules",$,V,N,me,q=a[3].version+"",ae,K,ge,ue="Policy Version";return{c(){e=i("div"),t=i("div"),r=i("div"),u=i("div"),s=g(),o=i("div"),v=i("div"),v.textContent=_,d=g(),m=i("div"),O=re(E),W=g(),C=i("div"),x=i("div"),I=re(D),j=g(),T=i("div"),T.textContent=oe,$=g(),V=i("div"),N=i("div"),me=re("v"),ae=re(q),K=g(),ge=i("div"),ge.textContent=ue,this.h()},l(A){e=c(A,"DIV",{class:!0});var U=p(e);t=c(U,"DIV",{class:!0});var te=p(t);r=c(te,"DIV",{class:!0});var he=p(r);u=c(he,"DIV",{class:!0}),p(u).forEach(h),s=y(he),o=c(he,"DIV",{});var le=p(o);v=c(le,"DIV",{class:!0,"data-svelte-h":!0}),F(v)!=="svelte-xvg4d"&&(v.textContent=_),d=y(le),m=c(le,"DIV",{class:!0});var M=p(m);O=ne(M,E),M.forEach(h),le.forEach(h),he.forEach(h),te.forEach(h),W=y(U),C=c(U,"DIV",{class:!0});var Y=p(C);x=c(Y,"DIV",{class:!0});var R=p(x);I=ne(R,D),R.forEach(h),j=y(Y),T=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),F(T)!=="svelte-p6pn2w"&&(T.textContent=oe),Y.forEach(h),$=y(U),V=c(U,"DIV",{class:!0});var B=p(V);N=c(B,"DIV",{class:!0});var ie=p(N);me=ne(ie,"v"),ae=ne(ie,q),ie.forEach(h),K=y(B),ge=c(B,"DIV",{class:!0,"data-svelte-h":!0}),F(ge)!=="svelte-a0ejuh"&&(ge.textContent=ue),B.forEach(h),U.forEach(h),this.h()},h(){f(u,"class",n="w-3 h-3 rounded-full "+(a[3].has_policy?"bg-green-400":"bg-red-400")),f(v,"class","text-lg font-semibold"),f(m,"class","text-sm text-gray-400"),f(r,"class","flex items-center space-x-3"),f(t,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-4"),f(x,"class","text-2xl font-bold text-cyan-400"),f(T,"class","text-sm text-gray-400"),f(C,"class","bg-black/40 backdrop-blur-sm border border-cyan-500/30 rounded-lg p-4"),f(N,"class","text-2xl font-bold text-purple-400"),f(ge,"class","text-sm text-gray-400"),f(V,"class","bg-black/40 backdrop-blur-sm border border-purple-500/30 rounded-lg p-4"),f(e,"class","grid grid-cols-1 md:grid-cols-3 gap-4")},m(A,U){fe(A,e,U),l(e,t),l(t,r),l(r,u),l(r,s),l(r,o),l(o,v),l(o,d),l(o,m),l(m,O),l(e,W),l(e,C),l(C,x),l(x,I),l(C,j),l(C,T),l(e,$),l(e,V),l(V,N),l(N,me),l(N,ae),l(V,K),l(V,ge)},p(A,U){U[0]&8&&n!==(n="w-3 h-3 rounded-full "+(A[3].has_policy?"bg-green-400":"bg-red-400"))&&f(u,"class",n),U[0]&8&&E!==(E=A[3].has_policy?"Active":"Inactive")&&ye(O,E),U[0]&8&&D!==(D=A[3].total_rules+"")&&ye(I,D),U[0]&8&&q!==(q=A[3].version+"")&&ye(ae,q)},d(A){A&&h(e)}}}function Ut(a){let e,t,r=a[54]+"",u;return{c(){e=i("div"),t=re("• "),u=re(r)},l(n){e=c(n,"DIV",{});var s=p(e);t=ne(s,"• "),u=ne(s,r),s.forEach(h)},m(n,s){fe(n,e,s),l(e,t),l(e,u)},p:Qe,d(n){n&&h(e)}}}function Rt(a){let e,t,r=a[51]+"",u;return{c(){e=i("div"),t=re("• "),u=re(r)},l(n){e=c(n,"DIV",{});var s=p(e);t=ne(s,"• "),u=ne(s,r),s.forEach(h)},m(n,s){fe(n,e,s),l(e,t),l(e,u)},p:Qe,d(n){n&&h(e)}}}function ll(a){let e,t,r,u,n,s,o,v='<h1 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent">Security &amp; Policy</h1> <p class="text-sm text-gray-400">Policy Engine Management &amp; Testing</p>',_,d,m,E,O,W,C,x,D,I,j,T,oe,$,V,N,me,q,ae,K,ge,ue,A,U,te,he,le;n=new jt({props:{class:"w-8 h-8 text-blue-400"}});let M=a[3]&&dt(a),Y=a[1]&&ut(a),R=a[0]&&ft(a);const B=[Kt,Jt,Qt,Wt],ie=[];function _e(P,Q){return P[2]==="overview"?0:P[2]==="editor"?1:P[2]==="tester"?2:P[2]==="context"?3:-1}return~(A=_e(a))&&(U=ie[A]=B[A](a)),{c(){e=i("div"),t=i("div"),r=i("div"),u=i("div"),Ue(n.$$.fragment),s=g(),o=i("div"),o.innerHTML=v,_=g(),M&&M.c(),d=g(),m=i("div"),E=i("button"),O=re("Overview"),C=g(),x=i("button"),D=re("Policy Editor"),j=g(),T=i("button"),oe=re("Policy Tester"),V=g(),N=i("button"),me=re("Context Manager"),ae=g(),Y&&Y.c(),K=g(),R&&R.c(),ge=g(),ue=i("div"),U&&U.c(),this.h()},l(P){e=c(P,"DIV",{class:!0});var Q=p(e);t=c(Q,"DIV",{class:!0});var se=p(t);r=c(se,"DIV",{class:!0});var xe=p(r);u=c(xe,"DIV",{class:!0});var ee=p(u);Re(n.$$.fragment,ee),s=y(ee),o=c(ee,"DIV",{"data-svelte-h":!0}),F(o)!=="svelte-ni6yo7"&&(o.innerHTML=v),ee.forEach(h),_=y(xe),M&&M.l(xe),xe.forEach(h),d=y(se),m=c(se,"DIV",{class:!0});var ce=p(m);E=c(ce,"BUTTON",{class:!0});var X=p(E);O=ne(X,"Overview"),X.forEach(h),C=y(ce),x=c(ce,"BUTTON",{class:!0});var be=p(x);D=ne(be,"Policy Editor"),be.forEach(h),j=y(ce),T=c(ce,"BUTTON",{class:!0});var w=p(T);oe=ne(w,"Policy Tester"),w.forEach(h),V=y(ce),N=c(ce,"BUTTON",{class:!0});var H=p(N);me=ne(H,"Context Manager"),H.forEach(h),ce.forEach(h),se.forEach(h),ae=y(Q),Y&&Y.l(Q),K=y(Q),R&&R.l(Q),ge=y(Q),ue=c(Q,"DIV",{class:!0});var S=p(ue);U&&U.l(S),S.forEach(h),Q.forEach(h),this.h()},h(){f(u,"class","flex items-center space-x-3"),f(r,"class","flex items-center justify-between p-4"),f(E,"class",W="px-4 py-2 rounded-lg transition-colors "+(a[2]==="overview"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")),f(x,"class",I="px-4 py-2 rounded-lg transition-colors "+(a[2]==="editor"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")),f(T,"class",$="px-4 py-2 rounded-lg transition-colors "+(a[2]==="tester"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")),f(N,"class",q="px-4 py-2 rounded-lg transition-colors "+(a[2]==="context"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")),f(m,"class","flex space-x-1 px-4 pb-4"),f(t,"class","border-b border-blue-500/30 bg-black/20 backdrop-blur-sm"),f(ue,"class","flex-1 overflow-hidden"),f(e,"class","h-full bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 text-white overflow-hidden")},m(P,Q){fe(P,e,Q),l(e,t),l(t,r),l(r,u),je(n,u,null),l(u,s),l(u,o),l(r,_),M&&M.m(r,null),l(t,d),l(t,m),l(m,E),l(E,O),l(m,C),l(m,x),l(x,D),l(m,j),l(m,T),l(T,oe),l(m,V),l(m,N),l(N,me),l(e,ae),Y&&Y.m(e,null),l(e,K),R&&R.m(e,null),l(e,ge),l(e,ue),~A&&ie[A].m(ue,null),te=!0,he||(le=[Ee(E,"click",a[30]),Ee(x,"click",a[31]),Ee(T,"click",a[32]),Ee(N,"click",a[33])],he=!0)},p(P,Q){P[3]?M?M.p(P,Q):(M=dt(P),M.c(),M.m(r,null)):M&&(M.d(1),M=null),(!te||Q[0]&4&&W!==(W="px-4 py-2 rounded-lg transition-colors "+(P[2]==="overview"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")))&&f(E,"class",W),(!te||Q[0]&4&&I!==(I="px-4 py-2 rounded-lg transition-colors "+(P[2]==="editor"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")))&&f(x,"class",I),(!te||Q[0]&4&&$!==($="px-4 py-2 rounded-lg transition-colors "+(P[2]==="tester"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")))&&f(T,"class",$),(!te||Q[0]&4&&q!==(q="px-4 py-2 rounded-lg transition-colors "+(P[2]==="context"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")))&&f(N,"class",q),P[1]?Y?Y.p(P,Q):(Y=ut(P),Y.c(),Y.m(e,K)):Y&&(Y.d(1),Y=null),P[0]?R?R.p(P,Q):(R=ft(P),R.c(),R.m(e,ge)):R&&(R.d(1),R=null);let se=A;A=_e(P),A===se?~A&&ie[A].p(P,Q):(U&&(ze(),De(ie[se],1,1,()=>{ie[se]=null}),We()),~A?(U=ie[A],U?U.p(P,Q):(U=ie[A]=B[A](P),U.c()),Ce(U,1),U.m(ue,null)):U=null)},i(P){te||(Ce(n.$$.fragment,P),Ce(U),te=!0)},o(P){De(n.$$.fragment,P),De(U),te=!1},d(P){P&&h(e),Oe(n),M&&M.d(),Y&&Y.d(),R&&R.d(),~A&&ie[A].d(),he=!1,Ke(le)}}}function sl(a,e,t){let r="overview",u=null,n="",s=null,o=null,v=null,_=!1,d="",m="",E="Terminal",O="Read",W={},C="",x="",D="current_user",I={};const j=["Terminal","Ssh","Vault","Vpn","Browser","Files","Clipboard","Network","Theme","Settings","Logs","Policy"],T=["Read","Write","Exec","Connect","Download","Upload","Autofill","Copy","Paste","Delete","Create","Update","Export","Import","Switch","Apply","Reload","Query","Browse","Search"],oe={restrictive:`# Restrictive Security Policy
# Denies most operations by default, requires explicit allow rules

version = 1
name = "Restrictive Policy"
description = "High security policy with minimal permissions"

[defaults]
effect = "Deny"
require_justification = true
audit_all = true
auto_clear_clipboard_ms = 30000
mask_preview = true
quarantine_downloads = true

[[rules]]
id = "allow-basic-terminal"
resource = "Terminal"
action = "Read"
effect = "Allow"
conditions = { user_role = "user" }

[[rules]]
id = "allow-settings-read"
resource = "Settings"
action = "Read"
effect = "Allow"

[[rules]]
id = "deny-sensitive-operations"
resource = ["Vault", "Ssh", "Files"]
action = ["Write", "Delete", "Export"]
effect = "Deny"
warning_message = "Sensitive operations require admin approval"`,development:`# Development Policy
# More permissive for development environments

version = 1
name = "Development Policy"
description = "Permissive policy for development use"

[defaults]
effect = "Allow"
require_justification = false
audit_all = false
auto_clear_clipboard_ms = 300000
mask_preview = false
quarantine_downloads = false

[[rules]]
id = "allow-all-terminal"
resource = "Terminal"
action = "*"
effect = "Allow"

[[rules]]
id = "allow-vault-read"
resource = "Vault"
action = ["Read", "Create", "Update"]
effect = "Allow"
conditions = { pq_available = true }

[[rules]]
id = "restrict-policy-changes"
resource = "Policy"
action = ["Update", "Delete"]
effect = "Deny"
require_justification = true
warning_message = "Policy changes require careful review"`,balanced:`# Balanced Security Policy
# Reasonable security with usability

version = 1
name = "Balanced Policy"
description = "Balanced security and usability"

[defaults]
effect = "Allow"
require_justification = false
audit_all = true
auto_clear_clipboard_ms = 120000
mask_preview = true
quarantine_downloads = true

[[rules]]
id = "allow-standard-operations"
resource = ["Terminal", "Settings", "Theme"]
action = "*"
effect = "Allow"

[[rules]]
id = "vault-with-mfa"
resource = "Vault"
action = "*"
effect = "Allow"
conditions = { mfa_verified = true }

[[rules]]
id = "sensitive-with-justification"
resource = ["Ssh", "Files", "Network"]
action = ["Write", "Delete", "Connect"]
effect = "Allow"
require_justification = true
time_limit_ms = 3600000

[[rules]]
id = "clipboard-security"
resource = "Clipboard"
action = "*"
effect = "Allow"
auto_clear_clipboard_ms = 60000
mask_preview = true`};qt(async()=>{await $(),t(4,n=oe.balanced)});async function $(){try{t(3,u=await Me("policy_get_stats"))}catch(b){console.error("Failed to load policy stats:",b)}}async function V(){if(!n.trim()){t(1,d="Policy content cannot be empty");return}t(8,_=!0),t(1,d="");try{t(5,s=await Me("policy_validate",{policyContent:n})),s.valid?t(0,m="Policy validation successful"):t(1,d="Policy validation failed")}catch(b){t(1,d=`Validation failed: ${b}`),t(5,s=null)}finally{t(8,_=!1)}}async function N(){if(!s?.valid){t(1,d="Please validate the policy first");return}t(8,_=!0),t(1,d="");try{await Me("policy_load",{policyContent:n}),t(0,m="Policy loaded successfully"),await $()}catch(b){t(1,d=`Failed to load policy: ${b}`)}finally{t(8,_=!1)}}async function me(){if(!E||!O){t(1,d="Please select resource and action");return}t(8,_=!0),t(1,d="");try{t(6,o=await Me("policy_dry_run",{resource:E,action:O,context:W}))}catch(b){t(1,d=`Dry run failed: ${b}`),t(6,o=null)}finally{t(8,_=!1)}}async function q(){if(!E||!O){t(1,d="Please select resource and action");return}t(8,_=!0),t(1,d="");try{t(7,v=await Me("policy_test_access",{resource:E,action:O,context:Object.keys(W).length>0?W:null}))}catch(b){t(1,d=`Access test failed: ${b}`),t(7,v=null)}finally{t(8,_=!1)}}async function ae(){if(!D.trim()){t(1,d="User ID cannot be empty");return}try{await Me("policy_set_user",{userId:D}),t(0,m=`User context set to: ${D}`)}catch(b){t(1,d=`Failed to set user: ${b}`)}}async function K(){if(!C.trim()||!x.trim()){t(1,d="Context key and value cannot be empty");return}try{await Me("policy_update_context",{key:C,value:x}),t(15,I[C]=x,I),t(0,m=`Context updated: ${C} = ${x}`),t(12,C=""),t(13,x="")}catch(b){t(1,d=`Failed to update context: ${b}`)}}function ge(){!C.trim()||!x.trim()||(t(11,W[C]=x,W),t(11,W={...W}),t(12,C=""),t(13,x=""))}function ue(b){delete W[b],t(11,W={...W})}function A(b){t(4,n=oe[b]),t(5,s=null),t(0,m=`Loaded ${b} policy template`)}async function U(b){try{const L=await Me("policy_get_defaults",{scenario:b});t(4,n=L),t(0,m=`Loaded ${b} default policy`)}catch(L){t(1,d=`Failed to load default policy: ${L}`)}}function te(){if(!n.trim()){t(1,d="No policy content to export");return}const b=new Blob([n],{type:"text/plain"}),L=URL.createObjectURL(b),k=document.createElement("a");k.href=L,k.download="ghostshell-policy.toml",document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(L),t(0,m="Policy exported successfully")}function he(b){const k=b.target.files?.[0];if(!k)return;const ve=new FileReader;ve.onload=Ve=>{t(4,n=Ve.target?.result),t(5,s=null),t(0,m="Policy imported successfully")},ve.readAsText(k)}const le=()=>t(2,r="overview"),M=()=>t(2,r="editor"),Y=()=>t(2,r="tester"),R=()=>t(2,r="context"),B=()=>U("restrictive"),ie=()=>U("development"),_e=()=>A("balanced");function P(){n=this.value,t(4,n)}const Q=()=>A("restrictive"),se=()=>A("development"),xe=()=>A("balanced");function ee(){E=$e(this),t(9,E),t(16,j)}function ce(){O=$e(this),t(10,O),t(17,T)}function X(){C=this.value,t(12,C)}function be(){x=this.value,t(13,x)}const w=b=>ue(b);function H(){D=this.value,t(14,D)}function S(){C=this.value,t(12,C)}function J(){x=this.value,t(13,x)}return a.$$.update=()=>{a.$$.dirty[0]&2&&d&&setTimeout(()=>t(1,d=""),5e3),a.$$.dirty[0]&1&&m&&setTimeout(()=>t(0,m=""),5e3)},[m,d,r,u,n,s,o,v,_,E,O,W,C,x,D,I,j,T,V,N,me,q,ae,K,ge,ue,A,U,te,he,le,M,Y,R,B,ie,_e,P,Q,se,xe,ee,ce,X,be,w,H,S,J]}class ul extends Lt{constructor(e){super(),Bt(this,e,sl,ll,Ot,{},null,[-1,-1,-1])}}export{ul as default};
