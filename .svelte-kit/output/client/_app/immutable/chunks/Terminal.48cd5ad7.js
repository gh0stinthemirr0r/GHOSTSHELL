import{_ as $}from"./preload-helper.a4192956.js";import{s as be,f as T,a as H,g as E,h as D,c as R,d as F,O as ge,j as y,k as se,i as ee,x as g,R as le,M as N,J as ye,E as ve,o as we,P as Fe,l as xe,m as ke,n as Be,p as Te,U as Ee,y as Ae}from"./scheduler.78e7c9ac.js";import{S as Se,i as De,b as de,d as fe,m as me,a as P,g as he,c as pe,t as j,e as _e}from"./index.93082cef.js";import{e as ie,X as Ie}from"./2.2a907247.js";import{s as Ce}from"./settings.10dbda86.js";import{t as Le,i as J}from"./theme.9ade0a60.js";import{l as Ve}from"./event.bbd47227.js";import{P as Pe}from"./plus.ff2ec606.js";function ae(s,n,r){const a=s.slice();return a[35]=n[r],a}function ce(s){let n,r,a,e,_;r=new Ie({props:{size:12}});function x(){return s[8](s[35])}return{c(){n=T("button"),de(r.$$.fragment),this.h()},l(m){n=E(m,"BUTTON",{class:!0});var o=D(n);fe(r.$$.fragment,o),o.forEach(F),this.h()},h(){y(n,"class","p-0.5 rounded hover:bg-red-500/20 hover:text-red-400 transition-colors")},m(m,o){ee(m,n,o),me(r,n,null),a=!0,e||(_=N(n,"click",Ee(x)),e=!0)},p(m,o){s=m},i(m){a||(P(r.$$.fragment,m),a=!0)},o(m){j(r.$$.fragment,m),a=!1},d(m){m&&F(n),_e(r),e=!1,_()}}}function ue(s){let n,r,a,e=s[35].title+"",_,x,m,o,h,I,k,l=s[1].length>1&&ce(s);function B(){return s[9](s[35])}return{c(){n=T("div"),r=T("button"),a=T("span"),_=xe(e),x=H(),l&&l.c(),o=H(),this.h()},l(b){n=E(b,"DIV",{class:!0});var c=D(n);r=E(c,"BUTTON",{class:!0});var A=D(r);a=E(A,"SPAN",{class:!0});var v=D(a);_=ke(v,e),v.forEach(F),x=R(A),l&&l.l(A),A.forEach(F),o=R(c),c.forEach(F),this.h()},h(){y(a,"class","text-sm font-medium"),y(r,"class",m="flex items-center space-x-2 px-3 py-1.5 rounded-t-lg border-b-2 transition-all duration-200 "+(s[35].active?"bg-black/20 border-cyan-500 text-cyan-400":"hover:bg-white/5 border-transparent text-gray-400 hover:text-white")),y(n,"class","flex items-center")},m(b,c){ee(b,n,c),g(n,r),g(r,a),g(a,_),g(r,x),l&&l.m(r,null),g(n,o),h=!0,I||(k=N(r,"click",B),I=!0)},p(b,c){s=b,(!h||c[0]&2)&&e!==(e=s[35].title+"")&&Be(_,e),s[1].length>1?l?(l.p(s,c),c[0]&2&&P(l,1)):(l=ce(s),l.c(),P(l,1),l.m(r,null)):l&&(he(),j(l,1,1,()=>{l=null}),pe()),(!h||c[0]&2&&m!==(m="flex items-center space-x-2 px-3 py-1.5 rounded-t-lg border-b-2 transition-all duration-200 "+(s[35].active?"bg-black/20 border-cyan-500 text-cyan-400":"hover:bg-white/5 border-transparent text-gray-400 hover:text-white")))&&y(r,"class",m)},i(b){h||(P(l),h=!0)},o(b){j(l),h=!1},d(b){b&&F(n),l&&l.d(),I=!1,k()}}}function ze(s){let n;return{c(){n=T("div"),this.h()},l(r){n=E(r,"DIV",{class:!0,style:!0}),D(n).forEach(F),this.h()},h(){y(n,"class","absolute inset-0 p-4 pb-0"),se(n,"font-family","var(--font-mono)")},m(r,a){ee(r,n,a),s[10](n)},p:Ae,d(r){r&&F(n),s[10](null)}}}function Oe(s){let n,r,a,e,_,x,m,o,h,I,k,l='<div class="absolute inset-4 rounded-lg" style="box-shadow: inset 0 0 20px rgba(175, 255, 0, 0.1);"></div>',B,b,c,A,v,W,z,X,K,L=ie(s[1]),u=[];for(let i=0;i<L.length;i+=1)u[i]=ue(ae(s,L,i));const Y=i=>j(u[i],1,1,()=>{u[i]=null});x=new Pe({props:{size:16}});function te(i,p){return ze}let O=te()(s);return{c(){n=T("div"),r=T("div"),a=T("div");for(let i=0;i<u.length;i+=1)u[i].c();e=H(),_=T("button"),de(x.$$.fragment),m=H(),o=T("div"),h=T("div"),O.c(),I=H(),k=T("div"),k.innerHTML=l,B=H(),b=T("div"),c=T("input"),A=H(),v=T("div"),this.h()},l(i){n=E(i,"DIV",{class:!0});var p=D(n);r=E(p,"DIV",{class:!0});var d=D(r);a=E(d,"DIV",{class:!0});var C=D(a);for(let Z=0;Z<u.length;Z+=1)u[Z].l(C);e=R(C),_=E(C,"BUTTON",{class:!0,title:!0});var Q=D(_);fe(x.$$.fragment,Q),Q.forEach(F),C.forEach(F),d.forEach(F),m=R(p),o=E(p,"DIV",{class:!0});var G=D(o);h=E(G,"DIV",{class:!0});var U=D(h);O.l(U),I=R(U),k=E(U,"DIV",{class:!0,"data-svelte-h":!0}),ge(k)!=="svelte-3ay1qp"&&(k.innerHTML=l),U.forEach(F),B=R(G),b=E(G,"DIV",{class:!0});var q=D(b);c=E(q,"INPUT",{placeholder:!0,class:!0,style:!0}),A=R(q),v=E(q,"DIV",{class:!0,style:!0}),D(v).forEach(F),q.forEach(F),G.forEach(F),p.forEach(F),this.h()},h(){y(_,"class","flex items-center justify-center w-8 h-8 rounded hover:bg-white/10 transition-colors text-gray-400 hover:text-white"),y(_,"title","New Shell"),y(a,"class","flex items-center space-x-1"),y(r,"class","frosted border-b border-gray-800/50 px-4 py-2"),y(k,"class","absolute inset-0 pointer-events-none"),y(h,"class","flex-1 relative"),y(c,"placeholder","Type your command here and press Enter..."),c.autofocus=!0,y(c,"class","w-full bg-black/30 border border-gray-700/50 rounded-lg px-4 py-2 text-white font-mono text-sm placeholder-gray-500 focus:border-cyan-500/50 focus:outline-none focus:ring-1 focus:ring-cyan-500/30 transition-all duration-200"),se(c,"font-family","var(--font-mono)"),y(v,"class",W="absolute inset-4 rounded-lg pointer-events-none opacity-0 transition-opacity duration-200 "+(s[3]?"opacity-100":"")),se(v,"box-shadow","0 0 20px rgba(0, 255, 209, 0.2)"),y(b,"class","frosted border-t border-gray-800/50 p-4 relative"),y(o,"class","flex-1 flex flex-col relative"),y(n,"class","h-full flex flex-col bg-transparent")},m(i,p){ee(i,n,p),g(n,r),g(r,a);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(a,null);g(a,e),g(a,_),me(x,_,null),g(n,m),g(n,o),g(o,h),O.m(h,null),g(h,I),g(h,k),g(o,B),g(o,b),g(b,c),le(c,s[2]),g(b,A),g(b,v),z=!0,c.focus(),X||(K=[N(_,"click",s[5]),N(c,"input",s[11]),N(c,"keydown",s[4]),N(c,"focus",s[12]),N(c,"blur",s[13])],X=!0)},p(i,p){if(p[0]&194){L=ie(i[1]);let d;for(d=0;d<L.length;d+=1){const C=ae(i,L,d);u[d]?(u[d].p(C,p),P(u[d],1)):(u[d]=ue(C),u[d].c(),P(u[d],1),u[d].m(a,e))}for(he(),d=L.length;d<u.length;d+=1)Y(d);pe()}O.p(i,p),p[0]&4&&c.value!==i[2]&&le(c,i[2]),(!z||p[0]&8&&W!==(W="absolute inset-4 rounded-lg pointer-events-none opacity-0 transition-opacity duration-200 "+(i[3]?"opacity-100":"")))&&y(v,"class",W)},i(i){if(!z){for(let p=0;p<L.length;p+=1)P(u[p]);P(x.$$.fragment,i),z=!0}},o(i){u=u.filter(Boolean);for(let p=0;p<u.length;p+=1)j(u[p]);j(x.$$.fragment,i),z=!1},d(i){i&&F(n),ye(u,i),_e(x),O.d(),X=!1,ve(K)}}}function Me(s,n,r){let a,e,_,x,m,o=[{id:1,title:"Shell 1",active:!0,sessionId:null}],h=1,I=2,k=new Map,l="",B=[],b=-1,c=!1,A=null,v=null;const W=Le.subscribe(t=>{A=t.currentTheme,e&&A&&K()}),z=Ce.subscribe(t=>{v=t,e&&v&&L()});we(async()=>{const{Terminal:t}=await $(()=>import("./xterm.7fe5c096.js").then(w=>w.x),["./xterm.7fe5c096.js","./_commonjsHelpers.d4b30cbb.js"],import.meta.url),{FitAddon:f}=await $(()=>import("./addon-fit.8c2f918b.js").then(w=>w.a),["./addon-fit.8c2f918b.js","./_commonjsHelpers.d4b30cbb.js"],import.meta.url),{WebglAddon:S}=await $(()=>import("./addon-webgl.d4c757b1.js").then(w=>w.a),["./addon-webgl.d4c757b1.js","./_commonjsHelpers.d4b30cbb.js"],import.meta.url),{LigaturesAddon:ne}=await $(()=>import("./addon-ligatures.619789de.js").then(w=>w.a),["./addon-ligatures.619789de.js","./_commonjsHelpers.d4b30cbb.js"],import.meta.url);await X(t,f,S,ne);const M=await Ve("terminal-output",w=>{e&&w.payload.session_id===Y()&&e.write(w.payload.data)}),oe=()=>{if(_){_.fit();const w=Y();w&&J("terminal_resize",{sessionId:w,cols:e.cols,rows:e.rows}).catch(console.error)}};return window.addEventListener("resize",oe),()=>{window.removeEventListener("resize",oe),M();for(const w of k.values())w&&J("terminal_close_session",{sessionId:w}).catch(console.error)}}),Fe(()=>{e&&e.dispose(),W(),z()});async function X(t,f,S,ne){e=new t({allowProposedApi:!0,allowTransparency:!0,fontFamily:"var(--font-mono)",fontSize:14,letterSpacing:.2,lineHeight:1.2,theme:{background:"#00000000",foreground:"#EAEAEA",cursor:"#AFFF00",cursorAccent:"#0A0F1E",selectionBackground:"#00FFD170",black:"#0A0F1E",red:"#FF4D4D",green:"#2EE6A6",yellow:"#F5A623",blue:"#6FA8FF",magenta:"#FF00FF",cyan:"#00FFD1",white:"#D7E1FF",brightBlack:"#1A2037",brightRed:"#FF6B6B",brightGreen:"#49F0B6",brightYellow:"#FFC85B",brightBlue:"#9BC2FF",brightMagenta:"#FF66FF",brightCyan:"#6FFFF0",brightWhite:"#FFFFFF"},cursorStyle:"underline",cursorBlink:!1,disableStdin:!0,convertEol:!0,rightClickSelectsWord:!1,scrollback:1e4,tabStopWidth:4}),e.open(a),e.textarea&&(e.textarea.style.display="none",e.textarea.style.visibility="hidden",e.textarea.style.position="absolute",e.textarea.style.left="-9999px",e.textarea.style.top="-9999px"),_=new f,e.loadAddon(_),m=new ne,e.loadAddon(m);try{x=new S,e.loadAddon(x),console.log("WebGL addon loaded successfully")}catch(M){console.warn("WebGL addon failed to load, falling back to canvas:",M)}_.fit(),await u(1),setTimeout(()=>{if(e){e.clear(),e.writeln("\x1B[1;32mTerminal ready. Type commands below.\x1B[0m");const M=a.querySelector(".xterm");M&&(M.querySelectorAll("textarea, input").forEach(V=>{V.style.display="none",V.style.visibility="hidden",V.style.position="absolute",V.style.left="-9999px",V.style.top="-9999px"}),M.querySelectorAll(".xterm-helper-textarea, .xterm-char-measure-element, .xterm-accessibility").forEach(V=>{V.style.display="none",V.style.visibility="hidden"}))}},200)}function K(){if(!e||!A)return;const t=A.tokens;e.options.theme={background:"#00000000",foreground:t.fg,cursor:t.cursorColor,cursorAccent:t.slate,selectionBackground:t.accentCyan+"70",black:"#0A0F1E",red:"#FF4D4D",green:t.accentNeonGreen,yellow:"#F5A623",blue:"#6FA8FF",magenta:t.accentPink,cyan:t.accentCyan,white:t.fg,brightBlack:"#1A2037",brightRed:"#FF6B6B",brightGreen:"#49F0B6",brightYellow:"#FFC85B",brightBlue:"#9BC2FF",brightMagenta:"#FF66FF",brightCyan:"#6FFFF0",brightWhite:"#FFFFFF"},e.options.fontFamily=t.monoFont}function L(){!e||!v||(e.options.cursorStyle=v.terminal.cursorStyle,e.options.cursorBlink=v.terminal.cursorBlink,e.options.fontSize=v.fonts.fontSize,e.options.fontFamily=v.fonts.monoFont)}async function u(t){try{const f=await J("terminal_create_session",{shellType:null,workingDirectory:null});return k.set(t,f),r(1,o=o.map(S=>S.id===t?{...S,sessionId:f}:S)),e&&t===h&&e.writeln("\x1B[1;32mConnected.\x1B[0m"),f}catch(f){return console.error("Failed to create terminal session:",f),e&&t===h&&e.writeln("\x1B[1;31mDemo mode.\x1B[0m"),null}}function Y(){return k.get(h)||null}function te(t){t.key==="Enter"?(t.preventDefault(),O()):t.key==="ArrowUp"?(t.preventDefault(),re(-1)):t.key==="ArrowDown"?(t.preventDefault(),re(1)):t.key==="Tab"&&t.preventDefault()}function re(t){if(B.length===0)return;const f=Math.max(-1,Math.min(B.length-1,b+t));b=f,f>=0?r(2,l=B[f]):r(2,l="")}async function O(){if(!l.trim())return;l.trim()!==B[B.length-1]&&(B=[...B,l.trim()],B.length>100&&(B=B.slice(-100))),b=-1;const t=l.trim();r(2,l=""),e&&e.write(`\x1B[1;36m>\x1B[0m ${t}\r
`);const f=Y();if(f)try{await J("terminal_write_input",{sessionId:f,input:t+"\r"})}catch(S){console.error("Failed to send command to terminal:",S),i(t)}else i(t)}function i(t){e&&setTimeout(()=>{switch(t.toLowerCase()){case"help":e.write(`\x1B[1;36mGHOSTSHELL Commands:\x1B[0m\r
`),e.write(`  help     - Show this help message\r
`),e.write(`  clear    - Clear the terminal\r
`),e.write(`  whoami   - Show current user\r
`),e.write(`  pwd      - Show current directory\r
`),e.write(`  ls       - List directory contents\r
`);break;case"clear":e.clear();return;case"whoami":e.write(`ghost\r
`);break;case"pwd":e.write(`/home/ghost\r
`);break;case"ls":e.write(`\x1B[1;34mDocuments\x1B[0m  \x1B[1;34mDownloads\x1B[0m  \x1B[1;34mDesktop\x1B[0m  \x1B[1;32mscript.sh\x1B[0m\r
`);break;default:t&&(e.write(`\x1B[1;31mCommand not found: ${t}\x1B[0m\r
`),e.write(`\x1B[1;33mType "help" for available commands\x1B[0m\r
`))}},100)}async function p(){const t={id:I++,title:`Shell ${I-1}`,active:!1,sessionId:null};r(1,o=o.map(f=>({...f,active:!1}))),r(1,o=[...o,{...t,active:!0}]),h=t.id,await u(t.id)}async function d(t){if(o.length===1)return;const f=k.get(t);if(f){try{await J("terminal_close_session",{sessionId:f})}catch(S){console.error("Failed to close terminal session:",S)}k.delete(t)}r(1,o=o.filter(S=>S.id!==t)),h===t&&o.length>0&&(r(1,o[0].active=!0,o),h=o[0].id,r(1,o=[...o]),e&&e.clear())}function C(t){r(1,o=o.map(f=>({...f,active:f.id===t}))),h=t,e&&e.clear()}const Q=t=>d(t.id),G=t=>C(t.id);function U(t){Te[t?"unshift":"push"](()=>{a=t,r(0,a)})}function q(){l=this.value,r(2,l)}return[a,o,l,c,te,p,d,C,Q,G,U,q,()=>r(3,c=!0),()=>r(3,c=!1)]}class Ye extends Se{constructor(n){super(),De(this,n,Me,Oe,be,{},null,[-1,-1])}}export{Ye as default};
