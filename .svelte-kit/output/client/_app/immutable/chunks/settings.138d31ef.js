import{w as u}from"./index.a5826648.js";function h(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function i(r,e=!1){const n=h(),o=`_${n}`;return Object.defineProperty(window,o,{value:t=>(e&&Reflect.deleteProperty(window,o),r?.(t)),writable:!1,configurable:!0}),n}async function a(r,e={}){return new Promise((n,o)=>{const t=i(c=>{n(c),Reflect.deleteProperty(window,`_${s}`)},!0),s=i(c=>{o(c),Reflect.deleteProperty(window,`_${t}`)},!0);window.__TAURI_IPC__({cmd:r,callback:t,error:s,...e})})}function m(r,e="asset"){return window.__TAURI__.convertFileSrc(r,e)}const T=Object.freeze(Object.defineProperty({__proto__:null,convertFileSrc:m,invoke:a,transformCallback:i},Symbol.toStringTag,{value:"Module"})),f={themes:[],currentTheme:null,currentThemeId:null};function w(){const{subscribe:r,set:e,update:n}=u(f);return{subscribe:r,setThemes:o=>{n(t=>({...t,themes:o}))},setCurrentTheme:o=>{n(t=>({...t,currentTheme:o})),l(o.tokens)},setCurrentThemeId:o=>{n(t=>({...t,currentThemeId:o}))},applyTheme:async o=>{try{const t=await a("apply_theme",{themeId:o});return n(s=>({...s,currentTheme:t,currentThemeId:o})),l(t.tokens),t}catch(t){throw console.error("Failed to apply theme:",t),t}},saveTheme:async o=>{try{const t=await a("save_theme",{theme:o}),s=await a("list_themes");return n(c=>({...c,themes:s})),t}catch(t){throw console.error("Failed to save theme:",t),t}},exportTheme:async o=>{try{return await a("export_theme",{themeId:o})}catch(t){throw console.error("Failed to export theme:",t),t}},importTheme:async o=>{try{const t=await a("import_theme",{theme:o}),s=await a("list_themes");return n(c=>({...c,themes:s})),t}catch(t){throw console.error("Failed to import theme:",t),t}}}}function l(r){const e=document.documentElement;e.style.setProperty("--bg-tint",r.bgTint),e.style.setProperty("--fg",r.fg),e.style.setProperty("--slate",r.slate),e.style.setProperty("--accent-pink",r.accentPink),e.style.setProperty("--accent-cyan",r.accentCyan),e.style.setProperty("--accent-neon-green",r.accentNeonGreen),e.style.setProperty("--glow-strength",r.glowStrength.toString()),e.style.setProperty("--blur",`${r.blurPx}px`),e.style.setProperty("--noise",r.noiseOpacity.toString()),e.style.setProperty("--cursor-color",r.cursorColor),e.style.setProperty("--font-mono",r.monoFont),e.style.setProperty("--font-ui",r.uiFont),e.style.setProperty("--radius",`${r.radius}px`),e.style.setProperty("--border-color",r.border),g(r.bgTint)}async function g(r){const e=P(r);if(e){const[n,o,t,s]=e,c=Math.round(s*255);try{await a("set_acrylic_tint",{r:n,g:o,b:t,a:c})}catch(d){console.warn("Failed to update acrylic tint:",d)}}}function P(r){const e=r.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(e){const n=parseInt(e[1],10),o=parseInt(e[2],10),t=parseInt(e[3],10),s=e[4]?parseFloat(e[4]):1;return[n,o,t,s]}return null}const v=w(),_={accessibility:{reduceMotion:!1,highContrast:!1,transparency:.7},fonts:{monoFont:"JetBrainsMono Nerd Font",uiFont:"Inter",fontSize:14},terminal:{cursorStyle:"block",cursorBlink:!1,fontLigatures:!0}};function b(){const{subscribe:r,set:e,update:n}=u(_);return{subscribe:r,set:e,update:n,updateSettings:async o=>{try{await a("update_settings",{newSettings:o}),e(o),F(o)}catch(t){throw console.error("Failed to update settings:",t),t}},setAccessibility:async o=>{try{await a("set_accessibility",{reduceMotion:o.reduceMotion,highContrast:o.highContrast,transparency:o.transparency}),n(t=>({...t,accessibility:o})),y(o)}catch(t){throw console.error("Failed to update accessibility settings:",t),t}},setFonts:async o=>{try{await a("set_fonts",{monoFont:o.monoFont,uiFont:o.uiFont,fontSize:o.fontSize}),n(t=>({...t,fonts:o})),p(o)}catch(t){throw console.error("Failed to update font settings:",t),t}}}}function F(r){y(r.accessibility),p(r.fonts)}function y(r){const e=document.documentElement;r.reduceMotion?e.classList.add("reduce-motion"):e.classList.remove("reduce-motion"),r.highContrast?e.classList.add("high-contrast"):e.classList.remove("high-contrast"),e.style.setProperty("--transparency",r.transparency.toString())}function p(r){const e=document.documentElement;e.style.setProperty("--font-mono",r.monoFont),e.style.setProperty("--font-ui",r.uiFont),e.style.setProperty("--font-size-base",`${r.fontSize}px`)}const I=b();export{i as a,T as b,a as i,I as s,v as t};
