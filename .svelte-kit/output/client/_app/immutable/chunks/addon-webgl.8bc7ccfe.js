import{g as Ee}from"./_commonjsHelpers.d4b30cbb.js";function Se(ne,ve){for(var re=0;re<ve.length;re++){const Z=ve[re];if(typeof Z!="string"&&!Array.isArray(Z)){for(const Y in Z)if(Y!=="default"&&!(Y in ne)){const oe=Object.getOwnPropertyDescriptor(Z,Y);oe&&Object.defineProperty(ne,Y,oe.get?oe:{enumerable:!0,get:()=>Z[Y]})}}}return Object.freeze(Object.defineProperty(ne,Symbol.toStringTag,{value:"Module"}))}var be={exports:{}};(function(ne,ve){(function(re,Z){ne.exports=Z()})(self,()=>(()=>{var re={965:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphRenderer=void 0;const l=c(374),o=c(509),r=c(855),_=c(859),L=c(381),d=11,i=d*Float32Array.BYTES_PER_ELEMENT;let t,g=0,w=0,v=0;class M extends _.Disposable{constructor(a,m,u,h){super(),this._terminal=a,this._gl=m,this._dimensions=u,this._optionsService=h,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};const s=this._gl;o.TextureAtlas.maxAtlasPages===void 0&&(o.TextureAtlas.maxAtlasPages=Math.min(32,(0,l.throwIfFalsy)(s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS))),o.TextureAtlas.maxTextureSize=(0,l.throwIfFalsy)(s.getParameter(s.MAX_TEXTURE_SIZE))),this._program=(0,l.throwIfFalsy)((0,L.createProgram)(s,`#version 300 es
layout (location = 0) in vec2 a_unitquad;
layout (location = 1) in vec2 a_cellpos;
layout (location = 2) in vec2 a_offset;
layout (location = 3) in vec2 a_size;
layout (location = 4) in float a_texpage;
layout (location = 5) in vec2 a_texcoord;
layout (location = 6) in vec2 a_texsize;

uniform mat4 u_projection;
uniform vec2 u_resolution;

out vec2 v_texcoord;
flat out int v_texpage;

void main() {
  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_texpage = int(a_texpage);
  v_texcoord = a_texcoord + a_unitquad * a_texsize;
}`,function(y){let R="";for(let b=1;b<y;b++)R+=` else if (v_texpage == ${b}) { outColor = texture(u_texture[${b}], v_texcoord); }`;return`#version 300 es
precision lowp float;

in vec2 v_texcoord;
flat in int v_texpage;

uniform sampler2D u_texture[${y}];

out vec4 outColor;

void main() {
  if (v_texpage == 0) {
    outColor = texture(u_texture[0], v_texcoord);
  } ${R}
}`}(o.TextureAtlas.maxAtlasPages))),this.register((0,_.toDisposable)(()=>s.deleteProgram(this._program))),this._projectionLocation=(0,l.throwIfFalsy)(s.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=(0,l.throwIfFalsy)(s.getUniformLocation(this._program,"u_resolution")),this._textureLocation=(0,l.throwIfFalsy)(s.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=s.createVertexArray(),s.bindVertexArray(this._vertexArrayObject);const f=new Float32Array([0,0,1,0,0,1,1,1]),n=s.createBuffer();this.register((0,_.toDisposable)(()=>s.deleteBuffer(n))),s.bindBuffer(s.ARRAY_BUFFER,n),s.bufferData(s.ARRAY_BUFFER,f,s.STATIC_DRAW),s.enableVertexAttribArray(0),s.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);const C=new Uint8Array([0,1,2,3]),p=s.createBuffer();this.register((0,_.toDisposable)(()=>s.deleteBuffer(p))),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,p),s.bufferData(s.ELEMENT_ARRAY_BUFFER,C,s.STATIC_DRAW),this._attributesBuffer=(0,l.throwIfFalsy)(s.createBuffer()),this.register((0,_.toDisposable)(()=>s.deleteBuffer(this._attributesBuffer))),s.bindBuffer(s.ARRAY_BUFFER,this._attributesBuffer),s.enableVertexAttribArray(2),s.vertexAttribPointer(2,2,s.FLOAT,!1,i,0),s.vertexAttribDivisor(2,1),s.enableVertexAttribArray(3),s.vertexAttribPointer(3,2,s.FLOAT,!1,i,2*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(3,1),s.enableVertexAttribArray(4),s.vertexAttribPointer(4,1,s.FLOAT,!1,i,4*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(4,1),s.enableVertexAttribArray(5),s.vertexAttribPointer(5,2,s.FLOAT,!1,i,5*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(5,1),s.enableVertexAttribArray(6),s.vertexAttribPointer(6,2,s.FLOAT,!1,i,7*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(6,1),s.enableVertexAttribArray(1),s.vertexAttribPointer(1,2,s.FLOAT,!1,i,9*Float32Array.BYTES_PER_ELEMENT),s.vertexAttribDivisor(1,1),s.useProgram(this._program);const A=new Int32Array(o.TextureAtlas.maxAtlasPages);for(let y=0;y<o.TextureAtlas.maxAtlasPages;y++)A[y]=y;s.uniform1iv(this._textureLocation,A),s.uniformMatrix4fv(this._projectionLocation,!1,L.PROJECTION_MATRIX),this._atlasTextures=[];for(let y=0;y<o.TextureAtlas.maxAtlasPages;y++){const R=new L.GLTexture((0,l.throwIfFalsy)(s.createTexture()));this.register((0,_.toDisposable)(()=>s.deleteTexture(R.texture))),s.activeTexture(s.TEXTURE0+y),s.bindTexture(s.TEXTURE_2D,R.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),this._atlasTextures[y]=R}s.enable(s.BLEND),s.blendFunc(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA),this.handleResize()}beginFrame(){return!this._atlas||this._atlas.beginFrame()}updateCell(a,m,u,h,s,f,n,C,p){this._updateCell(this._vertices.attributes,a,m,u,h,s,f,n,C,p)}_updateCell(a,m,u,h,s,f,n,C,p,A){g=(u*this._terminal.cols+m)*d,h!==r.NULL_CELL_CODE&&h!==void 0?this._atlas&&(t=C&&C.length>1?this._atlas.getRasterizedGlyphCombinedChar(C,s,f,n,!1):this._atlas.getRasterizedGlyph(h,s,f,n,!1),w=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),s!==A&&t.offset.x>w?(v=t.offset.x-w,a[g]=-(t.offset.x-v)+this._dimensions.device.char.left,a[g+1]=-t.offset.y+this._dimensions.device.char.top,a[g+2]=(t.size.x-v)/this._dimensions.device.canvas.width,a[g+3]=t.size.y/this._dimensions.device.canvas.height,a[g+4]=t.texturePage,a[g+5]=t.texturePositionClipSpace.x+v/this._atlas.pages[t.texturePage].canvas.width,a[g+6]=t.texturePositionClipSpace.y,a[g+7]=t.sizeClipSpace.x-v/this._atlas.pages[t.texturePage].canvas.width,a[g+8]=t.sizeClipSpace.y):(a[g]=-t.offset.x+this._dimensions.device.char.left,a[g+1]=-t.offset.y+this._dimensions.device.char.top,a[g+2]=t.size.x/this._dimensions.device.canvas.width,a[g+3]=t.size.y/this._dimensions.device.canvas.height,a[g+4]=t.texturePage,a[g+5]=t.texturePositionClipSpace.x,a[g+6]=t.texturePositionClipSpace.y,a[g+7]=t.sizeClipSpace.x,a[g+8]=t.sizeClipSpace.y),this._optionsService.rawOptions.rescaleOverlappingGlyphs&&(0,l.allowRescaling)(h,p,t.size.x,this._dimensions.device.cell.width)&&(a[g+2]=(this._dimensions.device.cell.width-1)/this._dimensions.device.canvas.width)):a.fill(0,g,g+d-1-2)}clear(){const a=this._terminal,m=a.cols*a.rows*d;this._vertices.count!==m?this._vertices.attributes=new Float32Array(m):this._vertices.attributes.fill(0);let u=0;for(;u<this._vertices.attributesBuffers.length;u++)this._vertices.count!==m?this._vertices.attributesBuffers[u]=new Float32Array(m):this._vertices.attributesBuffers[u].fill(0);this._vertices.count=m,u=0;for(let h=0;h<a.rows;h++)for(let s=0;s<a.cols;s++)this._vertices.attributes[u+9]=s/a.cols,this._vertices.attributes[u+10]=h/a.rows,u+=d}handleResize(){const a=this._gl;a.useProgram(this._program),a.viewport(0,0,a.canvas.width,a.canvas.height),a.uniform2f(this._resolutionLocation,a.canvas.width,a.canvas.height),this.clear()}render(a){if(!this._atlas)return;const m=this._gl;m.useProgram(this._program),m.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;const u=this._vertices.attributesBuffers[this._activeBuffer];let h=0;for(let s=0;s<a.lineLengths.length;s++){const f=s*this._terminal.cols*d,n=this._vertices.attributes.subarray(f,f+a.lineLengths[s]*d);u.set(n,h),h+=n.length}m.bindBuffer(m.ARRAY_BUFFER,this._attributesBuffer),m.bufferData(m.ARRAY_BUFFER,u.subarray(0,h),m.STREAM_DRAW);for(let s=0;s<this._atlas.pages.length;s++)this._atlas.pages[s].version!==this._atlasTextures[s].version&&this._bindAtlasPageTexture(m,this._atlas,s);m.drawElementsInstanced(m.TRIANGLE_STRIP,4,m.UNSIGNED_BYTE,0,h/d)}setAtlas(a){this._atlas=a;for(const m of this._atlasTextures)m.version=-1}_bindAtlasPageTexture(a,m,u){a.activeTexture(a.TEXTURE0+u),a.bindTexture(a.TEXTURE_2D,this._atlasTextures[u].texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,m.pages[u].canvas),a.generateMipmap(a.TEXTURE_2D),this._atlasTextures[u].version=m.pages[u].version}setDimensions(a){this._dimensions=a}}e.GlyphRenderer=M},742:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RectangleRenderer=void 0;const l=c(374),o=c(859),r=c(310),_=c(381),L=8*Float32Array.BYTES_PER_ELEMENT;class d{constructor(){this.attributes=new Float32Array(160),this.count=0}}let i=0,t=0,g=0,w=0,v=0,M=0,x=0;class a extends o.Disposable{constructor(u,h,s,f){super(),this._terminal=u,this._gl=h,this._dimensions=s,this._themeService=f,this._vertices=new d,this._verticesCursor=new d;const n=this._gl;this._program=(0,l.throwIfFalsy)((0,_.createProgram)(n,`#version 300 es
layout (location = 0) in vec2 a_position;
layout (location = 1) in vec2 a_size;
layout (location = 2) in vec4 a_color;
layout (location = 3) in vec2 a_unitquad;

uniform mat4 u_projection;

out vec4 v_color;

void main() {
  vec2 zeroToOne = a_position + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_color = a_color;
}`,`#version 300 es
precision lowp float;

in vec4 v_color;

out vec4 outColor;

void main() {
  outColor = v_color;
}`)),this.register((0,o.toDisposable)(()=>n.deleteProgram(this._program))),this._projectionLocation=(0,l.throwIfFalsy)(n.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=n.createVertexArray(),n.bindVertexArray(this._vertexArrayObject);const C=new Float32Array([0,0,1,0,0,1,1,1]),p=n.createBuffer();this.register((0,o.toDisposable)(()=>n.deleteBuffer(p))),n.bindBuffer(n.ARRAY_BUFFER,p),n.bufferData(n.ARRAY_BUFFER,C,n.STATIC_DRAW),n.enableVertexAttribArray(3),n.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);const A=new Uint8Array([0,1,2,3]),y=n.createBuffer();this.register((0,o.toDisposable)(()=>n.deleteBuffer(y))),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,y),n.bufferData(n.ELEMENT_ARRAY_BUFFER,A,n.STATIC_DRAW),this._attributesBuffer=(0,l.throwIfFalsy)(n.createBuffer()),this.register((0,o.toDisposable)(()=>n.deleteBuffer(this._attributesBuffer))),n.bindBuffer(n.ARRAY_BUFFER,this._attributesBuffer),n.enableVertexAttribArray(0),n.vertexAttribPointer(0,2,n.FLOAT,!1,L,0),n.vertexAttribDivisor(0,1),n.enableVertexAttribArray(1),n.vertexAttribPointer(1,2,n.FLOAT,!1,L,2*Float32Array.BYTES_PER_ELEMENT),n.vertexAttribDivisor(1,1),n.enableVertexAttribArray(2),n.vertexAttribPointer(2,4,n.FLOAT,!1,L,4*Float32Array.BYTES_PER_ELEMENT),n.vertexAttribDivisor(2,1),this._updateCachedColors(f.colors),this.register(this._themeService.onChangeColors(R=>{this._updateCachedColors(R),this._updateViewportRectangle()}))}renderBackgrounds(){this._renderVertices(this._vertices)}renderCursor(){this._renderVertices(this._verticesCursor)}_renderVertices(u){const h=this._gl;h.useProgram(this._program),h.bindVertexArray(this._vertexArrayObject),h.uniformMatrix4fv(this._projectionLocation,!1,_.PROJECTION_MATRIX),h.bindBuffer(h.ARRAY_BUFFER,this._attributesBuffer),h.bufferData(h.ARRAY_BUFFER,u.attributes,h.DYNAMIC_DRAW),h.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,h.UNSIGNED_BYTE,0,u.count)}handleResize(){this._updateViewportRectangle()}setDimensions(u){this._dimensions=u}_updateCachedColors(u){this._bgFloat=this._colorToFloat32Array(u.background),this._cursorFloat=this._colorToFloat32Array(u.cursor)}_updateViewportRectangle(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}updateBackgrounds(u){const h=this._terminal,s=this._vertices;let f,n,C,p,A,y,R,b,S,E,I,B=1;for(f=0;f<h.rows;f++){for(C=-1,p=0,A=0,y=!1,n=0;n<h.cols;n++)R=(f*h.cols+n)*r.RENDER_MODEL_INDICIES_PER_CELL,b=u.cells[R+r.RENDER_MODEL_BG_OFFSET],S=u.cells[R+r.RENDER_MODEL_FG_OFFSET],E=!!(67108864&S),(b!==p||S!==A&&(y||E))&&((p!==0||y&&A!==0)&&(I=8*B++,this._updateRectangle(s,I,A,p,C,n,f)),C=n,p=b,A=S,y=E);(p!==0||y&&A!==0)&&(I=8*B++,this._updateRectangle(s,I,A,p,C,h.cols,f))}s.count=B}updateCursor(u){const h=this._verticesCursor,s=u.cursor;if(!s||s.style==="block")return void(h.count=0);let f,n=0;s.style!=="bar"&&s.style!=="outline"||(f=8*n++,this._addRectangleFloat(h.attributes,f,s.x*this._dimensions.device.cell.width,s.y*this._dimensions.device.cell.height,s.style==="bar"?s.dpr*s.cursorWidth:s.dpr,this._dimensions.device.cell.height,this._cursorFloat)),s.style!=="underline"&&s.style!=="outline"||(f=8*n++,this._addRectangleFloat(h.attributes,f,s.x*this._dimensions.device.cell.width,(s.y+1)*this._dimensions.device.cell.height-s.dpr,s.width*this._dimensions.device.cell.width,s.dpr,this._cursorFloat)),s.style==="outline"&&(f=8*n++,this._addRectangleFloat(h.attributes,f,s.x*this._dimensions.device.cell.width,s.y*this._dimensions.device.cell.height,s.width*this._dimensions.device.cell.width,s.dpr,this._cursorFloat),f=8*n++,this._addRectangleFloat(h.attributes,f,(s.x+s.width)*this._dimensions.device.cell.width-s.dpr,s.y*this._dimensions.device.cell.height,s.dpr,this._dimensions.device.cell.height,this._cursorFloat)),h.count=n}_updateRectangle(u,h,s,f,n,C,p){if(67108864&s)switch(50331648&s){case 16777216:case 33554432:i=this._themeService.colors.ansi[255&s].rgba;break;case 50331648:i=(16777215&s)<<8;break;default:i=this._themeService.colors.foreground.rgba}else switch(50331648&f){case 16777216:case 33554432:i=this._themeService.colors.ansi[255&f].rgba;break;case 50331648:i=(16777215&f)<<8;break;default:i=this._themeService.colors.background.rgba}u.attributes.length<h+4&&(u.attributes=(0,_.expandFloat32Array)(u.attributes,this._terminal.rows*this._terminal.cols*8)),t=n*this._dimensions.device.cell.width,g=p*this._dimensions.device.cell.height,w=(i>>24&255)/255,v=(i>>16&255)/255,M=(i>>8&255)/255,x=1,this._addRectangle(u.attributes,h,t,g,(C-n)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,w,v,M,x)}_addRectangle(u,h,s,f,n,C,p,A,y,R){u[h]=s/this._dimensions.device.canvas.width,u[h+1]=f/this._dimensions.device.canvas.height,u[h+2]=n/this._dimensions.device.canvas.width,u[h+3]=C/this._dimensions.device.canvas.height,u[h+4]=p,u[h+5]=A,u[h+6]=y,u[h+7]=R}_addRectangleFloat(u,h,s,f,n,C,p){u[h]=s/this._dimensions.device.canvas.width,u[h+1]=f/this._dimensions.device.canvas.height,u[h+2]=n/this._dimensions.device.canvas.width,u[h+3]=C/this._dimensions.device.canvas.height,u[h+4]=p[0],u[h+5]=p[1],u[h+6]=p[2],u[h+7]=p[3]}_colorToFloat32Array(u){return new Float32Array([(u.rgba>>24&255)/255,(u.rgba>>16&255)/255,(u.rgba>>8&255)/255,(255&u.rgba)/255])}}e.RectangleRenderer=a},310:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.RenderModel=e.COMBINED_CHAR_BIT_MASK=e.RENDER_MODEL_EXT_OFFSET=e.RENDER_MODEL_FG_OFFSET=e.RENDER_MODEL_BG_OFFSET=e.RENDER_MODEL_INDICIES_PER_CELL=void 0;const l=c(296);e.RENDER_MODEL_INDICIES_PER_CELL=4,e.RENDER_MODEL_BG_OFFSET=1,e.RENDER_MODEL_FG_OFFSET=2,e.RENDER_MODEL_EXT_OFFSET=3,e.COMBINED_CHAR_BIT_MASK=2147483648,e.RenderModel=class{constructor(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,l.createSelectionRenderModel)()}resize(o,r){const _=o*r*e.RENDER_MODEL_INDICIES_PER_CELL;_!==this.cells.length&&(this.cells=new Uint32Array(_),this.lineLengths=new Uint32Array(r))}clear(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}},666:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.JoinedCellData=e.WebglRenderer=void 0;const l=c(820),o=c(274),r=c(627),_=c(457),L=c(56),d=c(374),i=c(345),t=c(859),g=c(147),w=c(782),v=c(855),M=c(965),x=c(742),a=c(310),m=c(733);class u extends t.Disposable{constructor(n,C,p,A,y,R,b,S,E){super(),this._terminal=n,this._characterJoinerService=C,this._charSizeService=p,this._coreBrowserService=A,this._coreService=y,this._decorationService=R,this._optionsService=b,this._themeService=S,this._cursorBlinkStateManager=new t.MutableDisposable,this._charAtlasDisposable=this.register(new t.MutableDisposable),this._observerDisposable=this.register(new t.MutableDisposable),this._model=new a.RenderModel,this._workCell=new w.CellData,this._workCell2=new w.CellData,this._rectangleRenderer=this.register(new t.MutableDisposable),this._glyphRenderer=this.register(new t.MutableDisposable),this._onChangeTextureAtlas=this.register(new i.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new i.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new i.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onRequestRedraw=this.register(new i.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onContextLoss=this.register(new i.EventEmitter),this.onContextLoss=this._onContextLoss.event,this.register(this._themeService.onChangeColors(()=>this._handleColorChange())),this._cellColorResolver=new o.CellColorResolver(this._terminal,this._optionsService,this._model.selection,this._decorationService,this._coreBrowserService,this._themeService),this._core=this._terminal._core,this._renderLayers=[new m.LinkRenderLayer(this._core.screenElement,2,this._terminal,this._core.linkifier,this._coreBrowserService,b,this._themeService)],this.dimensions=(0,d.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this._updateCursorBlink(),this.register(b.onOptionChange(()=>this._handleOptionsChanged())),this._canvas=this._coreBrowserService.mainDocument.createElement("canvas");const I={antialias:!1,depth:!1,preserveDrawingBuffer:E};if(this._gl=this._canvas.getContext("webgl2",I),!this._gl)throw new Error("WebGL2 not supported "+this._gl);this.register((0,l.addDisposableDomListener)(this._canvas,"webglcontextlost",B=>{console.log("webglcontextlost event received"),B.preventDefault(),this._contextRestorationTimeout=setTimeout(()=>{this._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),this._onContextLoss.fire(B)},3e3)})),this.register((0,l.addDisposableDomListener)(this._canvas,"webglcontextrestored",B=>{console.warn("webglcontextrestored event received"),clearTimeout(this._contextRestorationTimeout),this._contextRestorationTimeout=void 0,(0,r.removeTerminalFromCache)(this._terminal),this._initializeWebGLState(),this._requestRedrawViewport()})),this._observerDisposable.value=(0,L.observeDevicePixelDimensions)(this._canvas,this._coreBrowserService.window,(B,W)=>this._setCanvasDevicePixelDimensions(B,W)),this.register(this._coreBrowserService.onWindowChange(B=>{this._observerDisposable.value=(0,L.observeDevicePixelDimensions)(this._canvas,B,(W,O)=>this._setCanvasDevicePixelDimensions(W,O))})),this._core.screenElement.appendChild(this._canvas),[this._rectangleRenderer.value,this._glyphRenderer.value]=this._initializeWebGLState(),this._isAttached=this._coreBrowserService.window.document.body.contains(this._core.screenElement),this.register((0,t.toDisposable)(()=>{var B;for(const W of this._renderLayers)W.dispose();(B=this._canvas.parentElement)==null||B.removeChild(this._canvas),(0,r.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){var n;return(n=this._charAtlas)==null?void 0:n.pages[0].canvas}_handleColorChange(){this._refreshCharAtlas(),this._clearModel(!0)}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}handleResize(n,C){var p,A,y,R;this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(const b of this._renderLayers)b.resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width=`${this.dimensions.css.canvas.width}px`,this._canvas.style.height=`${this.dimensions.css.canvas.height}px`,this._core.screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._core.screenElement.style.height=`${this.dimensions.css.canvas.height}px`,(p=this._rectangleRenderer.value)==null||p.setDimensions(this.dimensions),(A=this._rectangleRenderer.value)==null||A.handleResize(),(y=this._glyphRenderer.value)==null||y.setDimensions(this.dimensions),(R=this._glyphRenderer.value)==null||R.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}handleCharSizeChanged(){this.handleResize(this._terminal.cols,this._terminal.rows)}handleBlur(){var n;for(const C of this._renderLayers)C.handleBlur(this._terminal);(n=this._cursorBlinkStateManager.value)==null||n.pause(),this._requestRedrawViewport()}handleFocus(){var n;for(const C of this._renderLayers)C.handleFocus(this._terminal);(n=this._cursorBlinkStateManager.value)==null||n.resume(),this._requestRedrawViewport()}handleSelectionChanged(n,C,p){for(const A of this._renderLayers)A.handleSelectionChanged(this._terminal,n,C,p);this._model.selection.update(this._core,n,C,p),this._requestRedrawViewport()}handleCursorMove(){var n;for(const C of this._renderLayers)C.handleCursorMove(this._terminal);(n=this._cursorBlinkStateManager.value)==null||n.restartBlinkAnimation()}_handleOptionsChanged(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}_initializeWebGLState(){return this._rectangleRenderer.value=new x.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new M.GlyphRenderer(this._terminal,this._gl,this.dimensions,this._optionsService),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}_refreshCharAtlas(){var C;if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)return void(this._isAttached=!1);const n=(0,r.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==n&&(this._onChangeTextureAtlas.fire(n.pages[0].canvas),this._charAtlasDisposable.value=(0,t.getDisposeArrayDisposable)([(0,i.forwardEvent)(n.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,i.forwardEvent)(n.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=n,this._charAtlas.warmUp(),(C=this._glyphRenderer.value)==null||C.setAtlas(this._charAtlas)}_clearModel(n){var C;this._model.clear(),n&&((C=this._glyphRenderer.value)==null||C.clear())}clearTextureAtlas(){var n;(n=this._charAtlas)==null||n.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}clear(){var n;this._clearModel(!0);for(const C of this._renderLayers)C.reset(this._terminal);(n=this._cursorBlinkStateManager.value)==null||n.restartBlinkAnimation(),this._updateCursorBlink()}registerCharacterJoiner(n){return-1}deregisterCharacterJoiner(n){return!1}renderRows(n,C){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(const p of this._renderLayers)p.handleGridChanged(this._terminal,n,C);this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(n,C),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),this._cursorBlinkStateManager.value&&!this._cursorBlinkStateManager.value.isCursorVisible||this._rectangleRenderer.value.renderCursor())}_updateCursorBlink(){this._terminal.options.cursorBlink?this._cursorBlinkStateManager.value=new _.CursorBlinkStateManager(()=>{this._requestRedrawCursor()},this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}_updateModel(n,C){const p=this._core;let A,y,R,b,S,E,I,B,W,O,X,z,k,j,H=this._workCell;n=s(n,p.rows-1,0),C=s(C,p.rows-1,0);const J=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,fe=J-p.buffer.ydisp,ee=Math.min(this._terminal.buffer.active.cursorX,p.cols-1);let te=-1;const U=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;let ie=!1;for(y=n;y<=C;y++)for(R=y+p.buffer.ydisp,b=p.buffer.lines.get(R),this._model.lineLengths[y]=0,S=this._characterJoinerService.getJoinedCharacters(R),k=0;k<p.cols;k++)if(A=this._cellColorResolver.result.bg,b.loadCell(k,H),k===0&&(A=this._cellColorResolver.result.bg),E=!1,I=k,S.length>0&&k===S[0][0]&&(E=!0,B=S.shift(),H=new h(H,b.translateToString(!0,B[0],B[1]),B[1]-B[0]),I=B[1]-1),W=H.getChars(),O=H.getCode(),z=(y*p.cols+k)*a.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(H,k,R,this.dimensions.device.cell.width),U&&R===J&&(k===ee&&(this._model.cursor={x:ee,y:fe,width:H.getWidth(),style:this._coreBrowserService.isFocused?p.options.cursorStyle||"block":p.options.cursorInactiveStyle,cursorWidth:p.options.cursorWidth,dpr:this._devicePixelRatio},te=ee+H.getWidth()-1),k>=ee&&k<=te&&(this._coreBrowserService.isFocused&&(p.options.cursorStyle||"block")==="block"||this._coreBrowserService.isFocused===!1&&p.options.cursorInactiveStyle==="block")&&(this._cellColorResolver.result.fg=50331648|this._themeService.colors.cursorAccent.rgba>>8&16777215,this._cellColorResolver.result.bg=50331648|this._themeService.colors.cursor.rgba>>8&16777215)),O!==v.NULL_CELL_CODE&&(this._model.lineLengths[y]=k+1),(this._model.cells[z]!==O||this._model.cells[z+a.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[z+a.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[z+a.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(ie=!0,W.length>1&&(O|=a.COMBINED_CHAR_BIT_MASK),this._model.cells[z]=O,this._model.cells[z+a.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[z+a.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[z+a.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,X=H.getWidth(),this._glyphRenderer.value.updateCell(k,y,O,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,W,X,A),E))for(H=this._workCell,k++;k<I;k++)j=(y*p.cols+k)*a.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.value.updateCell(k,y,v.NULL_CELL_CODE,0,0,0,v.NULL_CELL_CHAR,0,0),this._model.cells[j]=v.NULL_CELL_CODE,this._model.cells[j+a.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[j+a.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[j+a.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;ie&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}_updateDimensions(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}_setCanvasDevicePixelDimensions(n,C){this._canvas.width===n&&this._canvas.height===C||(this._canvas.width=n,this._canvas.height=C,this._requestRedrawViewport())}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}_requestRedrawCursor(){const n=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:n,end:n})}}e.WebglRenderer=u;class h extends g.AttributeData{constructor(n,C,p){super(),this.content=0,this.combinedData="",this.fg=n.fg,this.bg=n.bg,this.combinedData=C,this._width=p}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(n){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}function s(f,n,C=0){return Math.max(Math.min(f,n),C)}e.JoinedCellData=h},381:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GLTexture=e.expandFloat32Array=e.createShader=e.createProgram=e.PROJECTION_MATRIX=void 0;const l=c(374);function o(r,_,L){const d=(0,l.throwIfFalsy)(r.createShader(_));if(r.shaderSource(d,L),r.compileShader(d),r.getShaderParameter(d,r.COMPILE_STATUS))return d;console.error(r.getShaderInfoLog(d)),r.deleteShader(d)}e.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),e.createProgram=function(r,_,L){const d=(0,l.throwIfFalsy)(r.createProgram());if(r.attachShader(d,(0,l.throwIfFalsy)(o(r,r.VERTEX_SHADER,_))),r.attachShader(d,(0,l.throwIfFalsy)(o(r,r.FRAGMENT_SHADER,L))),r.linkProgram(d),r.getProgramParameter(d,r.LINK_STATUS))return d;console.error(r.getProgramInfoLog(d)),r.deleteProgram(d)},e.createShader=o,e.expandFloat32Array=function(r,_){const L=Math.min(2*r.length,_),d=new Float32Array(L);for(let i=0;i<r.length;i++)d[i]=r[i];return d},e.GLTexture=class{constructor(r){this.texture=r,this.version=-1}}},592:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseRenderLayer=void 0;const l=c(627),o=c(237),r=c(374),_=c(859);class L extends _.Disposable{constructor(i,t,g,w,v,M,x,a){super(),this._container=t,this._alpha=v,this._coreBrowserService=M,this._optionsService=x,this._themeService=a,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add(`xterm-${g}-layer`),this._canvas.style.zIndex=w.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this.register(this._themeService.onChangeColors(m=>{this._refreshCharAtlas(i,m),this.reset(i)})),this.register((0,_.toDisposable)(()=>{this._canvas.remove()}))}_initCanvas(){this._ctx=(0,r.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(i){}handleFocus(i){}handleCursorMove(i){}handleGridChanged(i,t,g){}handleSelectionChanged(i,t,g,w=!1){}_setTransparency(i,t){if(t===this._alpha)return;const g=this._canvas;this._alpha=t,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,g),this._refreshCharAtlas(i,this._themeService.colors),this.handleGridChanged(i,0,i.rows-1)}_refreshCharAtlas(i,t){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,l.acquireTextureAtlas)(i,this._optionsService.rawOptions,t,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}resize(i,t){this._deviceCellWidth=t.device.cell.width,this._deviceCellHeight=t.device.cell.height,this._deviceCharWidth=t.device.char.width,this._deviceCharHeight=t.device.char.height,this._deviceCharLeft=t.device.char.left,this._deviceCharTop=t.device.char.top,this._canvas.width=t.device.canvas.width,this._canvas.height=t.device.canvas.height,this._canvas.style.width=`${t.css.canvas.width}px`,this._canvas.style.height=`${t.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(i,this._themeService.colors)}_fillBottomLineAtCells(i,t,g=1){this._ctx.fillRect(i*this._deviceCellWidth,(t+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,g*this._deviceCellWidth,this._coreBrowserService.dpr)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(i,t,g,w){this._alpha?this._ctx.clearRect(i*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,w*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(i*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,w*this._deviceCellHeight))}_fillCharTrueColor(i,t,g,w){this._ctx.font=this._getFont(i,!1,!1),this._ctx.textBaseline=o.TEXT_BASELINE,this._clipCell(g,w,t.getWidth()),this._ctx.fillText(t.getChars(),g*this._deviceCellWidth+this._deviceCharLeft,w*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_clipCell(i,t,g){this._ctx.beginPath(),this._ctx.rect(i*this._deviceCellWidth,t*this._deviceCellHeight,g*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(i,t,g){return`${g?"italic":""} ${t?i.options.fontWeightBold:i.options.fontWeight} ${i.options.fontSize*this._coreBrowserService.dpr}px ${i.options.fontFamily}`}}e.BaseRenderLayer=L},733:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LinkRenderLayer=void 0;const l=c(197),o=c(237),r=c(592);class _ extends r.BaseRenderLayer{constructor(d,i,t,g,w,v,M){super(t,d,"link",i,!0,w,v,M),this.register(g.onShowLinkUnderline(x=>this._handleShowLinkUnderline(x))),this.register(g.onHideLinkUnderline(x=>this._handleHideLinkUnderline(x)))}resize(d,i){super.resize(d,i),this._state=void 0}reset(d){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);const d=this._state.y2-this._state.y1-1;d>0&&this._clearCells(0,this._state.y1+1,this._state.cols,d),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(d){if(d.fg===o.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:d.fg!==void 0&&(0,l.is256Color)(d.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[d.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,d.y1===d.y2)this._fillBottomLineAtCells(d.x1,d.y1,d.x2-d.x1);else{this._fillBottomLineAtCells(d.x1,d.y1,d.cols-d.x1);for(let i=d.y1+1;i<d.y2;i++)this._fillBottomLineAtCells(0,i,d.cols);this._fillBottomLineAtCells(0,d.y2,d.x2)}this._state=d}_handleHideLinkUnderline(d){this._clearCurrentLink()}}e.LinkRenderLayer=_},820:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.addDisposableDomListener=void 0,e.addDisposableDomListener=function(c,l,o,r){c.addEventListener(l,o,r);let _=!1;return{dispose:()=>{_||(_=!0,c.removeEventListener(l,o,r))}}}},274:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CellColorResolver=void 0;const l=c(855),o=c(160),r=c(374);let _,L=0,d=0,i=!1,t=!1,g=!1,w=0;e.CellColorResolver=class{constructor(v,M,x,a,m,u){this._terminal=v,this._optionService=M,this._selectionRenderModel=x,this._decorationService=a,this._coreBrowserService=m,this._themeService=u,this.result={fg:0,bg:0,ext:0}}resolve(v,M,x,a){if(this.result.bg=v.bg,this.result.fg=v.fg,this.result.ext=268435456&v.bg?v.extended.ext:0,d=0,L=0,t=!1,i=!1,g=!1,_=this._themeService.colors,w=0,v.getCode()!==l.NULL_CELL_CODE&&v.extended.underlineStyle===4){const m=Math.max(1,Math.floor(this._optionService.rawOptions.fontSize*this._coreBrowserService.dpr/15));w=M*a%(2*Math.round(m))}if(this._decorationService.forEachDecorationAtCell(M,x,"bottom",m=>{m.backgroundColorRGB&&(d=m.backgroundColorRGB.rgba>>8&16777215,t=!0),m.foregroundColorRGB&&(L=m.foregroundColorRGB.rgba>>8&16777215,i=!0)}),g=this._selectionRenderModel.isCellSelected(this._terminal,M,x),g){if(67108864&this.result.fg||50331648&this.result.bg){if(67108864&this.result.fg)switch(50331648&this.result.fg){case 16777216:case 33554432:d=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 50331648:d=(16777215&this.result.fg)<<8|255;break;default:d=this._themeService.colors.foreground.rgba}else switch(50331648&this.result.bg){case 16777216:case 33554432:d=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 50331648:d=(16777215&this.result.bg)<<8|255}d=o.rgba.blend(d,4294967040&(this._coreBrowserService.isFocused?_.selectionBackgroundOpaque:_.selectionInactiveBackgroundOpaque).rgba|128)>>8&16777215}else d=(this._coreBrowserService.isFocused?_.selectionBackgroundOpaque:_.selectionInactiveBackgroundOpaque).rgba>>8&16777215;if(t=!0,_.selectionForeground&&(L=_.selectionForeground.rgba>>8&16777215,i=!0),(0,r.treatGlyphAsBackgroundColor)(v.getCode())){if(67108864&this.result.fg&&!(50331648&this.result.bg))L=(this._coreBrowserService.isFocused?_.selectionBackgroundOpaque:_.selectionInactiveBackgroundOpaque).rgba>>8&16777215;else{if(67108864&this.result.fg)switch(50331648&this.result.bg){case 16777216:case 33554432:L=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 50331648:L=(16777215&this.result.bg)<<8|255}else switch(50331648&this.result.fg){case 16777216:case 33554432:L=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 50331648:L=(16777215&this.result.fg)<<8|255;break;default:L=this._themeService.colors.foreground.rgba}L=o.rgba.blend(L,4294967040&(this._coreBrowserService.isFocused?_.selectionBackgroundOpaque:_.selectionInactiveBackgroundOpaque).rgba|128)>>8&16777215}i=!0}}this._decorationService.forEachDecorationAtCell(M,x,"top",m=>{m.backgroundColorRGB&&(d=m.backgroundColorRGB.rgba>>8&16777215,t=!0),m.foregroundColorRGB&&(L=m.foregroundColorRGB.rgba>>8&16777215,i=!0)}),t&&(d=g?-16777216&v.bg&-134217729|d|50331648:-16777216&v.bg|d|50331648),i&&(L=-16777216&v.fg&-67108865|L|50331648),67108864&this.result.fg&&(t&&!i&&(L=50331648&this.result.bg?-134217728&this.result.fg|67108863&this.result.bg:-134217728&this.result.fg|16777215&_.background.rgba>>8|50331648,i=!0),!t&&i&&(d=50331648&this.result.fg?-67108864&this.result.bg|67108863&this.result.fg:-67108864&this.result.bg|16777215&_.foreground.rgba>>8|50331648,t=!0)),_=void 0,this.result.bg=t?d:this.result.bg,this.result.fg=i?L:this.result.fg,this.result.ext&=536870911,this.result.ext|=w<<29&3758096384}}},627:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.removeTerminalFromCache=e.acquireTextureAtlas=void 0;const l=c(509),o=c(197),r=[];e.acquireTextureAtlas=function(_,L,d,i,t,g,w,v){const M=(0,o.generateConfig)(i,t,g,w,L,d,v);for(let m=0;m<r.length;m++){const u=r[m],h=u.ownedBy.indexOf(_);if(h>=0){if((0,o.configEquals)(u.config,M))return u.atlas;u.ownedBy.length===1?(u.atlas.dispose(),r.splice(m,1)):u.ownedBy.splice(h,1);break}}for(let m=0;m<r.length;m++){const u=r[m];if((0,o.configEquals)(u.config,M))return u.ownedBy.push(_),u.atlas}const x=_._core,a={atlas:new l.TextureAtlas(document,M,x.unicodeService),config:M,ownedBy:[_]};return r.push(a),a.atlas},e.removeTerminalFromCache=function(_){for(let L=0;L<r.length;L++){const d=r[L].ownedBy.indexOf(_);if(d!==-1){r[L].ownedBy.length===1?(r[L].atlas.dispose(),r.splice(L,1)):r[L].ownedBy.splice(d,1);break}}}},197:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.is256Color=e.configEquals=e.generateConfig=void 0;const l=c(160);e.generateConfig=function(o,r,_,L,d,i,t){const g={foreground:i.foreground,background:i.background,cursor:l.NULL_COLOR,cursorAccent:l.NULL_COLOR,selectionForeground:l.NULL_COLOR,selectionBackgroundTransparent:l.NULL_COLOR,selectionBackgroundOpaque:l.NULL_COLOR,selectionInactiveBackgroundTransparent:l.NULL_COLOR,selectionInactiveBackgroundOpaque:l.NULL_COLOR,ansi:i.ansi.slice(),contrastCache:i.contrastCache,halfContrastCache:i.halfContrastCache};return{customGlyphs:d.customGlyphs,devicePixelRatio:t,letterSpacing:d.letterSpacing,lineHeight:d.lineHeight,deviceCellWidth:o,deviceCellHeight:r,deviceCharWidth:_,deviceCharHeight:L,fontFamily:d.fontFamily,fontSize:d.fontSize,fontWeight:d.fontWeight,fontWeightBold:d.fontWeightBold,allowTransparency:d.allowTransparency,drawBoldTextInBrightColors:d.drawBoldTextInBrightColors,minimumContrastRatio:d.minimumContrastRatio,colors:g}},e.configEquals=function(o,r){for(let _=0;_<o.colors.ansi.length;_++)if(o.colors.ansi[_].rgba!==r.colors.ansi[_].rgba)return!1;return o.devicePixelRatio===r.devicePixelRatio&&o.customGlyphs===r.customGlyphs&&o.lineHeight===r.lineHeight&&o.letterSpacing===r.letterSpacing&&o.fontFamily===r.fontFamily&&o.fontSize===r.fontSize&&o.fontWeight===r.fontWeight&&o.fontWeightBold===r.fontWeightBold&&o.allowTransparency===r.allowTransparency&&o.deviceCharWidth===r.deviceCharWidth&&o.deviceCharHeight===r.deviceCharHeight&&o.drawBoldTextInBrightColors===r.drawBoldTextInBrightColors&&o.minimumContrastRatio===r.minimumContrastRatio&&o.colors.foreground.rgba===r.colors.foreground.rgba&&o.colors.background.rgba===r.colors.background.rgba},e.is256Color=function(o){return(50331648&o)==16777216||(50331648&o)==33554432}},237:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TEXT_BASELINE=e.DIM_OPACITY=e.INVERTED_DEFAULT_COLOR=void 0;const l=c(399);e.INVERTED_DEFAULT_COLOR=257,e.DIM_OPACITY=.5,e.TEXT_BASELINE=l.isFirefox||l.isLegacyEdge?"bottom":"ideographic"},457:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CursorBlinkStateManager=void 0,e.CursorBlinkStateManager=class{constructor(c,l){this._renderCallback=c,this._coreBrowserService=l,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(c=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){const l=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,l>0)return void this._restartInterval(l)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){const l=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(l)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},c)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},860:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.tryDrawCustomChar=e.powerlineDefinitions=e.boxDrawingDefinitions=e.blockElementDefinitions=void 0;const l=c(374);e.blockElementDefinitions={"▀":[{x:0,y:0,w:8,h:4}],"▁":[{x:0,y:7,w:8,h:1}],"▂":[{x:0,y:6,w:8,h:2}],"▃":[{x:0,y:5,w:8,h:3}],"▄":[{x:0,y:4,w:8,h:4}],"▅":[{x:0,y:3,w:8,h:5}],"▆":[{x:0,y:2,w:8,h:6}],"▇":[{x:0,y:1,w:8,h:7}],"█":[{x:0,y:0,w:8,h:8}],"▉":[{x:0,y:0,w:7,h:8}],"▊":[{x:0,y:0,w:6,h:8}],"▋":[{x:0,y:0,w:5,h:8}],"▌":[{x:0,y:0,w:4,h:8}],"▍":[{x:0,y:0,w:3,h:8}],"▎":[{x:0,y:0,w:2,h:8}],"▏":[{x:0,y:0,w:1,h:8}],"▐":[{x:4,y:0,w:4,h:8}],"▔":[{x:0,y:0,w:8,h:1}],"▕":[{x:7,y:0,w:1,h:8}],"▖":[{x:0,y:4,w:4,h:4}],"▗":[{x:4,y:4,w:4,h:4}],"▘":[{x:0,y:0,w:4,h:4}],"▙":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"▚":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"▛":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"▜":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"▝":[{x:4,y:0,w:4,h:4}],"▞":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"▟":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"🭰":[{x:1,y:0,w:1,h:8}],"🭱":[{x:2,y:0,w:1,h:8}],"🭲":[{x:3,y:0,w:1,h:8}],"🭳":[{x:4,y:0,w:1,h:8}],"🭴":[{x:5,y:0,w:1,h:8}],"🭵":[{x:6,y:0,w:1,h:8}],"🭶":[{x:0,y:1,w:8,h:1}],"🭷":[{x:0,y:2,w:8,h:1}],"🭸":[{x:0,y:3,w:8,h:1}],"🭹":[{x:0,y:4,w:8,h:1}],"🭺":[{x:0,y:5,w:8,h:1}],"🭻":[{x:0,y:6,w:8,h:1}],"🭼":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🭽":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭾":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"🭿":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"🮀":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮁":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"🮂":[{x:0,y:0,w:8,h:2}],"🮃":[{x:0,y:0,w:8,h:3}],"🮄":[{x:0,y:0,w:8,h:5}],"🮅":[{x:0,y:0,w:8,h:6}],"🮆":[{x:0,y:0,w:8,h:7}],"🮇":[{x:6,y:0,w:2,h:8}],"🮈":[{x:5,y:0,w:3,h:8}],"🮉":[{x:3,y:0,w:5,h:8}],"🮊":[{x:2,y:0,w:6,h:8}],"🮋":[{x:1,y:0,w:7,h:8}],"🮕":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"🮖":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"🮗":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};const o={"░":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"▒":[[1,0],[0,0],[0,1],[0,0]],"▓":[[0,1],[1,1],[1,0],[1,1]]};e.boxDrawingDefinitions={"─":{1:"M0,.5 L1,.5"},"━":{3:"M0,.5 L1,.5"},"│":{1:"M.5,0 L.5,1"},"┃":{3:"M.5,0 L.5,1"},"┌":{1:"M0.5,1 L.5,.5 L1,.5"},"┏":{3:"M0.5,1 L.5,.5 L1,.5"},"┐":{1:"M0,.5 L.5,.5 L.5,1"},"┓":{3:"M0,.5 L.5,.5 L.5,1"},"└":{1:"M.5,0 L.5,.5 L1,.5"},"┗":{3:"M.5,0 L.5,.5 L1,.5"},"┘":{1:"M.5,0 L.5,.5 L0,.5"},"┛":{3:"M.5,0 L.5,.5 L0,.5"},"├":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"┣":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"┤":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"┫":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"┬":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"┳":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"┴":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"┻":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"┼":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"╋":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"╴":{1:"M.5,.5 L0,.5"},"╸":{3:"M.5,.5 L0,.5"},"╵":{1:"M.5,.5 L.5,0"},"╹":{3:"M.5,.5 L.5,0"},"╶":{1:"M.5,.5 L1,.5"},"╺":{3:"M.5,.5 L1,.5"},"╷":{1:"M.5,.5 L.5,1"},"╻":{3:"M.5,.5 L.5,1"},"═":{1:(i,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"║":{1:(i,t)=>`M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1`},"╒":{1:(i,t)=>`M.5,1 L.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"╓":{1:(i,t)=>`M${.5-i},1 L${.5-i},.5 L1,.5 M${.5+i},.5 L${.5+i},1`},"╔":{1:(i,t)=>`M1,${.5-t} L${.5-i},${.5-t} L${.5-i},1 M1,${.5+t} L${.5+i},${.5+t} L${.5+i},1`},"╕":{1:(i,t)=>`M0,${.5-t} L.5,${.5-t} L.5,1 M0,${.5+t} L.5,${.5+t}`},"╖":{1:(i,t)=>`M${.5+i},1 L${.5+i},.5 L0,.5 M${.5-i},.5 L${.5-i},1`},"╗":{1:(i,t)=>`M0,${.5+t} L${.5-i},${.5+t} L${.5-i},1 M0,${.5-t} L${.5+i},${.5-t} L${.5+i},1`},"╘":{1:(i,t)=>`M.5,0 L.5,${.5+t} L1,${.5+t} M.5,${.5-t} L1,${.5-t}`},"╙":{1:(i,t)=>`M1,.5 L${.5-i},.5 L${.5-i},0 M${.5+i},.5 L${.5+i},0`},"╚":{1:(i,t)=>`M1,${.5-t} L${.5+i},${.5-t} L${.5+i},0 M1,${.5+t} L${.5-i},${.5+t} L${.5-i},0`},"╛":{1:(i,t)=>`M0,${.5+t} L.5,${.5+t} L.5,0 M0,${.5-t} L.5,${.5-t}`},"╜":{1:(i,t)=>`M0,.5 L${.5+i},.5 L${.5+i},0 M${.5-i},.5 L${.5-i},0`},"╝":{1:(i,t)=>`M0,${.5-t} L${.5-i},${.5-t} L${.5-i},0 M0,${.5+t} L${.5+i},${.5+t} L${.5+i},0`},"╞":{1:(i,t)=>`M.5,0 L.5,1 M.5,${.5-t} L1,${.5-t} M.5,${.5+t} L1,${.5+t}`},"╟":{1:(i,t)=>`M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1 M${.5+i},.5 L1,.5`},"╠":{1:(i,t)=>`M${.5-i},0 L${.5-i},1 M1,${.5+t} L${.5+i},${.5+t} L${.5+i},1 M1,${.5-t} L${.5+i},${.5-t} L${.5+i},0`},"╡":{1:(i,t)=>`M.5,0 L.5,1 M0,${.5-t} L.5,${.5-t} M0,${.5+t} L.5,${.5+t}`},"╢":{1:(i,t)=>`M0,.5 L${.5-i},.5 M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1`},"╣":{1:(i,t)=>`M${.5+i},0 L${.5+i},1 M0,${.5+t} L${.5-i},${.5+t} L${.5-i},1 M0,${.5-t} L${.5-i},${.5-t} L${.5-i},0`},"╤":{1:(i,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t} M.5,${.5+t} L.5,1`},"╥":{1:(i,t)=>`M0,.5 L1,.5 M${.5-i},.5 L${.5-i},1 M${.5+i},.5 L${.5+i},1`},"╦":{1:(i,t)=>`M0,${.5-t} L1,${.5-t} M0,${.5+t} L${.5-i},${.5+t} L${.5-i},1 M1,${.5+t} L${.5+i},${.5+t} L${.5+i},1`},"╧":{1:(i,t)=>`M.5,0 L.5,${.5-t} M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"╨":{1:(i,t)=>`M0,.5 L1,.5 M${.5-i},.5 L${.5-i},0 M${.5+i},.5 L${.5+i},0`},"╩":{1:(i,t)=>`M0,${.5+t} L1,${.5+t} M0,${.5-t} L${.5-i},${.5-t} L${.5-i},0 M1,${.5-t} L${.5+i},${.5-t} L${.5+i},0`},"╪":{1:(i,t)=>`M.5,0 L.5,1 M0,${.5-t} L1,${.5-t} M0,${.5+t} L1,${.5+t}`},"╫":{1:(i,t)=>`M0,.5 L1,.5 M${.5-i},0 L${.5-i},1 M${.5+i},0 L${.5+i},1`},"╬":{1:(i,t)=>`M0,${.5+t} L${.5-i},${.5+t} L${.5-i},1 M1,${.5+t} L${.5+i},${.5+t} L${.5+i},1 M0,${.5-t} L${.5-i},${.5-t} L${.5-i},0 M1,${.5-t} L${.5+i},${.5-t} L${.5+i},0`},"╱":{1:"M1,0 L0,1"},"╲":{1:"M0,0 L1,1"},"╳":{1:"M1,0 L0,1 M0,0 L1,1"},"╼":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"╽":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"╾":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"╿":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"┍":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"┎":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"┑":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"┒":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"┕":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"┖":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"┙":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"┚":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"┝":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"┞":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"┟":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"┠":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"┡":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"┢":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"┥":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"┦":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"┧":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"┨":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"┩":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"┪":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"┭":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"┮":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"┯":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"┰":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"┱":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"┲":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"┵":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"┶":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"┷":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"┸":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"┹":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"┺":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"┽":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"┾":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"┿":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"╀":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"╁":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"╂":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"╃":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"╄":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"╅":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"╆":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"╇":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"╈":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"╉":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"╊":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"╌":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"╍":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"┄":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"┅":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"┈":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"┉":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"╎":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"╏":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"┆":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"┇":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"┊":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"┋":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"╭":{1:(i,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,1,.5`},"╮":{1:(i,t)=>`M.5,1 L.5,${.5+t/.15*.5} C.5,${.5+t/.15*.5},.5,.5,0,.5`},"╯":{1:(i,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,0,.5`},"╰":{1:(i,t)=>`M.5,0 L.5,${.5-t/.15*.5} C.5,${.5-t/.15*.5},.5,.5,1,.5`}},e.powerlineDefinitions={"":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},e.powerlineDefinitions[""]=e.powerlineDefinitions[""],e.powerlineDefinitions[""]=e.powerlineDefinitions[""],e.tryDrawCustomChar=function(i,t,g,w,v,M,x,a){const m=e.blockElementDefinitions[t];if(m)return function(f,n,C,p,A,y){for(let R=0;R<n.length;R++){const b=n[R],S=A/8,E=y/8;f.fillRect(C+b.x*S,p+b.y*E,b.w*S,b.h*E)}}(i,m,g,w,v,M),!0;const u=o[t];if(u)return function(f,n,C,p,A,y){let R=r.get(n);R||(R=new Map,r.set(n,R));const b=f.fillStyle;if(typeof b!="string")throw new Error(`Unexpected fillStyle type "${b}"`);let S=R.get(b);if(!S){const E=n[0].length,I=n.length,B=f.canvas.ownerDocument.createElement("canvas");B.width=E,B.height=I;const W=(0,l.throwIfFalsy)(B.getContext("2d")),O=new ImageData(E,I);let X,z,k,j;if(b.startsWith("#"))X=parseInt(b.slice(1,3),16),z=parseInt(b.slice(3,5),16),k=parseInt(b.slice(5,7),16),j=b.length>7&&parseInt(b.slice(7,9),16)||1;else{if(!b.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${b}" when drawing pattern glyph`);[X,z,k,j]=b.substring(5,b.length-1).split(",").map(H=>parseFloat(H))}for(let H=0;H<I;H++)for(let J=0;J<E;J++)O.data[4*(H*E+J)]=X,O.data[4*(H*E+J)+1]=z,O.data[4*(H*E+J)+2]=k,O.data[4*(H*E+J)+3]=n[H][J]*(255*j);W.putImageData(O,0,0),S=(0,l.throwIfFalsy)(f.createPattern(B,null)),R.set(b,S)}f.fillStyle=S,f.fillRect(C,p,A,y)}(i,u,g,w,v,M),!0;const h=e.boxDrawingDefinitions[t];if(h)return function(f,n,C,p,A,y,R){f.strokeStyle=f.fillStyle;for(const[b,S]of Object.entries(n)){let E;f.beginPath(),f.lineWidth=R*Number.parseInt(b),E=typeof S=="function"?S(.15,.15/y*A):S;for(const I of E.split(" ")){const B=I[0],W=L[B];if(!W){console.error(`Could not find drawing instructions for "${B}"`);continue}const O=I.substring(1).split(",");O[0]&&O[1]&&W(f,d(O,A,y,C,p,!0,R))}f.stroke(),f.closePath()}}(i,h,g,w,v,M,a),!0;const s=e.powerlineDefinitions[t];return!!s&&(function(f,n,C,p,A,y,R,b){var I,B;const S=new Path2D;S.rect(C,p,A,y),f.clip(S),f.beginPath();const E=R/12;f.lineWidth=b*E;for(const W of n.d.split(" ")){const O=W[0],X=L[O];if(!X){console.error(`Could not find drawing instructions for "${O}"`);continue}const z=W.substring(1).split(",");z[0]&&z[1]&&X(f,d(z,A,y,C,p,!1,b,((I=n.leftPadding)!=null?I:0)*(E/2),((B=n.rightPadding)!=null?B:0)*(E/2)))}n.type===1?(f.strokeStyle=f.fillStyle,f.stroke()):f.fill(),f.closePath()}(i,s,g,w,v,M,x,a),!0)};const r=new Map;function _(i,t,g=0){return Math.max(Math.min(i,t),g)}const L={C:(i,t)=>i.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5]),L:(i,t)=>i.lineTo(t[0],t[1]),M:(i,t)=>i.moveTo(t[0],t[1])};function d(i,t,g,w,v,M,x,a=0,m=0){const u=i.map(h=>parseFloat(h)||parseInt(h));if(u.length<2)throw new Error("Too few arguments for instruction");for(let h=0;h<u.length;h+=2)u[h]*=t-a*x-m*x,M&&u[h]!==0&&(u[h]=_(Math.round(u[h]+.5)-.5,t,0)),u[h]+=w+a*x;for(let h=1;h<u.length;h+=2)u[h]*=g,M&&u[h]!==0&&(u[h]=_(Math.round(u[h]+.5)-.5,g,0)),u[h]+=v;return u}},56:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.observeDevicePixelDimensions=void 0;const l=c(859);e.observeDevicePixelDimensions=function(o,r,_){let L=new r.ResizeObserver(d=>{const i=d.find(w=>w.target===o);if(!i)return;if(!("devicePixelContentBoxSize"in i))return L==null||L.disconnect(),void(L=void 0);const t=i.devicePixelContentBoxSize[0].inlineSize,g=i.devicePixelContentBoxSize[0].blockSize;t>0&&g>0&&_(t,g)});try{L.observe(o,{box:["device-pixel-content-box"]})}catch{L.disconnect(),L=void 0}return(0,l.toDisposable)(()=>L==null?void 0:L.disconnect())}},374:(D,e)=>{function c(o){return 57508<=o&&o<=57558}function l(o){return o>=128512&&o<=128591||o>=127744&&o<=128511||o>=128640&&o<=128767||o>=9728&&o<=9983||o>=9984&&o<=10175||o>=65024&&o<=65039||o>=129280&&o<=129535||o>=127462&&o<=127487}Object.defineProperty(e,"__esModule",{value:!0}),e.computeNextVariantOffset=e.createRenderDimensions=e.treatGlyphAsBackgroundColor=e.allowRescaling=e.isEmoji=e.isRestrictedPowerlineGlyph=e.isPowerlineGlyph=e.throwIfFalsy=void 0,e.throwIfFalsy=function(o){if(!o)throw new Error("value must not be falsy");return o},e.isPowerlineGlyph=c,e.isRestrictedPowerlineGlyph=function(o){return 57520<=o&&o<=57527},e.isEmoji=l,e.allowRescaling=function(o,r,_,L){return r===1&&_>Math.ceil(1.5*L)&&o!==void 0&&o>255&&!l(o)&&!c(o)&&!function(d){return 57344<=d&&d<=63743}(o)},e.treatGlyphAsBackgroundColor=function(o){return c(o)||function(r){return 9472<=r&&r<=9631}(o)},e.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},e.computeNextVariantOffset=function(o,r,_=0){return(o-(2*Math.round(r)-_))%(2*Math.round(r))}},296:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createSelectionRenderModel=void 0;class c{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(o,r,_,L=!1){if(this.selectionStart=r,this.selectionEnd=_,!r||!_||r[0]===_[0]&&r[1]===_[1])return void this.clear();const d=o.buffers.active.ydisp,i=r[1]-d,t=_[1]-d,g=Math.max(i,0),w=Math.min(t,o.rows-1);g>=o.rows||w<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=L,this.viewportStartRow=i,this.viewportEndRow=t,this.viewportCappedStartRow=g,this.viewportCappedEndRow=w,this.startCol=r[0],this.endCol=_[0])}isCellSelected(o,r,_){return!!this.hasSelection&&(_-=o.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?r>=this.startCol&&_>=this.viewportCappedStartRow&&r<this.endCol&&_<=this.viewportCappedEndRow:r<this.startCol&&_>=this.viewportCappedStartRow&&r>=this.endCol&&_<=this.viewportCappedEndRow:_>this.viewportStartRow&&_<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&_===this.viewportStartRow&&r>=this.startCol&&r<this.endCol||this.viewportStartRow<this.viewportEndRow&&_===this.viewportEndRow&&r<this.endCol||this.viewportStartRow<this.viewportEndRow&&_===this.viewportStartRow&&r>=this.startCol)}}e.createSelectionRenderModel=function(){return new c}},509:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextureAtlas=void 0;const l=c(237),o=c(860),r=c(374),_=c(160),L=c(345),d=c(485),i=c(385),t=c(147),g=c(855),w={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}};let v;class M{get pages(){return this._pages}constructor(h,s,f){this._document=h,this._config=s,this._unicodeService=f,this._didWarmUp=!1,this._cacheMap=new d.FourKeyMap,this._cacheMapCombined=new d.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new t.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new L.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new L.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=m(h,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,r.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}dispose(){for(const h of this.pages)h.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){const h=new i.IdleTaskQueue;for(let s=33;s<126;s++)h.enqueue(()=>{if(!this._cacheMap.get(s,g.DEFAULT_COLOR,g.DEFAULT_COLOR,g.DEFAULT_EXT)){const f=this._drawToCache(s,g.DEFAULT_COLOR,g.DEFAULT_COLOR,g.DEFAULT_EXT);this._cacheMap.set(s,g.DEFAULT_COLOR,g.DEFAULT_COLOR,g.DEFAULT_EXT,f)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(const h of this._pages)h.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){if(M.maxAtlasPages&&this._pages.length>=Math.max(4,M.maxAtlasPages)){const s=this._pages.filter(R=>2*R.canvas.width<=(M.maxTextureSize||4096)).sort((R,b)=>b.canvas.width!==R.canvas.width?b.canvas.width-R.canvas.width:b.percentageUsed-R.percentageUsed);let f=-1,n=0;for(let R=0;R<s.length;R++)if(s[R].canvas.width!==n)f=R,n=s[R].canvas.width;else if(R-f==3)break;const C=s.slice(f,f+4),p=C.map(R=>R.glyphs[0].texturePage).sort((R,b)=>R>b?1:-1),A=this.pages.length-C.length,y=this._mergePages(C,A);y.version++;for(let R=p.length-1;R>=0;R--)this._deletePage(p[R]);this.pages.push(y),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(y.canvas)}const h=new x(this._document,this._textureSize);return this._pages.push(h),this._activePages.push(h),this._onAddTextureAtlasCanvas.fire(h.canvas),h}_mergePages(h,s){const f=2*h[0].canvas.width,n=new x(this._document,f,h);for(const[C,p]of h.entries()){const A=C*p.canvas.width%f,y=Math.floor(C/2)*p.canvas.height;n.ctx.drawImage(p.canvas,A,y);for(const b of p.glyphs)b.texturePage=s,b.sizeClipSpace.x=b.size.x/f,b.sizeClipSpace.y=b.size.y/f,b.texturePosition.x+=A,b.texturePosition.y+=y,b.texturePositionClipSpace.x=b.texturePosition.x/f,b.texturePositionClipSpace.y=b.texturePosition.y/f;this._onRemoveTextureAtlasCanvas.fire(p.canvas);const R=this._activePages.indexOf(p);R!==-1&&this._activePages.splice(R,1)}return n}_deletePage(h){this._pages.splice(h,1);for(let s=h;s<this._pages.length;s++){const f=this._pages[s];for(const n of f.glyphs)n.texturePage--;f.version++}}getRasterizedGlyphCombinedChar(h,s,f,n,C){return this._getFromCacheMap(this._cacheMapCombined,h,s,f,n,C)}getRasterizedGlyph(h,s,f,n,C){return this._getFromCacheMap(this._cacheMap,h,s,f,n,C)}_getFromCacheMap(h,s,f,n,C,p=!1){return v=h.get(s,f,n,C),v||(v=this._drawToCache(s,f,n,C,p),h.set(s,f,n,C,v)),v}_getColorFromAnsiIndex(h){if(h>=this._config.colors.ansi.length)throw new Error("No color found for idx "+h);return this._config.colors.ansi[h]}_getBackgroundColor(h,s,f,n){if(this._config.allowTransparency)return _.NULL_COLOR;let C;switch(h){case 16777216:case 33554432:C=this._getColorFromAnsiIndex(s);break;case 50331648:const p=t.AttributeData.toColorRGB(s);C=_.channels.toColor(p[0],p[1],p[2]);break;default:C=f?_.color.opaque(this._config.colors.foreground):this._config.colors.background}return C}_getForegroundColor(h,s,f,n,C,p,A,y,R,b){const S=this._getMinimumContrastColor(h,s,f,n,C,p,A,R,y,b);if(S)return S;let E;switch(C){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&R&&p<8&&(p+=8),E=this._getColorFromAnsiIndex(p);break;case 50331648:const I=t.AttributeData.toColorRGB(p);E=_.channels.toColor(I[0],I[1],I[2]);break;default:E=A?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(E=_.color.opaque(E)),y&&(E=_.color.multiplyOpacity(E,l.DIM_OPACITY)),E}_resolveBackgroundRgba(h,s,f){switch(h){case 16777216:case 33554432:return this._getColorFromAnsiIndex(s).rgba;case 50331648:return s<<8;default:return f?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(h,s,f,n){switch(h){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&n&&s<8&&(s+=8),this._getColorFromAnsiIndex(s).rgba;case 50331648:return s<<8;default:return f?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(h,s,f,n,C,p,A,y,R,b){if(this._config.minimumContrastRatio===1||b)return;const S=this._getContrastCache(R),E=S.getColor(h,n);if(E!==void 0)return E||void 0;const I=this._resolveBackgroundRgba(s,f,A),B=this._resolveForegroundRgba(C,p,A,y),W=_.rgba.ensureContrastRatio(I,B,this._config.minimumContrastRatio/(R?2:1));if(!W)return void S.setColor(h,n,null);const O=_.channels.toColor(W>>24&255,W>>16&255,W>>8&255);return S.setColor(h,n,O),O}_getContrastCache(h){return h?this._config.colors.halfContrastCache:this._config.colors.contrastCache}_drawToCache(h,s,f,n,C=!1){const p=typeof h=="number"?String.fromCharCode(h):h,A=Math.min(this._config.deviceCellWidth*Math.max(p.length,2)+4,this._textureSize);this._tmpCanvas.width<A&&(this._tmpCanvas.width=A);const y=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<y&&(this._tmpCanvas.height=y),this._tmpCtx.save(),this._workAttributeData.fg=f,this._workAttributeData.bg=s,this._workAttributeData.extended.ext=n,this._workAttributeData.isInvisible())return w;const R=!!this._workAttributeData.isBold(),b=!!this._workAttributeData.isInverse(),S=!!this._workAttributeData.isDim(),E=!!this._workAttributeData.isItalic(),I=!!this._workAttributeData.isUnderline(),B=!!this._workAttributeData.isStrikethrough(),W=!!this._workAttributeData.isOverline();let O=this._workAttributeData.getFgColor(),X=this._workAttributeData.getFgColorMode(),z=this._workAttributeData.getBgColor(),k=this._workAttributeData.getBgColorMode();if(b){const T=O;O=z,z=T;const N=X;X=k,k=N}const j=this._getBackgroundColor(k,z,b,S);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=j.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";const H=R?this._config.fontWeightBold:this._config.fontWeight,J=E?"italic":"";this._tmpCtx.font=`${J} ${H} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=l.TEXT_BASELINE;const fe=p.length===1&&(0,r.isPowerlineGlyph)(p.charCodeAt(0)),ee=p.length===1&&(0,r.isRestrictedPowerlineGlyph)(p.charCodeAt(0)),te=this._getForegroundColor(s,k,z,f,X,O,b,S,R,(0,r.treatGlyphAsBackgroundColor)(p.charCodeAt(0)));this._tmpCtx.fillStyle=te.css;const U=ee?0:4;let ie=!1;this._config.customGlyphs!==!1&&(ie=(0,o.tryDrawCustomChar)(this._tmpCtx,p,U,U,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let ae,he=!fe;if(ae=typeof h=="number"?this._unicodeService.wcwidth(h):this._unicodeService.getStringCellWidth(h),I){this._tmpCtx.save();const T=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),N=T%2==1?.5:0;if(this._tmpCtx.lineWidth=T,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())he=!1,this._tmpCtx.strokeStyle=`rgb(${t.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{he=!1;let Q=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&Q<8&&(Q+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(Q).css}this._tmpCtx.beginPath();const K=U,q=Math.ceil(U+this._config.deviceCharHeight)-N-(C?2*T:0),le=q+T,ce=q+2*T;let se=this._workAttributeData.getUnderlineVariantOffset();for(let Q=0;Q<ae;Q++){this._tmpCtx.save();const G=K+Q*this._config.deviceCellWidth,V=K+(Q+1)*this._config.deviceCellWidth,pe=G+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(G,q),this._tmpCtx.lineTo(V,q),this._tmpCtx.moveTo(G,ce),this._tmpCtx.lineTo(V,ce);break;case 3:const _e=T<=1?ce:Math.ceil(U+this._config.deviceCharHeight-T/2)-N,ue=T<=1?q:Math.ceil(U+this._config.deviceCharHeight+T/2)-N,Le=new Path2D;Le.rect(G,q,this._config.deviceCellWidth,ce-q),this._tmpCtx.clip(Le),this._tmpCtx.moveTo(G-this._config.deviceCellWidth/2,le),this._tmpCtx.bezierCurveTo(G-this._config.deviceCellWidth/2,ue,G,ue,G,le),this._tmpCtx.bezierCurveTo(G,_e,pe,_e,pe,le),this._tmpCtx.bezierCurveTo(pe,ue,V,ue,V,le),this._tmpCtx.bezierCurveTo(V,_e,V+this._config.deviceCellWidth/2,_e,V+this._config.deviceCellWidth/2,le);break;case 4:const ge=se===0?0:se>=T?2*T-se:T-se;se>=T||ge===0?(this._tmpCtx.setLineDash([Math.round(T),Math.round(T)]),this._tmpCtx.moveTo(G+ge,q),this._tmpCtx.lineTo(V,q)):(this._tmpCtx.setLineDash([Math.round(T),Math.round(T)]),this._tmpCtx.moveTo(G,q),this._tmpCtx.lineTo(G+ge,q),this._tmpCtx.moveTo(G+ge+T,q),this._tmpCtx.lineTo(V,q)),se=(0,r.computeNextVariantOffset)(V-G,T,se);break;case 5:const Re=.6,ye=.3,Ce=V-G,xe=Math.floor(Re*Ce),we=Math.floor(ye*Ce),Ae=Ce-xe-we;this._tmpCtx.setLineDash([xe,we,Ae]),this._tmpCtx.moveTo(G,q),this._tmpCtx.lineTo(V,q);break;default:this._tmpCtx.moveTo(G,q),this._tmpCtx.lineTo(V,q)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!ie&&this._config.fontSize>=12&&!this._config.allowTransparency&&p!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";const Q=this._tmpCtx.measureText(p);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in Q&&Q.actualBoundingBoxDescent>0){this._tmpCtx.save();const G=new Path2D;G.rect(K,q-Math.ceil(T/2),this._config.deviceCellWidth*ae,ce-q+Math.ceil(T/2)),this._tmpCtx.clip(G),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=j.css,this._tmpCtx.strokeText(p,U,U+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(W){const T=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),N=T%2==1?.5:0;this._tmpCtx.lineWidth=T,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(U,U+N),this._tmpCtx.lineTo(U+this._config.deviceCharWidth*ae,U+N),this._tmpCtx.stroke()}if(ie||this._tmpCtx.fillText(p,U,U+this._config.deviceCharHeight),p==="_"&&!this._config.allowTransparency){let T=a(this._tmpCtx.getImageData(U,U,this._config.deviceCellWidth,this._config.deviceCellHeight),j,te,he);if(T)for(let N=1;N<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=j.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(p,U,U+this._config.deviceCharHeight-N),T=a(this._tmpCtx.getImageData(U,U,this._config.deviceCellWidth,this._config.deviceCellHeight),j,te,he),T);N++);}if(B){const T=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),N=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=T,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(U,U+Math.floor(this._config.deviceCharHeight/2)-N),this._tmpCtx.lineTo(U+this._config.deviceCharWidth*ae,U+Math.floor(this._config.deviceCharHeight/2)-N),this._tmpCtx.stroke()}this._tmpCtx.restore();const de=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height);let me;if(me=this._config.allowTransparency?function(T){for(let N=0;N<T.data.length;N+=4)if(T.data[N+3]>0)return!1;return!0}(de):a(de,j,te,he),me)return w;const $=this._findGlyphBoundingBox(de,this._workBoundingBox,A,ee,ie,U);let F,P;for(;;){if(this._activePages.length===0){const T=this._createNewPage();F=T,P=T.currentRow,P.height=$.size.y;break}F=this._activePages[this._activePages.length-1],P=F.currentRow;for(const T of this._activePages)$.size.y<=T.currentRow.height&&(F=T,P=T.currentRow);for(let T=this._activePages.length-1;T>=0;T--)for(const N of this._activePages[T].fixedRows)N.height<=P.height&&$.size.y<=N.height&&(F=this._activePages[T],P=N);if(P.y+$.size.y>=F.canvas.height||P.height>$.size.y+2){let T=!1;if(F.currentRow.y+F.currentRow.height+$.size.y>=F.canvas.height){let N;for(const K of this._activePages)if(K.currentRow.y+K.currentRow.height+$.size.y<K.canvas.height){N=K;break}if(N)F=N;else if(M.maxAtlasPages&&this._pages.length>=M.maxAtlasPages&&P.y+$.size.y<=F.canvas.height&&P.height>=$.size.y&&P.x+$.size.x<=F.canvas.width)T=!0;else{const K=this._createNewPage();F=K,P=K.currentRow,P.height=$.size.y,T=!0}}T||(F.currentRow.height>0&&F.fixedRows.push(F.currentRow),P={x:0,y:F.currentRow.y+F.currentRow.height,height:$.size.y},F.fixedRows.push(P),F.currentRow={x:0,y:P.y+P.height,height:0})}if(P.x+$.size.x<=F.canvas.width)break;P===F.currentRow?(P.x=0,P.y+=P.height,P.height=0):F.fixedRows.splice(F.fixedRows.indexOf(P),1)}return $.texturePage=this._pages.indexOf(F),$.texturePosition.x=P.x,$.texturePosition.y=P.y,$.texturePositionClipSpace.x=P.x/F.canvas.width,$.texturePositionClipSpace.y=P.y/F.canvas.height,$.sizeClipSpace.x/=F.canvas.width,$.sizeClipSpace.y/=F.canvas.height,P.height=Math.max(P.height,$.size.y),P.x+=$.size.x,F.ctx.putImageData(de,$.texturePosition.x-this._workBoundingBox.left,$.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,$.size.x,$.size.y),F.addGlyph($),F.version++,$}_findGlyphBoundingBox(h,s,f,n,C,p){s.top=0;const A=n?this._config.deviceCellHeight:this._tmpCanvas.height,y=n?this._config.deviceCellWidth:f;let R=!1;for(let b=0;b<A;b++){for(let S=0;S<y;S++){const E=b*this._tmpCanvas.width*4+4*S+3;if(h.data[E]!==0){s.top=b,R=!0;break}}if(R)break}s.left=0,R=!1;for(let b=0;b<p+y;b++){for(let S=0;S<A;S++){const E=S*this._tmpCanvas.width*4+4*b+3;if(h.data[E]!==0){s.left=b,R=!0;break}}if(R)break}s.right=y,R=!1;for(let b=p+y-1;b>=p;b--){for(let S=0;S<A;S++){const E=S*this._tmpCanvas.width*4+4*b+3;if(h.data[E]!==0){s.right=b,R=!0;break}}if(R)break}s.bottom=A,R=!1;for(let b=A-1;b>=0;b--){for(let S=0;S<y;S++){const E=b*this._tmpCanvas.width*4+4*S+3;if(h.data[E]!==0){s.bottom=b,R=!0;break}}if(R)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:s.right-s.left+1,y:s.bottom-s.top+1},sizeClipSpace:{x:s.right-s.left+1,y:s.bottom-s.top+1},offset:{x:-s.left+p+(n||C?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-s.top+p+(n||C?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}e.TextureAtlas=M;class x{get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(h){this._glyphs.push(h),this._usedPixels+=h.size.x*h.size.y}constructor(h,s,f){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],f)for(const n of f)this._glyphs.push(...n.glyphs),this._usedPixels+=n._usedPixels;this.canvas=m(h,s,s),this.ctx=(0,r.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function a(u,h,s,f){const n=h.rgba>>>24,C=h.rgba>>>16&255,p=h.rgba>>>8&255,A=s.rgba>>>24,y=s.rgba>>>16&255,R=s.rgba>>>8&255,b=Math.floor((Math.abs(n-A)+Math.abs(C-y)+Math.abs(p-R))/12);let S=!0;for(let E=0;E<u.data.length;E+=4)u.data[E]===n&&u.data[E+1]===C&&u.data[E+2]===p||f&&Math.abs(u.data[E]-n)+Math.abs(u.data[E+1]-C)+Math.abs(u.data[E+2]-p)<b?u.data[E+3]=0:S=!1;return S}function m(u,h,s){const f=u.createElement("canvas");return f.width=h,f.height=s,f}},160:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.contrastRatio=e.toPaddedHex=e.rgba=e.rgb=e.css=e.color=e.channels=e.NULL_COLOR=void 0;let c=0,l=0,o=0,r=0;var _,L,d,i,t;function g(v){const M=v.toString(16);return M.length<2?"0"+M:M}function w(v,M){return v<M?(M+.05)/(v+.05):(v+.05)/(M+.05)}e.NULL_COLOR={css:"#00000000",rgba:0},function(v){v.toCss=function(M,x,a,m){return m!==void 0?`#${g(M)}${g(x)}${g(a)}${g(m)}`:`#${g(M)}${g(x)}${g(a)}`},v.toRgba=function(M,x,a,m=255){return(M<<24|x<<16|a<<8|m)>>>0},v.toColor=function(M,x,a,m){return{css:v.toCss(M,x,a,m),rgba:v.toRgba(M,x,a,m)}}}(_||(e.channels=_={})),function(v){function M(x,a){return r=Math.round(255*a),[c,l,o]=t.toChannels(x.rgba),{css:_.toCss(c,l,o,r),rgba:_.toRgba(c,l,o,r)}}v.blend=function(x,a){if(r=(255&a.rgba)/255,r===1)return{css:a.css,rgba:a.rgba};const m=a.rgba>>24&255,u=a.rgba>>16&255,h=a.rgba>>8&255,s=x.rgba>>24&255,f=x.rgba>>16&255,n=x.rgba>>8&255;return c=s+Math.round((m-s)*r),l=f+Math.round((u-f)*r),o=n+Math.round((h-n)*r),{css:_.toCss(c,l,o),rgba:_.toRgba(c,l,o)}},v.isOpaque=function(x){return(255&x.rgba)==255},v.ensureContrastRatio=function(x,a,m){const u=t.ensureContrastRatio(x.rgba,a.rgba,m);if(u)return _.toColor(u>>24&255,u>>16&255,u>>8&255)},v.opaque=function(x){const a=(255|x.rgba)>>>0;return[c,l,o]=t.toChannels(a),{css:_.toCss(c,l,o),rgba:a}},v.opacity=M,v.multiplyOpacity=function(x,a){return r=255&x.rgba,M(x,r*a/255)},v.toColorRGB=function(x){return[x.rgba>>24&255,x.rgba>>16&255,x.rgba>>8&255]}}(L||(e.color=L={})),function(v){let M,x;try{const a=document.createElement("canvas");a.width=1,a.height=1;const m=a.getContext("2d",{willReadFrequently:!0});m&&(M=m,M.globalCompositeOperation="copy",x=M.createLinearGradient(0,0,1,1))}catch{}v.toColor=function(a){if(a.match(/#[\da-f]{3,8}/i))switch(a.length){case 4:return c=parseInt(a.slice(1,2).repeat(2),16),l=parseInt(a.slice(2,3).repeat(2),16),o=parseInt(a.slice(3,4).repeat(2),16),_.toColor(c,l,o);case 5:return c=parseInt(a.slice(1,2).repeat(2),16),l=parseInt(a.slice(2,3).repeat(2),16),o=parseInt(a.slice(3,4).repeat(2),16),r=parseInt(a.slice(4,5).repeat(2),16),_.toColor(c,l,o,r);case 7:return{css:a,rgba:(parseInt(a.slice(1),16)<<8|255)>>>0};case 9:return{css:a,rgba:parseInt(a.slice(1),16)>>>0}}const m=a.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(m)return c=parseInt(m[1]),l=parseInt(m[2]),o=parseInt(m[3]),r=Math.round(255*(m[5]===void 0?1:parseFloat(m[5]))),_.toColor(c,l,o,r);if(!M||!x)throw new Error("css.toColor: Unsupported css format");if(M.fillStyle=x,M.fillStyle=a,typeof M.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(M.fillRect(0,0,1,1),[c,l,o,r]=M.getImageData(0,0,1,1).data,r!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:_.toRgba(c,l,o,r),css:a}}}(d||(e.css=d={})),function(v){function M(x,a,m){const u=x/255,h=a/255,s=m/255;return .2126*(u<=.03928?u/12.92:Math.pow((u+.055)/1.055,2.4))+.7152*(h<=.03928?h/12.92:Math.pow((h+.055)/1.055,2.4))+.0722*(s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4))}v.relativeLuminance=function(x){return M(x>>16&255,x>>8&255,255&x)},v.relativeLuminance2=M}(i||(e.rgb=i={})),function(v){function M(a,m,u){const h=a>>24&255,s=a>>16&255,f=a>>8&255;let n=m>>24&255,C=m>>16&255,p=m>>8&255,A=w(i.relativeLuminance2(n,C,p),i.relativeLuminance2(h,s,f));for(;A<u&&(n>0||C>0||p>0);)n-=Math.max(0,Math.ceil(.1*n)),C-=Math.max(0,Math.ceil(.1*C)),p-=Math.max(0,Math.ceil(.1*p)),A=w(i.relativeLuminance2(n,C,p),i.relativeLuminance2(h,s,f));return(n<<24|C<<16|p<<8|255)>>>0}function x(a,m,u){const h=a>>24&255,s=a>>16&255,f=a>>8&255;let n=m>>24&255,C=m>>16&255,p=m>>8&255,A=w(i.relativeLuminance2(n,C,p),i.relativeLuminance2(h,s,f));for(;A<u&&(n<255||C<255||p<255);)n=Math.min(255,n+Math.ceil(.1*(255-n))),C=Math.min(255,C+Math.ceil(.1*(255-C))),p=Math.min(255,p+Math.ceil(.1*(255-p))),A=w(i.relativeLuminance2(n,C,p),i.relativeLuminance2(h,s,f));return(n<<24|C<<16|p<<8|255)>>>0}v.blend=function(a,m){if(r=(255&m)/255,r===1)return m;const u=m>>24&255,h=m>>16&255,s=m>>8&255,f=a>>24&255,n=a>>16&255,C=a>>8&255;return c=f+Math.round((u-f)*r),l=n+Math.round((h-n)*r),o=C+Math.round((s-C)*r),_.toRgba(c,l,o)},v.ensureContrastRatio=function(a,m,u){const h=i.relativeLuminance(a>>8),s=i.relativeLuminance(m>>8);if(w(h,s)<u){if(s<h){const C=M(a,m,u),p=w(h,i.relativeLuminance(C>>8));if(p<u){const A=x(a,m,u);return p>w(h,i.relativeLuminance(A>>8))?C:A}return C}const f=x(a,m,u),n=w(h,i.relativeLuminance(f>>8));if(n<u){const C=M(a,m,u);return n>w(h,i.relativeLuminance(C>>8))?f:C}return f}},v.reduceLuminance=M,v.increaseLuminance=x,v.toChannels=function(a){return[a>>24&255,a>>16&255,a>>8&255,255&a]}}(t||(e.rgba=t={})),e.toPaddedHex=g,e.contrastRatio=w},345:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.runAndSubscribe=e.forwardEvent=e.EventEmitter=void 0,e.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=c=>(this._listeners.push(c),{dispose:()=>{if(!this._disposed){for(let l=0;l<this._listeners.length;l++)if(this._listeners[l]===c)return void this._listeners.splice(l,1)}}})),this._event}fire(c,l){const o=[];for(let r=0;r<this._listeners.length;r++)o.push(this._listeners[r]);for(let r=0;r<o.length;r++)o[r].call(void 0,c,l)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},e.forwardEvent=function(c,l){return c(o=>l.fire(o))},e.runAndSubscribe=function(c,l){return l(void 0),c(o=>l(o))}},859:(D,e)=>{function c(l){for(const o of l)o.dispose();l.length=0}Object.defineProperty(e,"__esModule",{value:!0}),e.getDisposeArrayDisposable=e.disposeArray=e.toDisposable=e.MutableDisposable=e.Disposable=void 0,e.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const l of this._disposables)l.dispose();this._disposables.length=0}register(l){return this._disposables.push(l),l}unregister(l){const o=this._disposables.indexOf(l);o!==-1&&this._disposables.splice(o,1)}},e.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(l){var o;this._isDisposed||l===this._value||((o=this._value)==null||o.dispose(),this._value=l)}clear(){this.value=void 0}dispose(){var l;this._isDisposed=!0,(l=this._value)==null||l.dispose(),this._value=void 0}},e.toDisposable=function(l){return{dispose:l}},e.disposeArray=c,e.getDisposeArrayDisposable=function(l){return{dispose:()=>c(l)}}},485:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FourKeyMap=e.TwoKeyMap=void 0;class c{constructor(){this._data={}}set(o,r,_){this._data[o]||(this._data[o]={}),this._data[o][r]=_}get(o,r){return this._data[o]?this._data[o][r]:void 0}clear(){this._data={}}}e.TwoKeyMap=c,e.FourKeyMap=class{constructor(){this._data=new c}set(l,o,r,_,L){this._data.get(l,o)||this._data.set(l,o,new c),this._data.get(l,o).set(r,_,L)}get(l,o,r,_){var L;return(L=this._data.get(l,o))==null?void 0:L.get(r,_)}clear(){this._data.clear()}}},399:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isChromeOS=e.isLinux=e.isWindows=e.isIphone=e.isIpad=e.isMac=e.getSafariVersion=e.isSafari=e.isLegacyEdge=e.isFirefox=e.isNode=void 0,e.isNode=typeof process<"u"&&"title"in process;const c=e.isNode?"node":navigator.userAgent,l=e.isNode?"node":navigator.platform;e.isFirefox=c.includes("Firefox"),e.isLegacyEdge=c.includes("Edge"),e.isSafari=/^((?!chrome|android).)*safari/i.test(c),e.getSafariVersion=function(){if(!e.isSafari)return 0;const o=c.match(/Version\/(\d+)/);return o===null||o.length<2?0:parseInt(o[1])},e.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(l),e.isIpad=l==="iPad",e.isIphone=l==="iPhone",e.isWindows=["Windows","Win16","Win32","WinCE"].includes(l),e.isLinux=l.indexOf("Linux")>=0,e.isChromeOS=/\bCrOS\b/.test(c)},385:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DebouncedIdleTask=e.IdleTaskQueue=e.PriorityTaskQueue=void 0;const l=c(399);class o{constructor(){this._tasks=[],this._i=0}enqueue(L){this._tasks.push(L),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(L){this._idleCallback=void 0;let d=0,i=0,t=L.timeRemaining(),g=0;for(;this._i<this._tasks.length;){if(d=Date.now(),this._tasks[this._i]()||this._i++,d=Math.max(1,Date.now()-d),i=Math.max(d,i),g=L.timeRemaining(),1.5*i>g)return t-d<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(t-d))}ms`),void this._start();t=g}this.clear()}}class r extends o{_requestCallback(L){return setTimeout(()=>L(this._createDeadline(16)))}_cancelCallback(L){clearTimeout(L)}_createDeadline(L){const d=Date.now()+L;return{timeRemaining:()=>Math.max(0,d-Date.now())}}}e.PriorityTaskQueue=r,e.IdleTaskQueue=!l.isNode&&"requestIdleCallback"in window?class extends o{_requestCallback(_){return requestIdleCallback(_)}_cancelCallback(_){cancelIdleCallback(_)}}:r,e.DebouncedIdleTask=class{constructor(){this._queue=new e.IdleTaskQueue}set(_){this._queue.clear(),this._queue.enqueue(_)}flush(){this._queue.flush()}}},147:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ExtendedAttrs=e.AttributeData=void 0;class c{constructor(){this.fg=0,this.bg=0,this.extended=new l}static toColorRGB(r){return[r>>>16&255,r>>>8&255,255&r]}static fromColorRGB(r){return(255&r[0])<<16|(255&r[1])<<8|255&r[2]}clone(){const r=new c;return r.fg=this.fg,r.bg=this.bg,r.extended=this.extended.clone(),r}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}e.AttributeData=c;class l{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(r){this._ext=r}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(r){this._ext&=-469762049,this._ext|=r<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(r){this._ext&=-67108864,this._ext|=67108863&r}get urlId(){return this._urlId}set urlId(r){this._urlId=r}get underlineVariantOffset(){const r=(3758096384&this._ext)>>29;return r<0?4294967288^r:r}set underlineVariantOffset(r){this._ext&=536870911,this._ext|=r<<29&3758096384}constructor(r=0,_=0){this._ext=0,this._urlId=0,this._ext=r,this._urlId=_}clone(){return new l(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}e.ExtendedAttrs=l},782:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CellData=void 0;const l=c(133),o=c(855),r=c(147);class _ extends r.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new r.ExtendedAttrs,this.combinedData=""}static fromCharData(d){const i=new _;return i.setFromCharData(d),i}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,l.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(d){this.fg=d[o.CHAR_DATA_ATTR_INDEX],this.bg=0;let i=!1;if(d[o.CHAR_DATA_CHAR_INDEX].length>2)i=!0;else if(d[o.CHAR_DATA_CHAR_INDEX].length===2){const t=d[o.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=t&&t<=56319){const g=d[o.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=g&&g<=57343?this.content=1024*(t-55296)+g-56320+65536|d[o.CHAR_DATA_WIDTH_INDEX]<<22:i=!0}else i=!0}else this.content=d[o.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|d[o.CHAR_DATA_WIDTH_INDEX]<<22;i&&(this.combinedData=d[o.CHAR_DATA_CHAR_INDEX],this.content=2097152|d[o.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}e.CellData=_},855:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.WHITESPACE_CELL_CODE=e.WHITESPACE_CELL_WIDTH=e.WHITESPACE_CELL_CHAR=e.NULL_CELL_CODE=e.NULL_CELL_WIDTH=e.NULL_CELL_CHAR=e.CHAR_DATA_CODE_INDEX=e.CHAR_DATA_WIDTH_INDEX=e.CHAR_DATA_CHAR_INDEX=e.CHAR_DATA_ATTR_INDEX=e.DEFAULT_EXT=e.DEFAULT_ATTR=e.DEFAULT_COLOR=void 0,e.DEFAULT_COLOR=0,e.DEFAULT_ATTR=256|e.DEFAULT_COLOR<<9,e.DEFAULT_EXT=0,e.CHAR_DATA_ATTR_INDEX=0,e.CHAR_DATA_CHAR_INDEX=1,e.CHAR_DATA_WIDTH_INDEX=2,e.CHAR_DATA_CODE_INDEX=3,e.NULL_CELL_CHAR="",e.NULL_CELL_WIDTH=1,e.NULL_CELL_CODE=0,e.WHITESPACE_CELL_CHAR=" ",e.WHITESPACE_CELL_WIDTH=1,e.WHITESPACE_CELL_CODE=32},133:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Utf8ToUtf32=e.StringToUtf32=e.utf32ToString=e.stringFromCodePoint=void 0,e.stringFromCodePoint=function(c){return c>65535?(c-=65536,String.fromCharCode(55296+(c>>10))+String.fromCharCode(c%1024+56320)):String.fromCharCode(c)},e.utf32ToString=function(c,l=0,o=c.length){let r="";for(let _=l;_<o;++_){let L=c[_];L>65535?(L-=65536,r+=String.fromCharCode(55296+(L>>10))+String.fromCharCode(L%1024+56320)):r+=String.fromCharCode(L)}return r},e.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(c,l){const o=c.length;if(!o)return 0;let r=0,_=0;if(this._interim){const L=c.charCodeAt(_++);56320<=L&&L<=57343?l[r++]=1024*(this._interim-55296)+L-56320+65536:(l[r++]=this._interim,l[r++]=L),this._interim=0}for(let L=_;L<o;++L){const d=c.charCodeAt(L);if(55296<=d&&d<=56319){if(++L>=o)return this._interim=d,r;const i=c.charCodeAt(L);56320<=i&&i<=57343?l[r++]=1024*(d-55296)+i-56320+65536:(l[r++]=d,l[r++]=i)}else d!==65279&&(l[r++]=d)}return r}},e.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(c,l){const o=c.length;if(!o)return 0;let r,_,L,d,i=0,t=0,g=0;if(this.interim[0]){let M=!1,x=this.interim[0];x&=(224&x)==192?31:(240&x)==224?15:7;let a,m=0;for(;(a=63&this.interim[++m])&&m<4;)x<<=6,x|=a;const u=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,h=u-m;for(;g<h;){if(g>=o)return 0;if(a=c[g++],(192&a)!=128){g--,M=!0;break}this.interim[m++]=a,x<<=6,x|=63&a}M||(u===2?x<128?g--:l[i++]=x:u===3?x<2048||x>=55296&&x<=57343||x===65279||(l[i++]=x):x<65536||x>1114111||(l[i++]=x)),this.interim.fill(0)}const w=o-4;let v=g;for(;v<o;){for(;!(!(v<w)||128&(r=c[v])||128&(_=c[v+1])||128&(L=c[v+2])||128&(d=c[v+3]));)l[i++]=r,l[i++]=_,l[i++]=L,l[i++]=d,v+=4;if(r=c[v++],r<128)l[i++]=r;else if((224&r)==192){if(v>=o)return this.interim[0]=r,i;if(_=c[v++],(192&_)!=128){v--;continue}if(t=(31&r)<<6|63&_,t<128){v--;continue}l[i++]=t}else if((240&r)==224){if(v>=o)return this.interim[0]=r,i;if(_=c[v++],(192&_)!=128){v--;continue}if(v>=o)return this.interim[0]=r,this.interim[1]=_,i;if(L=c[v++],(192&L)!=128){v--;continue}if(t=(15&r)<<12|(63&_)<<6|63&L,t<2048||t>=55296&&t<=57343||t===65279)continue;l[i++]=t}else if((248&r)==240){if(v>=o)return this.interim[0]=r,i;if(_=c[v++],(192&_)!=128){v--;continue}if(v>=o)return this.interim[0]=r,this.interim[1]=_,i;if(L=c[v++],(192&L)!=128){v--;continue}if(v>=o)return this.interim[0]=r,this.interim[1]=_,this.interim[2]=L,i;if(d=c[v++],(192&d)!=128){v--;continue}if(t=(7&r)<<18|(63&_)<<12|(63&L)<<6|63&d,t<65536||t>1114111)continue;l[i++]=t}}return i}}},776:function(D,e,c){var l=this&&this.__decorate||function(t,g,w,v){var M,x=arguments.length,a=x<3?g:v===null?v=Object.getOwnPropertyDescriptor(g,w):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,g,w,v);else for(var m=t.length-1;m>=0;m--)(M=t[m])&&(a=(x<3?M(a):x>3?M(g,w,a):M(g,w))||a);return x>3&&a&&Object.defineProperty(g,w,a),a},o=this&&this.__param||function(t,g){return function(w,v){g(w,v,t)}};Object.defineProperty(e,"__esModule",{value:!0}),e.traceCall=e.setTraceLogger=e.LogService=void 0;const r=c(859),_=c(97),L={trace:_.LogLevelEnum.TRACE,debug:_.LogLevelEnum.DEBUG,info:_.LogLevelEnum.INFO,warn:_.LogLevelEnum.WARN,error:_.LogLevelEnum.ERROR,off:_.LogLevelEnum.OFF};let d,i=e.LogService=class extends r.Disposable{get logLevel(){return this._logLevel}constructor(t){super(),this._optionsService=t,this._logLevel=_.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),d=this}_updateLogLevel(){this._logLevel=L[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(t){for(let g=0;g<t.length;g++)typeof t[g]=="function"&&(t[g]=t[g]())}_log(t,g,w){this._evalLazyOptionalParams(w),t.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+g,...w)}trace(t,...g){var w,v;this._logLevel<=_.LogLevelEnum.TRACE&&this._log((v=(w=this._optionsService.options.logger)==null?void 0:w.trace.bind(this._optionsService.options.logger))!=null?v:console.log,t,g)}debug(t,...g){var w,v;this._logLevel<=_.LogLevelEnum.DEBUG&&this._log((v=(w=this._optionsService.options.logger)==null?void 0:w.debug.bind(this._optionsService.options.logger))!=null?v:console.log,t,g)}info(t,...g){var w,v;this._logLevel<=_.LogLevelEnum.INFO&&this._log((v=(w=this._optionsService.options.logger)==null?void 0:w.info.bind(this._optionsService.options.logger))!=null?v:console.info,t,g)}warn(t,...g){var w,v;this._logLevel<=_.LogLevelEnum.WARN&&this._log((v=(w=this._optionsService.options.logger)==null?void 0:w.warn.bind(this._optionsService.options.logger))!=null?v:console.warn,t,g)}error(t,...g){var w,v;this._logLevel<=_.LogLevelEnum.ERROR&&this._log((v=(w=this._optionsService.options.logger)==null?void 0:w.error.bind(this._optionsService.options.logger))!=null?v:console.error,t,g)}};e.LogService=i=l([o(0,_.IOptionsService)],i),e.setTraceLogger=function(t){d=t},e.traceCall=function(t,g,w){if(typeof w.value!="function")throw new Error("not supported");const v=w.value;w.value=function(...M){if(d.logLevel!==_.LogLevelEnum.TRACE)return v.apply(this,M);d.trace(`GlyphRenderer#${v.name}(${M.map(a=>JSON.stringify(a)).join(", ")})`);const x=v.apply(this,M);return d.trace(`GlyphRenderer#${v.name} return`,x),x}}},726:(D,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createDecorator=e.getServiceDependencies=e.serviceRegistry=void 0;const c="di$target",l="di$dependencies";e.serviceRegistry=new Map,e.getServiceDependencies=function(o){return o[l]||[]},e.createDecorator=function(o){if(e.serviceRegistry.has(o))return e.serviceRegistry.get(o);const r=function(_,L,d){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(i,t,g){t[c]===t?t[l].push({id:i,index:g}):(t[l]=[{id:i,index:g}],t[c]=t)})(r,_,d)};return r.toString=()=>o,e.serviceRegistry.set(o,r),r}},97:(D,e,c)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IDecorationService=e.IUnicodeService=e.IOscLinkService=e.IOptionsService=e.ILogService=e.LogLevelEnum=e.IInstantiationService=e.ICharsetService=e.ICoreService=e.ICoreMouseService=e.IBufferService=void 0;const l=c(726);var o;e.IBufferService=(0,l.createDecorator)("BufferService"),e.ICoreMouseService=(0,l.createDecorator)("CoreMouseService"),e.ICoreService=(0,l.createDecorator)("CoreService"),e.ICharsetService=(0,l.createDecorator)("CharsetService"),e.IInstantiationService=(0,l.createDecorator)("InstantiationService"),function(r){r[r.TRACE=0]="TRACE",r[r.DEBUG=1]="DEBUG",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.OFF=5]="OFF"}(o||(e.LogLevelEnum=o={})),e.ILogService=(0,l.createDecorator)("LogService"),e.IOptionsService=(0,l.createDecorator)("OptionsService"),e.IOscLinkService=(0,l.createDecorator)("OscLinkService"),e.IUnicodeService=(0,l.createDecorator)("UnicodeService"),e.IDecorationService=(0,l.createDecorator)("DecorationService")}},Z={};function Y(D){var e=Z[D];if(e!==void 0)return e.exports;var c=Z[D]={exports:{}};return re[D].call(c.exports,c,c.exports,Y),c.exports}var oe={};return(()=>{var D=oe;Object.defineProperty(D,"__esModule",{value:!0}),D.WebglAddon=void 0;const e=Y(345),c=Y(859),l=Y(399),o=Y(666),r=Y(776);class _ extends c.Disposable{constructor(d){if(l.isSafari&&(0,l.getSafariVersion)()<16){const i={antialias:!1,depth:!1,preserveDrawingBuffer:!0};if(!document.createElement("canvas").getContext("webgl2",i))throw new Error("Webgl2 is only supported on Safari 16 and above")}super(),this._preserveDrawingBuffer=d,this._onChangeTextureAtlas=this.register(new e.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new e.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new e.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onContextLoss=this.register(new e.EventEmitter),this.onContextLoss=this._onContextLoss.event}activate(d){const i=d._core;if(!d.element)return void this.register(i.onWillOpen(()=>this.activate(d)));this._terminal=d;const t=i.coreService,g=i.optionsService,w=i,v=w._renderService,M=w._characterJoinerService,x=w._charSizeService,a=w._coreBrowserService,m=w._decorationService,u=w._logService,h=w._themeService;(0,r.setTraceLogger)(u),this._renderer=this.register(new o.WebglRenderer(d,M,x,a,t,m,g,h,this._preserveDrawingBuffer)),this.register((0,e.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,e.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,e.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,e.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),v.setRenderer(this._renderer),this.register((0,c.toDisposable)(()=>{const s=this._terminal._core._renderService;s.setRenderer(this._terminal._core._createRenderer()),s.handleResize(d.cols,d.rows)}))}get textureAtlas(){var d;return(d=this._renderer)==null?void 0:d.textureAtlas}clearTextureAtlas(){var d;(d=this._renderer)==null||d.clearTextureAtlas()}}D.WebglAddon=_})(),oe})())})(be);var Me=be.exports;const Te=Ee(Me),Be=Se({__proto__:null,default:Te},[Me]);export{Be as a};
