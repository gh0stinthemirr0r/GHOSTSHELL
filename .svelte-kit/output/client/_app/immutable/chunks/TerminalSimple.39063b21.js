import{s as Ce,f as N,a as J,g as E,h as $,d as v,c as M,j as k,i as z,x,M as A,E as Ne,N as Le,o as Ee,J as Ie,q as te,l as oe,m as re,n as fe,O as ne,y as ae,k as K,P as me,Q as We,U as $e}from"./scheduler.b5668ba5.js";import{S as Pe,i as De,g as q,t as O,c as R,a as D,b as U,d as Q,m as F,e as G}from"./index.ca943cf7.js";import{e as se,T as H,M as ce,C as Oe,S as Ve,X as ze}from"./2.482f52c3.js";import{i as le}from"./settings.59c27804.js";import{G as Be}from"./git-branch.e16d437f.js";import{P as Je}from"./plus.b0c1fa37.js";function _e(o,e,l){const t=o.slice();return t[15]=e[l],t}function Me(o){const e=o.slice(),l=e[6]();return e[18]=l,e}function je(o){let e,l,t,s=ue(o[18])+"",r,m,c,u;var n=o[7](o[18]);function h(f,p){return{props:{size:16,class:"text-cyan-400"}}}return n&&(e=te(n,h())),c=new Oe({props:{size:14,class:"text-gray-400 ml-auto"}}),{c(){e&&U(e.$$.fragment),l=J(),t=N("span"),r=oe(s),m=J(),U(c.$$.fragment),this.h()},l(f){e&&Q(e.$$.fragment,f),l=M(f),t=E(f,"SPAN",{class:!0});var p=$(t);r=re(p,s),p.forEach(v),m=M(f),Q(c.$$.fragment,f),this.h()},h(){k(t,"class","text-white truncate")},m(f,p){e&&F(e,f,p),z(f,l,p),z(f,t,p),x(t,r),z(f,m,p),F(c,f,p),u=!0},p(f,p){if(n!==(n=f[7](f[18]))){if(e){q();const y=e;O(y.$$.fragment,1,0,()=>{G(y,1)}),R()}n?(e=te(n,h()),U(e.$$.fragment),D(e.$$.fragment,1),F(e,l.parentNode,l)):e=null}},i(f){u||(e&&D(e.$$.fragment,f),D(c.$$.fragment,f),u=!0)},o(f){e&&O(e.$$.fragment,f),O(c.$$.fragment,f),u=!1},d(f){f&&(v(l),v(t),v(m)),e&&G(e,f),G(c,f)}}}function Ae(o){let e,l,t,s="Loading...";return{c(){e=N("div"),l=J(),t=N("span"),t.textContent=s,this.h()},l(r){e=E(r,"DIV",{class:!0}),$(e).forEach(v),l=M(r),t=E(r,"SPAN",{class:!0,"data-svelte-h":!0}),ne(t)!=="svelte-13049mz"&&(t.textContent=s),this.h()},h(){k(e,"class","animate-spin rounded-full h-4 w-4 border-b-2 border-cyan-400"),k(t,"class","text-gray-400")},m(r,m){z(r,e,m),z(r,l,m),z(r,t,m)},p:ae,i:ae,o:ae,d(r){r&&(v(e),v(l),v(t))}}}function ye(o){let e,l,t,s=se(o[2]),r=[];for(let u=0;u<s.length;u+=1)r[u]=ve(_e(o,s,u));const m=u=>O(r[u],1,1,()=>{r[u]=null});let c=o[2].length===0&&Se();return{c(){e=N("div");for(let u=0;u<r.length;u+=1)r[u].c();l=J(),c&&c.c(),this.h()},l(u){e=E(u,"DIV",{class:!0});var n=$(e);for(let h=0;h<r.length;h+=1)r[h].l(n);l=M(n),c&&c.l(n),n.forEach(v),this.h()},h(){k(e,"class","absolute top-full left-0 right-0 mt-1 bg-black/90 backdrop-blur-sm border border-gray-700/50 rounded-lg shadow-xl z-50 max-h-64 overflow-y-auto")},m(u,n){z(u,e,n);for(let h=0;h<r.length;h+=1)r[h]&&r[h].m(e,null);x(e,l),c&&c.m(e,null),t=!0},p(u,n){if(n&167){s=se(u[2]);let h;for(h=0;h<s.length;h+=1){const f=_e(u,s,h);r[h]?(r[h].p(f,n),D(r[h],1)):(r[h]=ve(f),r[h].c(),D(r[h],1),r[h].m(e,l))}for(q(),h=s.length;h<r.length;h+=1)m(h);R()}u[2].length===0?c||(c=Se(),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},i(u){if(!t){for(let n=0;n<s.length;n+=1)D(r[n]);t=!0}},o(u){r=r.filter(Boolean);for(let n=0;n<r.length;n+=1)O(r[n]);t=!1},d(u){u&&v(e),Ie(r,u),c&&c.d()}}}function be(o){let e,l="Not available";return{c(){e=N("div"),e.textContent=l,this.h()},l(t){e=E(t,"DIV",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-16hj01e"&&(e.textContent=l),this.h()},h(){k(e,"class","text-xs text-red-400")},m(t,s){z(t,e,s)},d(t){t&&v(e)}}}function ge(o){let e;return{c(){e=N("div"),this.h()},l(l){e=E(l,"DIV",{class:!0}),$(e).forEach(v),this.h()},h(){k(e,"class","w-2 h-2 bg-cyan-400 rounded-full")},m(l,t){z(l,e,t)},d(l){l&&v(e)}}}function ve(o){let e,l,t,s,r,m=ue(o[15])+"",c,u,n,h=JSON.stringify(o[15].shell_type)===JSON.stringify(o[1]||o[0]),f,p,y,b,w;var C=o[7](o[15]);function B(i,_){return{props:{size:16,class:"text-cyan-400 flex-shrink-0"}}}C&&(l=te(C,B()));let d=!o[15].is_available&&be(),g=h&&ge();function a(){return o[10](o[15])}return{c(){e=N("button"),l&&U(l.$$.fragment),t=J(),s=N("div"),r=N("div"),c=oe(m),u=J(),d&&d.c(),n=J(),g&&g.c(),this.h()},l(i){e=E(i,"BUTTON",{class:!0});var _=$(e);l&&Q(l.$$.fragment,_),t=M(_),s=E(_,"DIV",{class:!0});var I=$(s);r=E(I,"DIV",{class:!0});var L=$(r);c=re(L,m),L.forEach(v),u=M(I),d&&d.l(I),I.forEach(v),n=M(_),g&&g.l(_),_.forEach(v),this.h()},h(){k(r,"class","text-sm font-medium text-white truncate"),k(s,"class","flex-1 min-w-0"),k(e,"class",f="w-full flex items-center space-x-3 px-3 py-2 hover:bg-cyan-500/10 transition-colors text-left border-b border-gray-800/30 last:border-b-0 "+(o[15].is_available?"":"opacity-50 cursor-not-allowed")),e.disabled=p=!o[15].is_available},m(i,_){z(i,e,_),l&&F(l,e,null),x(e,t),x(e,s),x(s,r),x(r,c),x(s,u),d&&d.m(s,null),x(e,n),g&&g.m(e,null),y=!0,b||(w=A(e,"click",a),b=!0)},p(i,_){if(o=i,_&4&&C!==(C=o[7](o[15]))){if(l){q();const I=l;O(I.$$.fragment,1,0,()=>{G(I,1)}),R()}C?(l=te(C,B()),U(l.$$.fragment),D(l.$$.fragment,1),F(l,e,t)):l=null}(!y||_&4)&&m!==(m=ue(o[15])+"")&&fe(c,m),o[15].is_available?d&&(d.d(1),d=null):d||(d=be(),d.c(),d.m(s,null)),_&7&&(h=JSON.stringify(o[15].shell_type)===JSON.stringify(o[1]||o[0])),h?g||(g=ge(),g.c(),g.m(e,null)):g&&(g.d(1),g=null),(!y||_&4&&f!==(f="w-full flex items-center space-x-3 px-3 py-2 hover:bg-cyan-500/10 transition-colors text-left border-b border-gray-800/30 last:border-b-0 "+(o[15].is_available?"":"opacity-50 cursor-not-allowed")))&&k(e,"class",f),(!y||_&4&&p!==(p=!o[15].is_available))&&(e.disabled=p)},i(i){y||(l&&D(l.$$.fragment,i),y=!0)},o(i){l&&O(l.$$.fragment,i),y=!1},d(i){i&&v(e),l&&G(l),d&&d.d(),g&&g.d(),b=!1,w()}}}function Se(o){let e,l="No shells available";return{c(){e=N("div"),e.textContent=l,this.h()},l(t){e=E(t,"DIV",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1xc20tp"&&(e.textContent=l),this.h()},h(){k(e,"class","px-3 py-4 text-center text-gray-400 text-sm")},m(t,s){z(t,e,s)},d(t){t&&v(e)}}}function Ue(o){let e,l,t,s,r,m,c,u;const n=[Ae,je],h=[];function f(b,w){return b[3]?0:1}function p(b,w){return w===1?Me(b):b}t=f(o),s=h[t]=n[t](p(o,t));let y=o[4]&&!o[3]&&ye(o);return{c(){e=N("div"),l=N("button"),s.c(),r=J(),y&&y.c(),this.h()},l(b){e=E(b,"DIV",{class:!0});var w=$(e);l=E(w,"BUTTON",{class:!0});var C=$(l);s.l(C),C.forEach(v),r=M(w),y&&y.l(w),w.forEach(v),this.h()},h(){k(l,"class","flex items-center space-x-2 px-3 py-2 bg-black/20 border border-gray-700/50 rounded-lg hover:border-cyan-500/50 transition-colors text-sm min-w-[160px]"),l.disabled=o[3],k(e,"class","shell-selector relative svelte-1xkpzkl")},m(b,w){z(b,e,w),x(e,l),h[t].m(l,null),x(e,r),y&&y.m(e,null),m=!0,c||(u=[A(window,"click",o[8]),A(l,"click",o[9])],c=!0)},p(b,[w]){let C=t;t=f(b),t===C?h[t].p(p(b,t),w):(q(),O(h[C],1,1,()=>{h[C]=null}),R(),s=h[t],s?s.p(p(b,t),w):(s=h[t]=n[t](p(b,t)),s.c()),D(s,1),s.m(l,null)),(!m||w&8)&&(l.disabled=b[3]),b[4]&&!b[3]?y?(y.p(b,w),w&24&&D(y,1)):(y=ye(b),y.c(),D(y,1),y.m(e,null)):y&&(q(),O(y,1,1,()=>{y=null}),R())},i(b){m||(D(s),D(y),m=!0)},o(b){O(s),O(y),m=!1},d(b){b&&v(e),h[t].d(),y&&y.d(),c=!1,Ne(u)}}}function ue(o){return typeof o.shell_type=="object"&&o.shell_type.WSLDistro?`WSL: ${o.shell_type.WSLDistro}`:o.display_name}function Fe(o,e,l){const t=Le();let{selectedShell:s=null}=e,r=null,m=[],c=null,u=!0,n=!1;const h={Nushell:H,PowerShell:H,PowerShellCore:H,Cmd:Ve,WSL:ce,WSLDistro:ce,GitBash:Be,Custom:H};Ee(async()=>{await f()});async function f(){try{l(3,u=!0),l(2,m=[{shell_type:"Nushell",display_name:"Nushell (Embedded)",executable_path:"embedded",is_available:!0},{shell_type:"PowerShell",display_name:"PowerShell",executable_path:"powershell.exe",is_available:!0},{shell_type:"CommandPrompt",display_name:"Command Prompt",executable_path:"cmd.exe",is_available:!0},{shell_type:"WSL",display_name:"WSL",executable_path:"wsl.exe",is_available:!0}]),c="Nushell",s||l(0,s=c),console.log("ShellSelector: Using PowerShell Core only (hardcoded)")}catch(d){console.error("Failed to load shells:",d)}finally{l(3,u=!1)}}function p(d){console.log("ShellSelector: handleShellSelect called with:",d),console.log("ShellSelector: shell.shell_type:",d.shell_type),console.log("ShellSelector: shell.display_name:",d.display_name),l(0,s=d.shell_type),l(1,r=d.shell_type),l(4,n=!1);const g={shellType:d.shell_type,displayName:d.display_name};console.log("ShellSelector: dispatching event with data:",g),t("shell-selected",g)}function y(){const d=r||s;if(console.log("getSelectedShellInfo: Looking for shell:",d),console.log("getSelectedShellInfo: Available shells:",m),!d)return console.log("getSelectedShellInfo: No shell selected, using default"),{display_name:"Nushell (Embedded)",shell_type:"Nushell"};let g=null;if(typeof d=="string"&&(g=m.find(a=>typeof a.shell_type=="string"?a.shell_type===d:!1),!g)){const i={PowerShell:"PowerShell",PowerShellCore:"PowerShell",CommandPrompt:"Command Prompt",Cmd:"Command Prompt",WSL:"WSL",WSL2:"WSL",Nushell:"Nushell (Embedded)"}[d];i&&(g=m.find(_=>_.display_name===i))}return g||(g=m.find(a=>JSON.stringify(a.shell_type)===JSON.stringify(d))),!g&&typeof d=="string"&&d.startsWith("WSL")&&(g=m.find(a=>a.display_name&&a.display_name.includes("WSL"))),console.log("getSelectedShellInfo: Found shell:",g),g||{display_name:typeof d=="string"?d:"Nushell (Embedded)",shell_type:d}}function b(d){if(typeof d.shell_type=="string")return h[d.shell_type]||H;if(d.shell_type&&typeof d.shell_type=="object"){if(d.shell_type.WSLDistro)return ce;const g=Object.keys(d.shell_type)[0];return h[g]||H}return H}function w(d){d.target.closest(".shell-selector")||l(4,n=!1)}const C=()=>l(4,n=!n),B=d=>p(d);return o.$$set=d=>{"selectedShell"in d&&l(0,s=d.selectedShell)},o.$$.update=()=>{o.$$.dirty&1&&s&&l(0,s),o.$$.dirty&3&&s!==r&&(l(1,r=s),console.log("ShellSelector: selectedShell prop changed to:",s),console.log("ShellSelector: currentSelectedShell updated to:",r))},[s,r,m,u,n,p,y,b,w,C,B]}class Ge extends Pe{constructor(e){super(),De(this,e,Fe,Ue,Ce,{selectedShell:0})}}function we(o,e,l){const t=o.slice();return t[17]=e[l],t}function ke(o){let e,l,t,s,r;l=new ze({props:{size:12}});function m(){return o[10](o[17])}return{c(){e=N("button"),U(l.$$.fragment),this.h()},l(c){e=E(c,"BUTTON",{class:!0});var u=$(e);Q(l.$$.fragment,u),u.forEach(v),this.h()},h(){k(e,"class","ml-2 text-gray-400 hover:text-pink-400 transition-colors")},m(c,u){z(c,e,u),F(l,e,null),t=!0,s||(r=A(e,"click",$e(m)),s=!0)},p(c,u){o=c},i(c){t||(D(l.$$.fragment,c),t=!0)},o(c){O(l.$$.fragment,c),t=!1},d(c){c&&v(e),G(l),s=!1,r()}}}function Te(o){let e,l=o[17].title+"",t,s,r,m,c,u,n=o[0].length>1&&ke(o);function h(){return o[11](o[17])}return{c(){e=N("button"),t=oe(l),s=J(),n&&n.c(),this.h()},l(f){e=E(f,"BUTTON",{class:!0});var p=$(e);t=re(p,l),s=M(p),n&&n.l(p),p.forEach(v),this.h()},h(){k(e,"class",r="tab px-3 py-2 rounded-t-lg text-sm transition-all duration-200 relative "+(o[17].active?"bg-black/95 text-cyan-300 border-t-2 border-l-2 border-r-2 border-cyan-400 shadow-lg shadow-cyan-500/20 -mb-px":"bg-gray-800/60 text-gray-300 hover:bg-cyan-500/10 hover:text-cyan-400 border border-gray-600/50")+" svelte-veueib")},m(f,p){z(f,e,p),x(e,t),x(e,s),n&&n.m(e,null),m=!0,c||(u=A(e,"click",h),c=!0)},p(f,p){o=f,(!m||p&1)&&l!==(l=o[17].title+"")&&fe(t,l),o[0].length>1?n?(n.p(o,p),p&1&&D(n,1)):(n=ke(o),n.c(),D(n,1),n.m(e,null)):n&&(q(),O(n,1,1,()=>{n=null}),R()),(!m||p&1&&r!==(r="tab px-3 py-2 rounded-t-lg text-sm transition-all duration-200 relative "+(o[17].active?"bg-black/95 text-cyan-300 border-t-2 border-l-2 border-r-2 border-cyan-400 shadow-lg shadow-cyan-500/20 -mb-px":"bg-gray-800/60 text-gray-300 hover:bg-cyan-500/10 hover:text-cyan-400 border border-gray-600/50")+" svelte-veueib"))&&k(e,"class",r)},i(f){m||(D(n),m=!0)},o(f){O(n),m=!1},d(f){f&&v(e),n&&n.d(),c=!1,u()}}}function xe(o){let e=(o[3].output||`◉ GHOSTSHELL TERMINAL v2.0 ◉
> System ready. Enter commands below.
> Type "help" for available commands.

`)+"",l;return{c(){l=oe(e)},l(t){l=re(t,e)},m(t,s){z(t,l,s)},p(t,s){s&8&&e!==(e=(t[3].output||`◉ GHOSTSHELL TERMINAL v2.0 ◉
> System ready. Enter commands below.
> Type "help" for available commands.

`)+"")&&fe(l,e)},d(t){t&&v(l)}}}function He(o){let e,l,t,s,r,m,c,u,n,h,f,p,y,b,w,C,B,d="❯",g,a,i,_,I,L=se(o[0]),T=[];for(let S=0;S<L.length;S+=1)T[S]=Te(we(o,L,S));const X=S=>O(T[S],1,1,()=>{T[S]=null});m=new Je({props:{size:14}}),n=new Ge({props:{selectedShell:o[2],key:o[2]}}),n.$on("shell-selected",o[5]);let V=o[3]&&xe(o);return{c(){e=N("div"),l=N("div"),t=N("div");for(let S=0;S<T.length;S+=1)T[S].c();s=J(),r=N("button"),U(m.$$.fragment),c=J(),u=N("div"),U(n.$$.fragment),h=J(),f=N("div"),p=N("div"),V&&V.c(),b=J(),w=N("div"),C=N("div"),B=N("span"),B.textContent=d,g=J(),a=N("input"),this.h()},l(S){e=E(S,"DIV",{class:!0});var P=$(e);l=E(P,"DIV",{class:!0});var j=$(l);t=E(j,"DIV",{class:!0});var W=$(t);for(let ie=0;ie<T.length;ie+=1)T[ie].l(W);s=M(W),r=E(W,"BUTTON",{class:!0});var Y=$(r);Q(m.$$.fragment,Y),Y.forEach(v),W.forEach(v),c=M(j),u=E(j,"DIV",{class:!0});var de=$(u);Q(n.$$.fragment,de),de.forEach(v),j.forEach(v),h=M(P),f=E(P,"DIV",{class:!0});var Z=$(f);p=E(Z,"DIV",{id:!0,class:!0,style:!0});var he=$(p);V&&V.l(he),he.forEach(v),b=M(Z),w=E(Z,"DIV",{class:!0});var pe=$(w);C=E(pe,"DIV",{class:!0});var ee=$(C);B=E(ee,"SPAN",{class:!0,"data-svelte-h":!0}),ne(B)!=="svelte-1ldj7xk"&&(B.textContent=d),g=M(ee),a=E(ee,"INPUT",{type:!0,placeholder:!0,class:!0,style:!0}),ee.forEach(v),pe.forEach(v),Z.forEach(v),P.forEach(v),this.h()},h(){k(r,"class","add-tab px-2 py-2 rounded-lg bg-gray-800/60 hover:bg-cyan-500/20 text-gray-300 hover:text-cyan-400 transition-all duration-200 border border-gray-600/50"),k(t,"class","flex space-x-1 flex-1"),k(u,"class","ml-4"),k(l,"class","tab-bar flex items-center bg-gray-900/90 border-b border-cyan-500/30 px-4 py-1 backdrop-blur-sm relative z-10 svelte-veueib"),k(p,"id",y="output-"+o[1]),k(p,"class","output-area flex-1 p-4 bg-black/95 text-cyan-300 font-mono text-sm overflow-y-auto whitespace-pre-wrap border-l-2 border-r-2 border-cyan-400/50 shadow-inner shadow-cyan-500/10 min-h-0 svelte-veueib"),K(p,"font-family","'JetBrains Mono', monospace"),K(p,"line-height","1.5"),K(p,"text-shadow","0 0 2px rgba(34, 211, 238, 0.3)"),K(p,"max-height","calc(100vh - 200px)"),k(B,"class","text-pink-400 font-mono mr-2 font-bold animate-pulse"),k(a,"type","text"),k(a,"placeholder","Enter command..."),k(a,"class","flex-1 bg-transparent text-cyan-300 font-mono outline-none placeholder-gray-500"),K(a,"font-family","'JetBrains Mono', monospace"),K(a,"text-shadow","0 0 2px rgba(34, 211, 238, 0.3)"),k(C,"class","flex items-center"),k(w,"class","input-area flex-shrink-0 bg-gray-900/95 border-t border-l-2 border-r-2 border-b-2 border-cyan-500/30 border-l-cyan-400/50 border-r-cyan-400/50 border-b-cyan-400/50 p-4 backdrop-blur-sm svelte-veueib"),k(f,"class","terminal-output flex-1 flex flex-col relative min-h-0 svelte-veueib"),k(e,"class","terminal-container h-full flex flex-col bg-gray-900/95 backdrop-blur-sm relative svelte-veueib")},m(S,P){z(S,e,P),x(e,l),x(l,t);for(let j=0;j<T.length;j+=1)T[j]&&T[j].m(t,null);x(t,s),x(t,r),F(m,r,null),x(l,c),x(l,u),F(n,u,null),x(e,h),x(e,f),x(f,p),V&&V.m(p,null),x(f,b),x(f,w),x(w,C),x(C,B),x(C,g),x(C,a),me(a,o[4]),i=!0,_||(I=[A(r,"click",o[6]),A(a,"input",o[12]),A(a,"keydown",o[9])],_=!0)},p(S,[P]){if(P&385){L=se(S[0]);let W;for(W=0;W<L.length;W+=1){const Y=we(S,L,W);T[W]?(T[W].p(Y,P),D(T[W],1)):(T[W]=Te(Y),T[W].c(),D(T[W],1),T[W].m(t,s))}for(q(),W=L.length;W<T.length;W+=1)X(W);R()}const j={};P&4&&(j.selectedShell=S[2]),P&4&&(j.key=S[2]),n.$set(j),S[3]?V?V.p(S,P):(V=xe(S),V.c(),V.m(p,null)):V&&(V.d(1),V=null),(!i||P&2&&y!==(y="output-"+S[1]))&&k(p,"id",y),P&16&&a.value!==S[4]&&me(a,S[4])},i(S){if(!i){for(let P=0;P<L.length;P+=1)D(T[P]);D(m.$$.fragment,S),D(n.$$.fragment,S),i=!0}},o(S){T=T.filter(Boolean);for(let P=0;P<T.length;P+=1)O(T[P]);O(m.$$.fragment,S),O(n.$$.fragment,S),i=!1},d(S){S&&v(e),Ie(T,S),G(m),G(n),V&&V.d(),_=!1,Ne(I)}}}function qe(o,e,l){let t,s=[{id:1,title:"Shell 1",active:!0,sessionId:null,shellType:"Nushell",output:""}],r=1,m=2,c="",u="Nushell";Ee(async()=>{console.log("Terminal mounted, initializing..."),await n()}),We(()=>{console.log("Terminal component destroyed")});async function n(){const a=s.find(_=>_.id===r);if(!a)return;console.log(`Initializing tab ${a.id} with shell ${a.shellType}`);let i="";a.shellType==="Nushell"?i=`◉ Nushell ready. Enter commands below.

`:i=`◉ ${a.shellType?.replace("PowerShellCore","PowerShell Core")||"PowerShell Core"} ready. Enter commands below.

`,l(0,s=s.map(_=>_.id===a.id?{..._,output:i}:_)),console.log(`Tab ${a.id} initialized successfully`)}async function h(){if(!c.trim()||!t)return;const a=c.trim();console.log(`Executing command with ${t.shellType}: ${a}`),l(4,c=""),l(3,t.output+=`❯ ${a}
`,t),l(0,s=[...s]),w();try{let i;if(t.shellType==="Nushell")t.sessionId||(l(3,t.sessionId=await le("nushell_create_session"),t),console.log(`Created Nushell session: ${t.sessionId}`)),i=await le("nushell_execute_command",{sessionId:t.sessionId,command:a});else{let _=t.shellType||"PowerShell Core";_==="PowerShell Core"&&(_="PowerShellCore"),i=await le("simple_execute_command",{shellType:_,command:a})}i.output?l(3,t.output+=i.output,t):i.stdout&&l(3,t.output+=i.stdout,t),i.error?l(3,t.output+=`Error: ${i.error}
`,t):i.stderr&&l(3,t.output+=`Error: ${i.stderr}`,t),!i.success&&i.exit_code!==0&&l(3,t.output+=`Command exited with code: ${i.exit_code}
`,t),l(0,s=[...s]),w()}catch(i){console.error("Error executing command:",i),l(3,t.output+=`Error: ${i}
`,t),l(0,s=[...s]),w()}}async function f(a){const{shellType:i,displayName:_}=a.detail;if(console.log("Shell selected:",i,_),console.log("Shell type type:",typeof i),console.log("Shell type JSON:",JSON.stringify(i)),!t)return;let I="";if(typeof i=="string")I=i;else if(typeof i=="object"&&i!==null)if(i.WSLDistro)I=`WSL:${i.WSLDistro}`;else if(i.WSL)I="WSL";else{const L=Object.keys(i);if(L.length>0){const T=L[0],X=i[T];typeof X=="string"&&X.length>0?I=`${T}:${X}`:I=T}else console.error("Empty shell type object:",i),I="PowerShellCore"}else i==null?(console.error("Null/undefined shell type"),I="PowerShellCore"):(console.error("Invalid shell type:",i,typeof i),I="PowerShellCore");console.log("Converted shell type string:",I),I==="PowerShell Core"&&(I="PowerShellCore"),l(3,t.sessionId=null,t),l(0,s=s.map(L=>L.id===r?{...L,shellType:I,sessionId:null,output:`${L.output}◉ Switching to ${_}...
`}:L)),l(0,s=[...s]);try{await n(),t&&(l(3,t.output+=`✓ Successfully switched to ${_}

`,t),l(0,s=[...s]))}catch(L){console.error("Failed to switch shell:",L),t&&(l(3,t.output+=`✗ Failed to switch to ${_}: ${L}

`,t),l(0,s=[...s]))}}function p(){const a={id:m++,title:`Shell ${m-1}`,active:!1,sessionId:null,shellType:"PowerShellCore",output:""};l(0,s=[...s,a]),b(a.id)}async function y(a){if(s.length===1)return;const i=s.find(_=>_.id===a);if(i&&i.shellType==="Nushell"&&i.sessionId)try{await le("nushell_close_session",{sessionId:i.sessionId}),console.log(`Closed Nushell session: ${i.sessionId}`)}catch(_){console.error("Error closing Nushell session:",_)}l(0,s=s.filter(_=>_.id!==a)),r===a&&l(1,r=s[0].id)}function b(a){l(0,s=s.map(_=>({..._,active:_.id===a}))),l(1,r=a);const i=s.find(_=>_.id===a);i&&!i.sessionId&&n()}function w(){setTimeout(()=>{const a=document.getElementById(`output-${r}`);a&&(a.scrollTop=a.scrollHeight)},10)}function C(a){a.key==="Enter"&&(a.preventDefault(),h())}const B=a=>y(a.id),d=a=>b(a.id);function g(){c=this.value,l(4,c)}return o.$$.update=()=>{o.$$.dirty&3&&l(3,t=s.find(a=>a.id===r)),o.$$.dirty&12&&(l(2,u=t?.shellType||"Nushell"),console.log("TerminalSimple: currentShellType updated to:",u),console.log("TerminalSimple: activeTab.shellType:",t?.shellType))},[s,r,u,t,c,f,p,y,b,C,B,d,g]}class el extends Pe{constructor(e){super(),De(this,e,qe,He,Ce,{})}}export{el as default};
