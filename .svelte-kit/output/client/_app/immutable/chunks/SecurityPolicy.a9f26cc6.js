import{s as Rt,f as i,a as g,l as re,g as c,h as p,c as y,O as Y,d as h,m as ne,j as f,i as ve,x as l,M as Ee,E as Ke,o as qt,n as ye,W as $e,R as Se,y as Qe,S as et,T as Xe,J as He}from"./scheduler.a8b88eab.js";import{S as Lt,i as Bt,b as Ue,d as je,m as Oe,g as ze,t as De,c as We,a as Ce,e as Re}from"./index.8884acef.js";import{b as Ot,e as Te,E as Ht,n as Ge,S as Mt,F as Ft}from"./2.20172fad.js";import{i as Me}from"./theme.50793ec2.js";import{D as Yt}from"./download.acbd7ea8.js";import{U as zt}from"./upload.3b0fe74c.js";import{X as Ze}from"./circle-x.b8f80171.js";function tt(a,e,t){const r=a.slice();return r[64]=e[t][0],r[65]=e[t][1],r}function lt(a,e,t){const r=a.slice();return r[57]=e[t],r}function st(a,e,t){const r=a.slice();return r[64]=e[t][0],r[65]=e[t][1],r}function rt(a,e,t){const r=a.slice();return r[51]=e[t],r}function nt(a,e,t){const r=a.slice();return r[54]=e[t],r}function ot(a,e,t){const r=a.slice();return r[57]=e[t],r}function at(a,e,t){const r=a.slice();return r[1]=e[t],r}function it(a,e,t){const r=a.slice();return r[51]=e[t],r}function ct(a,e,t){const r=a.slice();return r[54]=e[t],r}function dt(a){let e,t,r,u,n,s,o=a[3].has_policy?"Policy Active":"No Policy",v,_,d,m,E=a[3].total_rules+"",R,W,C,x,D,I=a[3].version+"",O;return{c(){e=i("div"),t=i("div"),r=i("div"),n=g(),s=i("span"),v=re(o),_=g(),d=i("div"),m=i("span"),R=re(E),W=re(" rules"),C=g(),x=i("div"),D=re("v"),O=re(I),this.h()},l(T){e=c(T,"DIV",{class:!0});var oe=p(e);t=c(oe,"DIV",{class:!0});var $=p(t);r=c($,"DIV",{class:!0}),p(r).forEach(h),n=y($),s=c($,"SPAN",{});var V=p(s);v=ne(V,o),V.forEach(h),$.forEach(h),_=y(oe),d=c(oe,"DIV",{class:!0});var N=p(d);m=c(N,"SPAN",{class:!0});var me=p(m);R=ne(me,E),me.forEach(h),W=ne(N," rules"),N.forEach(h),C=y(oe),x=c(oe,"DIV",{class:!0});var q=p(x);D=ne(q,"v"),O=ne(q,I),q.forEach(h),oe.forEach(h),this.h()},h(){f(r,"class",u="w-2 h-2 rounded-full "+(a[3].has_policy?"bg-green-400":"bg-red-400")),f(t,"class","flex items-center space-x-2"),f(m,"class","text-blue-400"),f(d,"class","text-gray-300"),f(x,"class","text-gray-300"),f(e,"class","flex items-center space-x-4 text-sm")},m(T,oe){ve(T,e,oe),l(e,t),l(t,r),l(t,n),l(t,s),l(s,v),l(e,_),l(e,d),l(d,m),l(m,R),l(d,W),l(e,C),l(e,x),l(x,D),l(x,O)},p(T,oe){oe[0]&8&&u!==(u="w-2 h-2 rounded-full "+(T[3].has_policy?"bg-green-400":"bg-red-400"))&&f(r,"class",u),oe[0]&8&&o!==(o=T[3].has_policy?"Policy Active":"No Policy")&&ye(v,o),oe[0]&8&&E!==(E=T[3].total_rules+"")&&ye(R,E),oe[0]&8&&I!==(I=T[3].version+"")&&ye(O,I)},d(T){T&&h(e)}}}function ut(a){let e,t;return{c(){e=i("div"),t=re(a[1]),this.h()},l(r){e=c(r,"DIV",{class:!0});var u=p(e);t=ne(u,a[1]),u.forEach(h),this.h()},h(){f(e,"class","bg-red-600/20 border border-red-500/30 text-red-200 p-3 m-4 rounded-lg")},m(r,u){ve(r,e,u),l(e,t)},p(r,u){u[0]&2&&ye(t,r[1])},d(r){r&&h(e)}}}function ft(a){let e,t;return{c(){e=i("div"),t=re(a[0]),this.h()},l(r){e=c(r,"DIV",{class:!0});var u=p(e);t=ne(u,a[0]),u.forEach(h),this.h()},h(){f(e,"class","bg-green-600/20 border border-green-500/30 text-green-200 p-3 m-4 rounded-lg")},m(r,u){ve(r,e,u),l(e,t)},p(r,u){u[0]&1&&ye(t,r[0])},d(r){r&&h(e)}}}function Wt(a){let e,t,r,u,n="User Context",s,o,v,_,d="Current User",m,E,R,W,C,x="Set",D,I,O,T="Session Context",oe,$,V,N,me,q,ae,X,ge="Add",fe,A=Object.keys(a[15]).length>0,U,te,_e='<h4 class="font-medium mb-4">Context Variables</h4> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm"><div><div class="font-medium text-purple-300 mb-2">User Context</div> <div class="space-y-1 text-gray-300"><div>• user_id</div> <div>• user_role</div> <div>• user_groups</div> <div>• mfa_verified</div></div></div> <div><div class="font-medium text-blue-300 mb-2">System Context</div> <div class="space-y-1 text-gray-300"><div>• pq_available</div> <div>• network_trust</div> <div>• sensitivity_level</div> <div>• time_of_day</div></div></div> <div><div class="font-medium text-cyan-300 mb-2">Resource Context</div> <div class="space-y-1 text-gray-300"><div>• resource_id</div> <div>• resource_path</div> <div>• file_size</div> <div>• source_url</div></div></div></div>',le,F,z=A&&vt(a);return{c(){e=i("div"),t=i("div"),r=i("div"),u=i("h4"),u.textContent=n,s=g(),o=i("div"),v=i("div"),_=i("label"),_.textContent=d,m=g(),E=i("div"),R=i("input"),W=g(),C=i("button"),C.textContent=x,D=g(),I=i("div"),O=i("h4"),O.textContent=T,oe=g(),$=i("div"),V=i("div"),N=i("input"),me=g(),q=i("input"),ae=g(),X=i("button"),X.textContent=ge,fe=g(),z&&z.c(),U=g(),te=i("div"),te.innerHTML=_e,this.h()},l(j){e=c(j,"DIV",{class:!0});var B=p(e);t=c(B,"DIV",{class:!0});var ie=p(t);r=c(ie,"DIV",{class:!0});var pe=p(r);u=c(pe,"H4",{class:!0,"data-svelte-h":!0}),Y(u)!=="svelte-1oincio"&&(u.textContent=n),s=y(pe),o=c(pe,"DIV",{class:!0});var P=p(o);v=c(P,"DIV",{});var Q=p(v);_=c(Q,"LABEL",{class:!0,"data-svelte-h":!0}),Y(_)!=="svelte-t52j7a"&&(_.textContent=d),m=y(Q),E=c(Q,"DIV",{class:!0});var se=p(E);R=c(se,"INPUT",{type:!0,placeholder:!0,class:!0}),W=y(se),C=c(se,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(C)!=="svelte-4myyng"&&(C.textContent=x),se.forEach(h),Q.forEach(h),P.forEach(h),pe.forEach(h),D=y(ie),I=c(ie,"DIV",{class:!0});var xe=p(I);O=c(xe,"H4",{class:!0,"data-svelte-h":!0}),Y(O)!=="svelte-mfq0mj"&&(O.textContent=T),oe=y(xe),$=c(xe,"DIV",{class:!0});var ee=p($);V=c(ee,"DIV",{class:!0});var ce=p(V);N=c(ce,"INPUT",{type:!0,placeholder:!0,class:!0}),me=y(ce),q=c(ce,"INPUT",{type:!0,placeholder:!0,class:!0}),ae=y(ce),X=c(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(X)!=="svelte-vt70s1"&&(X.textContent=ge),ce.forEach(h),fe=y(ee),z&&z.l(ee),ee.forEach(h),xe.forEach(h),ie.forEach(h),U=y(B),te=c(B,"DIV",{class:!0,"data-svelte-h":!0}),Y(te)!=="svelte-1q8gafc"&&(te.innerHTML=_e),B.forEach(h),this.h()},h(){f(u,"class","font-medium mb-4"),f(_,"class","block text-sm font-medium text-gray-300 mb-2"),f(R,"type","text"),f(R,"placeholder","User ID"),f(R,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),f(C,"class","px-4 py-2 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 transition-colors"),f(E,"class","flex space-x-2"),f(o,"class","space-y-3"),f(r,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-4"),f(O,"class","font-medium mb-4"),f(N,"type","text"),f(N,"placeholder","Context Key"),f(N,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),f(q,"type","text"),f(q,"placeholder","Context Value"),f(q,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),f(X,"class","px-4 py-2 bg-cyan-600/20 border border-cyan-500/30 rounded-lg hover:bg-cyan-600/30 transition-colors"),f(V,"class","flex space-x-2"),f($,"class","space-y-3"),f(I,"class","bg-black/40 backdrop-blur-sm border border-cyan-500/30 rounded-lg p-4"),f(t,"class","grid grid-cols-1 lg:grid-cols-2 gap-6"),f(te,"class","bg-black/40 backdrop-blur-sm border border-purple-500/30 rounded-lg p-4"),f(e,"class","p-6 space-y-6")},m(j,B){ve(j,e,B),l(e,t),l(t,r),l(r,u),l(r,s),l(r,o),l(o,v),l(v,_),l(v,m),l(v,E),l(E,R),Se(R,a[14]),l(E,W),l(E,C),l(t,D),l(t,I),l(I,O),l(I,oe),l(I,$),l($,V),l(V,N),Se(N,a[12]),l(V,me),l(V,q),Se(q,a[13]),l(V,ae),l(V,X),l($,fe),z&&z.m($,null),l(e,U),l(e,te),le||(F=[Ee(R,"input",a[46]),Ee(C,"click",a[22]),Ee(N,"input",a[47]),Ee(q,"input",a[48]),Ee(X,"click",a[23])],le=!0)},p(j,B){B[0]&16384&&R.value!==j[14]&&Se(R,j[14]),B[0]&4096&&N.value!==j[12]&&Se(N,j[12]),B[0]&8192&&q.value!==j[13]&&Se(q,j[13]),B[0]&32768&&(A=Object.keys(j[15]).length>0),A?z?z.p(j,B):(z=vt(j),z.c(),z.m($,null)):z&&(z.d(1),z=null)},i:Qe,o:Qe,d(j){j&&h(e),z&&z.d(),le=!1,Ke(F)}}}function Qt(a){let e,t,r,u="Policy Tester",n,s,o,v="Resource",_,d,m,E,R,W="Action",C,x,D,I,O,T="Test Context",oe,$,V,N,me,q,ae,X,ge="Add",fe,A=Object.keys(a[11]).length>0,U,te,_e,le=a[8]?"Running...":"Dry Run Test",F,z,j,B=a[8]?"Testing...":"Test Access",ie,pe,P,Q,se,xe,ee,ce=Te(a[16]),G=[];for(let b=0;b<ce.length;b+=1)G[b]=_t(nt(a,ce,b));let be=Te(a[17]),w=[];for(let b=0;b<be.length;b+=1)w[b]=pt(rt(a,be,b));let H=A&&bt(a),S=a[6]&&gt(a),K=a[7]&&kt(a);return{c(){e=i("div"),t=i("div"),r=i("h3"),r.textContent=u,n=g(),s=i("div"),o=i("label"),o.textContent=v,_=g(),d=i("select");for(let b=0;b<G.length;b+=1)G[b].c();m=g(),E=i("div"),R=i("label"),R.textContent=W,C=g(),x=i("select");for(let b=0;b<w.length;b+=1)w[b].c();D=g(),I=i("div"),O=i("label"),O.textContent=T,oe=g(),$=i("div"),V=i("div"),N=i("input"),me=g(),q=i("input"),ae=g(),X=i("button"),X.textContent=ge,fe=g(),H&&H.c(),U=g(),te=i("div"),_e=i("button"),F=re(le),z=g(),j=i("button"),ie=re(B),pe=g(),P=i("div"),S&&S.c(),Q=g(),K&&K.c(),this.h()},l(b){e=c(b,"DIV",{class:!0});var L=p(e);t=c(L,"DIV",{class:!0});var k=p(t);r=c(k,"H3",{class:!0,"data-svelte-h":!0}),Y(r)!=="svelte-1of2s4"&&(r.textContent=u),n=y(k),s=c(k,"DIV",{});var he=p(s);o=c(he,"LABEL",{class:!0,"data-svelte-h":!0}),Y(o)!=="svelte-13yzv4y"&&(o.textContent=v),_=y(he),d=c(he,"SELECT",{class:!0});var Ve=p(d);for(let Ie=0;Ie<G.length;Ie+=1)G[Ie].l(Ve);Ve.forEach(h),he.forEach(h),m=y(k),E=c(k,"DIV",{});var J=p(E);R=c(J,"LABEL",{class:!0,"data-svelte-h":!0}),Y(R)!=="svelte-46c3r0"&&(R.textContent=W),C=y(J),x=c(J,"SELECT",{class:!0});var de=p(x);for(let Ie=0;Ie<w.length;Ie+=1)w[Ie].l(de);de.forEach(h),J.forEach(h),D=y(k),I=c(k,"DIV",{});var ue=p(I);O=c(ue,"LABEL",{class:!0,"data-svelte-h":!0}),Y(O)!=="svelte-s8zdl9"&&(O.textContent=T),oe=y(ue),$=c(ue,"DIV",{class:!0});var M=p($);V=c(M,"DIV",{class:!0});var ke=p(V);N=c(ke,"INPUT",{type:!0,placeholder:!0,class:!0}),me=y(ke),q=c(ke,"INPUT",{type:!0,placeholder:!0,class:!0}),ae=y(ke),X=c(ke,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(X)!=="svelte-k3v1qt"&&(X.textContent=ge),ke.forEach(h),fe=y(M),H&&H.l(M),M.forEach(h),ue.forEach(h),U=y(k),te=c(k,"DIV",{class:!0});var Z=p(te);_e=c(Z,"BUTTON",{class:!0});var we=p(_e);F=ne(we,le),we.forEach(h),z=y(Z),j=c(Z,"BUTTON",{class:!0});var Ne=p(j);ie=ne(Ne,B),Ne.forEach(h),Z.forEach(h),k.forEach(h),pe=y(L),P=c(L,"DIV",{class:!0});var Pe=p(P);S&&S.l(Pe),Q=y(Pe),K&&K.l(Pe),Pe.forEach(h),L.forEach(h),this.h()},h(){f(r,"class","text-lg font-semibold"),f(o,"class","block text-sm font-medium text-gray-300 mb-2"),f(d,"class","w-full px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),a[9]===void 0&&et(()=>a[41].call(d)),f(R,"class","block text-sm font-medium text-gray-300 mb-2"),f(x,"class","w-full px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none"),a[10]===void 0&&et(()=>a[42].call(x)),f(O,"class","block text-sm font-medium text-gray-300 mb-2"),f(N,"type","text"),f(N,"placeholder","Key"),f(N,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none text-sm"),f(q,"type","text"),f(q,"placeholder","Value"),f(q,"class","flex-1 px-3 py-2 bg-gray-800/50 border border-gray-600/50 rounded-lg focus:border-blue-500 focus:outline-none text-sm"),f(X,"class","px-3 py-2 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 transition-colors text-sm"),f(V,"class","flex space-x-2"),f($,"class","space-y-2"),_e.disabled=a[8],f(_e,"class","w-full py-2 bg-yellow-600/20 border border-yellow-500/30 rounded-lg hover:bg-yellow-600/30 disabled:opacity-50 transition-colors"),j.disabled=a[8],f(j,"class","w-full py-2 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 disabled:opacity-50 transition-colors"),f(te,"class","space-y-2"),f(t,"class","w-96 border-r border-blue-500/20 bg-black/20 backdrop-blur-sm p-4 space-y-4"),f(P,"class","flex-1 p-6 space-y-6 overflow-y-auto"),f(e,"class","flex h-full")},m(b,L){ve(b,e,L),l(e,t),l(t,r),l(t,n),l(t,s),l(s,o),l(s,_),l(s,d);for(let k=0;k<G.length;k+=1)G[k]&&G[k].m(d,null);Xe(d,a[9],!0),l(t,m),l(t,E),l(E,R),l(E,C),l(E,x);for(let k=0;k<w.length;k+=1)w[k]&&w[k].m(x,null);Xe(x,a[10],!0),l(t,D),l(t,I),l(I,O),l(I,oe),l(I,$),l($,V),l(V,N),Se(N,a[12]),l(V,me),l(V,q),Se(q,a[13]),l(V,ae),l(V,X),l($,fe),H&&H.m($,null),l(t,U),l(t,te),l(te,_e),l(_e,F),l(te,z),l(te,j),l(j,ie),l(e,pe),l(e,P),S&&S.m(P,null),l(P,Q),K&&K.m(P,null),se=!0,xe||(ee=[Ee(d,"change",a[41]),Ee(x,"change",a[42]),Ee(N,"input",a[43]),Ee(q,"input",a[44]),Ee(X,"click",a[24]),Ee(_e,"click",a[20]),Ee(j,"click",a[21])],xe=!0)},p(b,L){if(L[0]&65536){ce=Te(b[16]);let k;for(k=0;k<ce.length;k+=1){const he=nt(b,ce,k);G[k]?G[k].p(he,L):(G[k]=_t(he),G[k].c(),G[k].m(d,null))}for(;k<G.length;k+=1)G[k].d(1);G.length=ce.length}if(L[0]&66048&&Xe(d,b[9]),L[0]&131072){be=Te(b[17]);let k;for(k=0;k<be.length;k+=1){const he=rt(b,be,k);w[k]?w[k].p(he,L):(w[k]=pt(he),w[k].c(),w[k].m(x,null))}for(;k<w.length;k+=1)w[k].d(1);w.length=be.length}L[0]&132096&&Xe(x,b[10]),L[0]&4096&&N.value!==b[12]&&Se(N,b[12]),L[0]&8192&&q.value!==b[13]&&Se(q,b[13]),L[0]&2048&&(A=Object.keys(b[11]).length>0),A?H?H.p(b,L):(H=bt(b),H.c(),H.m($,null)):H&&(H.d(1),H=null),(!se||L[0]&256)&&le!==(le=b[8]?"Running...":"Dry Run Test")&&ye(F,le),(!se||L[0]&256)&&(_e.disabled=b[8]),(!se||L[0]&256)&&B!==(B=b[8]?"Testing...":"Test Access")&&ye(ie,B),(!se||L[0]&256)&&(j.disabled=b[8]),b[6]?S?(S.p(b,L),L[0]&64&&Ce(S,1)):(S=gt(b),S.c(),Ce(S,1),S.m(P,Q)):S&&(ze(),De(S,1,1,()=>{S=null}),We()),b[7]?K?(K.p(b,L),L[0]&128&&Ce(K,1)):(K=kt(b),K.c(),Ce(K,1),K.m(P,null)):K&&(ze(),De(K,1,1,()=>{K=null}),We())},i(b){se||(Ce(S),Ce(K),se=!0)},o(b){De(S),De(K),se=!1},d(b){b&&h(e),He(G,b),He(w,b),H&&H.d(),S&&S.d(),K&&K.d(),xe=!1,Ke(ee)}}}function Jt(a){let e,t,r,u,n,s="Policy Editor",o,v,_,d,m,E,R="Export",W,C,x,D,I,O="Import",T,oe,$,V,N,me,q,ae=a[8]?"Validating...":"Validate",X,ge,fe,A,U,te,_e=a[8]?"Loading...":"Load Policy",le,F,z,j,B,ie,pe,P,Q,se="Templates",xe,ee,ce,G='<div class="font-medium">Restrictive</div> <div class="text-gray-400 text-xs">High security</div>',be,w,H='<div class="font-medium">Development</div> <div class="text-gray-400 text-xs">Permissive</div>',S,K,b='<div class="font-medium">Balanced</div> <div class="text-gray-400 text-xs">Security + usability</div>',L,k,he,Ve;d=new Yt({props:{class:"w-4 h-4"}}),x=new zt({props:{class:"w-4 h-4"}}),N=new Ht({props:{class:"w-4 h-4"}}),A=new Ge({props:{class:"w-4 h-4"}});let J=a[5]&&It(a);return{c(){e=i("div"),t=i("div"),r=i("div"),u=i("div"),n=i("h3"),n.textContent=s,o=g(),v=i("div"),_=i("button"),Ue(d.$$.fragment),m=g(),E=i("span"),E.textContent=R,W=g(),C=i("label"),Ue(x.$$.fragment),D=g(),I=i("span"),I.textContent=O,T=g(),oe=i("input"),$=g(),V=i("button"),Ue(N.$$.fragment),me=g(),q=i("span"),X=re(ae),ge=g(),fe=i("button"),Ue(A.$$.fragment),U=g(),te=i("span"),le=re(_e),z=g(),j=i("div"),B=i("textarea"),ie=g(),pe=i("div"),P=i("div"),Q=i("h4"),Q.textContent=se,xe=g(),ee=i("div"),ce=i("button"),ce.innerHTML=G,be=g(),w=i("button"),w.innerHTML=H,S=g(),K=i("button"),K.innerHTML=b,L=g(),J&&J.c(),this.h()},l(de){e=c(de,"DIV",{class:!0});var ue=p(e);t=c(ue,"DIV",{class:!0});var M=p(t);r=c(M,"DIV",{class:!0});var ke=p(r);u=c(ke,"DIV",{class:!0});var Z=p(u);n=c(Z,"H3",{class:!0,"data-svelte-h":!0}),Y(n)!=="svelte-pto2q6"&&(n.textContent=s),o=y(Z),v=c(Z,"DIV",{class:!0});var we=p(v);_=c(we,"BUTTON",{class:!0});var Ne=p(_);je(d.$$.fragment,Ne),m=y(Ne),E=c(Ne,"SPAN",{"data-svelte-h":!0}),Y(E)!=="svelte-l90c7o"&&(E.textContent=R),Ne.forEach(h),W=y(we),C=c(we,"LABEL",{class:!0});var Pe=p(C);je(x.$$.fragment,Pe),D=y(Pe),I=c(Pe,"SPAN",{"data-svelte-h":!0}),Y(I)!=="svelte-1pfbzu3"&&(I.textContent=O),T=y(Pe),oe=c(Pe,"INPUT",{type:!0,accept:!0,class:!0}),Pe.forEach(h),$=y(we),V=c(we,"BUTTON",{class:!0});var Ie=p(V);je(N.$$.fragment,Ie),me=y(Ie),q=c(Ie,"SPAN",{});var Fe=p(q);X=ne(Fe,ae),Fe.forEach(h),Ie.forEach(h),ge=y(we),fe=c(we,"BUTTON",{class:!0});var qe=p(fe);je(A.$$.fragment,qe),U=y(qe),te=c(qe,"SPAN",{});var Ye=p(te);le=ne(Ye,_e),Ye.forEach(h),qe.forEach(h),we.forEach(h),Z.forEach(h),ke.forEach(h),z=y(M),j=c(M,"DIV",{class:!0});var Je=p(j);B=c(Je,"TEXTAREA",{placeholder:!0,class:!0}),p(B).forEach(h),Je.forEach(h),M.forEach(h),ie=y(ue),pe=c(ue,"DIV",{class:!0});var Le=p(pe);P=c(Le,"DIV",{class:!0});var Be=p(P);Q=c(Be,"H4",{class:!0,"data-svelte-h":!0}),Y(Q)!=="svelte-1tsqs1s"&&(Q.textContent=se),xe=y(Be),ee=c(Be,"DIV",{class:!0});var Ae=p(ee);ce=c(Ae,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(ce)!=="svelte-jguh2"&&(ce.innerHTML=G),be=y(Ae),w=c(Ae,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(w)!=="svelte-9ujzcp"&&(w.innerHTML=H),S=y(Ae),K=c(Ae,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(K)!=="svelte-1fgo7nm"&&(K.innerHTML=b),Ae.forEach(h),Be.forEach(h),L=y(Le),J&&J.l(Le),Le.forEach(h),ue.forEach(h),this.h()},h(){var de;f(n,"class","text-lg font-semibold"),f(_,"class","flex items-center space-x-2 px-3 py-2 bg-gray-600/20 border border-gray-500/30 rounded-lg hover:bg-gray-600/30 transition-colors text-sm"),f(oe,"type","file"),f(oe,"accept",".toml,.txt"),f(oe,"class","hidden"),f(C,"class","flex items-center space-x-2 px-3 py-2 bg-gray-600/20 border border-gray-500/30 rounded-lg hover:bg-gray-600/30 transition-colors text-sm cursor-pointer"),V.disabled=a[8],f(V,"class","flex items-center space-x-2 px-3 py-2 bg-yellow-600/20 border border-yellow-500/30 rounded-lg hover:bg-yellow-600/30 disabled:opacity-50 transition-colors text-sm"),fe.disabled=F=a[8]||!((de=a[5])!=null&&de.valid),f(fe,"class","flex items-center space-x-2 px-3 py-2 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 disabled:opacity-50 transition-colors text-sm"),f(v,"class","flex items-center space-x-2"),f(u,"class","flex items-center justify-between"),f(r,"class","border-b border-blue-500/20 p-4"),f(B,"placeholder","Enter your TOML policy configuration here..."),f(B,"class","w-full h-full bg-gray-900/50 border border-gray-600/50 rounded-lg p-4 font-mono text-sm focus:border-blue-500 focus:outline-none resize-none"),f(j,"class","flex-1 p-4"),f(t,"class","flex-1 flex flex-col"),f(Q,"class","font-medium mb-3"),f(ce,"class","w-full p-3 bg-red-600/20 border border-red-500/30 rounded-lg hover:bg-red-600/30 transition-colors text-left text-sm"),f(w,"class","w-full p-3 bg-green-600/20 border border-green-500/30 rounded-lg hover:bg-green-600/30 transition-colors text-left text-sm"),f(K,"class","w-full p-3 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 transition-colors text-left text-sm"),f(ee,"class","space-y-2"),f(P,"class","border-b border-blue-500/20 p-4"),f(pe,"class","w-80 border-l border-blue-500/20 bg-black/20 backdrop-blur-sm"),f(e,"class","flex h-full")},m(de,ue){ve(de,e,ue),l(e,t),l(t,r),l(r,u),l(u,n),l(u,o),l(u,v),l(v,_),Oe(d,_,null),l(_,m),l(_,E),l(v,W),l(v,C),Oe(x,C,null),l(C,D),l(C,I),l(C,T),l(C,oe),l(v,$),l(v,V),Oe(N,V,null),l(V,me),l(V,q),l(q,X),l(v,ge),l(v,fe),Oe(A,fe,null),l(fe,U),l(fe,te),l(te,le),l(t,z),l(t,j),l(j,B),Se(B,a[4]),l(e,ie),l(e,pe),l(pe,P),l(P,Q),l(P,xe),l(P,ee),l(ee,ce),l(ee,be),l(ee,w),l(ee,S),l(ee,K),l(pe,L),J&&J.m(pe,null),k=!0,he||(Ve=[Ee(_,"click",a[28]),Ee(oe,"change",a[29]),Ee(V,"click",a[18]),Ee(fe,"click",a[19]),Ee(B,"input",a[37]),Ee(ce,"click",a[38]),Ee(w,"click",a[39]),Ee(K,"click",a[40])],he=!0)},p(de,ue){var M;(!k||ue[0]&256)&&ae!==(ae=de[8]?"Validating...":"Validate")&&ye(X,ae),(!k||ue[0]&256)&&(V.disabled=de[8]),(!k||ue[0]&256)&&_e!==(_e=de[8]?"Loading...":"Load Policy")&&ye(le,_e),(!k||ue[0]&288&&F!==(F=de[8]||!((M=de[5])!=null&&M.valid)))&&(fe.disabled=F),ue[0]&16&&Se(B,de[4]),de[5]?J?(J.p(de,ue),ue[0]&32&&Ce(J,1)):(J=It(de),J.c(),Ce(J,1),J.m(pe,null)):J&&(ze(),De(J,1,1,()=>{J=null}),We())},i(de){k||(Ce(d.$$.fragment,de),Ce(x.$$.fragment,de),Ce(N.$$.fragment,de),Ce(A.$$.fragment,de),Ce(J),k=!0)},o(de){De(d.$$.fragment,de),De(x.$$.fragment,de),De(N.$$.fragment,de),De(A.$$.fragment,de),De(J),k=!1},d(de){de&&h(e),Re(d),Re(x),Re(N),Re(A),J&&J.d(),he=!1,Ke(Ve)}}}function Kt(a){let e,t,r,u,n="Quick Actions",s,o,v,_,d,m,E="Restrictive Policy",R,W,C="High security, minimal permissions",x,D,I,O,T,oe="Development Policy",$,V,N="Permissive for development",me,q,ae,X,ge,fe="Balanced Policy",A,U,te="Security with usability",_e,le,F,z="Policy Engine Features",j,B,ie,pe,P="Resources",Q,se,xe,ee,ce,G="Actions",be,w,H,S,K="...and more",b,L,k,he=a[3]&&St(a);_=new Ot({props:{class:"w-6 h-6 text-red-400 mb-2"}}),I=new Mt({props:{class:"w-6 h-6 text-green-400 mb-2"}}),ae=new Ft({props:{class:"w-6 h-6 text-blue-400 mb-2"}});let Ve=Te(a[16]),J=[];for(let M=0;M<Ve.length;M+=1)J[M]=Ut(ct(a,Ve,M));let de=Te(a[17].slice(0,10)),ue=[];for(let M=0;M<de.length;M+=1)ue[M]=jt(it(a,de,M));return{c(){e=i("div"),he&&he.c(),t=g(),r=i("div"),u=i("h3"),u.textContent=n,s=g(),o=i("div"),v=i("button"),Ue(_.$$.fragment),d=g(),m=i("div"),m.textContent=E,R=g(),W=i("div"),W.textContent=C,x=g(),D=i("button"),Ue(I.$$.fragment),O=g(),T=i("div"),T.textContent=oe,$=g(),V=i("div"),V.textContent=N,me=g(),q=i("button"),Ue(ae.$$.fragment),X=g(),ge=i("div"),ge.textContent=fe,A=g(),U=i("div"),U.textContent=te,_e=g(),le=i("div"),F=i("h3"),F.textContent=z,j=g(),B=i("div"),ie=i("div"),pe=i("h4"),pe.textContent=P,Q=g(),se=i("div");for(let M=0;M<J.length;M+=1)J[M].c();xe=g(),ee=i("div"),ce=i("h4"),ce.textContent=G,be=g(),w=i("div");for(let M=0;M<ue.length;M+=1)ue[M].c();H=g(),S=i("div"),S.textContent=K,this.h()},l(M){e=c(M,"DIV",{class:!0});var ke=p(e);he&&he.l(ke),t=y(ke),r=c(ke,"DIV",{class:!0});var Z=p(r);u=c(Z,"H3",{class:!0,"data-svelte-h":!0}),Y(u)!=="svelte-11279rj"&&(u.textContent=n),s=y(Z),o=c(Z,"DIV",{class:!0});var we=p(o);v=c(we,"BUTTON",{class:!0});var Ne=p(v);je(_.$$.fragment,Ne),d=y(Ne),m=c(Ne,"DIV",{class:!0,"data-svelte-h":!0}),Y(m)!=="svelte-1h95xb4"&&(m.textContent=E),R=y(Ne),W=c(Ne,"DIV",{class:!0,"data-svelte-h":!0}),Y(W)!=="svelte-11owj1w"&&(W.textContent=C),Ne.forEach(h),x=y(we),D=c(we,"BUTTON",{class:!0});var Pe=p(D);je(I.$$.fragment,Pe),O=y(Pe),T=c(Pe,"DIV",{class:!0,"data-svelte-h":!0}),Y(T)!=="svelte-3ypag7"&&(T.textContent=oe),$=y(Pe),V=c(Pe,"DIV",{class:!0,"data-svelte-h":!0}),Y(V)!=="svelte-jrxx14"&&(V.textContent=N),Pe.forEach(h),me=y(we),q=c(we,"BUTTON",{class:!0});var Ie=p(q);je(ae.$$.fragment,Ie),X=y(Ie),ge=c(Ie,"DIV",{class:!0,"data-svelte-h":!0}),Y(ge)!=="svelte-6lfjow"&&(ge.textContent=fe),A=y(Ie),U=c(Ie,"DIV",{class:!0,"data-svelte-h":!0}),Y(U)!=="svelte-zo1ja1"&&(U.textContent=te),Ie.forEach(h),we.forEach(h),Z.forEach(h),_e=y(ke),le=c(ke,"DIV",{class:!0});var Fe=p(le);F=c(Fe,"H3",{class:!0,"data-svelte-h":!0}),Y(F)!=="svelte-1xuy9hs"&&(F.textContent=z),j=y(Fe),B=c(Fe,"DIV",{class:!0});var qe=p(B);ie=c(qe,"DIV",{});var Ye=p(ie);pe=c(Ye,"H4",{class:!0,"data-svelte-h":!0}),Y(pe)!=="svelte-1xhxn0h"&&(pe.textContent=P),Q=y(Ye),se=c(Ye,"DIV",{class:!0});var Je=p(se);for(let Ae=0;Ae<J.length;Ae+=1)J[Ae].l(Je);Je.forEach(h),Ye.forEach(h),xe=y(qe),ee=c(qe,"DIV",{});var Le=p(ee);ce=c(Le,"H4",{class:!0,"data-svelte-h":!0}),Y(ce)!=="svelte-1jj0e1k"&&(ce.textContent=G),be=y(Le),w=c(Le,"DIV",{class:!0});var Be=p(w);for(let Ae=0;Ae<ue.length;Ae+=1)ue[Ae].l(Be);H=y(Be),S=c(Be,"DIV",{class:!0,"data-svelte-h":!0}),Y(S)!=="svelte-wugh2n"&&(S.textContent=K),Be.forEach(h),Le.forEach(h),qe.forEach(h),Fe.forEach(h),ke.forEach(h),this.h()},h(){f(u,"class","text-lg font-semibold mb-4"),f(m,"class","font-medium"),f(W,"class","text-sm text-gray-400"),f(v,"class","p-4 bg-red-600/20 border border-red-500/30 rounded-lg hover:bg-red-600/30 transition-colors text-left"),f(T,"class","font-medium"),f(V,"class","text-sm text-gray-400"),f(D,"class","p-4 bg-green-600/20 border border-green-500/30 rounded-lg hover:bg-green-600/30 transition-colors text-left"),f(ge,"class","font-medium"),f(U,"class","text-sm text-gray-400"),f(q,"class","p-4 bg-blue-600/20 border border-blue-500/30 rounded-lg hover:bg-blue-600/30 transition-colors text-left"),f(o,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"),f(r,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-6"),f(F,"class","text-lg font-semibold mb-4"),f(pe,"class","font-medium text-blue-300 mb-2"),f(se,"class","space-y-1 text-sm text-gray-300"),f(ce,"class","font-medium text-cyan-300 mb-2"),f(S,"class","text-gray-400"),f(w,"class","space-y-1 text-sm text-gray-300"),f(B,"class","grid grid-cols-1 md:grid-cols-2 gap-6"),f(le,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-6"),f(e,"class","p-6 space-y-6")},m(M,ke){ve(M,e,ke),he&&he.m(e,null),l(e,t),l(e,r),l(r,u),l(r,s),l(r,o),l(o,v),Oe(_,v,null),l(v,d),l(v,m),l(v,R),l(v,W),l(o,x),l(o,D),Oe(I,D,null),l(D,O),l(D,T),l(D,$),l(D,V),l(o,me),l(o,q),Oe(ae,q,null),l(q,X),l(q,ge),l(q,A),l(q,U),l(e,_e),l(e,le),l(le,F),l(le,j),l(le,B),l(B,ie),l(ie,pe),l(ie,Q),l(ie,se);for(let Z=0;Z<J.length;Z+=1)J[Z]&&J[Z].m(se,null);l(B,xe),l(B,ee),l(ee,ce),l(ee,be),l(ee,w);for(let Z=0;Z<ue.length;Z+=1)ue[Z]&&ue[Z].m(w,null);l(w,H),l(w,S),b=!0,L||(k=[Ee(v,"click",a[34]),Ee(D,"click",a[35]),Ee(q,"click",a[36])],L=!0)},p(M,ke){if(M[3]?he?he.p(M,ke):(he=St(M),he.c(),he.m(e,t)):he&&(he.d(1),he=null),ke[0]&65536){Ve=Te(M[16]);let Z;for(Z=0;Z<Ve.length;Z+=1){const we=ct(M,Ve,Z);J[Z]?J[Z].p(we,ke):(J[Z]=Ut(we),J[Z].c(),J[Z].m(se,null))}for(;Z<J.length;Z+=1)J[Z].d(1);J.length=Ve.length}if(ke[0]&131072){de=Te(M[17].slice(0,10));let Z;for(Z=0;Z<de.length;Z+=1){const we=it(M,de,Z);ue[Z]?ue[Z].p(we,ke):(ue[Z]=jt(we),ue[Z].c(),ue[Z].m(w,H))}for(;Z<ue.length;Z+=1)ue[Z].d(1);ue.length=de.length}},i(M){b||(Ce(_.$$.fragment,M),Ce(I.$$.fragment,M),Ce(ae.$$.fragment,M),b=!0)},o(M){De(_.$$.fragment,M),De(I.$$.fragment,M),De(ae.$$.fragment,M),b=!1},d(M){M&&h(e),he&&he.d(),Re(_),Re(I),Re(ae),He(J,M),He(ue,M),L=!1,Ke(k)}}}function vt(a){let e,t,r="Active Context:",u,n=Te(Object.entries(a[15])),s=[];for(let o=0;o<n.length;o+=1)s[o]=ht(tt(a,n,o));return{c(){e=i("div"),t=i("div"),t.textContent=r,u=g();for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=c(o,"DIV",{class:!0});var v=p(e);t=c(v,"DIV",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-15e1g6q"&&(t.textContent=r),u=y(v);for(let _=0;_<s.length;_+=1)s[_].l(v);v.forEach(h),this.h()},h(){f(t,"class","text-sm font-medium text-gray-300"),f(e,"class","space-y-2")},m(o,v){ve(o,e,v),l(e,t),l(e,u);for(let _=0;_<s.length;_+=1)s[_]&&s[_].m(e,null)},p(o,v){if(v[0]&32768){n=Te(Object.entries(o[15]));let _;for(_=0;_<n.length;_+=1){const d=tt(o,n,_);s[_]?s[_].p(d,v):(s[_]=ht(d),s[_].c(),s[_].m(e,null))}for(;_<s.length;_+=1)s[_].d(1);s.length=n.length}},d(o){o&&h(e),He(s,o)}}}function ht(a){let e,t,r=a[64]+"",u,n,s=a[65]+"",o,v;return{c(){e=i("div"),t=i("span"),u=re(r),n=re(" = "),o=re(s),v=g(),this.h()},l(_){e=c(_,"DIV",{class:!0});var d=p(e);t=c(d,"SPAN",{class:!0});var m=p(t);u=ne(m,r),n=ne(m," = "),o=ne(m,s),m.forEach(h),v=y(d),d.forEach(h),this.h()},h(){f(t,"class","font-mono"),f(e,"class","flex items-center justify-between bg-gray-800/30 p-2 rounded text-sm")},m(_,d){ve(_,e,d),l(e,t),l(t,u),l(t,n),l(t,o),l(e,v)},p(_,d){d[0]&32768&&r!==(r=_[64]+"")&&ye(u,r),d[0]&32768&&s!==(s=_[65]+"")&&ye(o,s)},d(_){_&&h(e)}}}function _t(a){let e,t=a[54]+"",r;return{c(){e=i("option"),r=re(t),this.h()},l(u){e=c(u,"OPTION",{});var n=p(e);r=ne(n,t),n.forEach(h),this.h()},h(){e.__value=a[54],Se(e,e.__value)},m(u,n){ve(u,e,n),l(e,r)},p:Qe,d(u){u&&h(e)}}}function pt(a){let e,t=a[51]+"",r;return{c(){e=i("option"),r=re(t),this.h()},l(u){e=c(u,"OPTION",{});var n=p(e);r=ne(n,t),n.forEach(h),this.h()},h(){e.__value=a[51],Se(e,e.__value)},m(u,n){ve(u,e,n),l(e,r)},p:Qe,d(u){u&&h(e)}}}function bt(a){let e,t=Te(Object.entries(a[11])),r=[];for(let u=0;u<t.length;u+=1)r[u]=mt(st(a,t,u));return{c(){e=i("div");for(let u=0;u<r.length;u+=1)r[u].c();this.h()},l(u){e=c(u,"DIV",{class:!0});var n=p(e);for(let s=0;s<r.length;s+=1)r[s].l(n);n.forEach(h),this.h()},h(){f(e,"class","space-y-1")},m(u,n){ve(u,e,n);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(e,null)},p(u,n){if(n[0]&33556480){t=Te(Object.entries(u[11]));let s;for(s=0;s<t.length;s+=1){const o=st(u,t,s);r[s]?r[s].p(o,n):(r[s]=mt(o),r[s].c(),r[s].m(e,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=t.length}},d(u){u&&h(e),He(r,u)}}}function mt(a){let e,t,r=a[64]+"",u,n,s=a[65]+"",o,v,_,d="✕",m,E,R;function W(){return a[45](a[64])}return{c(){e=i("div"),t=i("span"),u=re(r),n=re(" = "),o=re(s),v=g(),_=i("button"),_.textContent=d,m=g(),this.h()},l(C){e=c(C,"DIV",{class:!0});var x=p(e);t=c(x,"SPAN",{class:!0});var D=p(t);u=ne(D,r),n=ne(D," = "),o=ne(D,s),D.forEach(h),v=y(x),_=c(x,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(_)!=="svelte-1xs48ac"&&(_.textContent=d),m=y(x),x.forEach(h),this.h()},h(){f(t,"class","font-mono"),f(_,"class","text-red-400 hover:text-red-300"),f(e,"class","flex items-center justify-between bg-gray-800/30 p-2 rounded text-sm")},m(C,x){ve(C,e,x),l(e,t),l(t,u),l(t,n),l(t,o),l(e,v),l(e,_),l(e,m),E||(R=Ee(_,"click",W),E=!0)},p(C,x){a=C,x[0]&2048&&r!==(r=a[64]+"")&&ye(u,r),x[0]&2048&&s!==(s=a[65]+"")&&ye(o,s)},d(C){C&&h(e),E=!1,R()}}}function gt(a){let e,t,r="Dry Run Results",u,n,s,o,v,_,d,m,E,R="Evaluated Rules:",W,C,x=a[6].evaluated_rules+"",D,I,O,T,oe="Requires Justification:",$,V,N=a[6].decision.requires_justification?"Yes":"No",me,q,ae,X,ge="Mask Preview:",fe,A,U=a[6].decision.mask_preview?"Yes":"No",te,_e,le,F,z="Quarantine File:",j,B,ie=a[6].decision.quarantine_file?"Yes":"No",pe,P,Q,se;const xe=[Gt,Xt],ee=[];function ce(w,H){return w[6].decision.allowed?0:1}o=ce(a),v=ee[o]=xe[o](a);let G=a[6].decision.warning_message&&yt(a),be=a[6].warnings.length>0&&xt(a);return{c(){e=i("div"),t=i("h4"),t.textContent=r,u=g(),n=i("div"),s=i("div"),v.c(),_=g(),d=i("div"),m=i("div"),E=i("span"),E.textContent=R,W=g(),C=i("span"),D=re(x),I=g(),O=i("div"),T=i("span"),T.textContent=oe,$=g(),V=i("span"),me=re(N),q=g(),ae=i("div"),X=i("span"),X.textContent=ge,fe=g(),A=i("span"),te=re(U),_e=g(),le=i("div"),F=i("span"),F.textContent=z,j=g(),B=i("span"),pe=re(ie),P=g(),G&&G.c(),Q=g(),be&&be.c(),this.h()},l(w){e=c(w,"DIV",{class:!0});var H=p(e);t=c(H,"H4",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-1k79t4b"&&(t.textContent=r),u=y(H),n=c(H,"DIV",{class:!0});var S=p(n);s=c(S,"DIV",{class:!0});var K=p(s);v.l(K),K.forEach(h),_=y(S),d=c(S,"DIV",{class:!0});var b=p(d);m=c(b,"DIV",{});var L=p(m);E=c(L,"SPAN",{class:!0,"data-svelte-h":!0}),Y(E)!=="svelte-193k7sl"&&(E.textContent=R),W=y(L),C=c(L,"SPAN",{class:!0});var k=p(C);D=ne(k,x),k.forEach(h),L.forEach(h),I=y(b),O=c(b,"DIV",{});var he=p(O);T=c(he,"SPAN",{class:!0,"data-svelte-h":!0}),Y(T)!=="svelte-a7bxpp"&&(T.textContent=oe),$=y(he),V=c(he,"SPAN",{class:!0});var Ve=p(V);me=ne(Ve,N),Ve.forEach(h),he.forEach(h),q=y(b),ae=c(b,"DIV",{});var J=p(ae);X=c(J,"SPAN",{class:!0,"data-svelte-h":!0}),Y(X)!=="svelte-h1g6of"&&(X.textContent=ge),fe=y(J),A=c(J,"SPAN",{class:!0});var de=p(A);te=ne(de,U),de.forEach(h),J.forEach(h),_e=y(b),le=c(b,"DIV",{});var ue=p(le);F=c(ue,"SPAN",{class:!0,"data-svelte-h":!0}),Y(F)!=="svelte-4z2vfl"&&(F.textContent=z),j=y(ue),B=c(ue,"SPAN",{class:!0});var M=p(B);pe=ne(M,ie),M.forEach(h),ue.forEach(h),b.forEach(h),P=y(S),G&&G.l(S),Q=y(S),be&&be.l(S),S.forEach(h),H.forEach(h),this.h()},h(){f(t,"class","font-medium text-yellow-300 mb-3"),f(s,"class","flex items-center space-x-2"),f(E,"class","text-gray-400"),f(C,"class","text-white ml-2"),f(T,"class","text-gray-400"),f(V,"class","text-white ml-2"),f(X,"class","text-gray-400"),f(A,"class","text-white ml-2"),f(F,"class","text-gray-400"),f(B,"class","text-white ml-2"),f(d,"class","grid grid-cols-2 gap-4 text-sm"),f(n,"class","space-y-3"),f(e,"class","bg-black/40 backdrop-blur-sm border border-yellow-500/30 rounded-lg p-4")},m(w,H){ve(w,e,H),l(e,t),l(e,u),l(e,n),l(n,s),ee[o].m(s,null),l(n,_),l(n,d),l(d,m),l(m,E),l(m,W),l(m,C),l(C,D),l(d,I),l(d,O),l(O,T),l(O,$),l(O,V),l(V,me),l(d,q),l(d,ae),l(ae,X),l(ae,fe),l(ae,A),l(A,te),l(d,_e),l(d,le),l(le,F),l(le,j),l(le,B),l(B,pe),l(n,P),G&&G.m(n,null),l(n,Q),be&&be.m(n,null),se=!0},p(w,H){let S=o;o=ce(w),o!==S&&(ze(),De(ee[S],1,1,()=>{ee[S]=null}),We(),v=ee[o],v||(v=ee[o]=xe[o](w),v.c()),Ce(v,1),v.m(s,null)),(!se||H[0]&64)&&x!==(x=w[6].evaluated_rules+"")&&ye(D,x),(!se||H[0]&64)&&N!==(N=w[6].decision.requires_justification?"Yes":"No")&&ye(me,N),(!se||H[0]&64)&&U!==(U=w[6].decision.mask_preview?"Yes":"No")&&ye(te,U),(!se||H[0]&64)&&ie!==(ie=w[6].decision.quarantine_file?"Yes":"No")&&ye(pe,ie),w[6].decision.warning_message?G?G.p(w,H):(G=yt(w),G.c(),G.m(n,Q)):G&&(G.d(1),G=null),w[6].warnings.length>0?be?be.p(w,H):(be=xt(w),be.c(),be.m(n,null)):be&&(be.d(1),be=null)},i(w){se||(Ce(v),se=!0)},o(w){De(v),se=!1},d(w){w&&h(e),ee[o].d(),G&&G.d(),be&&be.d()}}}function Xt(a){let e,t,r,u="Access Denied",n;return e=new Ze({props:{class:"w-5 h-5 text-red-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){je(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),Y(r)!=="svelte-1y0llmf"&&(r.textContent=u),this.h()},h(){f(r,"class","text-red-300")},m(s,o){Oe(e,s,o),ve(s,t,o),ve(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Re(e,s)}}}function Gt(a){let e,t,r,u="Access Allowed",n;return e=new Ge({props:{class:"w-5 h-5 text-green-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){je(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),Y(r)!=="svelte-fs36s8"&&(r.textContent=u),this.h()},h(){f(r,"class","text-green-300")},m(s,o){Oe(e,s,o),ve(s,t,o),ve(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Re(e,s)}}}function yt(a){let e,t,r=a[6].decision.warning_message+"",u;return{c(){e=i("div"),t=i("div"),u=re(r),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);t=c(s,"DIV",{class:!0});var o=p(t);u=ne(o,r),o.forEach(h),s.forEach(h),this.h()},h(){f(t,"class","text-sm text-yellow-200"),f(e,"class","bg-yellow-600/20 border border-yellow-500/30 p-3 rounded")},m(n,s){ve(n,e,s),l(e,t),l(t,u)},p(n,s){s[0]&64&&r!==(r=n[6].decision.warning_message+"")&&ye(u,r)},d(n){n&&h(e)}}}function xt(a){let e,t,r="Warnings:",u,n,s=Te(a[6].warnings),o=[];for(let v=0;v<s.length;v+=1)o[v]=Ct(lt(a,s,v));return{c(){e=i("div"),t=i("div"),t.textContent=r,u=g(),n=i("div");for(let v=0;v<o.length;v+=1)o[v].c();this.h()},l(v){e=c(v,"DIV",{});var _=p(e);t=c(_,"DIV",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-93q19v"&&(t.textContent=r),u=y(_),n=c(_,"DIV",{class:!0});var d=p(n);for(let m=0;m<o.length;m+=1)o[m].l(d);d.forEach(h),_.forEach(h),this.h()},h(){f(t,"class","text-sm font-medium text-yellow-300 mb-2"),f(n,"class","space-y-1")},m(v,_){ve(v,e,_),l(e,t),l(e,u),l(e,n);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(v,_){if(_[0]&64){s=Te(v[6].warnings);let d;for(d=0;d<s.length;d+=1){const m=lt(v,s,d);o[d]?o[d].p(m,_):(o[d]=Ct(m),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(v){v&&h(e),He(o,v)}}}function Ct(a){let e,t=a[57]+"",r,u;return{c(){e=i("div"),r=re(t),u=g(),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);r=ne(s,t),u=y(s),s.forEach(h),this.h()},h(){f(e,"class","text-xs text-yellow-200 bg-yellow-600/20 p-2 rounded")},m(n,s){ve(n,e,s),l(e,r),l(e,u)},p(n,s){s[0]&64&&t!==(t=n[57]+"")&&ye(r,t)},d(n){n&&h(e)}}}function kt(a){let e,t,r="Access Test Results",u,n,s,o,v,_,d,m,E,R="Requires Justification:",W,C,x=a[7].requires_justification?"Yes":"No",D,I,O,T,oe="Audit Required:",$,V,N=a[7].audit_required?"Yes":"No",me,q,ae,X,ge="Mask Preview:",fe,A,U=a[7].mask_preview?"Yes":"No",te,_e,le,F,z="Quarantine File:",j,B,ie=a[7].quarantine_file?"Yes":"No",pe,P,Q,se,xe,ee;const ce=[$t,Zt],G=[];function be(b,L){return b[7].allowed?0:1}o=be(a),v=G[o]=ce[o](a);let w=a[7].auto_clear_clipboard_ms&&wt(a),H=a[7].time_limit_ms&&Et(a),S=a[7].warning_message&&Dt(a),K=a[7].policy_rule_id&&Vt(a);return{c(){e=i("div"),t=i("h4"),t.textContent=r,u=g(),n=i("div"),s=i("div"),v.c(),_=g(),d=i("div"),m=i("div"),E=i("span"),E.textContent=R,W=g(),C=i("span"),D=re(x),I=g(),O=i("div"),T=i("span"),T.textContent=oe,$=g(),V=i("span"),me=re(N),q=g(),ae=i("div"),X=i("span"),X.textContent=ge,fe=g(),A=i("span"),te=re(U),_e=g(),le=i("div"),F=i("span"),F.textContent=z,j=g(),B=i("span"),pe=re(ie),P=g(),w&&w.c(),Q=g(),H&&H.c(),se=g(),S&&S.c(),xe=g(),K&&K.c(),this.h()},l(b){e=c(b,"DIV",{class:!0});var L=p(e);t=c(L,"H4",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-2achcp"&&(t.textContent=r),u=y(L),n=c(L,"DIV",{class:!0});var k=p(n);s=c(k,"DIV",{class:!0});var he=p(s);v.l(he),he.forEach(h),_=y(k),d=c(k,"DIV",{class:!0});var Ve=p(d);m=c(Ve,"DIV",{});var J=p(m);E=c(J,"SPAN",{class:!0,"data-svelte-h":!0}),Y(E)!=="svelte-a7bxpp"&&(E.textContent=R),W=y(J),C=c(J,"SPAN",{class:!0});var de=p(C);D=ne(de,x),de.forEach(h),J.forEach(h),I=y(Ve),O=c(Ve,"DIV",{});var ue=p(O);T=c(ue,"SPAN",{class:!0,"data-svelte-h":!0}),Y(T)!=="svelte-wc001f"&&(T.textContent=oe),$=y(ue),V=c(ue,"SPAN",{class:!0});var M=p(V);me=ne(M,N),M.forEach(h),ue.forEach(h),q=y(Ve),ae=c(Ve,"DIV",{});var ke=p(ae);X=c(ke,"SPAN",{class:!0,"data-svelte-h":!0}),Y(X)!=="svelte-h1g6of"&&(X.textContent=ge),fe=y(ke),A=c(ke,"SPAN",{class:!0});var Z=p(A);te=ne(Z,U),Z.forEach(h),ke.forEach(h),_e=y(Ve),le=c(Ve,"DIV",{});var we=p(le);F=c(we,"SPAN",{class:!0,"data-svelte-h":!0}),Y(F)!=="svelte-4z2vfl"&&(F.textContent=z),j=y(we),B=c(we,"SPAN",{class:!0});var Ne=p(B);pe=ne(Ne,ie),Ne.forEach(h),we.forEach(h),Ve.forEach(h),P=y(k),w&&w.l(k),Q=y(k),H&&H.l(k),se=y(k),S&&S.l(k),xe=y(k),K&&K.l(k),k.forEach(h),L.forEach(h),this.h()},h(){f(t,"class","font-medium text-blue-300 mb-3"),f(s,"class","flex items-center space-x-2"),f(E,"class","text-gray-400"),f(C,"class","text-white ml-2"),f(T,"class","text-gray-400"),f(V,"class","text-white ml-2"),f(X,"class","text-gray-400"),f(A,"class","text-white ml-2"),f(F,"class","text-gray-400"),f(B,"class","text-white ml-2"),f(d,"class","grid grid-cols-2 gap-4 text-sm"),f(n,"class","space-y-3"),f(e,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-4")},m(b,L){ve(b,e,L),l(e,t),l(e,u),l(e,n),l(n,s),G[o].m(s,null),l(n,_),l(n,d),l(d,m),l(m,E),l(m,W),l(m,C),l(C,D),l(d,I),l(d,O),l(O,T),l(O,$),l(O,V),l(V,me),l(d,q),l(d,ae),l(ae,X),l(ae,fe),l(ae,A),l(A,te),l(d,_e),l(d,le),l(le,F),l(le,j),l(le,B),l(B,pe),l(n,P),w&&w.m(n,null),l(n,Q),H&&H.m(n,null),l(n,se),S&&S.m(n,null),l(n,xe),K&&K.m(n,null),ee=!0},p(b,L){let k=o;o=be(b),o!==k&&(ze(),De(G[k],1,1,()=>{G[k]=null}),We(),v=G[o],v||(v=G[o]=ce[o](b),v.c()),Ce(v,1),v.m(s,null)),(!ee||L[0]&128)&&x!==(x=b[7].requires_justification?"Yes":"No")&&ye(D,x),(!ee||L[0]&128)&&N!==(N=b[7].audit_required?"Yes":"No")&&ye(me,N),(!ee||L[0]&128)&&U!==(U=b[7].mask_preview?"Yes":"No")&&ye(te,U),(!ee||L[0]&128)&&ie!==(ie=b[7].quarantine_file?"Yes":"No")&&ye(pe,ie),b[7].auto_clear_clipboard_ms?w?w.p(b,L):(w=wt(b),w.c(),w.m(n,Q)):w&&(w.d(1),w=null),b[7].time_limit_ms?H?H.p(b,L):(H=Et(b),H.c(),H.m(n,se)):H&&(H.d(1),H=null),b[7].warning_message?S?S.p(b,L):(S=Dt(b),S.c(),S.m(n,xe)):S&&(S.d(1),S=null),b[7].policy_rule_id?K?K.p(b,L):(K=Vt(b),K.c(),K.m(n,null)):K&&(K.d(1),K=null)},i(b){ee||(Ce(v),ee=!0)},o(b){De(v),ee=!1},d(b){b&&h(e),G[o].d(),w&&w.d(),H&&H.d(),S&&S.d(),K&&K.d()}}}function Zt(a){let e,t,r,u="Access Denied",n;return e=new Ze({props:{class:"w-5 h-5 text-red-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){je(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),Y(r)!=="svelte-1y0llmf"&&(r.textContent=u),this.h()},h(){f(r,"class","text-red-300")},m(s,o){Oe(e,s,o),ve(s,t,o),ve(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Re(e,s)}}}function $t(a){let e,t,r,u="Access Allowed",n;return e=new Ge({props:{class:"w-5 h-5 text-green-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){je(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),Y(r)!=="svelte-fs36s8"&&(r.textContent=u),this.h()},h(){f(r,"class","text-green-300")},m(s,o){Oe(e,s,o),ve(s,t,o),ve(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Re(e,s)}}}function wt(a){let e,t,r="Auto-clear Clipboard:",u,n,s=a[7].auto_clear_clipboard_ms/1e3+"",o,v;return{c(){e=i("div"),t=i("span"),t.textContent=r,u=g(),n=i("span"),o=re(s),v=re("s"),this.h()},l(_){e=c(_,"DIV",{class:!0});var d=p(e);t=c(d,"SPAN",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-2c4ku2"&&(t.textContent=r),u=y(d),n=c(d,"SPAN",{class:!0});var m=p(n);o=ne(m,s),v=ne(m,"s"),m.forEach(h),d.forEach(h),this.h()},h(){f(t,"class","text-gray-400"),f(n,"class","text-white ml-2"),f(e,"class","text-sm")},m(_,d){ve(_,e,d),l(e,t),l(e,u),l(e,n),l(n,o),l(n,v)},p(_,d){d[0]&128&&s!==(s=_[7].auto_clear_clipboard_ms/1e3+"")&&ye(o,s)},d(_){_&&h(e)}}}function Et(a){let e,t,r="Time Limit:",u,n,s=a[7].time_limit_ms/1e3+"",o,v;return{c(){e=i("div"),t=i("span"),t.textContent=r,u=g(),n=i("span"),o=re(s),v=re("s"),this.h()},l(_){e=c(_,"DIV",{class:!0});var d=p(e);t=c(d,"SPAN",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-k8s06h"&&(t.textContent=r),u=y(d),n=c(d,"SPAN",{class:!0});var m=p(n);o=ne(m,s),v=ne(m,"s"),m.forEach(h),d.forEach(h),this.h()},h(){f(t,"class","text-gray-400"),f(n,"class","text-white ml-2"),f(e,"class","text-sm")},m(_,d){ve(_,e,d),l(e,t),l(e,u),l(e,n),l(n,o),l(n,v)},p(_,d){d[0]&128&&s!==(s=_[7].time_limit_ms/1e3+"")&&ye(o,s)},d(_){_&&h(e)}}}function Dt(a){let e,t,r=a[7].warning_message+"",u;return{c(){e=i("div"),t=i("div"),u=re(r),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);t=c(s,"DIV",{class:!0});var o=p(t);u=ne(o,r),o.forEach(h),s.forEach(h),this.h()},h(){f(t,"class","text-sm text-yellow-200"),f(e,"class","bg-yellow-600/20 border border-yellow-500/30 p-3 rounded")},m(n,s){ve(n,e,s),l(e,t),l(t,u)},p(n,s){s[0]&128&&r!==(r=n[7].warning_message+"")&&ye(u,r)},d(n){n&&h(e)}}}function Vt(a){let e,t,r="Matched Rule:",u,n,s=a[7].policy_rule_id+"",o;return{c(){e=i("div"),t=i("span"),t.textContent=r,u=g(),n=i("span"),o=re(s),this.h()},l(v){e=c(v,"DIV",{class:!0});var _=p(e);t=c(_,"SPAN",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-2f9b35"&&(t.textContent=r),u=y(_),n=c(_,"SPAN",{class:!0});var d=p(n);o=ne(d,s),d.forEach(h),_.forEach(h),this.h()},h(){f(t,"class","text-gray-400"),f(n,"class","text-white ml-2 font-mono"),f(e,"class","text-sm")},m(v,_){ve(v,e,_),l(e,t),l(e,u),l(e,n),l(n,o)},p(v,_){_[0]&128&&s!==(s=v[7].policy_rule_id+"")&&ye(o,s)},d(v){v&&h(e)}}}function It(a){let e,t,r="Validation Results",u,n,s,o,v,_,d,m;const E=[tl,el],R=[];function W(D,I){return D[5].valid?0:1}o=W(a),v=R[o]=E[o](a);let C=a[5].errors.length>0&&Pt(a),x=a[5].warnings.length>0&&Nt(a);return{c(){e=i("div"),t=i("h4"),t.textContent=r,u=g(),n=i("div"),s=i("div"),v.c(),_=g(),C&&C.c(),d=g(),x&&x.c(),this.h()},l(D){e=c(D,"DIV",{class:!0});var I=p(e);t=c(I,"H4",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-1ddqk88"&&(t.textContent=r),u=y(I),n=c(I,"DIV",{class:!0});var O=p(n);s=c(O,"DIV",{class:!0});var T=p(s);v.l(T),T.forEach(h),_=y(O),C&&C.l(O),d=y(O),x&&x.l(O),O.forEach(h),I.forEach(h),this.h()},h(){f(t,"class","font-medium mb-3"),f(s,"class","flex items-center space-x-2"),f(n,"class","space-y-3"),f(e,"class","p-4")},m(D,I){ve(D,e,I),l(e,t),l(e,u),l(e,n),l(n,s),R[o].m(s,null),l(n,_),C&&C.m(n,null),l(n,d),x&&x.m(n,null),m=!0},p(D,I){let O=o;o=W(D),o!==O&&(ze(),De(R[O],1,1,()=>{R[O]=null}),We(),v=R[o],v||(v=R[o]=E[o](D),v.c()),Ce(v,1),v.m(s,null)),D[5].errors.length>0?C?C.p(D,I):(C=Pt(D),C.c(),C.m(n,d)):C&&(C.d(1),C=null),D[5].warnings.length>0?x?x.p(D,I):(x=Nt(D),x.c(),x.m(n,null)):x&&(x.d(1),x=null)},i(D){m||(Ce(v),m=!0)},o(D){De(v),m=!1},d(D){D&&h(e),R[o].d(),C&&C.d(),x&&x.d()}}}function el(a){let e,t,r,u="Invalid Policy",n;return e=new Ze({props:{class:"w-5 h-5 text-red-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){je(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),Y(r)!=="svelte-1l5d5pf"&&(r.textContent=u),this.h()},h(){f(r,"class","text-red-300")},m(s,o){Oe(e,s,o),ve(s,t,o),ve(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Re(e,s)}}}function tl(a){let e,t,r,u="Valid Policy",n;return e=new Ge({props:{class:"w-5 h-5 text-green-400"}}),{c(){Ue(e.$$.fragment),t=g(),r=i("span"),r.textContent=u,this.h()},l(s){je(e.$$.fragment,s),t=y(s),r=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),Y(r)!=="svelte-yompue"&&(r.textContent=u),this.h()},h(){f(r,"class","text-green-300")},m(s,o){Oe(e,s,o),ve(s,t,o),ve(s,r,o),n=!0},i(s){n||(Ce(e.$$.fragment,s),n=!0)},o(s){De(e.$$.fragment,s),n=!1},d(s){s&&(h(t),h(r)),Re(e,s)}}}function Pt(a){let e,t,r="Errors:",u,n,s=Te(a[5].errors),o=[];for(let v=0;v<s.length;v+=1)o[v]=Tt(at(a,s,v));return{c(){e=i("div"),t=i("div"),t.textContent=r,u=g(),n=i("div");for(let v=0;v<o.length;v+=1)o[v].c();this.h()},l(v){e=c(v,"DIV",{});var _=p(e);t=c(_,"DIV",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-60o2ai"&&(t.textContent=r),u=y(_),n=c(_,"DIV",{class:!0});var d=p(n);for(let m=0;m<o.length;m+=1)o[m].l(d);d.forEach(h),_.forEach(h),this.h()},h(){f(t,"class","text-sm font-medium text-red-300 mb-2"),f(n,"class","space-y-1")},m(v,_){ve(v,e,_),l(e,t),l(e,u),l(e,n);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(v,_){if(_[0]&32){s=Te(v[5].errors);let d;for(d=0;d<s.length;d+=1){const m=at(v,s,d);o[d]?o[d].p(m,_):(o[d]=Tt(m),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(v){v&&h(e),He(o,v)}}}function Tt(a){let e,t=a[1]+"",r,u;return{c(){e=i("div"),r=re(t),u=g(),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);r=ne(s,t),u=y(s),s.forEach(h),this.h()},h(){f(e,"class","text-xs text-red-200 bg-red-600/20 p-2 rounded border border-red-500/30")},m(n,s){ve(n,e,s),l(e,r),l(e,u)},p(n,s){s[0]&32&&t!==(t=n[1]+"")&&ye(r,t)},d(n){n&&h(e)}}}function Nt(a){let e,t,r="Warnings:",u,n,s=Te(a[5].warnings),o=[];for(let v=0;v<s.length;v+=1)o[v]=At(ot(a,s,v));return{c(){e=i("div"),t=i("div"),t.textContent=r,u=g(),n=i("div");for(let v=0;v<o.length;v+=1)o[v].c();this.h()},l(v){e=c(v,"DIV",{});var _=p(e);t=c(_,"DIV",{class:!0,"data-svelte-h":!0}),Y(t)!=="svelte-93q19v"&&(t.textContent=r),u=y(_),n=c(_,"DIV",{class:!0});var d=p(n);for(let m=0;m<o.length;m+=1)o[m].l(d);d.forEach(h),_.forEach(h),this.h()},h(){f(t,"class","text-sm font-medium text-yellow-300 mb-2"),f(n,"class","space-y-1")},m(v,_){ve(v,e,_),l(e,t),l(e,u),l(e,n);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(n,null)},p(v,_){if(_[0]&32){s=Te(v[5].warnings);let d;for(d=0;d<s.length;d+=1){const m=ot(v,s,d);o[d]?o[d].p(m,_):(o[d]=At(m),o[d].c(),o[d].m(n,null))}for(;d<o.length;d+=1)o[d].d(1);o.length=s.length}},d(v){v&&h(e),He(o,v)}}}function At(a){let e,t=a[57]+"",r,u;return{c(){e=i("div"),r=re(t),u=g(),this.h()},l(n){e=c(n,"DIV",{class:!0});var s=p(e);r=ne(s,t),u=y(s),s.forEach(h),this.h()},h(){f(e,"class","text-xs text-yellow-200 bg-yellow-600/20 p-2 rounded border border-yellow-500/30")},m(n,s){ve(n,e,s),l(e,r),l(e,u)},p(n,s){s[0]&32&&t!==(t=n[57]+"")&&ye(r,t)},d(n){n&&h(e)}}}function St(a){let e,t,r,u,n,s,o,v,_="Policy Status",d,m,E=a[3].has_policy?"Active":"Inactive",R,W,C,x,D=a[3].total_rules+"",I,O,T,oe="Active Rules",$,V,N,me,q=a[3].version+"",ae,X,ge,fe="Policy Version";return{c(){e=i("div"),t=i("div"),r=i("div"),u=i("div"),s=g(),o=i("div"),v=i("div"),v.textContent=_,d=g(),m=i("div"),R=re(E),W=g(),C=i("div"),x=i("div"),I=re(D),O=g(),T=i("div"),T.textContent=oe,$=g(),V=i("div"),N=i("div"),me=re("v"),ae=re(q),X=g(),ge=i("div"),ge.textContent=fe,this.h()},l(A){e=c(A,"DIV",{class:!0});var U=p(e);t=c(U,"DIV",{class:!0});var te=p(t);r=c(te,"DIV",{class:!0});var _e=p(r);u=c(_e,"DIV",{class:!0}),p(u).forEach(h),s=y(_e),o=c(_e,"DIV",{});var le=p(o);v=c(le,"DIV",{class:!0,"data-svelte-h":!0}),Y(v)!=="svelte-xvg4d"&&(v.textContent=_),d=y(le),m=c(le,"DIV",{class:!0});var F=p(m);R=ne(F,E),F.forEach(h),le.forEach(h),_e.forEach(h),te.forEach(h),W=y(U),C=c(U,"DIV",{class:!0});var z=p(C);x=c(z,"DIV",{class:!0});var j=p(x);I=ne(j,D),j.forEach(h),O=y(z),T=c(z,"DIV",{class:!0,"data-svelte-h":!0}),Y(T)!=="svelte-p6pn2w"&&(T.textContent=oe),z.forEach(h),$=y(U),V=c(U,"DIV",{class:!0});var B=p(V);N=c(B,"DIV",{class:!0});var ie=p(N);me=ne(ie,"v"),ae=ne(ie,q),ie.forEach(h),X=y(B),ge=c(B,"DIV",{class:!0,"data-svelte-h":!0}),Y(ge)!=="svelte-a0ejuh"&&(ge.textContent=fe),B.forEach(h),U.forEach(h),this.h()},h(){f(u,"class",n="w-3 h-3 rounded-full "+(a[3].has_policy?"bg-green-400":"bg-red-400")),f(v,"class","text-lg font-semibold"),f(m,"class","text-sm text-gray-400"),f(r,"class","flex items-center space-x-3"),f(t,"class","bg-black/40 backdrop-blur-sm border border-blue-500/30 rounded-lg p-4"),f(x,"class","text-2xl font-bold text-cyan-400"),f(T,"class","text-sm text-gray-400"),f(C,"class","bg-black/40 backdrop-blur-sm border border-cyan-500/30 rounded-lg p-4"),f(N,"class","text-2xl font-bold text-purple-400"),f(ge,"class","text-sm text-gray-400"),f(V,"class","bg-black/40 backdrop-blur-sm border border-purple-500/30 rounded-lg p-4"),f(e,"class","grid grid-cols-1 md:grid-cols-3 gap-4")},m(A,U){ve(A,e,U),l(e,t),l(t,r),l(r,u),l(r,s),l(r,o),l(o,v),l(o,d),l(o,m),l(m,R),l(e,W),l(e,C),l(C,x),l(x,I),l(C,O),l(C,T),l(e,$),l(e,V),l(V,N),l(N,me),l(N,ae),l(V,X),l(V,ge)},p(A,U){U[0]&8&&n!==(n="w-3 h-3 rounded-full "+(A[3].has_policy?"bg-green-400":"bg-red-400"))&&f(u,"class",n),U[0]&8&&E!==(E=A[3].has_policy?"Active":"Inactive")&&ye(R,E),U[0]&8&&D!==(D=A[3].total_rules+"")&&ye(I,D),U[0]&8&&q!==(q=A[3].version+"")&&ye(ae,q)},d(A){A&&h(e)}}}function Ut(a){let e,t,r=a[54]+"",u;return{c(){e=i("div"),t=re("• "),u=re(r)},l(n){e=c(n,"DIV",{});var s=p(e);t=ne(s,"• "),u=ne(s,r),s.forEach(h)},m(n,s){ve(n,e,s),l(e,t),l(e,u)},p:Qe,d(n){n&&h(e)}}}function jt(a){let e,t,r=a[51]+"",u;return{c(){e=i("div"),t=re("• "),u=re(r)},l(n){e=c(n,"DIV",{});var s=p(e);t=ne(s,"• "),u=ne(s,r),s.forEach(h)},m(n,s){ve(n,e,s),l(e,t),l(e,u)},p:Qe,d(n){n&&h(e)}}}function ll(a){let e,t,r,u,n,s,o,v='<h1 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent">Security &amp; Policy</h1> <p class="text-sm text-gray-400">Policy Engine Management &amp; Testing</p>',_,d,m,E,R,W,C,x,D,I,O,T,oe,$,V,N,me,q,ae,X,ge,fe,A,U,te,_e,le;n=new Ot({props:{class:"w-8 h-8 text-blue-400"}});let F=a[3]&&dt(a),z=a[1]&&ut(a),j=a[0]&&ft(a);const B=[Kt,Jt,Qt,Wt],ie=[];function pe(P,Q){return P[2]==="overview"?0:P[2]==="editor"?1:P[2]==="tester"?2:P[2]==="context"?3:-1}return~(A=pe(a))&&(U=ie[A]=B[A](a)),{c(){e=i("div"),t=i("div"),r=i("div"),u=i("div"),Ue(n.$$.fragment),s=g(),o=i("div"),o.innerHTML=v,_=g(),F&&F.c(),d=g(),m=i("div"),E=i("button"),R=re("Overview"),C=g(),x=i("button"),D=re("Policy Editor"),O=g(),T=i("button"),oe=re("Policy Tester"),V=g(),N=i("button"),me=re("Context Manager"),ae=g(),z&&z.c(),X=g(),j&&j.c(),ge=g(),fe=i("div"),U&&U.c(),this.h()},l(P){e=c(P,"DIV",{class:!0});var Q=p(e);t=c(Q,"DIV",{class:!0});var se=p(t);r=c(se,"DIV",{class:!0});var xe=p(r);u=c(xe,"DIV",{class:!0});var ee=p(u);je(n.$$.fragment,ee),s=y(ee),o=c(ee,"DIV",{"data-svelte-h":!0}),Y(o)!=="svelte-ni6yo7"&&(o.innerHTML=v),ee.forEach(h),_=y(xe),F&&F.l(xe),xe.forEach(h),d=y(se),m=c(se,"DIV",{class:!0});var ce=p(m);E=c(ce,"BUTTON",{class:!0});var G=p(E);R=ne(G,"Overview"),G.forEach(h),C=y(ce),x=c(ce,"BUTTON",{class:!0});var be=p(x);D=ne(be,"Policy Editor"),be.forEach(h),O=y(ce),T=c(ce,"BUTTON",{class:!0});var w=p(T);oe=ne(w,"Policy Tester"),w.forEach(h),V=y(ce),N=c(ce,"BUTTON",{class:!0});var H=p(N);me=ne(H,"Context Manager"),H.forEach(h),ce.forEach(h),se.forEach(h),ae=y(Q),z&&z.l(Q),X=y(Q),j&&j.l(Q),ge=y(Q),fe=c(Q,"DIV",{class:!0});var S=p(fe);U&&U.l(S),S.forEach(h),Q.forEach(h),this.h()},h(){f(u,"class","flex items-center space-x-3"),f(r,"class","flex items-center justify-between p-4"),f(E,"class",W="px-4 py-2 rounded-lg transition-colors "+(a[2]==="overview"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")),f(x,"class",I="px-4 py-2 rounded-lg transition-colors "+(a[2]==="editor"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")),f(T,"class",$="px-4 py-2 rounded-lg transition-colors "+(a[2]==="tester"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")),f(N,"class",q="px-4 py-2 rounded-lg transition-colors "+(a[2]==="context"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")),f(m,"class","flex space-x-1 px-4 pb-4"),f(t,"class","border-b border-blue-500/30 bg-black/20 backdrop-blur-sm"),f(fe,"class","flex-1 overflow-hidden"),f(e,"class","h-full bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 text-white overflow-hidden")},m(P,Q){ve(P,e,Q),l(e,t),l(t,r),l(r,u),Oe(n,u,null),l(u,s),l(u,o),l(r,_),F&&F.m(r,null),l(t,d),l(t,m),l(m,E),l(E,R),l(m,C),l(m,x),l(x,D),l(m,O),l(m,T),l(T,oe),l(m,V),l(m,N),l(N,me),l(e,ae),z&&z.m(e,null),l(e,X),j&&j.m(e,null),l(e,ge),l(e,fe),~A&&ie[A].m(fe,null),te=!0,_e||(le=[Ee(E,"click",a[30]),Ee(x,"click",a[31]),Ee(T,"click",a[32]),Ee(N,"click",a[33])],_e=!0)},p(P,Q){P[3]?F?F.p(P,Q):(F=dt(P),F.c(),F.m(r,null)):F&&(F.d(1),F=null),(!te||Q[0]&4&&W!==(W="px-4 py-2 rounded-lg transition-colors "+(P[2]==="overview"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")))&&f(E,"class",W),(!te||Q[0]&4&&I!==(I="px-4 py-2 rounded-lg transition-colors "+(P[2]==="editor"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")))&&f(x,"class",I),(!te||Q[0]&4&&$!==($="px-4 py-2 rounded-lg transition-colors "+(P[2]==="tester"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")))&&f(T,"class",$),(!te||Q[0]&4&&q!==(q="px-4 py-2 rounded-lg transition-colors "+(P[2]==="context"?"bg-blue-600/30 text-blue-300 border border-blue-500/30":"hover:bg-gray-700/30")))&&f(N,"class",q),P[1]?z?z.p(P,Q):(z=ut(P),z.c(),z.m(e,X)):z&&(z.d(1),z=null),P[0]?j?j.p(P,Q):(j=ft(P),j.c(),j.m(e,ge)):j&&(j.d(1),j=null);let se=A;A=pe(P),A===se?~A&&ie[A].p(P,Q):(U&&(ze(),De(ie[se],1,1,()=>{ie[se]=null}),We()),~A?(U=ie[A],U?U.p(P,Q):(U=ie[A]=B[A](P),U.c()),Ce(U,1),U.m(fe,null)):U=null)},i(P){te||(Ce(n.$$.fragment,P),Ce(U),te=!0)},o(P){De(n.$$.fragment,P),De(U),te=!1},d(P){P&&h(e),Re(n),F&&F.d(),z&&z.d(),j&&j.d(),~A&&ie[A].d(),_e=!1,Ke(le)}}}function sl(a,e,t){let r="overview",u=null,n="",s=null,o=null,v=null,_=!1,d="",m="",E="Terminal",R="Read",W={},C="",x="",D="current_user",I={};const O=["Terminal","Ssh","Vault","Vpn","Browser","Files","Clipboard","Network","Theme","Settings","Logs","Policy"],T=["Read","Write","Exec","Connect","Download","Upload","Autofill","Copy","Paste","Delete","Create","Update","Export","Import","Switch","Apply","Reload","Query","Browse","Search"],oe={restrictive:`# Restrictive Security Policy
# Denies most operations by default, requires explicit allow rules

version = 1
name = "Restrictive Policy"
description = "High security policy with minimal permissions"

[defaults]
effect = "Deny"
require_justification = true
audit_all = true
auto_clear_clipboard_ms = 30000
mask_preview = true
quarantine_downloads = true

[[rules]]
id = "allow-basic-terminal"
resource = "Terminal"
action = "Read"
effect = "Allow"
conditions = { user_role = "user" }

[[rules]]
id = "allow-settings-read"
resource = "Settings"
action = "Read"
effect = "Allow"

[[rules]]
id = "deny-sensitive-operations"
resource = ["Vault", "Ssh", "Files"]
action = ["Write", "Delete", "Export"]
effect = "Deny"
warning_message = "Sensitive operations require admin approval"`,development:`# Development Policy
# More permissive for development environments

version = 1
name = "Development Policy"
description = "Permissive policy for development use"

[defaults]
effect = "Allow"
require_justification = false
audit_all = false
auto_clear_clipboard_ms = 300000
mask_preview = false
quarantine_downloads = false

[[rules]]
id = "allow-all-terminal"
resource = "Terminal"
action = "*"
effect = "Allow"

[[rules]]
id = "allow-vault-read"
resource = "Vault"
action = ["Read", "Create", "Update"]
effect = "Allow"
conditions = { pq_available = true }

[[rules]]
id = "restrict-policy-changes"
resource = "Policy"
action = ["Update", "Delete"]
effect = "Deny"
require_justification = true
warning_message = "Policy changes require careful review"`,balanced:`# Balanced Security Policy
# Reasonable security with usability

version = 1
name = "Balanced Policy"
description = "Balanced security and usability"

[defaults]
effect = "Allow"
require_justification = false
audit_all = true
auto_clear_clipboard_ms = 120000
mask_preview = true
quarantine_downloads = true

[[rules]]
id = "allow-standard-operations"
resource = ["Terminal", "Settings", "Theme"]
action = "*"
effect = "Allow"

[[rules]]
id = "vault-with-mfa"
resource = "Vault"
action = "*"
effect = "Allow"
conditions = { mfa_verified = true }

[[rules]]
id = "sensitive-with-justification"
resource = ["Ssh", "Files", "Network"]
action = ["Write", "Delete", "Connect"]
effect = "Allow"
require_justification = true
time_limit_ms = 3600000

[[rules]]
id = "clipboard-security"
resource = "Clipboard"
action = "*"
effect = "Allow"
auto_clear_clipboard_ms = 60000
mask_preview = true`};qt(async()=>{await $(),t(4,n=oe.balanced)});async function $(){try{t(3,u=await Me("policy_get_stats"))}catch(b){console.error("Failed to load policy stats:",b)}}async function V(){if(!n.trim()){t(1,d="Policy content cannot be empty");return}t(8,_=!0),t(1,d="");try{t(5,s=await Me("policy_validate",{policyContent:n})),s.valid?t(0,m="Policy validation successful"):t(1,d="Policy validation failed")}catch(b){t(1,d=`Validation failed: ${b}`),t(5,s=null)}finally{t(8,_=!1)}}async function N(){if(!(s!=null&&s.valid)){t(1,d="Please validate the policy first");return}t(8,_=!0),t(1,d="");try{await Me("policy_load",{policyContent:n}),t(0,m="Policy loaded successfully"),await $()}catch(b){t(1,d=`Failed to load policy: ${b}`)}finally{t(8,_=!1)}}async function me(){if(!E||!R){t(1,d="Please select resource and action");return}t(8,_=!0),t(1,d="");try{t(6,o=await Me("policy_dry_run",{resource:E,action:R,context:W}))}catch(b){t(1,d=`Dry run failed: ${b}`),t(6,o=null)}finally{t(8,_=!1)}}async function q(){if(!E||!R){t(1,d="Please select resource and action");return}t(8,_=!0),t(1,d="");try{t(7,v=await Me("policy_test_access",{resource:E,action:R,context:Object.keys(W).length>0?W:null}))}catch(b){t(1,d=`Access test failed: ${b}`),t(7,v=null)}finally{t(8,_=!1)}}async function ae(){if(!D.trim()){t(1,d="User ID cannot be empty");return}try{await Me("policy_set_user",{userId:D}),t(0,m=`User context set to: ${D}`)}catch(b){t(1,d=`Failed to set user: ${b}`)}}async function X(){if(!C.trim()||!x.trim()){t(1,d="Context key and value cannot be empty");return}try{await Me("policy_update_context",{key:C,value:x}),t(15,I[C]=x,I),t(0,m=`Context updated: ${C} = ${x}`),t(12,C=""),t(13,x="")}catch(b){t(1,d=`Failed to update context: ${b}`)}}function ge(){!C.trim()||!x.trim()||(t(11,W[C]=x,W),t(11,W={...W}),t(12,C=""),t(13,x=""))}function fe(b){delete W[b],t(11,W={...W})}function A(b){t(4,n=oe[b]),t(5,s=null),t(0,m=`Loaded ${b} policy template`)}async function U(b){try{const L=await Me("policy_get_defaults",{scenario:b});t(4,n=L),t(0,m=`Loaded ${b} default policy`)}catch(L){t(1,d=`Failed to load default policy: ${L}`)}}function te(){if(!n.trim()){t(1,d="No policy content to export");return}const b=new Blob([n],{type:"text/plain"}),L=URL.createObjectURL(b),k=document.createElement("a");k.href=L,k.download="ghostshell-policy.toml",document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(L),t(0,m="Policy exported successfully")}function _e(b){var Ve;const k=(Ve=b.target.files)==null?void 0:Ve[0];if(!k)return;const he=new FileReader;he.onload=J=>{var de;t(4,n=(de=J.target)==null?void 0:de.result),t(5,s=null),t(0,m="Policy imported successfully")},he.readAsText(k)}const le=()=>t(2,r="overview"),F=()=>t(2,r="editor"),z=()=>t(2,r="tester"),j=()=>t(2,r="context"),B=()=>U("restrictive"),ie=()=>U("development"),pe=()=>A("balanced");function P(){n=this.value,t(4,n)}const Q=()=>A("restrictive"),se=()=>A("development"),xe=()=>A("balanced");function ee(){E=$e(this),t(9,E),t(16,O)}function ce(){R=$e(this),t(10,R),t(17,T)}function G(){C=this.value,t(12,C)}function be(){x=this.value,t(13,x)}const w=b=>fe(b);function H(){D=this.value,t(14,D)}function S(){C=this.value,t(12,C)}function K(){x=this.value,t(13,x)}return a.$$.update=()=>{a.$$.dirty[0]&2&&d&&setTimeout(()=>t(1,d=""),5e3),a.$$.dirty[0]&1&&m&&setTimeout(()=>t(0,m=""),5e3)},[m,d,r,u,n,s,o,v,_,E,R,W,C,x,D,I,O,T,V,N,me,q,ae,X,ge,fe,A,U,te,_e,le,F,z,j,B,ie,pe,P,Q,se,xe,ee,ce,G,be,w,H,S,K]}class ul extends Lt{constructor(e){super(),Bt(this,e,sl,ll,Rt,{},null,[-1,-1,-1])}}export{ul as default};
