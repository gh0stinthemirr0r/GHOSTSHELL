import{w as u}from"./index.445d6633.js";function m(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function i(t,r=!1){const n=m(),o=`_${n}`;return Object.defineProperty(window,o,{value:e=>(r&&Reflect.deleteProperty(window,o),t?.(e)),writable:!1,configurable:!0}),n}async function a(t,r={}){return new Promise((n,o)=>{const e=i(c=>{n(c),Reflect.deleteProperty(window,`_${s}`)},!0),s=i(c=>{o(c),Reflect.deleteProperty(window,`_${e}`)},!0);window.__TAURI_IPC__({cmd:t,callback:e,error:s,...r})})}function h(t,r="asset"){return window.__TAURI__.convertFileSrc(t,r)}const T=Object.freeze(Object.defineProperty({__proto__:null,convertFileSrc:h,invoke:a,transformCallback:i},Symbol.toStringTag,{value:"Module"})),f={themes:[],currentTheme:null,currentThemeId:null};function g(){const{subscribe:t,set:r,update:n}=u(f);return{subscribe:t,setThemes:o=>{n(e=>({...e,themes:o}))},setCurrentTheme:o=>{n(e=>({...e,currentTheme:o})),l(o.tokens)},setCurrentThemeId:o=>{n(e=>({...e,currentThemeId:o}))},applyTheme:async o=>{try{const e=await a("apply_theme",{themeId:o});return n(s=>({...s,currentTheme:e,currentThemeId:o})),l(e.tokens),e}catch(e){throw console.error("Failed to apply theme:",e),e}},saveTheme:async o=>{try{const e=await a("save_theme",{theme:o}),s=await a("list_themes");return n(c=>({...c,themes:s})),e}catch(e){throw console.error("Failed to save theme:",e),e}},exportTheme:async o=>{try{return await a("export_theme",{themeId:o})}catch(e){throw console.error("Failed to export theme:",e),e}},importTheme:async o=>{try{const e=await a("import_theme",{theme:o}),s=await a("list_themes");return n(c=>({...c,themes:s})),e}catch(e){throw console.error("Failed to import theme:",e),e}}}}function l(t){const r=document.documentElement;r.style.setProperty("--bg-tint",t.bgTint),r.style.setProperty("--fg",t.fg),r.style.setProperty("--slate",t.slate),r.style.setProperty("--accent-pink",t.accentPink),r.style.setProperty("--accent-cyan",t.accentCyan),r.style.setProperty("--accent-neon-green",t.accentNeonGreen),r.style.setProperty("--glow-strength",t.glowStrength.toString()),r.style.setProperty("--blur",`${t.blurPx}px`),r.style.setProperty("--noise",t.noiseOpacity.toString()),r.style.setProperty("--cursor-color",t.cursorColor),r.style.setProperty("--font-mono",t.monoFont),r.style.setProperty("--font-ui",t.uiFont),r.style.setProperty("--radius",`${t.radius}px`),r.style.setProperty("--border-color",t.border),w(t.bgTint)}async function w(t){const r=F(t);if(r){const[n,o,e,s]=r,c=Math.round(s*255);try{await a("set_acrylic_tint",{r:n,g:o,b:e,a:c})}catch(d){console.warn("Failed to update acrylic tint:",d)}}}function F(t){const r=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(r){const n=parseInt(r[1],10),o=parseInt(r[2],10),e=parseInt(r[3],10),s=r[4]?parseFloat(r[4]):1;return[n,o,e,s]}return null}const I=g(),P={accessibility:{reduceMotion:!1,highContrast:!1,transparency:.7},fonts:{monoFont:"JetBrainsMono Nerd Font",uiFont:"Inter",fontSize:14},terminal:{cursorStyle:"block",cursorBlink:!1,fontLigatures:!0}};function _(){const{subscribe:t,set:r,update:n}=u(P);return{subscribe:t,set:r,update:n,updateSettings:async o=>{try{await a("update_settings",{newSettings:o}),r(o),S(o)}catch(e){throw console.error("Failed to update settings:",e),e}},setAccessibility:async o=>{try{await a("set_accessibility",{reduceMotion:o.reduceMotion,highContrast:o.highContrast,transparency:o.transparency}),n(e=>({...e,accessibility:o})),y(o)}catch(e){throw console.error("Failed to update accessibility settings:",e),e}},setFonts:async o=>{try{await a("set_fonts",{monoFont:o.monoFont,uiFont:o.uiFont,fontSize:o.fontSize}),n(e=>({...e,fonts:o})),p(o)}catch(e){throw console.error("Failed to update font settings:",e),e}}}}function S(t){y(t.accessibility),p(t.fonts)}function y(t){const r=document.documentElement;t.reduceMotion?r.classList.add("reduce-motion"):r.classList.remove("reduce-motion"),t.highContrast?r.classList.add("high-contrast"):r.classList.remove("high-contrast"),r.style.setProperty("--transparency",t.transparency.toString())}function p(t){const r=document.documentElement;r.style.setProperty("--font-mono",`"${t.monoFont}", "JetBrains Mono", "Fira Code", monospace`),r.style.setProperty("--font-ui",`"${t.uiFont}", "Inter", "Segoe UI", sans-serif`),r.style.setProperty("--font-size-base",`${t.fontSize}px`),r.style.setProperty("--font-terminal",`"${t.monoFont}", "JetBrains Mono", monospace`),r.style.setProperty("--font-display",`"${t.uiFont}", "Inter", sans-serif`),console.log(`Applied fonts: mono="${t.monoFont}", ui="${t.uiFont}", size=${t.fontSize}px`)}const $=_();export{i as a,T as b,a as i,$ as s,I as t};
