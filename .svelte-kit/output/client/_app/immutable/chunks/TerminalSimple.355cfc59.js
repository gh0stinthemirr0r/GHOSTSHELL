import{s as de,F as ue,L as ge,r as We,u as Oe,v as Ve,w as ze,f as C,a as M,g as E,h as W,d as v,c as J,j as k,i as z,x as N,M as G,E as $e,N as Be,o as De,J as Le,q as te,l as oe,m as ne,n as he,O as re,y as ae,k as Q,P as ve,Q as Me,U as Je}from"./scheduler.621791d8.js";import{S as pe,i as me,b as A,d as q,m as U,a as I,t as O,e as F,g as R,c as K}from"./index.de4558f1.js";import{I as je,g as Ae,a as Ue,e as se,T as H,M as ce,C as Fe,S as Ge,X as He}from"./2.166109b7.js";import{i as le}from"./settings.f97860d3.js";import{P as qe}from"./plus.110261dd.js";function Re(o){let e;const t=o[2].default,l=We(t,o,o[3],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,n){l&&l.m(s,n),e=!0},p(s,n){l&&l.p&&(!e||n&8)&&Oe(l,t,s,s[3],e?ze(t,s[3],n,null):Ve(s[3]),null)},i(s){e||(I(l,s),e=!0)},o(s){O(l,s),e=!1},d(s){l&&l.d(s)}}}function Ke(o){let e,t;const l=[{name:"git-branch"},o[1],{iconNode:o[0]}];let s={$$slots:{default:[Re]},$$scope:{ctx:o}};for(let n=0;n<l.length;n+=1)s=ue(s,l[n]);return e=new je({props:s}),{c(){A(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,u){U(e,n,u),t=!0},p(n,[u]){const a=u&3?Ae(l,[l[0],u&2&&Ue(n[1]),u&1&&{iconNode:n[0]}]):{};u&8&&(a.$$scope={dirty:u,ctx:n}),e.$set(a)},i(n){t||(I(e.$$.fragment,n),t=!0)},o(n){O(e.$$.fragment,n),t=!1},d(n){F(e,n)}}}function Qe(o,e,t){let{$$slots:l={},$$scope:s}=e;const n=[["line",{x1:"6",x2:"6",y1:"3",y2:"15"}],["circle",{cx:"18",cy:"6",r:"3"}],["circle",{cx:"6",cy:"18",r:"3"}],["path",{d:"M18 9a9 9 0 0 1-9 9"}]];return o.$$set=u=>{t(1,e=ue(ue({},e),ge(u))),"$$scope"in u&&t(3,s=u.$$scope)},e=ge(e),[n,e,l,s]}class Xe extends pe{constructor(e){super(),me(this,e,Qe,Ke,de,{})}}const Ye=Xe;function Se(o,e,t){const l=o.slice();return l[15]=e[t],l}function Ze(o){const e=o.slice(),t=e[6]();return e[18]=t,e}function el(o){let e,t,l,s=fe(o[18])+"",n,u,a,f;var r=o[7](o[18]);function p(d,m){return{props:{size:16,class:"text-cyan-400"}}}return r&&(e=te(r,p())),a=new Fe({props:{size:14,class:"text-gray-400 ml-auto"}}),{c(){e&&A(e.$$.fragment),t=M(),l=C("span"),n=oe(s),u=M(),A(a.$$.fragment),this.h()},l(d){e&&q(e.$$.fragment,d),t=J(d),l=E(d,"SPAN",{class:!0});var m=W(l);n=ne(m,s),m.forEach(v),u=J(d),q(a.$$.fragment,d),this.h()},h(){k(l,"class","text-white truncate")},m(d,m){e&&U(e,d,m),z(d,t,m),z(d,l,m),N(l,n),z(d,u,m),U(a,d,m),f=!0},p(d,m){if(r!==(r=d[7](d[18]))){if(e){R();const b=e;O(b.$$.fragment,1,0,()=>{F(b,1)}),K()}r?(e=te(r,p()),A(e.$$.fragment),I(e.$$.fragment,1),U(e,t.parentNode,t)):e=null}},i(d){f||(e&&I(e.$$.fragment,d),I(a.$$.fragment,d),f=!0)},o(d){e&&O(e.$$.fragment,d),O(a.$$.fragment,d),f=!1},d(d){d&&(v(t),v(l),v(u)),e&&F(e,d),F(a,d)}}}function ll(o){let e,t,l,s="Loading...";return{c(){e=C("div"),t=M(),l=C("span"),l.textContent=s,this.h()},l(n){e=E(n,"DIV",{class:!0}),W(e).forEach(v),t=J(n),l=E(n,"SPAN",{class:!0,"data-svelte-h":!0}),re(l)!=="svelte-13049mz"&&(l.textContent=s),this.h()},h(){k(e,"class","animate-spin rounded-full h-4 w-4 border-b-2 border-cyan-400"),k(l,"class","text-gray-400")},m(n,u){z(n,e,u),z(n,t,u),z(n,l,u)},p:ae,i:ae,o:ae,d(n){n&&(v(e),v(t),v(l))}}}function we(o){let e,t,l,s=se(o[2]),n=[];for(let f=0;f<s.length;f+=1)n[f]=Ne(Se(o,s,f));const u=f=>O(n[f],1,1,()=>{n[f]=null});let a=o[2].length===0&&xe();return{c(){e=C("div");for(let f=0;f<n.length;f+=1)n[f].c();t=M(),a&&a.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var r=W(e);for(let p=0;p<n.length;p+=1)n[p].l(r);t=J(r),a&&a.l(r),r.forEach(v),this.h()},h(){k(e,"class","absolute top-full left-0 right-0 mt-1 bg-black/90 backdrop-blur-sm border border-gray-700/50 rounded-lg shadow-xl z-50 max-h-64 overflow-y-auto")},m(f,r){z(f,e,r);for(let p=0;p<n.length;p+=1)n[p]&&n[p].m(e,null);N(e,t),a&&a.m(e,null),l=!0},p(f,r){if(r&167){s=se(f[2]);let p;for(p=0;p<s.length;p+=1){const d=Se(f,s,p);n[p]?(n[p].p(d,r),I(n[p],1)):(n[p]=Ne(d),n[p].c(),I(n[p],1),n[p].m(e,t))}for(R(),p=s.length;p<n.length;p+=1)u(p);K()}f[2].length===0?a||(a=xe(),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i(f){if(!l){for(let r=0;r<s.length;r+=1)I(n[r]);l=!0}},o(f){n=n.filter(Boolean);for(let r=0;r<n.length;r+=1)O(n[r]);l=!1},d(f){f&&v(e),Le(n,f),a&&a.d()}}}function ke(o){let e,t="Not available";return{c(){e=C("div"),e.textContent=t,this.h()},l(l){e=E(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-16hj01e"&&(e.textContent=t),this.h()},h(){k(e,"class","text-xs text-red-400")},m(l,s){z(l,e,s)},d(l){l&&v(e)}}}function Te(o){let e;return{c(){e=C("div"),this.h()},l(t){e=E(t,"DIV",{class:!0}),W(e).forEach(v),this.h()},h(){k(e,"class","w-2 h-2 bg-cyan-400 rounded-full")},m(t,l){z(t,e,l)},d(t){t&&v(e)}}}function Ne(o){let e,t,l,s,n,u=fe(o[15])+"",a,f,r,p=JSON.stringify(o[15].shell_type)===JSON.stringify(o[1]||o[0]),d,m,b,y,w;var x=o[7](o[15]);function B(i,_){return{props:{size:16,class:"text-cyan-400 flex-shrink-0"}}}x&&(t=te(x,B()));let h=!o[15].is_available&&ke(),g=p&&Te();function c(){return o[10](o[15])}return{c(){e=C("button"),t&&A(t.$$.fragment),l=M(),s=C("div"),n=C("div"),a=oe(u),f=M(),h&&h.c(),r=M(),g&&g.c(),this.h()},l(i){e=E(i,"BUTTON",{class:!0});var _=W(e);t&&q(t.$$.fragment,_),l=J(_),s=E(_,"DIV",{class:!0});var P=W(s);n=E(P,"DIV",{class:!0});var D=W(n);a=ne(D,u),D.forEach(v),f=J(P),h&&h.l(P),P.forEach(v),r=J(_),g&&g.l(_),_.forEach(v),this.h()},h(){k(n,"class","text-sm font-medium text-white truncate"),k(s,"class","flex-1 min-w-0"),k(e,"class",d="w-full flex items-center space-x-3 px-3 py-2 hover:bg-cyan-500/10 transition-colors text-left border-b border-gray-800/30 last:border-b-0 "+(o[15].is_available?"":"opacity-50 cursor-not-allowed")),e.disabled=m=!o[15].is_available},m(i,_){z(i,e,_),t&&U(t,e,null),N(e,l),N(e,s),N(s,n),N(n,a),N(s,f),h&&h.m(s,null),N(e,r),g&&g.m(e,null),b=!0,y||(w=G(e,"click",c),y=!0)},p(i,_){if(o=i,_&4&&x!==(x=o[7](o[15]))){if(t){R();const P=t;O(P.$$.fragment,1,0,()=>{F(P,1)}),K()}x?(t=te(x,B()),A(t.$$.fragment),I(t.$$.fragment,1),U(t,e,l)):t=null}(!b||_&4)&&u!==(u=fe(o[15])+"")&&he(a,u),o[15].is_available?h&&(h.d(1),h=null):h||(h=ke(),h.c(),h.m(s,null)),_&7&&(p=JSON.stringify(o[15].shell_type)===JSON.stringify(o[1]||o[0])),p?g||(g=Te(),g.c(),g.m(e,null)):g&&(g.d(1),g=null),(!b||_&4&&d!==(d="w-full flex items-center space-x-3 px-3 py-2 hover:bg-cyan-500/10 transition-colors text-left border-b border-gray-800/30 last:border-b-0 "+(o[15].is_available?"":"opacity-50 cursor-not-allowed")))&&k(e,"class",d),(!b||_&4&&m!==(m=!o[15].is_available))&&(e.disabled=m)},i(i){b||(t&&I(t.$$.fragment,i),b=!0)},o(i){t&&O(t.$$.fragment,i),b=!1},d(i){i&&v(e),t&&F(t),h&&h.d(),g&&g.d(),y=!1,w()}}}function xe(o){let e,t="No shells available";return{c(){e=C("div"),e.textContent=t,this.h()},l(l){e=E(l,"DIV",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-1xc20tp"&&(e.textContent=t),this.h()},h(){k(e,"class","px-3 py-4 text-center text-gray-400 text-sm")},m(l,s){z(l,e,s)},d(l){l&&v(e)}}}function tl(o){let e,t,l,s,n,u,a,f;const r=[ll,el],p=[];function d(y,w){return y[3]?0:1}function m(y,w){return w===1?Ze(y):y}l=d(o),s=p[l]=r[l](m(o,l));let b=o[4]&&!o[3]&&we(o);return{c(){e=C("div"),t=C("button"),s.c(),n=M(),b&&b.c(),this.h()},l(y){e=E(y,"DIV",{class:!0});var w=W(e);t=E(w,"BUTTON",{class:!0});var x=W(t);s.l(x),x.forEach(v),n=J(w),b&&b.l(w),w.forEach(v),this.h()},h(){k(t,"class","flex items-center space-x-2 px-3 py-2 bg-black/20 border border-gray-700/50 rounded-lg hover:border-cyan-500/50 transition-colors text-sm min-w-[160px]"),t.disabled=o[3],k(e,"class","shell-selector relative svelte-1xkpzkl")},m(y,w){z(y,e,w),N(e,t),p[l].m(t,null),N(e,n),b&&b.m(e,null),u=!0,a||(f=[G(window,"click",o[8]),G(t,"click",o[9])],a=!0)},p(y,[w]){let x=l;l=d(y),l===x?p[l].p(m(y,l),w):(R(),O(p[x],1,1,()=>{p[x]=null}),K(),s=p[l],s?s.p(m(y,l),w):(s=p[l]=r[l](m(y,l)),s.c()),I(s,1),s.m(t,null)),(!u||w&8)&&(t.disabled=y[3]),y[4]&&!y[3]?b?(b.p(y,w),w&24&&I(b,1)):(b=we(y),b.c(),I(b,1),b.m(e,null)):b&&(R(),O(b,1,1,()=>{b=null}),K())},i(y){u||(I(s),I(b),u=!0)},o(y){O(s),O(b),u=!1},d(y){y&&v(e),p[l].d(),b&&b.d(),a=!1,$e(f)}}}function fe(o){return typeof o.shell_type=="object"&&o.shell_type.WSLDistro?`WSL: ${o.shell_type.WSLDistro}`:o.display_name}function sl(o,e,t){const l=Be();let{selectedShell:s=null}=e,n=null,u=[],a=null,f=!0,r=!1;const p={Nushell:H,PowerShell:H,PowerShellCore:H,Cmd:Ge,WSL:ce,WSLDistro:ce,GitBash:Ye,Custom:H};De(async()=>{await d()});async function d(){try{t(3,f=!0),t(2,u=[{shell_type:"Nushell",display_name:"Nushell (Embedded)",executable_path:"embedded",is_available:!0},{shell_type:"PowerShell",display_name:"PowerShell",executable_path:"powershell.exe",is_available:!0},{shell_type:"CommandPrompt",display_name:"Command Prompt",executable_path:"cmd.exe",is_available:!0},{shell_type:"WSL",display_name:"WSL",executable_path:"wsl.exe",is_available:!0}]),a="Nushell",s||t(0,s=a),console.log("ShellSelector: Using PowerShell Core only (hardcoded)")}catch(h){console.error("Failed to load shells:",h)}finally{t(3,f=!1)}}function m(h){console.log("ShellSelector: handleShellSelect called with:",h),console.log("ShellSelector: shell.shell_type:",h.shell_type),console.log("ShellSelector: shell.display_name:",h.display_name),t(0,s=h.shell_type),t(1,n=h.shell_type),t(4,r=!1);const g={shellType:h.shell_type,displayName:h.display_name};console.log("ShellSelector: dispatching event with data:",g),l("shell-selected",g)}function b(){const h=n||s;if(console.log("getSelectedShellInfo: Looking for shell:",h),console.log("getSelectedShellInfo: Available shells:",u),!h)return console.log("getSelectedShellInfo: No shell selected, using default"),{display_name:"Nushell (Embedded)",shell_type:"Nushell"};let g=null;if(typeof h=="string"&&(g=u.find(c=>typeof c.shell_type=="string"?c.shell_type===h:!1),!g)){const i={PowerShell:"PowerShell",PowerShellCore:"PowerShell",CommandPrompt:"Command Prompt",Cmd:"Command Prompt",WSL:"WSL",WSL2:"WSL",Nushell:"Nushell (Embedded)"}[h];i&&(g=u.find(_=>_.display_name===i))}return g||(g=u.find(c=>JSON.stringify(c.shell_type)===JSON.stringify(h))),!g&&typeof h=="string"&&h.startsWith("WSL")&&(g=u.find(c=>c.display_name&&c.display_name.includes("WSL"))),console.log("getSelectedShellInfo: Found shell:",g),g||{display_name:typeof h=="string"?h:"Nushell (Embedded)",shell_type:h}}function y(h){if(typeof h.shell_type=="string")return p[h.shell_type]||H;if(h.shell_type&&typeof h.shell_type=="object"){if(h.shell_type.WSLDistro)return ce;const g=Object.keys(h.shell_type)[0];return p[g]||H}return H}function w(h){h.target.closest(".shell-selector")||t(4,r=!1)}const x=()=>t(4,r=!r),B=h=>m(h);return o.$$set=h=>{"selectedShell"in h&&t(0,s=h.selectedShell)},o.$$.update=()=>{o.$$.dirty&1&&s&&t(0,s),o.$$.dirty&3&&s!==n&&(t(1,n=s),console.log("ShellSelector: selectedShell prop changed to:",s),console.log("ShellSelector: currentSelectedShell updated to:",n))},[s,n,u,f,r,m,b,y,w,x,B]}class ol extends pe{constructor(e){super(),me(this,e,sl,tl,de,{selectedShell:0})}}function Ce(o,e,t){const l=o.slice();return l[17]=e[t],l}function Ee(o){let e,t,l,s,n;t=new He({props:{size:12}});function u(){return o[10](o[17])}return{c(){e=C("button"),A(t.$$.fragment),this.h()},l(a){e=E(a,"BUTTON",{class:!0});var f=W(e);q(t.$$.fragment,f),f.forEach(v),this.h()},h(){k(e,"class","ml-2 text-gray-400 hover:text-pink-400 transition-colors")},m(a,f){z(a,e,f),U(t,e,null),l=!0,s||(n=G(e,"click",Je(u)),s=!0)},p(a,f){o=a},i(a){l||(I(t.$$.fragment,a),l=!0)},o(a){O(t.$$.fragment,a),l=!1},d(a){a&&v(e),F(t),s=!1,n()}}}function Ie(o){let e,t=o[17].title+"",l,s,n,u,a,f,r=o[0].length>1&&Ee(o);function p(){return o[11](o[17])}return{c(){e=C("button"),l=oe(t),s=M(),r&&r.c(),this.h()},l(d){e=E(d,"BUTTON",{class:!0});var m=W(e);l=ne(m,t),s=J(m),r&&r.l(m),m.forEach(v),this.h()},h(){k(e,"class",n="tab px-3 py-2 rounded-t-lg text-sm transition-all duration-200 relative "+(o[17].active?"bg-black/95 text-cyan-300 border-t-2 border-l-2 border-r-2 border-cyan-400 shadow-lg shadow-cyan-500/20 -mb-px":"bg-gray-800/60 text-gray-300 hover:bg-cyan-500/10 hover:text-cyan-400 border border-gray-600/50")+" svelte-veueib")},m(d,m){z(d,e,m),N(e,l),N(e,s),r&&r.m(e,null),u=!0,a||(f=G(e,"click",p),a=!0)},p(d,m){o=d,(!u||m&1)&&t!==(t=o[17].title+"")&&he(l,t),o[0].length>1?r?(r.p(o,m),m&1&&I(r,1)):(r=Ee(o),r.c(),I(r,1),r.m(e,null)):r&&(R(),O(r,1,1,()=>{r=null}),K()),(!u||m&1&&n!==(n="tab px-3 py-2 rounded-t-lg text-sm transition-all duration-200 relative "+(o[17].active?"bg-black/95 text-cyan-300 border-t-2 border-l-2 border-r-2 border-cyan-400 shadow-lg shadow-cyan-500/20 -mb-px":"bg-gray-800/60 text-gray-300 hover:bg-cyan-500/10 hover:text-cyan-400 border border-gray-600/50")+" svelte-veueib"))&&k(e,"class",n)},i(d){u||(I(r),u=!0)},o(d){O(r),u=!1},d(d){d&&v(e),r&&r.d(),a=!1,f()}}}function Pe(o){let e=(o[3].output||`◉ GHOSTSHELL TERMINAL v2.0 ◉
> System ready. Enter commands below.
> Type "help" for available commands.

`)+"",t;return{c(){t=oe(e)},l(l){t=ne(l,e)},m(l,s){z(l,t,s)},p(l,s){s&8&&e!==(e=(l[3].output||`◉ GHOSTSHELL TERMINAL v2.0 ◉
> System ready. Enter commands below.
> Type "help" for available commands.

`)+"")&&he(t,e)},d(l){l&&v(t)}}}function nl(o){let e,t,l,s,n,u,a,f,r,p,d,m,b,y,w,x,B,h="❯",g,c,i,_,P,D=se(o[0]),T=[];for(let S=0;S<D.length;S+=1)T[S]=Ie(Ce(o,D,S));const X=S=>O(T[S],1,1,()=>{T[S]=null});u=new qe({props:{size:14}}),r=new ol({props:{selectedShell:o[2],key:o[2]}}),r.$on("shell-selected",o[5]);let V=o[3]&&Pe(o);return{c(){e=C("div"),t=C("div"),l=C("div");for(let S=0;S<T.length;S+=1)T[S].c();s=M(),n=C("button"),A(u.$$.fragment),a=M(),f=C("div"),A(r.$$.fragment),p=M(),d=C("div"),m=C("div"),V&&V.c(),y=M(),w=C("div"),x=C("div"),B=C("span"),B.textContent=h,g=M(),c=C("input"),this.h()},l(S){e=E(S,"DIV",{class:!0});var $=W(e);t=E($,"DIV",{class:!0});var j=W(t);l=E(j,"DIV",{class:!0});var L=W(l);for(let ie=0;ie<T.length;ie+=1)T[ie].l(L);s=J(L),n=E(L,"BUTTON",{class:!0});var Y=W(n);q(u.$$.fragment,Y),Y.forEach(v),L.forEach(v),a=J(j),f=E(j,"DIV",{class:!0});var _e=W(f);q(r.$$.fragment,_e),_e.forEach(v),j.forEach(v),p=J($),d=E($,"DIV",{class:!0});var Z=W(d);m=E(Z,"DIV",{id:!0,class:!0,style:!0});var be=W(m);V&&V.l(be),be.forEach(v),y=J(Z),w=E(Z,"DIV",{class:!0});var ye=W(w);x=E(ye,"DIV",{class:!0});var ee=W(x);B=E(ee,"SPAN",{class:!0,"data-svelte-h":!0}),re(B)!=="svelte-1ldj7xk"&&(B.textContent=h),g=J(ee),c=E(ee,"INPUT",{type:!0,placeholder:!0,class:!0,style:!0}),ee.forEach(v),ye.forEach(v),Z.forEach(v),$.forEach(v),this.h()},h(){k(n,"class","add-tab px-2 py-2 rounded-lg bg-gray-800/60 hover:bg-cyan-500/20 text-gray-300 hover:text-cyan-400 transition-all duration-200 border border-gray-600/50"),k(l,"class","flex space-x-1 flex-1"),k(f,"class","ml-4"),k(t,"class","tab-bar flex items-center bg-gray-900/90 border-b border-cyan-500/30 px-4 py-1 backdrop-blur-sm relative z-10 svelte-veueib"),k(m,"id",b="output-"+o[1]),k(m,"class","output-area flex-1 p-4 bg-black/95 text-cyan-300 font-mono text-sm overflow-y-auto whitespace-pre-wrap border-l-2 border-r-2 border-cyan-400/50 shadow-inner shadow-cyan-500/10 min-h-0 svelte-veueib"),Q(m,"font-family","'JetBrains Mono', monospace"),Q(m,"line-height","1.5"),Q(m,"text-shadow","0 0 2px rgba(34, 211, 238, 0.3)"),Q(m,"max-height","calc(100vh - 200px)"),k(B,"class","text-pink-400 font-mono mr-2 font-bold animate-pulse"),k(c,"type","text"),k(c,"placeholder","Enter command..."),k(c,"class","flex-1 bg-transparent text-cyan-300 font-mono outline-none placeholder-gray-500"),Q(c,"font-family","'JetBrains Mono', monospace"),Q(c,"text-shadow","0 0 2px rgba(34, 211, 238, 0.3)"),k(x,"class","flex items-center"),k(w,"class","input-area flex-shrink-0 bg-gray-900/95 border-t border-l-2 border-r-2 border-b-2 border-cyan-500/30 border-l-cyan-400/50 border-r-cyan-400/50 border-b-cyan-400/50 p-4 backdrop-blur-sm svelte-veueib"),k(d,"class","terminal-output flex-1 flex flex-col relative min-h-0 svelte-veueib"),k(e,"class","terminal-container h-full flex flex-col bg-gray-900/95 backdrop-blur-sm relative svelte-veueib")},m(S,$){z(S,e,$),N(e,t),N(t,l);for(let j=0;j<T.length;j+=1)T[j]&&T[j].m(l,null);N(l,s),N(l,n),U(u,n,null),N(t,a),N(t,f),U(r,f,null),N(e,p),N(e,d),N(d,m),V&&V.m(m,null),N(d,y),N(d,w),N(w,x),N(x,B),N(x,g),N(x,c),ve(c,o[4]),i=!0,_||(P=[G(n,"click",o[6]),G(c,"input",o[12]),G(c,"keydown",o[9])],_=!0)},p(S,[$]){if($&385){D=se(S[0]);let L;for(L=0;L<D.length;L+=1){const Y=Ce(S,D,L);T[L]?(T[L].p(Y,$),I(T[L],1)):(T[L]=Ie(Y),T[L].c(),I(T[L],1),T[L].m(l,s))}for(R(),L=D.length;L<T.length;L+=1)X(L);K()}const j={};$&4&&(j.selectedShell=S[2]),$&4&&(j.key=S[2]),r.$set(j),S[3]?V?V.p(S,$):(V=Pe(S),V.c(),V.m(m,null)):V&&(V.d(1),V=null),(!i||$&2&&b!==(b="output-"+S[1]))&&k(m,"id",b),$&16&&c.value!==S[4]&&ve(c,S[4])},i(S){if(!i){for(let $=0;$<D.length;$+=1)I(T[$]);I(u.$$.fragment,S),I(r.$$.fragment,S),i=!0}},o(S){T=T.filter(Boolean);for(let $=0;$<T.length;$+=1)O(T[$]);O(u.$$.fragment,S),O(r.$$.fragment,S),i=!1},d(S){S&&v(e),Le(T,S),F(u),F(r),V&&V.d(),_=!1,$e(P)}}}function rl(o,e,t){let l,s=[{id:1,title:"Shell 1",active:!0,sessionId:null,shellType:"Nushell",output:""}],n=1,u=2,a="",f="Nushell";De(async()=>{console.log("Terminal mounted, initializing..."),await r()}),Me(()=>{console.log("Terminal component destroyed")});async function r(){const c=s.find(_=>_.id===n);if(!c)return;console.log(`Initializing tab ${c.id} with shell ${c.shellType}`);let i="";c.shellType==="Nushell"?i=`◉ Nushell ready. Enter commands below.

`:i=`◉ ${c.shellType?.replace("PowerShellCore","PowerShell Core")||"PowerShell Core"} ready. Enter commands below.

`,t(0,s=s.map(_=>_.id===c.id?{..._,output:i}:_)),console.log(`Tab ${c.id} initialized successfully`)}async function p(){if(!a.trim()||!l)return;const c=a.trim();console.log(`Executing command with ${l.shellType}: ${c}`),t(4,a=""),t(3,l.output+=`❯ ${c}
`,l),t(0,s=[...s]),w();try{let i;if(l.shellType==="Nushell")l.sessionId||(t(3,l.sessionId=await le("nushell_create_session"),l),console.log(`Created Nushell session: ${l.sessionId}`)),i=await le("nushell_execute_command",{sessionId:l.sessionId,command:c});else{let _=l.shellType||"PowerShell Core";_==="PowerShell Core"&&(_="PowerShellCore"),i=await le("simple_execute_command",{shellType:_,command:c})}i.output?t(3,l.output+=i.output,l):i.stdout&&t(3,l.output+=i.stdout,l),i.error?t(3,l.output+=`Error: ${i.error}
`,l):i.stderr&&t(3,l.output+=`Error: ${i.stderr}`,l),!i.success&&i.exit_code!==0&&t(3,l.output+=`Command exited with code: ${i.exit_code}
`,l),t(0,s=[...s]),w()}catch(i){console.error("Error executing command:",i),t(3,l.output+=`Error: ${i}
`,l),t(0,s=[...s]),w()}}async function d(c){const{shellType:i,displayName:_}=c.detail;if(console.log("Shell selected:",i,_),console.log("Shell type type:",typeof i),console.log("Shell type JSON:",JSON.stringify(i)),!l)return;let P="";if(typeof i=="string")P=i;else if(typeof i=="object"&&i!==null)if(i.WSLDistro)P=`WSL:${i.WSLDistro}`;else if(i.WSL)P="WSL";else{const D=Object.keys(i);if(D.length>0){const T=D[0],X=i[T];typeof X=="string"&&X.length>0?P=`${T}:${X}`:P=T}else console.error("Empty shell type object:",i),P="PowerShellCore"}else i==null?(console.error("Null/undefined shell type"),P="PowerShellCore"):(console.error("Invalid shell type:",i,typeof i),P="PowerShellCore");console.log("Converted shell type string:",P),P==="PowerShell Core"&&(P="PowerShellCore"),t(3,l.sessionId=null,l),t(0,s=s.map(D=>D.id===n?{...D,shellType:P,sessionId:null,output:`${D.output}◉ Switching to ${_}...
`}:D)),t(0,s=[...s]);try{await r(),l&&(t(3,l.output+=`✓ Successfully switched to ${_}

`,l),t(0,s=[...s]))}catch(D){console.error("Failed to switch shell:",D),l&&(t(3,l.output+=`✗ Failed to switch to ${_}: ${D}

`,l),t(0,s=[...s]))}}function m(){const c={id:u++,title:`Shell ${u-1}`,active:!1,sessionId:null,shellType:"PowerShellCore",output:""};t(0,s=[...s,c]),y(c.id)}async function b(c){if(s.length===1)return;const i=s.find(_=>_.id===c);if(i&&i.shellType==="Nushell"&&i.sessionId)try{await le("nushell_close_session",{sessionId:i.sessionId}),console.log(`Closed Nushell session: ${i.sessionId}`)}catch(_){console.error("Error closing Nushell session:",_)}t(0,s=s.filter(_=>_.id!==c)),n===c&&t(1,n=s[0].id)}function y(c){t(0,s=s.map(_=>({..._,active:_.id===c}))),t(1,n=c);const i=s.find(_=>_.id===c);i&&!i.sessionId&&r()}function w(){setTimeout(()=>{const c=document.getElementById(`output-${n}`);c&&(c.scrollTop=c.scrollHeight)},10)}function x(c){c.key==="Enter"&&(c.preventDefault(),p())}const B=c=>b(c.id),h=c=>y(c.id);function g(){a=this.value,t(4,a)}return o.$$.update=()=>{o.$$.dirty&3&&t(3,l=s.find(c=>c.id===n)),o.$$.dirty&12&&(t(2,f=l?.shellType||"Nushell"),console.log("TerminalSimple: currentShellType updated to:",f),console.log("TerminalSimple: activeTab.shellType:",l?.shellType))},[s,n,f,l,a,d,m,b,y,x,B,h,g]}class dl extends pe{constructor(e){super(),me(this,e,rl,nl,de,{})}}export{dl as default};
