import{s as Ut,f as i,a as x,e as We,g as c,h as b,c as D,O as de,d as r,j as u,i as X,x as t,M as Ie,J as Me,o as Rt,Q as qt,q as it,l as V,m as S,n as G,E as Ze,P as Ne,S as Qt,T as ct,X as Xe,W as Wt,U as Xt,y as Ke,k as ut}from"./scheduler.239bea07.js";import{S as Jt,i as Yt,b as Ve,d as Te,m as Se,a as ce,g as Le,c as Be,t as he,e as Pe}from"./index.83fc6ed7.js";import{l as Je,c as et,e as $e,S as Ht,k as Gt,D as Kt,m as Zt,W as el,A as tl}from"./2.f404646e.js";import{i as Oe}from"./settings.0dec3c96.js";import{l as ll}from"./event.7e3060fe.js";import{P as sl}from"./play.08ac1df5.js";import{C as ft}from"./clock.cf8ee7a8.js";import{X as al}from"./circle-x.280f56e5.js";function dt(a,e,l){const s=a.slice();return s[28]=e[l],s}function _t(a,e,l){const s=a.slice();return s[31]=e[l],s}function vt(a,e,l){const s=a.slice();return s[34]=e[l],s}function ht(a,e,l){const s=a.slice();return s[37]=e[l],s}function pt(a,e,l){const s=a.slice();return s[40]=e[l][0],s[41]=e[l][1],s}function mt(a,e,l){const s=a.slice();return s[44]=e[l],s}function bt(a){let e,l,s,n,f,o,g;s=new Ht({props:{size:12,class:"inline mr-1"}});function m(){return a[12](a[44])}return{c(){e=i("div"),l=i("button"),Ve(s.$$.fragment),n=V(`\r
                Stop`),this.h()},l(_){e=c(_,"DIV",{class:!0});var p=b(e);l=c(p,"BUTTON",{class:!0});var v=b(l);Te(s.$$.fragment,v),n=S(v,`\r
                Stop`),v.forEach(r),p.forEach(r),this.h()},h(){u(l,"class","px-2 py-1 bg-red-500/20 hover:bg-red-500/30 text-red-400 text-xs rounded transition-colors"),u(e,"class","mt-2 flex items-center space-x-2")},m(_,p){X(_,e,p),t(e,l),Se(s,l,null),t(l,n),f=!0,o||(g=Ie(l,"click",Xt(m)),o=!0)},p(_,p){a=_},i(_){f||(ce(s.$$.fragment,_),f=!0)},o(_){he(s.$$.fragment,_),f=!1},d(_){_&&r(e),Pe(s),o=!1,g()}}}function gt(a){let e,l,s,n,f,o,g=a[44].interface+"",m,_,p,v=new Date(a[44].started_at).toLocaleTimeString()+"",y,I,w,C,T,P,M=a[44].status+"",A,j,H,N,$,L=a[44].packet_count.toLocaleString()+"",z,O,B,J,R=Ae(a[44].bytes_captured)+"",re,k,h,d,E,K;var W=a[10](a[44].status);function ee(Y,Q){return{props:{class:"w-4 h-4 "+Fe(Y[44].status)}}}W&&(n=it(W,ee(a)));let U=a[44].status==="Running"&&bt(a);function F(){return a[13](a[44])}function q(...Y){return a[14](a[44],...Y)}return{c(){e=i("div"),l=i("div"),s=i("div"),n&&Ve(n.$$.fragment),f=x(),o=i("span"),m=V(g),_=x(),p=i("span"),y=V(v),I=x(),w=i("div"),C=i("div"),T=V("Status: "),P=i("span"),A=V(M),H=x(),N=i("div"),$=V("Packets: "),z=V(L),O=x(),B=i("div"),J=V("Size: "),re=V(R),k=x(),U&&U.c(),this.h()},l(Y){e=c(Y,"DIV",{class:!0,role:!0,tabindex:!0});var Q=b(e);l=c(Q,"DIV",{class:!0});var le=b(l);s=c(le,"DIV",{class:!0});var ae=b(s);n&&Te(n.$$.fragment,ae),f=D(ae),o=c(ae,"SPAN",{class:!0});var _e=b(o);m=S(_e,g),_e.forEach(r),ae.forEach(r),_=D(le),p=c(le,"SPAN",{class:!0});var ue=b(p);y=S(ue,v),ue.forEach(r),le.forEach(r),I=D(Q),w=c(Q,"DIV",{class:!0});var te=b(w);C=c(te,"DIV",{});var ie=b(C);T=S(ie,"Status: "),P=c(ie,"SPAN",{class:!0});var oe=b(P);A=S(oe,M),oe.forEach(r),ie.forEach(r),H=D(te),N=c(te,"DIV",{});var we=b(N);$=S(we,"Packets: "),z=S(we,L),we.forEach(r),O=D(te),B=c(te,"DIV",{});var pe=b(B);J=S(pe,"Size: "),re=S(pe,R),pe.forEach(r),te.forEach(r),k=D(Q),U&&U.l(Q),Q.forEach(r),this.h()},h(){u(o,"class","text-white font-medium text-sm"),u(s,"class","flex items-center space-x-2"),u(p,"class","text-xs text-gray-400"),u(l,"class","flex items-center justify-between mb-2"),u(P,"class",j=Fe(a[44].status)),u(w,"class","text-xs text-gray-400 space-y-1"),u(e,"class",h="p-3 rounded-lg border transition-all cursor-pointer "+(a[2]?.id===a[44].id?"bg-cyan-500/10 border-cyan-500/50":"bg-black/20 border-gray-700/50 hover:border-gray-600/50")),u(e,"role","button"),u(e,"tabindex","0")},m(Y,Q){X(Y,e,Q),t(e,l),t(l,s),n&&Se(n,s,null),t(s,f),t(s,o),t(o,m),t(l,_),t(l,p),t(p,y),t(e,I),t(e,w),t(w,C),t(C,T),t(C,P),t(P,A),t(w,H),t(w,N),t(N,$),t(N,z),t(w,O),t(w,B),t(B,J),t(B,re),t(e,k),U&&U.m(e,null),d=!0,E||(K=[Ie(e,"click",F),Ie(e,"keydown",q)],E=!0)},p(Y,Q){if(a=Y,Q[0]&2&&W!==(W=a[10](a[44].status))){if(n){Le();const le=n;he(le.$$.fragment,1,0,()=>{Pe(le,1)}),Be()}W?(n=it(W,ee(a)),Ve(n.$$.fragment),ce(n.$$.fragment,1),Se(n,s,f)):n=null}else if(W){const le={};Q[0]&2&&(le.class="w-4 h-4 "+Fe(a[44].status)),n.$set(le)}(!d||Q[0]&2)&&g!==(g=a[44].interface+"")&&G(m,g),(!d||Q[0]&2)&&v!==(v=new Date(a[44].started_at).toLocaleTimeString()+"")&&G(y,v),(!d||Q[0]&2)&&M!==(M=a[44].status+"")&&G(A,M),(!d||Q[0]&2&&j!==(j=Fe(a[44].status)))&&u(P,"class",j),(!d||Q[0]&2)&&L!==(L=a[44].packet_count.toLocaleString()+"")&&G(z,L),(!d||Q[0]&2)&&R!==(R=Ae(a[44].bytes_captured)+"")&&G(re,R),a[44].status==="Running"?U?(U.p(a,Q),Q[0]&2&&ce(U,1)):(U=bt(a),U.c(),ce(U,1),U.m(e,null)):U&&(Le(),he(U,1,1,()=>{U=null}),Be()),(!d||Q[0]&6&&h!==(h="p-3 rounded-lg border transition-all cursor-pointer "+(a[2]?.id===a[44].id?"bg-cyan-500/10 border-cyan-500/50":"bg-black/20 border-gray-700/50 hover:border-gray-600/50")))&&u(e,"class",h)},i(Y){d||(n&&ce(n.$$.fragment,Y),ce(U),d=!0)},o(Y){n&&he(n.$$.fragment,Y),he(U),d=!1},d(Y){Y&&r(e),n&&Pe(n),U&&U.d(),E=!1,Ze(K)}}}function yt(a){let e,l,s,n,f="No captures yet",o,g,m="Start your first packet capture",_;return l=new Je({props:{class:"w-12 h-12 mx-auto mb-4 opacity-50"}}),{c(){e=i("div"),Ve(l.$$.fragment),s=x(),n=i("p"),n.textContent=f,o=x(),g=i("p"),g.textContent=m,this.h()},l(p){e=c(p,"DIV",{class:!0});var v=b(e);Te(l.$$.fragment,v),s=D(v),n=c(v,"P",{"data-svelte-h":!0}),de(n)!=="svelte-1cvkku0"&&(n.textContent=f),o=D(v),g=c(v,"P",{class:!0,"data-svelte-h":!0}),de(g)!=="svelte-1xi932u"&&(g.textContent=m),v.forEach(r),this.h()},h(){u(g,"class","text-sm"),u(e,"class","text-center text-gray-400 py-8")},m(p,v){X(p,e,v),Se(l,e,null),t(e,s),t(e,n),t(e,o),t(e,g),_=!0},i(p){_||(ce(l.$$.fragment,p),_=!0)},o(p){he(l.$$.fragment,p),_=!1},d(p){p&&r(e),Pe(l)}}}function rl(a){let e,l,s,n,f,o="PCAP Studio",g,m,_="Select a capture to view analysis results",p,v,y="Or start a new packet capture",I;return s=new Je({props:{class:"w-16 h-16 mx-auto mb-4 opacity-50"}}),{c(){e=i("div"),l=i("div"),Ve(s.$$.fragment),n=x(),f=i("h3"),f.textContent=o,g=x(),m=i("p"),m.textContent=_,p=x(),v=i("p"),v.textContent=y,this.h()},l(w){e=c(w,"DIV",{class:!0});var C=b(e);l=c(C,"DIV",{class:!0});var T=b(l);Te(s.$$.fragment,T),n=D(T),f=c(T,"H3",{class:!0,"data-svelte-h":!0}),de(f)!=="svelte-yzsit2"&&(f.textContent=o),g=D(T),m=c(T,"P",{"data-svelte-h":!0}),de(m)!=="svelte-18jntwx"&&(m.textContent=_),p=D(T),v=c(T,"P",{class:!0,"data-svelte-h":!0}),de(v)!=="svelte-vt571r"&&(v.textContent=y),T.forEach(r),C.forEach(r),this.h()},h(){u(f,"class","text-xl font-semibold mb-2"),u(v,"class","text-sm mt-2"),u(l,"class","text-center"),u(e,"class","flex-1 flex items-center justify-center text-gray-400")},m(w,C){X(w,e,C),t(e,l),Se(s,l,null),t(l,n),t(l,f),t(l,g),t(l,m),t(l,p),t(l,v),I=!0},p:Ke,i(w){I||(ce(s.$$.fragment,w),I=!0)},o(w){he(s.$$.fragment,w),I=!1},d(w){w&&r(e),Pe(s)}}}function nl(a){let e,l,s,n,f=a[2].interface+"",o,g,m,_,p,v=new Date(a[2].started_at).toLocaleString()+"",y,I,w,C,T=a[2].status+"",P,M,A,j,H,N,$,L,z,O=a[2].completed_at&&kt(a),B=a[2].results&&Et(a);const J=[il,ol],R=[];function re(k,h){return k[2].results&&k[4]?0:1}return $=re(a),L=R[$]=J[$](a),{c(){e=i("div"),l=i("div"),s=i("div"),n=i("h3"),o=V(f),g=x(),m=i("div"),_=i("span"),p=V("Started: "),y=V(v),I=x(),O&&O.c(),w=x(),C=i("span"),P=V(T),A=x(),j=i("div"),B&&B.c(),H=x(),N=i("div"),L.c(),this.h()},l(k){e=c(k,"DIV",{class:!0});var h=b(e);l=c(h,"DIV",{class:!0});var d=b(l);s=c(d,"DIV",{});var E=b(s);n=c(E,"H3",{class:!0});var K=b(n);o=S(K,f),K.forEach(r),g=D(E),m=c(E,"DIV",{class:!0});var W=b(m);_=c(W,"SPAN",{});var ee=b(_);p=S(ee,"Started: "),y=S(ee,v),ee.forEach(r),I=D(W),O&&O.l(W),w=D(W),C=c(W,"SPAN",{class:!0});var U=b(C);P=S(U,T),U.forEach(r),W.forEach(r),E.forEach(r),A=D(d),j=c(d,"DIV",{class:!0});var F=b(j);B&&B.l(F),F.forEach(r),d.forEach(r),h.forEach(r),H=D(k),N=c(k,"DIV",{class:!0});var q=b(N);L.l(q),q.forEach(r),this.h()},h(){u(n,"class","text-xl font-semibold text-white mb-1"),u(C,"class",M=Fe(a[2].status)),u(m,"class","flex items-center space-x-4 text-sm text-gray-400"),u(j,"class","flex items-center space-x-2"),u(l,"class","flex items-center justify-between"),u(e,"class","frosted border-b border-gray-800/50 p-4"),u(N,"class","flex-1 overflow-hidden")},m(k,h){X(k,e,h),t(e,l),t(l,s),t(s,n),t(n,o),t(s,g),t(s,m),t(m,_),t(_,p),t(_,y),t(m,I),O&&O.m(m,null),t(m,w),t(m,C),t(C,P),t(l,A),t(l,j),B&&B.m(j,null),X(k,H,h),X(k,N,h),R[$].m(N,null),z=!0},p(k,h){(!z||h[0]&4)&&f!==(f=k[2].interface+"")&&G(o,f),(!z||h[0]&4)&&v!==(v=new Date(k[2].started_at).toLocaleString()+"")&&G(y,v),k[2].completed_at?O?O.p(k,h):(O=kt(k),O.c(),O.m(m,w)):O&&(O.d(1),O=null),(!z||h[0]&4)&&T!==(T=k[2].status+"")&&G(P,T),(!z||h[0]&4&&M!==(M=Fe(k[2].status)))&&u(C,"class",M),k[2].results?B?(B.p(k,h),h[0]&4&&ce(B,1)):(B=Et(k),B.c(),ce(B,1),B.m(j,null)):B&&(Le(),he(B,1,1,()=>{B=null}),Be());let d=$;$=re(k),$===d?R[$].p(k,h):(Le(),he(R[d],1,1,()=>{R[d]=null}),Be(),L=R[$],L?L.p(k,h):(L=R[$]=J[$](k),L.c()),ce(L,1),L.m(N,null))},i(k){z||(ce(B),ce(L),z=!0)},o(k){he(B),he(L),z=!1},d(k){k&&(r(e),r(H),r(N)),O&&O.d(),B&&B.d(),R[$].d()}}}function kt(a){let e,l,s=new Date(a[2].completed_at).toLocaleString()+"",n;return{c(){e=i("span"),l=V("Completed: "),n=V(s)},l(f){e=c(f,"SPAN",{});var o=b(e);l=S(o,"Completed: "),n=S(o,s),o.forEach(r)},m(f,o){X(f,e,o),t(e,l),t(e,n)},p(f,o){o[0]&4&&s!==(s=new Date(f[2].completed_at).toLocaleString()+"")&&G(n,s)},d(f){f&&r(e)}}}function Et(a){let e,l=a[4]?"Terminal View":"Intel Panel",s,n,f,o,g,m,_;return o=new Kt({props:{size:16}}),{c(){e=i("button"),s=V(l),n=x(),f=i("button"),Ve(o.$$.fragment),this.h()},l(p){e=c(p,"BUTTON",{class:!0});var v=b(e);s=S(v,l),v.forEach(r),n=D(p),f=c(p,"BUTTON",{class:!0,title:!0});var y=b(f);Te(o.$$.fragment,y),y.forEach(r),this.h()},h(){u(e,"class","px-3 py-2 bg-purple-500/20 hover:bg-purple-500/30 border border-purple-500/50 rounded-lg text-purple-400 text-sm transition-colors"),u(f,"class","p-2 rounded-lg bg-green-500/20 hover:bg-green-500/30 text-green-400 transition-colors"),u(f,"title","Export JSON")},m(p,v){X(p,e,v),t(e,s),X(p,n,v),X(p,f,v),Se(o,f,null),g=!0,m||(_=[Ie(e,"click",a[15]),Ie(f,"click",a[16])],m=!0)},p(p,v){(!g||v[0]&16)&&l!==(l=p[4]?"Terminal View":"Intel Panel")&&G(s,l)},i(p){g||(ce(o.$$.fragment,p),g=!0)},o(p){he(o.$$.fragment,p),g=!1},d(p){p&&(r(e),r(n),r(f)),Pe(o),m=!1,Ze(_)}}}function ol(a){let e,l,s,n="PCAP Studio - Capture Analysis",f,o,g="═══════════════════════════════════════",m,_,p,v,y=a[2].interface+"",I,w,C,T,P,M=a[2].status+"",A,j,H,N,$,L,z=new Date(a[2].started_at).toLocaleString()+"",O,B,J,R,re,k,h=a[2].packet_count.toLocaleString()+"",d,E,K,W,ee,U=Ae(a[2].bytes_captured)+"",F,q,Y,Q,le=a[2].completed_at&&wt(a),ae=a[2].filter&&xt(a),_e=a[2].results&&Dt(a),ue=a[2].error_message&&It(a);return{c(){e=i("div"),l=i("div"),s=i("div"),s.textContent=n,f=x(),o=i("div"),o.textContent=g,m=x(),_=i("div"),p=V("Interface: "),v=i("span"),I=V(y),w=x(),C=i("div"),T=V("Status: "),P=i("span"),A=V(M),H=x(),N=i("div"),$=V("Started: "),L=i("span"),O=V(z),B=x(),le&&le.c(),J=x(),R=i("div"),re=V("Packets: "),k=i("span"),d=V(h),E=x(),K=i("div"),W=V("Bytes: "),ee=i("span"),F=V(U),q=x(),ae&&ae.c(),Y=x(),_e&&_e.c(),Q=x(),ue&&ue.c(),this.h()},l(te){e=c(te,"DIV",{class:!0});var ie=b(e);l=c(ie,"DIV",{class:!0});var oe=b(l);s=c(oe,"DIV",{class:!0,"data-svelte-h":!0}),de(s)!=="svelte-190vwk0"&&(s.textContent=n),f=D(oe),o=c(oe,"DIV",{class:!0,"data-svelte-h":!0}),de(o)!=="svelte-1t1bec7"&&(o.textContent=g),m=D(oe),_=c(oe,"DIV",{});var we=b(_);p=S(we,"Interface: "),v=c(we,"SPAN",{class:!0});var pe=b(v);I=S(pe,y),pe.forEach(r),we.forEach(r),w=D(oe),C=c(oe,"DIV",{});var ne=b(C);T=S(ne,"Status: "),P=c(ne,"SPAN",{class:!0});var Ee=b(P);A=S(Ee,M),Ee.forEach(r),ne.forEach(r),H=D(oe),N=c(oe,"DIV",{});var fe=b(N);$=S(fe,"Started: "),L=c(fe,"SPAN",{class:!0});var ke=b(L);O=S(ke,z),ke.forEach(r),fe.forEach(r),B=D(oe),le&&le.l(oe),J=D(oe),R=c(oe,"DIV",{});var xe=b(R);re=S(xe,"Packets: "),k=c(xe,"SPAN",{class:!0});var ye=b(k);d=S(ye,h),ye.forEach(r),xe.forEach(r),E=D(oe),K=c(oe,"DIV",{});var De=b(K);W=S(De,"Bytes: "),ee=c(De,"SPAN",{class:!0});var me=b(ee);F=S(me,U),me.forEach(r),De.forEach(r),q=D(oe),ae&&ae.l(oe),Y=D(oe),_e&&_e.l(oe),Q=D(oe),ue&&ue.l(oe),oe.forEach(r),ie.forEach(r),this.h()},h(){u(s,"class","text-cyan-400"),u(o,"class","text-gray-400"),u(v,"class","text-white"),u(P,"class",j=Fe(a[2].status)),u(L,"class","text-white"),u(k,"class","text-white"),u(ee,"class","text-white"),u(l,"class","space-y-1"),u(e,"class","h-full bg-black/20 p-4 font-mono text-sm text-green-400 overflow-y-auto")},m(te,ie){X(te,e,ie),t(e,l),t(l,s),t(l,f),t(l,o),t(l,m),t(l,_),t(_,p),t(_,v),t(v,I),t(l,w),t(l,C),t(C,T),t(C,P),t(P,A),t(l,H),t(l,N),t(N,$),t(N,L),t(L,O),t(l,B),le&&le.m(l,null),t(l,J),t(l,R),t(R,re),t(R,k),t(k,d),t(l,E),t(l,K),t(K,W),t(K,ee),t(ee,F),t(l,q),ae&&ae.m(l,null),t(l,Y),_e&&_e.m(l,null),t(l,Q),ue&&ue.m(l,null)},p(te,ie){ie[0]&4&&y!==(y=te[2].interface+"")&&G(I,y),ie[0]&4&&M!==(M=te[2].status+"")&&G(A,M),ie[0]&4&&j!==(j=Fe(te[2].status))&&u(P,"class",j),ie[0]&4&&z!==(z=new Date(te[2].started_at).toLocaleString()+"")&&G(O,z),te[2].completed_at?le?le.p(te,ie):(le=wt(te),le.c(),le.m(l,J)):le&&(le.d(1),le=null),ie[0]&4&&h!==(h=te[2].packet_count.toLocaleString()+"")&&G(d,h),ie[0]&4&&U!==(U=Ae(te[2].bytes_captured)+"")&&G(F,U),te[2].filter?ae?ae.p(te,ie):(ae=xt(te),ae.c(),ae.m(l,Y)):ae&&(ae.d(1),ae=null),te[2].results?_e?_e.p(te,ie):(_e=Dt(te),_e.c(),_e.m(l,Q)):_e&&(_e.d(1),_e=null),te[2].error_message?ue?ue.p(te,ie):(ue=It(te),ue.c(),ue.m(l,null)):ue&&(ue.d(1),ue=null)},i:Ke,o:Ke,d(te){te&&r(e),le&&le.d(),ae&&ae.d(),_e&&_e.d(),ue&&ue.d()}}}function il(a){let e,l,s,n,f=a[2].results.flows.length+"",o,g,m,_="Network Flows",p,v,y,I=a[2].packet_count.toLocaleString()+"",w,C,T,P="Total Packets",M,A,j,H=Ae(a[2].bytes_captured)+"",N,$,L,z="Data Captured",O,B,J,R=a[2].results.anomalies.length+"",re,k,h,d="Anomalies",E,K,W,ee,U,F,q,Y,Q,le,ae,_e,ue,te,ie,oe,we='<tr class="border-b border-gray-700"><th class="text-left p-2 text-gray-400">Source</th> <th class="text-left p-2 text-gray-400">Destination</th> <th class="text-left p-2 text-gray-400">Protocol</th> <th class="text-left p-2 text-gray-400">Packets</th> <th class="text-left p-2 text-gray-400">Bytes</th> <th class="text-left p-2 text-gray-400">Duration</th></tr>',pe,ne,Ee,fe,ke;ee=new Zt({props:{class:"w-5 h-5 mr-2 text-cyan-400"}});let xe=$e(Object.entries(a[2].results.protocols)),ye=[];for(let Z=0;Z<xe.length;Z+=1)ye[Z]=Vt(pt(a,xe,Z));ae=new el({props:{class:"w-5 h-5 mr-2 text-cyan-400"}});let De=$e(a[2].results.flows.slice(0,10)),me=[];for(let Z=0;Z<De.length;Z+=1)me[Z]=St(ht(a,De,Z));let be=a[2].results.anomalies.length>0&&Pt(a),ge=a[2].results.tls_analysis&&Lt(a);return{c(){e=i("div"),l=i("div"),s=i("div"),n=i("div"),o=V(f),g=x(),m=i("div"),m.textContent=_,p=x(),v=i("div"),y=i("div"),w=V(I),C=x(),T=i("div"),T.textContent=P,M=x(),A=i("div"),j=i("div"),N=V(H),$=x(),L=i("div"),L.textContent=z,O=x(),B=i("div"),J=i("div"),re=V(R),k=x(),h=i("div"),h.textContent=d,E=x(),K=i("div"),W=i("h4"),Ve(ee.$$.fragment),U=V(`\r
                Protocol Distribution`),F=x(),q=i("div");for(let Z=0;Z<ye.length;Z+=1)ye[Z].c();Y=x(),Q=i("div"),le=i("h4"),Ve(ae.$$.fragment),_e=V(`\r
                Network Flows`),ue=x(),te=i("div"),ie=i("table"),oe=i("thead"),oe.innerHTML=we,pe=x(),ne=i("tbody");for(let Z=0;Z<me.length;Z+=1)me[Z].c();Ee=x(),be&&be.c(),fe=x(),ge&&ge.c(),this.h()},l(Z){e=c(Z,"DIV",{class:!0});var ve=b(e);l=c(ve,"DIV",{class:!0});var se=b(l);s=c(se,"DIV",{class:!0});var Ce=b(s);n=c(Ce,"DIV",{class:!0});var tt=b(n);o=S(tt,f),tt.forEach(r),g=D(Ce),m=c(Ce,"DIV",{class:!0,"data-svelte-h":!0}),de(m)!=="svelte-1lbl0dy"&&(m.textContent=_),Ce.forEach(r),p=D(se),v=c(se,"DIV",{class:!0});var ze=b(v);y=c(ze,"DIV",{class:!0});var lt=b(y);w=S(lt,I),lt.forEach(r),C=D(ze),T=c(ze,"DIV",{class:!0,"data-svelte-h":!0}),de(T)!=="svelte-1ax0xlm"&&(T.textContent=P),ze.forEach(r),M=D(se),A=c(se,"DIV",{class:!0});var He=b(A);j=c(He,"DIV",{class:!0});var st=b(j);N=S(st,H),st.forEach(r),$=D(He),L=c(He,"DIV",{class:!0,"data-svelte-h":!0}),de(L)!=="svelte-mianxj"&&(L.textContent=z),He.forEach(r),O=D(se),B=c(se,"DIV",{class:!0});var Ue=b(B);J=c(Ue,"DIV",{class:!0});var at=b(J);re=S(at,R),at.forEach(r),k=D(Ue),h=c(Ue,"DIV",{class:!0,"data-svelte-h":!0}),de(h)!=="svelte-15qp5sg"&&(h.textContent=d),Ue.forEach(r),se.forEach(r),E=D(ve),K=c(ve,"DIV",{class:!0});var Re=b(K);W=c(Re,"H4",{class:!0});var Ye=b(W);Te(ee.$$.fragment,Ye),U=S(Ye,`\r
                Protocol Distribution`),Ye.forEach(r),F=D(Re),q=c(Re,"DIV",{class:!0});var rt=b(q);for(let je=0;je<ye.length;je+=1)ye[je].l(rt);rt.forEach(r),Re.forEach(r),Y=D(ve),Q=c(ve,"DIV",{class:!0});var qe=b(Q);le=c(qe,"H4",{class:!0});var Ge=b(le);Te(ae.$$.fragment,Ge),_e=S(Ge,`\r
                Network Flows`),Ge.forEach(r),ue=D(qe),te=c(qe,"DIV",{class:!0});var nt=b(te);ie=c(nt,"TABLE",{class:!0});var Qe=b(ie);oe=c(Qe,"THEAD",{"data-svelte-h":!0}),de(oe)!=="svelte-5br2wk"&&(oe.innerHTML=we),pe=D(Qe),ne=c(Qe,"TBODY",{});var ot=b(ne);for(let je=0;je<me.length;je+=1)me[je].l(ot);ot.forEach(r),Qe.forEach(r),nt.forEach(r),qe.forEach(r),Ee=D(ve),be&&be.l(ve),fe=D(ve),ge&&ge.l(ve),ve.forEach(r),this.h()},h(){u(n,"class","text-2xl font-bold text-cyan-400"),u(m,"class","text-sm text-gray-400"),u(s,"class","frosted p-4 rounded-lg border border-gray-700/50"),u(y,"class","text-2xl font-bold text-green-400"),u(T,"class","text-sm text-gray-400"),u(v,"class","frosted p-4 rounded-lg border border-gray-700/50"),u(j,"class","text-2xl font-bold text-blue-400"),u(L,"class","text-sm text-gray-400"),u(A,"class","frosted p-4 rounded-lg border border-gray-700/50"),u(J,"class","text-2xl font-bold text-yellow-400"),u(h,"class","text-sm text-gray-400"),u(B,"class","frosted p-4 rounded-lg border border-gray-700/50"),u(l,"class","grid grid-cols-4 gap-4"),u(W,"class","text-lg font-semibold text-white mb-3 flex items-center"),u(q,"class","space-y-2"),u(K,"class","frosted p-4 rounded-lg border border-gray-700/50"),u(le,"class","text-lg font-semibold text-white mb-3 flex items-center"),u(ie,"class","w-full text-sm"),u(te,"class","overflow-x-auto"),u(Q,"class","frosted p-4 rounded-lg border border-gray-700/50"),u(e,"class","h-full overflow-y-auto p-4 space-y-6")},m(Z,ve){X(Z,e,ve),t(e,l),t(l,s),t(s,n),t(n,o),t(s,g),t(s,m),t(l,p),t(l,v),t(v,y),t(y,w),t(v,C),t(v,T),t(l,M),t(l,A),t(A,j),t(j,N),t(A,$),t(A,L),t(l,O),t(l,B),t(B,J),t(J,re),t(B,k),t(B,h),t(e,E),t(e,K),t(K,W),Se(ee,W,null),t(W,U),t(K,F),t(K,q);for(let se=0;se<ye.length;se+=1)ye[se]&&ye[se].m(q,null);t(e,Y),t(e,Q),t(Q,le),Se(ae,le,null),t(le,_e),t(Q,ue),t(Q,te),t(te,ie),t(ie,oe),t(ie,pe),t(ie,ne);for(let se=0;se<me.length;se+=1)me[se]&&me[se].m(ne,null);t(e,Ee),be&&be.m(e,null),t(e,fe),ge&&ge.m(e,null),ke=!0},p(Z,ve){if((!ke||ve[0]&4)&&f!==(f=Z[2].results.flows.length+"")&&G(o,f),(!ke||ve[0]&4)&&I!==(I=Z[2].packet_count.toLocaleString()+"")&&G(w,I),(!ke||ve[0]&4)&&H!==(H=Ae(Z[2].bytes_captured)+"")&&G(N,H),(!ke||ve[0]&4)&&R!==(R=Z[2].results.anomalies.length+"")&&G(re,R),ve[0]&4){xe=$e(Object.entries(Z[2].results.protocols));let se;for(se=0;se<xe.length;se+=1){const Ce=pt(Z,xe,se);ye[se]?ye[se].p(Ce,ve):(ye[se]=Vt(Ce),ye[se].c(),ye[se].m(q,null))}for(;se<ye.length;se+=1)ye[se].d(1);ye.length=xe.length}if(ve[0]&4){De=$e(Z[2].results.flows.slice(0,10));let se;for(se=0;se<De.length;se+=1){const Ce=ht(Z,De,se);me[se]?me[se].p(Ce,ve):(me[se]=St(Ce),me[se].c(),me[se].m(ne,null))}for(;se<me.length;se+=1)me[se].d(1);me.length=De.length}Z[2].results.anomalies.length>0?be?(be.p(Z,ve),ve[0]&4&&ce(be,1)):(be=Pt(Z),be.c(),ce(be,1),be.m(e,fe)):be&&(Le(),he(be,1,1,()=>{be=null}),Be()),Z[2].results.tls_analysis?ge?(ge.p(Z,ve),ve[0]&4&&ce(ge,1)):(ge=Lt(Z),ge.c(),ce(ge,1),ge.m(e,null)):ge&&(Le(),he(ge,1,1,()=>{ge=null}),Be())},i(Z){ke||(ce(ee.$$.fragment,Z),ce(ae.$$.fragment,Z),ce(be),ce(ge),ke=!0)},o(Z){he(ee.$$.fragment,Z),he(ae.$$.fragment,Z),he(be),he(ge),ke=!1},d(Z){Z&&r(e),Pe(ee),Me(ye,Z),Pe(ae),Me(me,Z),be&&be.d(),ge&&ge.d()}}}function wt(a){let e,l,s,n=new Date(a[2].completed_at).toLocaleString()+"",f;return{c(){e=i("div"),l=V("Completed: "),s=i("span"),f=V(n),this.h()},l(o){e=c(o,"DIV",{});var g=b(e);l=S(g,"Completed: "),s=c(g,"SPAN",{class:!0});var m=b(s);f=S(m,n),m.forEach(r),g.forEach(r),this.h()},h(){u(s,"class","text-white")},m(o,g){X(o,e,g),t(e,l),t(e,s),t(s,f)},p(o,g){g[0]&4&&n!==(n=new Date(o[2].completed_at).toLocaleString()+"")&&G(f,n)},d(o){o&&r(e)}}}function xt(a){let e,l,s,n=a[2].filter+"",f;return{c(){e=i("div"),l=V("Filter: "),s=i("span"),f=V(n),this.h()},l(o){e=c(o,"DIV",{});var g=b(e);l=S(g,"Filter: "),s=c(g,"SPAN",{class:!0});var m=b(s);f=S(m,n),m.forEach(r),g.forEach(r),this.h()},h(){u(s,"class","text-yellow-400")},m(o,g){X(o,e,g),t(e,l),t(e,s),t(s,f)},p(o,g){g[0]&4&&n!==(n=o[2].filter+"")&&G(f,n)},d(o){o&&r(e)}}}function Dt(a){let e,l="Analysis Results:",s,n,f="───────────────",o,g,m,_,p=a[2].results.flows.length+"",v,y,I,w,C,T=Object.keys(a[2].results.protocols).join(", ")+"",P,M,A,j,H,N=a[2].results.top_talkers.length+"",$,L,z,O,B,J=a[2].results.anomalies.length+"",R,re,k,h=a[2].results.performance_stats&&Ct(a);return{c(){e=i("div"),e.textContent=l,s=x(),n=i("div"),n.textContent=f,o=x(),g=i("div"),m=V("Network Flows: "),_=i("span"),v=V(p),y=x(),I=i("div"),w=V("Protocols: "),C=i("span"),P=V(T),M=x(),A=i("div"),j=V("Top Talkers: "),H=i("span"),$=V(N),L=x(),z=i("div"),O=V("Anomalies: "),B=i("span"),R=V(J),re=x(),h&&h.c(),k=We(),this.h()},l(d){e=c(d,"DIV",{class:!0,"data-svelte-h":!0}),de(e)!=="svelte-1fqmmjz"&&(e.textContent=l),s=D(d),n=c(d,"DIV",{class:!0,"data-svelte-h":!0}),de(n)!=="svelte-110rspz"&&(n.textContent=f),o=D(d),g=c(d,"DIV",{});var E=b(g);m=S(E,"Network Flows: "),_=c(E,"SPAN",{class:!0});var K=b(_);v=S(K,p),K.forEach(r),E.forEach(r),y=D(d),I=c(d,"DIV",{});var W=b(I);w=S(W,"Protocols: "),C=c(W,"SPAN",{class:!0});var ee=b(C);P=S(ee,T),ee.forEach(r),W.forEach(r),M=D(d),A=c(d,"DIV",{});var U=b(A);j=S(U,"Top Talkers: "),H=c(U,"SPAN",{class:!0});var F=b(H);$=S(F,N),F.forEach(r),U.forEach(r),L=D(d),z=c(d,"DIV",{});var q=b(z);O=S(q,"Anomalies: "),B=c(q,"SPAN",{class:!0});var Y=b(B);R=S(Y,J),Y.forEach(r),q.forEach(r),re=D(d),h&&h.l(d),k=We(),this.h()},h(){u(e,"class","text-gray-400 mt-4"),u(n,"class","text-gray-400"),u(_,"class","text-white"),u(C,"class","text-white"),u(H,"class","text-white"),u(B,"class","text-yellow-400")},m(d,E){X(d,e,E),X(d,s,E),X(d,n,E),X(d,o,E),X(d,g,E),t(g,m),t(g,_),t(_,v),X(d,y,E),X(d,I,E),t(I,w),t(I,C),t(C,P),X(d,M,E),X(d,A,E),t(A,j),t(A,H),t(H,$),X(d,L,E),X(d,z,E),t(z,O),t(z,B),t(B,R),X(d,re,E),h&&h.m(d,E),X(d,k,E)},p(d,E){E[0]&4&&p!==(p=d[2].results.flows.length+"")&&G(v,p),E[0]&4&&T!==(T=Object.keys(d[2].results.protocols).join(", ")+"")&&G(P,T),E[0]&4&&N!==(N=d[2].results.top_talkers.length+"")&&G($,N),E[0]&4&&J!==(J=d[2].results.anomalies.length+"")&&G(R,J),d[2].results.performance_stats?h?h.p(d,E):(h=Ct(d),h.c(),h.m(k.parentNode,k)):h&&(h.d(1),h=null)},d(d){d&&(r(e),r(s),r(n),r(o),r(g),r(y),r(I),r(M),r(A),r(L),r(z),r(re),r(k)),h&&h.d(d)}}}function Ct(a){let e,l="Performance:",s,n,f="────────────",o,g,m,_,p=a[2].results.performance_stats.packets_per_second.toFixed(1)+"",v,y,I,w,C,T=Ae(a[2].results.performance_stats.bytes_per_second)+"",P,M,A,j,H,N,$=a[2].results.performance_stats.memory_usage_mb.toFixed(1)+"",L,z,O,B,J,R,re=a[2].results.performance_stats.cpu_usage_percent.toFixed(1)+"",k,h;return{c(){e=i("div"),e.textContent=l,s=x(),n=i("div"),n.textContent=f,o=x(),g=i("div"),m=V("PPS: "),_=i("span"),v=V(p),y=x(),I=i("div"),w=V("Throughput: "),C=i("span"),P=V(T),M=V("/s"),A=x(),j=i("div"),H=V("Memory: "),N=i("span"),L=V($),z=V(" MB"),O=x(),B=i("div"),J=V("CPU: "),R=i("span"),k=V(re),h=V("%"),this.h()},l(d){e=c(d,"DIV",{class:!0,"data-svelte-h":!0}),de(e)!=="svelte-1710uvj"&&(e.textContent=l),s=D(d),n=c(d,"DIV",{class:!0,"data-svelte-h":!0}),de(n)!=="svelte-1bs42dh"&&(n.textContent=f),o=D(d),g=c(d,"DIV",{});var E=b(g);m=S(E,"PPS: "),_=c(E,"SPAN",{class:!0});var K=b(_);v=S(K,p),K.forEach(r),E.forEach(r),y=D(d),I=c(d,"DIV",{});var W=b(I);w=S(W,"Throughput: "),C=c(W,"SPAN",{class:!0});var ee=b(C);P=S(ee,T),M=S(ee,"/s"),ee.forEach(r),W.forEach(r),A=D(d),j=c(d,"DIV",{});var U=b(j);H=S(U,"Memory: "),N=c(U,"SPAN",{class:!0});var F=b(N);L=S(F,$),z=S(F," MB"),F.forEach(r),U.forEach(r),O=D(d),B=c(d,"DIV",{});var q=b(B);J=S(q,"CPU: "),R=c(q,"SPAN",{class:!0});var Y=b(R);k=S(Y,re),h=S(Y,"%"),Y.forEach(r),q.forEach(r),this.h()},h(){u(e,"class","text-gray-400 mt-4"),u(n,"class","text-gray-400"),u(_,"class","text-white"),u(C,"class","text-white"),u(N,"class","text-white"),u(R,"class","text-white")},m(d,E){X(d,e,E),X(d,s,E),X(d,n,E),X(d,o,E),X(d,g,E),t(g,m),t(g,_),t(_,v),X(d,y,E),X(d,I,E),t(I,w),t(I,C),t(C,P),t(C,M),X(d,A,E),X(d,j,E),t(j,H),t(j,N),t(N,L),t(N,z),X(d,O,E),X(d,B,E),t(B,J),t(B,R),t(R,k),t(R,h)},p(d,E){E[0]&4&&p!==(p=d[2].results.performance_stats.packets_per_second.toFixed(1)+"")&&G(v,p),E[0]&4&&T!==(T=Ae(d[2].results.performance_stats.bytes_per_second)+"")&&G(P,T),E[0]&4&&$!==($=d[2].results.performance_stats.memory_usage_mb.toFixed(1)+"")&&G(L,$),E[0]&4&&re!==(re=d[2].results.performance_stats.cpu_usage_percent.toFixed(1)+"")&&G(k,re)},d(d){d&&(r(e),r(s),r(n),r(o),r(g),r(y),r(I),r(A),r(j),r(O),r(B))}}}function It(a){let e,l,s=a[2].error_message+"",n;return{c(){e=i("div"),l=V("Error: "),n=V(s),this.h()},l(f){e=c(f,"DIV",{class:!0});var o=b(e);l=S(o,"Error: "),n=S(o,s),o.forEach(r),this.h()},h(){u(e,"class","text-red-400 mt-4")},m(f,o){X(f,e,o),t(e,l),t(e,n)},p(f,o){o[0]&4&&s!==(s=f[2].error_message+"")&&G(n,s)},d(f){f&&r(e)}}}function Vt(a){let e,l,s=a[40]+"",n,f,o,g,m,_,p,v=a[41]+"",y,I;return{c(){e=i("div"),l=i("span"),n=V(s),f=x(),o=i("div"),g=i("div"),m=i("div"),_=x(),p=i("span"),y=V(v),I=x(),this.h()},l(w){e=c(w,"DIV",{class:!0});var C=b(e);l=c(C,"SPAN",{class:!0});var T=b(l);n=S(T,s),T.forEach(r),f=D(C),o=c(C,"DIV",{class:!0});var P=b(o);g=c(P,"DIV",{class:!0});var M=b(g);m=c(M,"DIV",{class:!0,style:!0}),b(m).forEach(r),M.forEach(r),_=D(P),p=c(P,"SPAN",{class:!0});var A=b(p);y=S(A,v),A.forEach(r),P.forEach(r),I=D(C),C.forEach(r),this.h()},h(){u(l,"class","text-gray-300"),u(m,"class","bg-cyan-400 h-2 rounded-full transition-all duration-300"),ut(m,"width",a[41]/Math.max(...Object.values(a[2].results.protocols))*100+"%"),u(g,"class","w-32 bg-gray-700 rounded-full h-2"),u(p,"class","text-sm text-gray-400 w-12 text-right"),u(o,"class","flex items-center space-x-2"),u(e,"class","flex items-center justify-between")},m(w,C){X(w,e,C),t(e,l),t(l,n),t(e,f),t(e,o),t(o,g),t(g,m),t(o,_),t(o,p),t(p,y),t(e,I)},p(w,C){C[0]&4&&s!==(s=w[40]+"")&&G(n,s),C[0]&4&&ut(m,"width",w[41]/Math.max(...Object.values(w[2].results.protocols))*100+"%"),C[0]&4&&v!==(v=w[41]+"")&&G(y,v)},d(w){w&&r(e)}}}function St(a){let e,l,s=a[37].src_ip+"",n,f,o=a[37].src_port+"",g,m,_,p=a[37].dst_ip+"",v,y,I=a[37].dst_port+"",w,C,T,P=a[37].protocol+"",M,A,j,H=a[37].packet_count+"",N,$,L,z=Ae(a[37].bytes)+"",O,B,J,R=zt(a[37].duration_ms)+"",re,k;return{c(){e=i("tr"),l=i("td"),n=V(s),f=V(":"),g=V(o),m=x(),_=i("td"),v=V(p),y=V(":"),w=V(I),C=x(),T=i("td"),M=V(P),A=x(),j=i("td"),N=V(H),$=x(),L=i("td"),O=V(z),B=x(),J=i("td"),re=V(R),k=x(),this.h()},l(h){e=c(h,"TR",{class:!0});var d=b(e);l=c(d,"TD",{class:!0});var E=b(l);n=S(E,s),f=S(E,":"),g=S(E,o),E.forEach(r),m=D(d),_=c(d,"TD",{class:!0});var K=b(_);v=S(K,p),y=S(K,":"),w=S(K,I),K.forEach(r),C=D(d),T=c(d,"TD",{class:!0});var W=b(T);M=S(W,P),W.forEach(r),A=D(d),j=c(d,"TD",{class:!0});var ee=b(j);N=S(ee,H),ee.forEach(r),$=D(d),L=c(d,"TD",{class:!0});var U=b(L);O=S(U,z),U.forEach(r),B=D(d),J=c(d,"TD",{class:!0});var F=b(J);re=S(F,R),F.forEach(r),k=D(d),d.forEach(r),this.h()},h(){u(l,"class","p-2 text-gray-300"),u(_,"class","p-2 text-gray-300"),u(T,"class","p-2 text-cyan-400"),u(j,"class","p-2 text-gray-300"),u(L,"class","p-2 text-gray-300"),u(J,"class","p-2 text-gray-300"),u(e,"class","border-b border-gray-800/50 hover:bg-gray-800/30")},m(h,d){X(h,e,d),t(e,l),t(l,n),t(l,f),t(l,g),t(e,m),t(e,_),t(_,v),t(_,y),t(_,w),t(e,C),t(e,T),t(T,M),t(e,A),t(e,j),t(j,N),t(e,$),t(e,L),t(L,O),t(e,B),t(e,J),t(J,re),t(e,k)},p(h,d){d[0]&4&&s!==(s=h[37].src_ip+"")&&G(n,s),d[0]&4&&o!==(o=h[37].src_port+"")&&G(g,o),d[0]&4&&p!==(p=h[37].dst_ip+"")&&G(v,p),d[0]&4&&I!==(I=h[37].dst_port+"")&&G(w,I),d[0]&4&&P!==(P=h[37].protocol+"")&&G(M,P),d[0]&4&&H!==(H=h[37].packet_count+"")&&G(N,H),d[0]&4&&z!==(z=Ae(h[37].bytes)+"")&&G(O,z),d[0]&4&&R!==(R=zt(h[37].duration_ms)+"")&&G(re,R)},d(h){h&&r(e)}}}function Pt(a){let e,l,s,n,f,o,g;s=new tl({props:{class:"w-5 h-5 mr-2 text-yellow-400"}});let m=$e(a[2].results.anomalies),_=[];for(let p=0;p<m.length;p+=1)_[p]=Nt(vt(a,m,p));return{c(){e=i("div"),l=i("h4"),Ve(s.$$.fragment),n=V(`\r
                  Security Anomalies`),f=x(),o=i("div");for(let p=0;p<_.length;p+=1)_[p].c();this.h()},l(p){e=c(p,"DIV",{class:!0});var v=b(e);l=c(v,"H4",{class:!0});var y=b(l);Te(s.$$.fragment,y),n=S(y,`\r
                  Security Anomalies`),y.forEach(r),f=D(v),o=c(v,"DIV",{class:!0});var I=b(o);for(let w=0;w<_.length;w+=1)_[w].l(I);I.forEach(r),v.forEach(r),this.h()},h(){u(l,"class","text-lg font-semibold text-white mb-3 flex items-center"),u(o,"class","space-y-3"),u(e,"class","frosted p-4 rounded-lg border border-gray-700/50")},m(p,v){X(p,e,v),t(e,l),Se(s,l,null),t(l,n),t(e,f),t(e,o);for(let y=0;y<_.length;y+=1)_[y]&&_[y].m(o,null);g=!0},p(p,v){if(v[0]&4){m=$e(p[2].results.anomalies);let y;for(y=0;y<m.length;y+=1){const I=vt(p,m,y);_[y]?_[y].p(I,v):(_[y]=Nt(I),_[y].c(),_[y].m(o,null))}for(;y<_.length;y+=1)_[y].d(1);_.length=m.length}},i(p){g||(ce(s.$$.fragment,p),g=!0)},o(p){he(s.$$.fragment,p),g=!1},d(p){p&&r(e),Pe(s),Me(_,p)}}}function $t(a){let e,l,s=a[34].src_ip&&Tt(a),n=a[34].dst_ip&&At(a);return{c(){e=i("div"),s&&s.c(),l=x(),n&&n.c(),this.h()},l(f){e=c(f,"DIV",{class:!0});var o=b(e);s&&s.l(o),l=D(o),n&&n.l(o),o.forEach(r),this.h()},h(){u(e,"class","text-xs text-gray-400")},m(f,o){X(f,e,o),s&&s.m(e,null),t(e,l),n&&n.m(e,null)},p(f,o){f[34].src_ip?s?s.p(f,o):(s=Tt(f),s.c(),s.m(e,l)):s&&(s.d(1),s=null),f[34].dst_ip?n?n.p(f,o):(n=At(f),n.c(),n.m(e,null)):n&&(n.d(1),n=null)},d(f){f&&r(e),s&&s.d(),n&&n.d()}}}function Tt(a){let e,l=a[34].src_ip+"",s;return{c(){e=V("Source: "),s=V(l)},l(n){e=S(n,"Source: "),s=S(n,l)},m(n,f){X(n,e,f),X(n,s,f)},p(n,f){f[0]&4&&l!==(l=n[34].src_ip+"")&&G(s,l)},d(n){n&&(r(e),r(s))}}}function At(a){let e,l=a[34].dst_ip+"",s;return{c(){e=V("Destination: "),s=V(l)},l(n){e=S(n,"Destination: "),s=S(n,l)},m(n,f){X(n,e,f),X(n,s,f)},p(n,f){f[0]&4&&l!==(l=n[34].dst_ip+"")&&G(s,l)},d(n){n&&(r(e),r(s))}}}function Nt(a){let e,l,s,n=a[34].severity+"",f,o,g,m,_=new Date(a[34].timestamp).toLocaleString()+"",p,v,y,I=a[34].description+"",w,C,T,P=(a[34].src_ip||a[34].dst_ip)&&$t(a);return{c(){e=i("div"),l=i("div"),s=i("span"),f=V(n),g=x(),m=i("span"),p=V(_),v=x(),y=i("p"),w=V(I),C=x(),P&&P.c(),T=x(),this.h()},l(M){e=c(M,"DIV",{class:!0});var A=b(e);l=c(A,"DIV",{class:!0});var j=b(l);s=c(j,"SPAN",{class:!0});var H=b(s);f=S(H,n),H.forEach(r),g=D(j),m=c(j,"SPAN",{class:!0});var N=b(m);p=S(N,_),N.forEach(r),j.forEach(r),v=D(A),y=c(A,"P",{class:!0});var $=b(y);w=S($,I),$.forEach(r),C=D(A),P&&P.l(A),T=D(A),A.forEach(r),this.h()},h(){u(s,"class",o="font-medium "+Mt(a[34].severity)),u(m,"class","text-xs text-gray-400"),u(l,"class","flex items-center justify-between mb-2"),u(y,"class","text-gray-300 text-sm mb-2"),u(e,"class","p-3 bg-black/20 rounded-lg border border-gray-700/30")},m(M,A){X(M,e,A),t(e,l),t(l,s),t(s,f),t(l,g),t(l,m),t(m,p),t(e,v),t(e,y),t(y,w),t(e,C),P&&P.m(e,null),t(e,T)},p(M,A){A[0]&4&&n!==(n=M[34].severity+"")&&G(f,n),A[0]&4&&o!==(o="font-medium "+Mt(M[34].severity))&&u(s,"class",o),A[0]&4&&_!==(_=new Date(M[34].timestamp).toLocaleString()+"")&&G(p,_),A[0]&4&&I!==(I=M[34].description+"")&&G(w,I),M[34].src_ip||M[34].dst_ip?P?P.p(M,A):(P=$t(M),P.c(),P.m(e,T)):P&&(P.d(1),P=null)},d(M){M&&r(e),P&&P.d()}}}function Lt(a){let e,l,s,n,f,o,g,m,_=a[2].results.tls_analysis.pq_connections+"",p,v,y,I="Post-Quantum",w,C,T,P=a[2].results.tls_analysis.hybrid_connections+"",M,A,j,H="Hybrid",N,$,L,z=a[2].results.tls_analysis.classical_connections+"",O,B,J,R="Classical",re,k;s=new et({props:{class:"w-5 h-5 mr-2 text-green-400"}});let h=a[2].results.tls_analysis.handshakes.length>0&&Bt(a);return{c(){e=i("div"),l=i("h4"),Ve(s.$$.fragment),n=V(`\r
                  TLS Analysis`),f=x(),o=i("div"),g=i("div"),m=i("div"),p=V(_),v=x(),y=i("div"),y.textContent=I,w=x(),C=i("div"),T=i("div"),M=V(P),A=x(),j=i("div"),j.textContent=H,N=x(),$=i("div"),L=i("div"),O=V(z),B=x(),J=i("div"),J.textContent=R,re=x(),h&&h.c(),this.h()},l(d){e=c(d,"DIV",{class:!0});var E=b(e);l=c(E,"H4",{class:!0});var K=b(l);Te(s.$$.fragment,K),n=S(K,`\r
                  TLS Analysis`),K.forEach(r),f=D(E),o=c(E,"DIV",{class:!0});var W=b(o);g=c(W,"DIV",{class:!0});var ee=b(g);m=c(ee,"DIV",{class:!0});var U=b(m);p=S(U,_),U.forEach(r),v=D(ee),y=c(ee,"DIV",{class:!0,"data-svelte-h":!0}),de(y)!=="svelte-1q3e7fm"&&(y.textContent=I),ee.forEach(r),w=D(W),C=c(W,"DIV",{class:!0});var F=b(C);T=c(F,"DIV",{class:!0});var q=b(T);M=S(q,P),q.forEach(r),A=D(F),j=c(F,"DIV",{class:!0,"data-svelte-h":!0}),de(j)!=="svelte-145ln66"&&(j.textContent=H),F.forEach(r),N=D(W),$=c(W,"DIV",{class:!0});var Y=b($);L=c(Y,"DIV",{class:!0});var Q=b(L);O=S(Q,z),Q.forEach(r),B=D(Y),J=c(Y,"DIV",{class:!0,"data-svelte-h":!0}),de(J)!=="svelte-12ge3l3"&&(J.textContent=R),Y.forEach(r),W.forEach(r),re=D(E),h&&h.l(E),E.forEach(r),this.h()},h(){u(l,"class","text-lg font-semibold text-white mb-3 flex items-center"),u(m,"class","text-xl font-bold text-green-400"),u(y,"class","text-xs text-gray-400"),u(g,"class","text-center"),u(T,"class","text-xl font-bold text-yellow-400"),u(j,"class","text-xs text-gray-400"),u(C,"class","text-center"),u(L,"class","text-xl font-bold text-red-400"),u(J,"class","text-xs text-gray-400"),u($,"class","text-center"),u(o,"class","grid grid-cols-3 gap-4 mb-4"),u(e,"class","frosted p-4 rounded-lg border border-gray-700/50")},m(d,E){X(d,e,E),t(e,l),Se(s,l,null),t(l,n),t(e,f),t(e,o),t(o,g),t(g,m),t(m,p),t(g,v),t(g,y),t(o,w),t(o,C),t(C,T),t(T,M),t(C,A),t(C,j),t(o,N),t(o,$),t($,L),t(L,O),t($,B),t($,J),t(e,re),h&&h.m(e,null),k=!0},p(d,E){(!k||E[0]&4)&&_!==(_=d[2].results.tls_analysis.pq_connections+"")&&G(p,_),(!k||E[0]&4)&&P!==(P=d[2].results.tls_analysis.hybrid_connections+"")&&G(M,P),(!k||E[0]&4)&&z!==(z=d[2].results.tls_analysis.classical_connections+"")&&G(O,z),d[2].results.tls_analysis.handshakes.length>0?h?h.p(d,E):(h=Bt(d),h.c(),h.m(e,null)):h&&(h.d(1),h=null)},i(d){k||(ce(s.$$.fragment,d),k=!0)},o(d){he(s.$$.fragment,d),k=!1},d(d){d&&r(e),Pe(s),h&&h.d()}}}function Bt(a){let e,l,s,n='<tr class="border-b border-gray-700"><th class="text-left p-2 text-gray-400">Destination</th> <th class="text-left p-2 text-gray-400">Version</th> <th class="text-left p-2 text-gray-400">Cipher Suite</th> <th class="text-left p-2 text-gray-400">PQ Status</th></tr>',f,o,g=$e(a[2].results.tls_analysis.handshakes),m=[];for(let _=0;_<g.length;_+=1)m[_]=Ft(_t(a,g,_));return{c(){e=i("div"),l=i("table"),s=i("thead"),s.innerHTML=n,f=x(),o=i("tbody");for(let _=0;_<m.length;_+=1)m[_].c();this.h()},l(_){e=c(_,"DIV",{class:!0});var p=b(e);l=c(p,"TABLE",{class:!0});var v=b(l);s=c(v,"THEAD",{"data-svelte-h":!0}),de(s)!=="svelte-o24ux7"&&(s.innerHTML=n),f=D(v),o=c(v,"TBODY",{});var y=b(o);for(let I=0;I<m.length;I+=1)m[I].l(y);y.forEach(r),v.forEach(r),p.forEach(r),this.h()},h(){u(l,"class","w-full text-sm"),u(e,"class","overflow-x-auto")},m(_,p){X(_,e,p),t(e,l),t(l,s),t(l,f),t(l,o);for(let v=0;v<m.length;v+=1)m[v]&&m[v].m(o,null)},p(_,p){if(p[0]&4){g=$e(_[2].results.tls_analysis.handshakes);let v;for(v=0;v<g.length;v+=1){const y=_t(_,g,v);m[v]?m[v].p(y,p):(m[v]=Ft(y),m[v].c(),m[v].m(o,null))}for(;v<m.length;v+=1)m[v].d(1);m.length=g.length}},d(_){_&&r(e),Me(m,_)}}}function cl(a){let e,l="Classical";return{c(){e=i("span"),e.textContent=l,this.h()},l(s){e=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),de(e)!=="svelte-18gv83o"&&(e.textContent=l),this.h()},h(){u(e,"class","text-red-400")},m(s,n){X(s,e,n)},d(s){s&&r(e)}}}function ul(a){let e,l="Hybrid";return{c(){e=i("span"),e.textContent=l,this.h()},l(s){e=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),de(e)!=="svelte-7ntzhc"&&(e.textContent=l),this.h()},h(){u(e,"class","text-yellow-400")},m(s,n){X(s,e,n)},d(s){s&&r(e)}}}function fl(a){let e,l="Post-Quantum";return{c(){e=i("span"),e.textContent=l,this.h()},l(s){e=c(s,"SPAN",{class:!0,"data-svelte-h":!0}),de(e)!=="svelte-1j9blor"&&(e.textContent=l),this.h()},h(){u(e,"class","text-green-400")},m(s,n){X(s,e,n)},d(s){s&&r(e)}}}function Ft(a){let e,l,s=a[31].dst_ip+"",n,f,o=a[31].dst_port+"",g,m,_,p=a[31].version+"",v,y,I,w=a[31].cipher_suite+"",C,T,P,M;function A(N,$){return N[31].is_post_quantum?fl:N[31].is_hybrid?ul:cl}let j=A(a),H=j(a);return{c(){e=i("tr"),l=i("td"),n=V(s),f=V(":"),g=V(o),m=x(),_=i("td"),v=V(p),y=x(),I=i("td"),C=V(w),T=x(),P=i("td"),H.c(),M=x(),this.h()},l(N){e=c(N,"TR",{class:!0});var $=b(e);l=c($,"TD",{class:!0});var L=b(l);n=S(L,s),f=S(L,":"),g=S(L,o),L.forEach(r),m=D($),_=c($,"TD",{class:!0});var z=b(_);v=S(z,p),z.forEach(r),y=D($),I=c($,"TD",{class:!0});var O=b(I);C=S(O,w),O.forEach(r),T=D($),P=c($,"TD",{class:!0});var B=b(P);H.l(B),B.forEach(r),M=D($),$.forEach(r),this.h()},h(){u(l,"class","p-2 text-gray-300"),u(_,"class","p-2 text-gray-300"),u(I,"class","p-2 text-gray-300"),u(P,"class","p-2"),u(e,"class","border-b border-gray-800/50")},m(N,$){X(N,e,$),t(e,l),t(l,n),t(l,f),t(l,g),t(e,m),t(e,_),t(_,v),t(e,y),t(e,I),t(I,C),t(e,T),t(e,P),H.m(P,null),t(e,M)},p(N,$){$[0]&4&&s!==(s=N[31].dst_ip+"")&&G(n,s),$[0]&4&&o!==(o=N[31].dst_port+"")&&G(g,o),$[0]&4&&p!==(p=N[31].version+"")&&G(v,p),$[0]&4&&w!==(w=N[31].cipher_suite+"")&&G(C,w),j!==(j=A(N))&&(H.d(1),H=j(N),H&&(H.c(),H.m(P,null)))},d(N){N&&r(e),H.d()}}}function jt(a){let e,l,s,n="New Packet Capture",f,o,g,m,_="Interface",p,v,y,I="Select interface...",w,C,T,P="BPF Filter (optional)",M,A,j,H,N,$,L="Duration (seconds)",z,O,B,J,R,re="Buffer (MB)",k,h,d,E,K,W,ee,U="Promiscuous mode",F,q,Y,Q="Cancel",le,ae,_e=a[5]?"Starting...":"Start Capture",ue,te,ie,oe,we=$e(a[0]),pe=[];for(let ne=0;ne<we.length;ne+=1)pe[ne]=Ot(dt(a,we,ne));return{c(){e=i("div"),l=i("div"),s=i("h3"),s.textContent=n,f=x(),o=i("div"),g=i("div"),m=i("label"),m.textContent=_,p=x(),v=i("select"),y=i("option"),y.textContent=I;for(let ne=0;ne<pe.length;ne+=1)pe[ne].c();w=x(),C=i("div"),T=i("label"),T.textContent=P,M=x(),A=i("input"),j=x(),H=i("div"),N=i("div"),$=i("label"),$.textContent=L,z=x(),O=i("input"),B=x(),J=i("div"),R=i("label"),R.textContent=re,k=x(),h=i("input"),d=x(),E=i("div"),K=i("input"),W=x(),ee=i("label"),ee.textContent=U,F=x(),q=i("div"),Y=i("button"),Y.textContent=Q,le=x(),ae=i("button"),ue=V(_e),this.h()},l(ne){e=c(ne,"DIV",{class:!0});var Ee=b(e);l=c(Ee,"DIV",{class:!0});var fe=b(l);s=c(fe,"H3",{class:!0,"data-svelte-h":!0}),de(s)!=="svelte-l3lhpi"&&(s.textContent=n),f=D(fe),o=c(fe,"DIV",{class:!0});var ke=b(o);g=c(ke,"DIV",{});var xe=b(g);m=c(xe,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),de(m)!=="svelte-1cxi2g1"&&(m.textContent=_),p=D(xe),v=c(xe,"SELECT",{id:!0,class:!0});var ye=b(v);y=c(ye,"OPTION",{"data-svelte-h":!0}),de(y)!=="svelte-5wx007"&&(y.textContent=I);for(let Ce=0;Ce<pe.length;Ce+=1)pe[Ce].l(ye);ye.forEach(r),xe.forEach(r),w=D(ke),C=c(ke,"DIV",{});var De=b(C);T=c(De,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),de(T)!=="svelte-14q4y8c"&&(T.textContent=P),M=D(De),A=c(De,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),De.forEach(r),j=D(ke),H=c(ke,"DIV",{class:!0});var me=b(H);N=c(me,"DIV",{});var be=b(N);$=c(be,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),de($)!=="svelte-589u7z"&&($.textContent=L),z=D(be),O=c(be,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),be.forEach(r),B=D(me),J=c(me,"DIV",{});var ge=b(J);R=c(ge,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),de(R)!=="svelte-cycvu1"&&(R.textContent=re),k=D(ge),h=c(ge,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),ge.forEach(r),me.forEach(r),d=D(ke),E=c(ke,"DIV",{class:!0});var Z=b(E);K=c(Z,"INPUT",{id:!0,type:!0,class:!0}),W=D(Z),ee=c(Z,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),de(ee)!=="svelte-1xen35p"&&(ee.textContent=U),Z.forEach(r),ke.forEach(r),F=D(fe),q=c(fe,"DIV",{class:!0});var ve=b(q);Y=c(ve,"BUTTON",{class:!0,"data-svelte-h":!0}),de(Y)!=="svelte-pr9zi"&&(Y.textContent=Q),le=D(ve),ae=c(ve,"BUTTON",{class:!0});var se=b(ae);ue=S(se,_e),se.forEach(r),ve.forEach(r),fe.forEach(r),Ee.forEach(r),this.h()},h(){u(s,"class","text-lg font-semibold text-white mb-4"),u(m,"for","interface"),u(m,"class","block text-sm font-medium text-gray-300 mb-1"),y.__value="",Ne(y,y.__value),u(v,"id","interface"),u(v,"class","w-full p-2 bg-black/20 border border-gray-600 rounded text-white focus:border-cyan-400 focus:outline-none"),a[6].interface===void 0&&Qt(()=>a[17].call(v)),u(T,"for","filter"),u(T,"class","block text-sm font-medium text-gray-300 mb-1"),u(A,"id","filter"),u(A,"type","text"),u(A,"placeholder","e.g., tcp port 80"),u(A,"class","w-full p-2 bg-black/20 border border-gray-600 rounded text-white focus:border-cyan-400 focus:outline-none"),u($,"for","duration"),u($,"class","block text-sm font-medium text-gray-300 mb-1"),u(O,"id","duration"),u(O,"type","number"),u(O,"min","1"),u(O,"max","3600"),u(O,"class","w-full p-2 bg-black/20 border border-gray-600 rounded text-white focus:border-cyan-400 focus:outline-none"),u(R,"for","buffer"),u(R,"class","block text-sm font-medium text-gray-300 mb-1"),u(h,"id","buffer"),u(h,"type","number"),u(h,"min","1"),u(h,"max","1024"),u(h,"class","w-full p-2 bg-black/20 border border-gray-600 rounded text-white focus:border-cyan-400 focus:outline-none"),u(H,"class","grid grid-cols-2 gap-4"),u(K,"id","promiscuous"),u(K,"type","checkbox"),u(K,"class","mr-2"),u(ee,"for","promiscuous"),u(ee,"class","text-sm text-gray-300"),u(E,"class","flex items-center"),u(o,"class","space-y-4"),u(Y,"class","px-4 py-2 text-gray-400 hover:text-white transition-colors"),ae.disabled=te=!a[6].interface||a[5],u(ae,"class","px-4 py-2 bg-cyan-500 hover:bg-cyan-600 text-white rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),u(q,"class","flex justify-end space-x-2 mt-6"),u(l,"class","frosted p-6 rounded-lg border border-gray-700/50 w-96 max-w-[90vw]"),u(e,"class","fixed inset-0 bg-black/50 flex items-center justify-center z-50")},m(ne,Ee){X(ne,e,Ee),t(e,l),t(l,s),t(l,f),t(l,o),t(o,g),t(g,m),t(g,p),t(g,v),t(v,y);for(let fe=0;fe<pe.length;fe+=1)pe[fe]&&pe[fe].m(v,null);ct(v,a[6].interface,!0),t(o,w),t(o,C),t(C,T),t(C,M),t(C,A),Ne(A,a[6].filter),t(o,j),t(o,H),t(H,N),t(N,$),t(N,z),t(N,O),Ne(O,a[6].duration_seconds),t(H,B),t(H,J),t(J,R),t(J,k),t(J,h),Ne(h,a[6].buffer_size_mb),t(o,d),t(o,E),t(E,K),K.checked=a[6].promiscuous_mode,t(E,W),t(E,ee),t(l,F),t(l,q),t(q,Y),t(q,le),t(q,ae),t(ae,ue),ie||(oe=[Ie(v,"change",a[17]),Ie(A,"input",a[18]),Ie(O,"input",a[19]),Ie(h,"input",a[20]),Ie(K,"change",a[21]),Ie(Y,"click",a[22]),Ie(ae,"click",a[7])],ie=!0)},p(ne,Ee){if(Ee[0]&1){we=$e(ne[0]);let fe;for(fe=0;fe<we.length;fe+=1){const ke=dt(ne,we,fe);pe[fe]?pe[fe].p(ke,Ee):(pe[fe]=Ot(ke),pe[fe].c(),pe[fe].m(v,null))}for(;fe<pe.length;fe+=1)pe[fe].d(1);pe.length=we.length}Ee[0]&65&&ct(v,ne[6].interface),Ee[0]&65&&A.value!==ne[6].filter&&Ne(A,ne[6].filter),Ee[0]&65&&Xe(O.value)!==ne[6].duration_seconds&&Ne(O,ne[6].duration_seconds),Ee[0]&65&&Xe(h.value)!==ne[6].buffer_size_mb&&Ne(h,ne[6].buffer_size_mb),Ee[0]&65&&(K.checked=ne[6].promiscuous_mode),Ee[0]&32&&_e!==(_e=ne[5]?"Starting...":"Start Capture")&&G(ue,_e),Ee[0]&97&&te!==(te=!ne[6].interface||ne[5])&&(ae.disabled=te)},d(ne){ne&&r(e),Me(pe,ne),ie=!1,Ze(oe)}}}function Ot(a){let e,l=a[28].name+"",s,n,f=a[28].description+"",o,g,m=a[28].policy_allowed?"":"(Policy Restricted)",_,p,v,y;return{c(){e=i("option"),s=V(l),n=V(" - "),o=V(f),g=x(),_=V(m),p=x(),this.h()},l(I){e=c(I,"OPTION",{});var w=b(e);s=S(w,l),n=S(w," - "),o=S(w,f),g=D(w),_=S(w,m),p=D(w),w.forEach(r),this.h()},h(){e.__value=v=a[28].name,Ne(e,e.__value),e.disabled=y=!a[28].policy_allowed},m(I,w){X(I,e,w),t(e,s),t(e,n),t(e,o),t(e,g),t(e,_),t(e,p)},p(I,w){w[0]&1&&l!==(l=I[28].name+"")&&G(s,l),w[0]&1&&f!==(f=I[28].description+"")&&G(o,f),w[0]&1&&m!==(m=I[28].policy_allowed?"":"(Policy Restricted)")&&G(_,m),w[0]&1&&v!==(v=I[28].name)&&(e.__value=v,Ne(e,e.__value)),w[0]&1&&y!==(y=!I[28].policy_allowed)&&(e.disabled=y)},d(I){I&&r(e)}}}function dl(a){let e,l,s,n,f,o,g,m,_="PCAP Studio",p,v,y,I,w,C,T,P,M="Post-Quantum Secured",A,j,H,N,$,L,z,O,B,J,R,re;o=new Je({props:{class:"w-5 h-5 text-cyan-400"}}),y=new sl({props:{size:16}}),C=new et({props:{class:"w-4 h-4 text-green-400"}});let k=$e(a[1]),h=[];for(let F=0;F<k.length;F+=1)h[F]=gt(mt(a,k,F));const d=F=>he(h[F],1,1,()=>{h[F]=null});let E=a[1].length===0&&yt();const K=[nl,rl],W=[];function ee(F,q){return F[2]?0:1}L=ee(a),z=W[L]=K[L](a);let U=a[3]&&jt(a);return{c(){e=i("div"),l=i("div"),s=i("div"),n=i("div"),f=i("div"),Ve(o.$$.fragment),g=x(),m=i("h2"),m.textContent=_,p=x(),v=i("button"),Ve(y.$$.fragment),I=x(),w=i("div"),Ve(C.$$.fragment),T=x(),P=i("span"),P.textContent=M,A=x(),j=i("div");for(let F=0;F<h.length;F+=1)h[F].c();H=x(),E&&E.c(),N=x(),$=i("div"),z.c(),O=x(),U&&U.c(),B=We(),this.h()},l(F){e=c(F,"DIV",{class:!0});var q=b(e);l=c(q,"DIV",{class:!0});var Y=b(l);s=c(Y,"DIV",{class:!0});var Q=b(s);n=c(Q,"DIV",{class:!0});var le=b(n);f=c(le,"DIV",{class:!0});var ae=b(f);Te(o.$$.fragment,ae),g=D(ae),m=c(ae,"H2",{class:!0,"data-svelte-h":!0}),de(m)!=="svelte-2lf82c"&&(m.textContent=_),ae.forEach(r),p=D(le),v=c(le,"BUTTON",{class:!0,title:!0});var _e=b(v);Te(y.$$.fragment,_e),_e.forEach(r),le.forEach(r),I=D(Q),w=c(Q,"DIV",{class:!0});var ue=b(w);Te(C.$$.fragment,ue),T=D(ue),P=c(ue,"SPAN",{"data-svelte-h":!0}),de(P)!=="svelte-4r02vj"&&(P.textContent=M),ue.forEach(r),Q.forEach(r),A=D(Y),j=c(Y,"DIV",{class:!0});var te=b(j);for(let oe=0;oe<h.length;oe+=1)h[oe].l(te);H=D(te),E&&E.l(te),te.forEach(r),Y.forEach(r),N=D(q),$=c(q,"DIV",{class:!0});var ie=b($);z.l(ie),ie.forEach(r),q.forEach(r),O=D(F),U&&U.l(F),B=We(),this.h()},h(){u(m,"class","text-lg font-semibold text-white"),u(f,"class","flex items-center space-x-2"),u(v,"class","p-2 rounded-lg bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 transition-colors"),u(v,"title","New Capture"),v.disabled=a[5],u(n,"class","flex items-center justify-between mb-4"),u(w,"class","flex items-center space-x-2 text-sm text-gray-400"),u(s,"class","p-4 border-b border-gray-800/50"),u(j,"class","flex-1 overflow-y-auto p-4 space-y-2"),u(l,"class","w-80 frosted border-r border-gray-800/50 flex flex-col"),u($,"class","flex-1 flex flex-col"),u(e,"class","h-full flex")},m(F,q){X(F,e,q),t(e,l),t(l,s),t(s,n),t(n,f),Se(o,f,null),t(f,g),t(f,m),t(n,p),t(n,v),Se(y,v,null),t(s,I),t(s,w),Se(C,w,null),t(w,T),t(w,P),t(l,A),t(l,j);for(let Y=0;Y<h.length;Y+=1)h[Y]&&h[Y].m(j,null);t(j,H),E&&E.m(j,null),t(e,N),t(e,$),W[L].m($,null),X(F,O,q),U&&U.m(F,q),X(F,B,q),J=!0,R||(re=Ie(v,"click",a[11]),R=!0)},p(F,q){if((!J||q[0]&32)&&(v.disabled=F[5]),q[0]&1286){k=$e(F[1]);let Q;for(Q=0;Q<k.length;Q+=1){const le=mt(F,k,Q);h[Q]?(h[Q].p(le,q),ce(h[Q],1)):(h[Q]=gt(le),h[Q].c(),ce(h[Q],1),h[Q].m(j,H))}for(Le(),Q=k.length;Q<h.length;Q+=1)d(Q);Be()}F[1].length===0?E?q[0]&2&&ce(E,1):(E=yt(),E.c(),ce(E,1),E.m(j,null)):E&&(Le(),he(E,1,1,()=>{E=null}),Be());let Y=L;L=ee(F),L===Y?W[L].p(F,q):(Le(),he(W[Y],1,1,()=>{W[Y]=null}),Be(),z=W[L],z?z.p(F,q):(z=W[L]=K[L](F),z.c()),ce(z,1),z.m($,null)),F[3]?U?U.p(F,q):(U=jt(F),U.c(),U.m(B.parentNode,B)):U&&(U.d(1),U=null)},i(F){if(!J){ce(o.$$.fragment,F),ce(y.$$.fragment,F),ce(C.$$.fragment,F);for(let q=0;q<k.length;q+=1)ce(h[q]);ce(E),ce(z),J=!0}},o(F){he(o.$$.fragment,F),he(y.$$.fragment,F),he(C.$$.fragment,F),h=h.filter(Boolean);for(let q=0;q<h.length;q+=1)he(h[q]);he(E),he(z),J=!1},d(F){F&&(r(e),r(O),r(B)),Pe(o),Pe(y),Pe(C),Me(h,F),E&&E.d(),W[L].d(),U&&U.d(F),R=!1,re()}}}function Fe(a){switch(a){case"Completed":return"text-green-400";case"Failed":return"text-red-400";case"PolicyDenied":return"text-yellow-400";case"Running":return"text-cyan-400";case"Starting":return"text-blue-400";case"Stopping":return"text-orange-400";default:return"text-gray-400"}}function Mt(a){switch(a){case"Critical":return"text-red-400";case"High":return"text-orange-400";case"Medium":return"text-yellow-400";case"Low":return"text-blue-400";default:return"text-gray-400"}}function Ae(a){if(a===0)return"0 B";const e=1024,l=["B","KB","MB","GB"],s=Math.floor(Math.log(a)/Math.log(e));return parseFloat((a/Math.pow(e,s)).toFixed(2))+" "+l[s]}function zt(a){if(a<1e3)return`${a}ms`;const e=Math.floor(a/1e3);if(e<60)return`${e}s`;const l=Math.floor(e/60),s=e%60;return`${l}m ${s}s`}function _l(a,e,l){let s=[],n=[],f=null,o=!1,g=!1,m=!1,_={interface:"",filter:"",duration_seconds:60,max_packets:1e4,max_bytes:100*1024*1024,promiscuous_mode:!1,buffer_size_mb:32},p=null;Rt(async()=>{await v(),await y(),p=await ll("pcap-progress",k=>{T(k.payload)})}),qt(()=>{p&&p()});async function v(){try{l(0,s=await Oe("pcap_get_interfaces"))}catch(k){console.error("Failed to load interfaces:",k)}}async function y(){try{l(1,n=await Oe("pcap_list_captures"))}catch(k){console.error("Failed to load captures:",k)}}async function I(){if(!_.interface){alert("Please select an interface");return}l(5,m=!0),l(3,o=!1);try{const k={interface:_.interface,filter:_.filter||void 0,duration_seconds:_.duration_seconds||void 0,max_packets:_.max_packets||void 0,max_bytes:_.max_bytes||void 0,promiscuous_mode:_.promiscuous_mode,buffer_size_mb:_.buffer_size_mb},h=await Oe("pcap_start_capture",{config:k});C(h),await y()}catch(k){console.error("Failed to start capture:",k),alert(`Failed to start capture: ${k}`)}finally{l(5,m=!1)}}async function w(k){try{await Oe("pcap_stop_capture",{captureId:k}),await y()}catch(h){console.error("Failed to stop capture:",h),alert(`Failed to stop capture: ${h}`)}}async function C(k){const h=setInterval(async()=>{try{const d=await Oe("pcap_get_capture_status",{captureId:k});d&&(l(1,n=n.map(E=>E.id===k?d:E)),f&&f.id===k&&l(2,f=d),(d.status==="Completed"||d.status==="Failed"||d.status==="PolicyDenied")&&clearInterval(h))}catch(d){console.error("Failed to poll capture status:",d),clearInterval(h)}},1e3)}function T(k){l(1,n=n.map(h=>h.id===k.capture_id?{...h,packet_count:k.packet_count,bytes_captured:k.bytes_captured}:h)),f&&f.id===k.capture_id&&l(2,f={...f,packet_count:k.packet_count,bytes_captured:k.bytes_captured})}async function P(k,h){try{const d=await Oe("pcap_export_results",{captureId:k,format:h}),E=new Blob([d],{type:h==="json"?"application/json":"text/csv"}),K=URL.createObjectURL(E),W=document.createElement("a");W.href=K,W.download=`pcap-${k}.${h}`,W.click(),URL.revokeObjectURL(K)}catch(d){console.error("Failed to export results:",d),alert(`Export failed: ${d}`)}}function M(k){switch(k){case"Completed":return Gt;case"Failed":return al;case"PolicyDenied":return et;case"Running":return Je;case"Starting":return ft;case"Stopping":return Ht;default:return ft}}const A=()=>l(3,o=!0),j=k=>w(k.id),H=k=>l(2,f=k),N=(k,h)=>h.key==="Enter"&&l(2,f=k),$=()=>l(4,g=!g),L=()=>f&&P(f.id,"json");function z(){_.interface=Wt(this),l(6,_),l(0,s)}function O(){_.filter=this.value,l(6,_),l(0,s)}function B(){_.duration_seconds=Xe(this.value),l(6,_),l(0,s)}function J(){_.buffer_size_mb=Xe(this.value),l(6,_),l(0,s)}function R(){_.promiscuous_mode=this.checked,l(6,_),l(0,s)}return[s,n,f,o,g,m,_,I,w,P,M,A,j,H,N,$,L,z,O,B,J,R,()=>l(3,o=!1)]}class El extends Jt{constructor(e){super(),Yt(this,e,_l,dl,Ut,{},null,[-1,-1])}}export{El as default};
