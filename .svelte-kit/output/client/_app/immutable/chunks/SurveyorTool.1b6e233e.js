import{s as zt,f as c,a as k,e as ut,g as f,h as g,c as I,O as te,d as p,j as u,i as le,x as t,M as ke,J as dt,o as Jt,q as ct,l as W,m as Z,n as ae,R as Xe,X as Ke,E as pt,k as kt,y as nt}from"./scheduler.a8b88eab.js";import{S as Qt,i as Xt,b as Te,d as Oe,m as Ae,a as M,g as Pe,c as $e,t as G,e as Re}from"./index.8884acef.js";import{m as ht,b as ft,e as ot,h as It,n as Wt,W as Zt,Z as Yt,B as Gt}from"./2.20172fad.js";import{i as it}from"./theme.50793ec2.js";import{l as Kt}from"./event.4deddad1.js";import{P as el}from"./play.a30cea0f.js";import{C as tl}from"./clock.9e5fbce5.js";import{X as ll}from"./circle-x.b8f80171.js";import{T as sl}from"./target.da3c9d66.js";import{D as rl}from"./download.acbd7ea8.js";function Dt(i,e,l){const r=i.slice();return r[30]=e[l],r}function Pt(i,e,l){const r=i.slice();return r[27]=e[l],r}function $t(i,e,l){const r=i.slice();return r[33]=e[l],r}function Vt(i){let e,l;return{c(){e=c("div"),l=c("div"),this.h()},l(r){e=f(r,"DIV",{class:!0});var s=g(e);l=f(s,"DIV",{class:!0,style:!0}),g(l).forEach(p),s.forEach(p),this.h()},h(){u(l,"class","bg-cyan-400 h-1.5 rounded-full transition-all duration-300"),kt(l,"width",i[33].progress+"%"),u(e,"class","w-full bg-gray-700 rounded-full h-1.5 mb-2")},m(r,s){le(r,e,s),t(e,l)},p(r,s){s[0]&1&&kt(l,"width",r[33].progress+"%")},d(r){r&&p(e)}}}function Nt(i){let e,l,r,s,a,o,n=i[33].target+"",h,m,d,_=new Date(i[33].started_at).toLocaleTimeString()+"",D,V,T,y,U,w,R=i[33].status+"",J,q,O,L,j,x;var P=i[8](i[33].status);function $(E,C){return{props:{class:"w-4 h-4 "+at(E[33].status)}}}P&&(s=ct(P,$(i)));let S=i[33].status==="Running"&&Vt(i);function N(){return i[11](i[33])}return{c(){e=c("div"),l=c("div"),r=c("div"),s&&Te(s.$$.fragment),a=k(),o=c("span"),h=W(n),m=k(),d=c("span"),D=W(_),V=k(),S&&S.c(),T=k(),y=c("div"),U=W("Status: "),w=c("span"),J=W(R),this.h()},l(E){e=f(E,"DIV",{class:!0});var C=g(e);l=f(C,"DIV",{class:!0});var b=g(l);r=f(b,"DIV",{class:!0});var v=g(r);s&&Oe(s.$$.fragment,v),a=I(v),o=f(v,"SPAN",{class:!0});var z=g(o);h=Z(z,n),z.forEach(p),v.forEach(p),m=I(b),d=f(b,"SPAN",{class:!0});var F=g(d);D=Z(F,_),F.forEach(p),b.forEach(p),V=I(C),S&&S.l(C),T=I(C),y=f(C,"DIV",{class:!0});var ee=g(y);U=Z(ee,"Status: "),w=f(ee,"SPAN",{class:!0});var H=g(w);J=Z(H,R),H.forEach(p),ee.forEach(p),C.forEach(p),this.h()},h(){var E;u(o,"class","text-white font-medium text-sm"),u(r,"class","flex items-center space-x-2"),u(d,"class","text-xs text-gray-400"),u(l,"class","flex items-center justify-between mb-2"),u(w,"class",q=at(i[33].status)),u(y,"class","text-xs text-gray-400"),u(e,"class",O="p-3 rounded-lg border transition-all cursor-pointer "+(((E=i[1])==null?void 0:E.id)===i[33].id?"bg-cyan-500/10 border-cyan-500/50":"bg-black/20 border-gray-700/50 hover:border-gray-600/50"))},m(E,C){le(E,e,C),t(e,l),t(l,r),s&&Ae(s,r,null),t(r,a),t(r,o),t(o,h),t(l,m),t(l,d),t(d,D),t(e,V),S&&S.m(e,null),t(e,T),t(e,y),t(y,U),t(y,w),t(w,J),L=!0,j||(x=ke(e,"click",N),j=!0)},p(E,C){var b;if(i=E,C[0]&1&&P!==(P=i[8](i[33].status))){if(s){Pe();const v=s;G(v.$$.fragment,1,0,()=>{Re(v,1)}),$e()}P?(s=ct(P,$(i)),Te(s.$$.fragment),M(s.$$.fragment,1),Ae(s,r,a)):s=null}else if(P){const v={};C[0]&1&&(v.class="w-4 h-4 "+at(i[33].status)),s.$set(v)}(!L||C[0]&1)&&n!==(n=i[33].target+"")&&ae(h,n),(!L||C[0]&1)&&_!==(_=new Date(i[33].started_at).toLocaleTimeString()+"")&&ae(D,_),i[33].status==="Running"?S?S.p(i,C):(S=Vt(i),S.c(),S.m(e,T)):S&&(S.d(1),S=null),(!L||C[0]&1)&&R!==(R=i[33].status+"")&&ae(J,R),(!L||C[0]&1&&q!==(q=at(i[33].status)))&&u(w,"class",q),(!L||C[0]&3&&O!==(O="p-3 rounded-lg border transition-all cursor-pointer "+(((b=i[1])==null?void 0:b.id)===i[33].id?"bg-cyan-500/10 border-cyan-500/50":"bg-black/20 border-gray-700/50 hover:border-gray-600/50")))&&u(e,"class",O)},i(E){L||(s&&M(s.$$.fragment,E),L=!0)},o(E){s&&G(s.$$.fragment,E),L=!1},d(E){E&&p(e),s&&Re(s),S&&S.d(),j=!1,x()}}}function Tt(i){let e,l,r,s,a="No scans yet",o,n,h="Start your first network survey",m;return l=new ht({props:{class:"w-12 h-12 mx-auto mb-4 opacity-50"}}),{c(){e=c("div"),Te(l.$$.fragment),r=k(),s=c("p"),s.textContent=a,o=k(),n=c("p"),n.textContent=h,this.h()},l(d){e=f(d,"DIV",{class:!0});var _=g(e);Oe(l.$$.fragment,_),r=I(_),s=f(_,"P",{"data-svelte-h":!0}),te(s)!=="svelte-set971"&&(s.textContent=a),o=I(_),n=f(_,"P",{class:!0,"data-svelte-h":!0}),te(n)!=="svelte-ejrdy8"&&(n.textContent=h),_.forEach(p),this.h()},h(){u(n,"class","text-sm"),u(e,"class","text-center text-gray-400 py-8")},m(d,_){le(d,e,_),Ae(l,e,null),t(e,r),t(e,s),t(e,o),t(e,n),m=!0},i(d){m||(M(l.$$.fragment,d),m=!0)},o(d){G(l.$$.fragment,d),m=!1},d(d){d&&p(e),Re(l)}}}function al(i){let e,l,r,s,a,o="No Scan Selected",n,h,m="Select a scan from the sidebar or start a new one",d;return r=new sl({props:{class:"w-16 h-16 mx-auto mb-4 opacity-50"}}),{c(){e=c("div"),l=c("div"),Te(r.$$.fragment),s=k(),a=c("h3"),a.textContent=o,n=k(),h=c("p"),h.textContent=m,this.h()},l(_){e=f(_,"DIV",{class:!0});var D=g(e);l=f(D,"DIV",{class:!0});var V=g(l);Oe(r.$$.fragment,V),s=I(V),a=f(V,"H3",{class:!0,"data-svelte-h":!0}),te(a)!=="svelte-wx0lyl"&&(a.textContent=o),n=I(V),h=f(V,"P",{"data-svelte-h":!0}),te(h)!=="svelte-xhrs6d"&&(h.textContent=m),V.forEach(p),D.forEach(p),this.h()},h(){u(a,"class","text-xl font-semibold mb-2"),u(l,"class","text-center"),u(e,"class","flex-1 flex items-center justify-center text-gray-400")},m(_,D){le(_,e,D),t(e,l),Ae(r,l,null),t(l,s),t(l,a),t(l,n),t(l,h),d=!0},p:nt,i(_){d||(M(r.$$.fragment,_),d=!0)},o(_){G(r.$$.fragment,_),d=!1},d(_){_&&p(e),Re(r)}}}function nl(i){let e,l,r,s,a=i[1].target+"",o,n,h,m,d,_=new Date(i[1].started_at).toLocaleString()+"",D,V,T,y,U=i[1].status+"",w,R,J,q,O,L,j,x,P,$=i[1].completed_at&&At(i),S=i[1].results&&Rt(i);const N=[il,ol],E=[];function C(b,v){return b[5]&&b[1].results?0:1}return j=C(i),x=E[j]=N[j](i),{c(){e=c("div"),l=c("div"),r=c("div"),s=c("h3"),o=W(a),n=k(),h=c("div"),m=c("span"),d=W("Started: "),D=W(_),V=k(),$&&$.c(),T=k(),y=c("span"),w=W(U),J=k(),q=c("div"),S&&S.c(),O=k(),L=c("div"),x.c(),this.h()},l(b){e=f(b,"DIV",{class:!0});var v=g(e);l=f(v,"DIV",{class:!0});var z=g(l);r=f(z,"DIV",{});var F=g(r);s=f(F,"H3",{class:!0});var ee=g(s);o=Z(ee,a),ee.forEach(p),n=I(F),h=f(F,"DIV",{class:!0});var H=g(h);m=f(H,"SPAN",{});var re=g(m);d=Z(re,"Started: "),D=Z(re,_),re.forEach(p),V=I(H),$&&$.l(H),T=I(H),y=f(H,"SPAN",{class:!0});var Y=g(y);w=Z(Y,U),Y.forEach(p),H.forEach(p),F.forEach(p),J=I(z),q=f(z,"DIV",{class:!0});var A=g(q);S&&S.l(A),A.forEach(p),z.forEach(p),v.forEach(p),O=I(b),L=f(b,"DIV",{class:!0});var B=g(L);x.l(B),B.forEach(p),this.h()},h(){u(s,"class","text-xl font-semibold text-white mb-1"),u(y,"class",R=at(i[1].status)),u(h,"class","flex items-center space-x-4 text-sm text-gray-400"),u(q,"class","flex items-center space-x-2"),u(l,"class","flex items-center justify-between"),u(e,"class","frosted border-b border-gray-800/50 p-4"),u(L,"class","flex-1 overflow-hidden")},m(b,v){le(b,e,v),t(e,l),t(l,r),t(r,s),t(s,o),t(r,n),t(r,h),t(h,m),t(m,d),t(m,D),t(h,V),$&&$.m(h,null),t(h,T),t(h,y),t(y,w),t(l,J),t(l,q),S&&S.m(q,null),le(b,O,v),le(b,L,v),E[j].m(L,null),P=!0},p(b,v){(!P||v[0]&2)&&a!==(a=b[1].target+"")&&ae(o,a),(!P||v[0]&2)&&_!==(_=new Date(b[1].started_at).toLocaleString()+"")&&ae(D,_),b[1].completed_at?$?$.p(b,v):($=At(b),$.c(),$.m(h,T)):$&&($.d(1),$=null),(!P||v[0]&2)&&U!==(U=b[1].status+"")&&ae(w,U),(!P||v[0]&2&&R!==(R=at(b[1].status)))&&u(y,"class",R),b[1].results?S?(S.p(b,v),v[0]&2&&M(S,1)):(S=Rt(b),S.c(),M(S,1),S.m(q,null)):S&&(Pe(),G(S,1,1,()=>{S=null}),$e());let z=j;j=C(b),j===z?E[j].p(b,v):(Pe(),G(E[z],1,1,()=>{E[z]=null}),$e(),x=E[j],x?x.p(b,v):(x=E[j]=N[j](b),x.c()),M(x,1),x.m(L,null))},i(b){P||(M(S),M(x),P=!0)},o(b){G(S),G(x),P=!1},d(b){b&&(p(e),p(O),p(L)),$&&$.d(),S&&S.d(),E[j].d()}}}function At(i){let e,l,r=new Date(i[1].completed_at).toLocaleString()+"",s;return{c(){e=c("span"),l=W("Completed: "),s=W(r)},l(a){e=f(a,"SPAN",{});var o=g(e);l=Z(o,"Completed: "),s=Z(o,r),o.forEach(p)},m(a,o){le(a,e,o),t(e,l),t(e,s)},p(a,o){o[0]&2&&r!==(r=new Date(a[1].completed_at).toLocaleString()+"")&&ae(s,r)},d(a){a&&p(e)}}}function Rt(i){let e,l=i[5]?"Terminal View":"Intel Panel",r,s,a,o,n,h,m;return o=new rl({props:{size:16}}),{c(){e=c("button"),r=W(l),s=k(),a=c("button"),Te(o.$$.fragment),this.h()},l(d){e=f(d,"BUTTON",{class:!0});var _=g(e);r=Z(_,l),_.forEach(p),s=I(d),a=f(d,"BUTTON",{class:!0,title:!0});var D=g(a);Oe(o.$$.fragment,D),D.forEach(p),this.h()},h(){u(e,"class","px-3 py-2 bg-purple-500/20 hover:bg-purple-500/30 border border-purple-500/50 rounded-lg text-purple-400 text-sm transition-colors"),u(a,"class","p-2 rounded-lg bg-green-500/20 hover:bg-green-500/30 text-green-400 transition-colors"),u(a,"title","Export JSON")},m(d,_){le(d,e,_),t(e,r),le(d,s,_),le(d,a,_),Ae(o,a,null),n=!0,h||(m=[ke(e,"click",i[12]),ke(a,"click",i[13])],h=!0)},p(d,_){(!n||_[0]&32)&&l!==(l=d[5]?"Terminal View":"Intel Panel")&&ae(r,l)},i(d){n||(M(o.$$.fragment,d),n=!0)},o(d){G(o.$$.fragment,d),n=!1},d(d){d&&(p(e),p(s),p(a)),Re(o),h=!1,pt(m)}}}function ol(i){let e,l,r,s=ot(i[1].logs),a=[];for(let n=0;n<s.length;n+=1)a[n]=Lt(Dt(i,s,n));let o=i[1].status==="Running"&&jt(i);return{c(){e=c("div"),l=c("div");for(let n=0;n<a.length;n+=1)a[n].c();r=k(),o&&o.c(),this.h()},l(n){e=f(n,"DIV",{class:!0});var h=g(e);l=f(h,"DIV",{class:!0});var m=g(l);for(let d=0;d<a.length;d+=1)a[d].l(m);r=I(m),o&&o.l(m),m.forEach(p),h.forEach(p),this.h()},h(){u(l,"class","flex-1 overflow-y-auto p-4 bg-black/10 font-mono text-sm"),u(e,"class","h-full flex flex-col")},m(n,h){le(n,e,h),t(e,l);for(let m=0;m<a.length;m+=1)a[m]&&a[m].m(l,null);t(l,r),o&&o.m(l,null)},p(n,h){if(h[0]&2){s=ot(n[1].logs);let m;for(m=0;m<s.length;m+=1){const d=Dt(n,s,m);a[m]?a[m].p(d,h):(a[m]=Lt(d),a[m].c(),a[m].m(l,r))}for(;m<a.length;m+=1)a[m].d(1);a.length=s.length}n[1].status==="Running"?o?o.p(n,h):(o=jt(n),o.c(),o.m(l,null)):o&&(o.d(1),o=null)},i:nt,o:nt,d(n){n&&p(e),dt(a,n),o&&o.d()}}}function il(i){var a;let e,l,r,s=((a=i[1].results)==null?void 0:a.Surveyor)&&Ft(i);return{c(){e=c("div"),l=c("div"),s&&s.c(),this.h()},l(o){e=f(o,"DIV",{class:!0});var n=g(e);l=f(n,"DIV",{class:!0});var h=g(l);s&&s.l(h),h.forEach(p),n.forEach(p),this.h()},h(){u(l,"class","space-y-6"),u(e,"class","h-full overflow-y-auto p-6")},m(o,n){le(o,e,n),t(e,l),s&&s.m(l,null),r=!0},p(o,n){var h;(h=o[1].results)!=null&&h.Surveyor?s?(s.p(o,n),n[0]&2&&M(s,1)):(s=Ft(o),s.c(),M(s,1),s.m(l,null)):s&&(Pe(),G(s,1,1,()=>{s=null}),$e())},i(o){r||(M(s),r=!0)},o(o){G(s),r=!1},d(o){o&&p(e),s&&s.d()}}}function Lt(i){let e,l=i[30]+"",r;return{c(){e=c("div"),r=W(l),this.h()},l(s){e=f(s,"DIV",{class:!0});var a=g(e);r=Z(a,l),a.forEach(p),this.h()},h(){u(e,"class","text-gray-300 mb-1")},m(s,a){le(s,e,a),t(e,r)},p(s,a){a[0]&2&&l!==(l=s[30]+"")&&ae(r,l)},d(s){s&&p(e)}}}function jt(i){let e,l,r=Math.round(i[1].progress)+"",s,a;return{c(){e=c("div"),l=W("Scanning... "),s=W(r),a=W("% complete"),this.h()},l(o){e=f(o,"DIV",{class:!0});var n=g(e);l=Z(n,"Scanning... "),s=Z(n,r),a=Z(n,"% complete"),n.forEach(p),this.h()},h(){u(e,"class","text-cyan-400 animate-pulse")},m(o,n){le(o,e,n),t(e,l),t(e,s),t(e,a)},p(o,n){n[0]&2&&r!==(r=Math.round(o[1].progress)+"")&&ae(s,r)},d(o){o&&p(e)}}}function Ft(i){var R,J,q,O,L,j;let e,l,r="Port Scan Results",s,a,o,n,h='<tr class="border-b border-gray-700"><th class="text-left py-2 text-gray-300">Port</th> <th class="text-left py-2 text-gray-300">Protocol</th> <th class="text-left py-2 text-gray-300">Status</th> <th class="text-left py-2 text-gray-300">Service</th> <th class="text-left py-2 text-gray-300">Version</th></tr>',m,d,_,D,V,T=ot(((J=(R=i[1].results)==null?void 0:R.Surveyor)==null?void 0:J.ports)||[]),y=[];for(let x=0;x<T.length;x+=1)y[x]=Bt(Pt(i,T,x));const U=x=>G(y[x],1,1,()=>{y[x]=null});let w=(((O=(q=i[1].results)==null?void 0:q.Surveyor)==null?void 0:O.throughput)||((j=(L=i[1].results)==null?void 0:L.Surveyor)==null?void 0:j.latency))&&Ut(i);return{c(){e=c("div"),l=c("h4"),l.textContent=r,s=k(),a=c("div"),o=c("table"),n=c("thead"),n.innerHTML=h,m=k(),d=c("tbody");for(let x=0;x<y.length;x+=1)y[x].c();_=k(),w&&w.c(),D=ut(),this.h()},l(x){e=f(x,"DIV",{class:!0});var P=g(e);l=f(P,"H4",{class:!0,"data-svelte-h":!0}),te(l)!=="svelte-1dydr26"&&(l.textContent=r),s=I(P),a=f(P,"DIV",{class:!0});var $=g(a);o=f($,"TABLE",{class:!0});var S=g(o);n=f(S,"THEAD",{"data-svelte-h":!0}),te(n)!=="svelte-qy3ptf"&&(n.innerHTML=h),m=I(S),d=f(S,"TBODY",{});var N=g(d);for(let E=0;E<y.length;E+=1)y[E].l(N);N.forEach(p),S.forEach(p),$.forEach(p),P.forEach(p),_=I(x),w&&w.l(x),D=ut(),this.h()},h(){u(l,"class","text-lg font-semibold text-white mb-4"),u(o,"class","w-full text-sm"),u(a,"class","overflow-x-auto"),u(e,"class","frosted rounded-lg p-6")},m(x,P){le(x,e,P),t(e,l),t(e,s),t(e,a),t(a,o),t(o,n),t(o,m),t(o,d);for(let $=0;$<y.length;$+=1)y[$]&&y[$].m(d,null);le(x,_,P),w&&w.m(x,P),le(x,D,P),V=!0},p(x,P){var $,S,N,E,C,b;if(P[0]&514){T=ot(((S=($=x[1].results)==null?void 0:$.Surveyor)==null?void 0:S.ports)||[]);let v;for(v=0;v<T.length;v+=1){const z=Pt(x,T,v);y[v]?(y[v].p(z,P),M(y[v],1)):(y[v]=Bt(z),y[v].c(),M(y[v],1),y[v].m(d,null))}for(Pe(),v=T.length;v<y.length;v+=1)U(v);$e()}(E=(N=x[1].results)==null?void 0:N.Surveyor)!=null&&E.throughput||(b=(C=x[1].results)==null?void 0:C.Surveyor)!=null&&b.latency?w?(w.p(x,P),P[0]&2&&M(w,1)):(w=Ut(x),w.c(),M(w,1),w.m(D.parentNode,D)):w&&(Pe(),G(w,1,1,()=>{w=null}),$e())},i(x){if(!V){for(let P=0;P<T.length;P+=1)M(y[P]);M(w),V=!0}},o(x){y=y.filter(Boolean);for(let P=0;P<y.length;P+=1)G(y[P]);G(w),V=!1},d(x){x&&(p(e),p(_),p(D)),dt(y,x),w&&w.d(x)}}}function ul(i){let e,l="Unknown";return{c(){e=c("span"),e.textContent=l,this.h()},l(r){e=f(r,"SPAN",{class:!0,"data-svelte-h":!0}),te(e)!=="svelte-14twc8g"&&(e.textContent=l),this.h()},h(){u(e,"class","text-gray-500")},m(r,s){le(r,e,s)},p:nt,i:nt,o:nt,d(r){r&&p(e)}}}function cl(i){let e,l,r,s,a=i[27].service+"",o,n;var h=i[9](i[27].service);function m(d,_){return{props:{class:"w-4 h-4 text-cyan-400"}}}return h&&(l=ct(h,m())),{c(){e=c("div"),l&&Te(l.$$.fragment),r=k(),s=c("span"),o=W(a),this.h()},l(d){e=f(d,"DIV",{class:!0});var _=g(e);l&&Oe(l.$$.fragment,_),r=I(_),s=f(_,"SPAN",{class:!0});var D=g(s);o=Z(D,a),D.forEach(p),_.forEach(p),this.h()},h(){u(s,"class","text-gray-300"),u(e,"class","flex items-center space-x-2")},m(d,_){le(d,e,_),l&&Ae(l,e,null),t(e,r),t(e,s),t(s,o),n=!0},p(d,_){if(_[0]&2&&h!==(h=d[9](d[27].service))){if(l){Pe();const D=l;G(D.$$.fragment,1,0,()=>{Re(D,1)}),$e()}h?(l=ct(h,m()),Te(l.$$.fragment),M(l.$$.fragment,1),Ae(l,e,r)):l=null}(!n||_[0]&2)&&a!==(a=d[27].service+"")&&ae(o,a)},i(d){n||(l&&M(l.$$.fragment,d),n=!0)},o(d){l&&G(l.$$.fragment,d),n=!1},d(d){d&&p(e),l&&Re(l)}}}function Bt(i){let e,l,r=i[27].port+"",s,a,o,n=i[27].protocol+"",h,m,d,_,D=i[27].status+"",V,T,y,U,w,R,J,q,O=(i[27].version||"-")+"",L,j,x;const P=[cl,ul],$=[];function S(N,E){return N[27].service?0:1}return w=S(i),R=$[w]=P[w](i),{c(){e=c("tr"),l=c("td"),s=W(r),a=k(),o=c("td"),h=W(n),m=k(),d=c("td"),_=c("span"),V=W(D),y=k(),U=c("td"),R.c(),J=k(),q=c("td"),L=W(O),j=k(),this.h()},l(N){e=f(N,"TR",{class:!0});var E=g(e);l=f(E,"TD",{class:!0});var C=g(l);s=Z(C,r),C.forEach(p),a=I(E),o=f(E,"TD",{class:!0});var b=g(o);h=Z(b,n),b.forEach(p),m=I(E),d=f(E,"TD",{class:!0});var v=g(d);_=f(v,"SPAN",{class:!0});var z=g(_);V=Z(z,D),z.forEach(p),v.forEach(p),y=I(E),U=f(E,"TD",{class:!0});var F=g(U);R.l(F),F.forEach(p),J=I(E),q=f(E,"TD",{class:!0});var ee=g(q);L=Z(ee,O),ee.forEach(p),j=I(E),E.forEach(p),this.h()},h(){u(l,"class","py-2 text-white font-mono"),u(o,"class","py-2 text-gray-300"),u(_,"class",T=Ot(i[27].status)),u(d,"class","py-2"),u(U,"class","py-2"),u(q,"class","py-2 text-gray-300 font-mono text-xs"),u(e,"class","border-b border-gray-800/50")},m(N,E){le(N,e,E),t(e,l),t(l,s),t(e,a),t(e,o),t(o,h),t(e,m),t(e,d),t(d,_),t(_,V),t(e,y),t(e,U),$[w].m(U,null),t(e,J),t(e,q),t(q,L),t(e,j),x=!0},p(N,E){(!x||E[0]&2)&&r!==(r=N[27].port+"")&&ae(s,r),(!x||E[0]&2)&&n!==(n=N[27].protocol+"")&&ae(h,n),(!x||E[0]&2)&&D!==(D=N[27].status+"")&&ae(V,D),(!x||E[0]&2&&T!==(T=Ot(N[27].status)))&&u(_,"class",T);let C=w;w=S(N),w===C?$[w].p(N,E):(Pe(),G($[C],1,1,()=>{$[C]=null}),$e(),R=$[w],R?R.p(N,E):(R=$[w]=P[w](N),R.c()),M(R,1),R.m(U,null)),(!x||E[0]&2)&&O!==(O=(N[27].version||"-")+"")&&ae(L,O)},i(N){x||(M(R),x=!0)},o(N){G(R),x=!1},d(N){N&&p(e),$[w].d()}}}function Ut(i){var o,n,h,m;let e,l,r,s=((n=(o=i[1].results)==null?void 0:o.Surveyor)==null?void 0:n.throughput)&&Mt(i),a=((m=(h=i[1].results)==null?void 0:h.Surveyor)==null?void 0:m.latency)&&qt(i);return{c(){e=c("div"),s&&s.c(),l=k(),a&&a.c(),this.h()},l(d){e=f(d,"DIV",{class:!0});var _=g(e);s&&s.l(_),l=I(_),a&&a.l(_),_.forEach(p),this.h()},h(){u(e,"class","grid grid-cols-1 md:grid-cols-2 gap-6")},m(d,_){le(d,e,_),s&&s.m(e,null),t(e,l),a&&a.m(e,null),r=!0},p(d,_){var D,V,T,y;(V=(D=d[1].results)==null?void 0:D.Surveyor)!=null&&V.throughput?s?(s.p(d,_),_[0]&2&&M(s,1)):(s=Mt(d),s.c(),M(s,1),s.m(e,l)):s&&(Pe(),G(s,1,1,()=>{s=null}),$e()),(y=(T=d[1].results)==null?void 0:T.Surveyor)!=null&&y.latency?a?(a.p(d,_),_[0]&2&&M(a,1)):(a=qt(d),a.c(),M(a,1),a.m(e,null)):a&&(Pe(),G(a,1,1,()=>{a=null}),$e())},i(d){r||(M(s),M(a),r=!0)},o(d){G(s),G(a),r=!1},d(d){d&&p(e),s&&s.d(),a&&a.d()}}}function Mt(i){var he,be,ve,ye,me,ue,Le,Ie,We,Me,ce,De,Ge,Ze;let e,l,r,s,a,o="Throughput Test",n,h,m,d,_="Send Speed",D,V,T=(((ye=(ve=(be=(he=i[1].results)==null?void 0:he.Surveyor)==null?void 0:be.throughput)==null?void 0:ve.send_mbps)==null?void 0:ye.toFixed(1))||"0")+"",y,U,w,R,J,q="Receive Speed",O,L,j=(((Ie=(Le=(ue=(me=i[1].results)==null?void 0:me.Surveyor)==null?void 0:ue.throughput)==null?void 0:Le.recv_mbps)==null?void 0:Ie.toFixed(1))||"0")+"",x,P,$,S,N,E="Duration",C,b,v=(((ce=(Me=(We=i[1].results)==null?void 0:We.Surveyor)==null?void 0:Me.throughput)==null?void 0:ce.duration_seconds)||"0")+"",z,F,ee,H,re,Y="Security",A,B,K=(Ze=(Ge=(De=i[1].results)==null?void 0:De.Surveyor)==null?void 0:Ge.throughput)!=null&&Ze.pq_secured?"PQ-Secured":"Standard",Q,ne;return r=new Yt({props:{class:"w-5 h-5 text-yellow-400"}}),{c(){e=c("div"),l=c("h4"),Te(r.$$.fragment),s=k(),a=c("span"),a.textContent=o,n=k(),h=c("div"),m=c("div"),d=c("span"),d.textContent=_,D=k(),V=c("span"),y=W(T),U=W(" Mbps"),w=k(),R=c("div"),J=c("span"),J.textContent=q,O=k(),L=c("span"),x=W(j),P=W(" Mbps"),$=k(),S=c("div"),N=c("span"),N.textContent=E,C=k(),b=c("span"),z=W(v),F=W("s"),ee=k(),H=c("div"),re=c("span"),re.textContent=Y,A=k(),B=c("span"),Q=W(K),this.h()},l(se){e=f(se,"DIV",{class:!0});var pe=g(e);l=f(pe,"H4",{class:!0});var Ce=g(l);Oe(r.$$.fragment,Ce),s=I(Ce),a=f(Ce,"SPAN",{"data-svelte-h":!0}),te(a)!=="svelte-1weh6uw"&&(a.textContent=o),Ce.forEach(p),n=I(pe),h=f(pe,"DIV",{class:!0});var _e=g(h);m=f(_e,"DIV",{class:!0});var xe=g(m);d=f(xe,"SPAN",{class:!0,"data-svelte-h":!0}),te(d)!=="svelte-183dg0l"&&(d.textContent=_),D=I(xe),V=f(xe,"SPAN",{class:!0});var Ve=g(V);y=Z(Ve,T),U=Z(Ve," Mbps"),Ve.forEach(p),xe.forEach(p),w=I(_e),R=f(_e,"DIV",{class:!0});var Ne=g(R);J=f(Ne,"SPAN",{class:!0,"data-svelte-h":!0}),te(J)!=="svelte-9q3jie"&&(J.textContent=q),O=I(Ne),L=f(Ne,"SPAN",{class:!0});var je=g(L);x=Z(je,j),P=Z(je," Mbps"),je.forEach(p),Ne.forEach(p),$=I(_e),S=f(_e,"DIV",{class:!0});var we=g(S);N=f(we,"SPAN",{class:!0,"data-svelte-h":!0}),te(N)!=="svelte-12jf0co"&&(N.textContent=E),C=I(we),b=f(we,"SPAN",{class:!0});var fe=g(b);z=Z(fe,v),F=Z(fe,"s"),fe.forEach(p),we.forEach(p),ee=I(_e),H=f(_e,"DIV",{class:!0});var X=g(H);re=f(X,"SPAN",{class:!0,"data-svelte-h":!0}),te(re)!=="svelte-24xqvy"&&(re.textContent=Y),A=I(X),B=f(X,"SPAN",{class:!0});var oe=g(B);Q=Z(oe,K),oe.forEach(p),X.forEach(p),_e.forEach(p),pe.forEach(p),this.h()},h(){u(l,"class","text-lg font-semibold text-white mb-4 flex items-center space-x-2"),u(d,"class","text-gray-300"),u(V,"class","text-green-400 font-mono"),u(m,"class","flex justify-between items-center"),u(J,"class","text-gray-300"),u(L,"class","text-blue-400 font-mono"),u(R,"class","flex justify-between items-center"),u(N,"class","text-gray-300"),u(b,"class","text-gray-400 font-mono"),u(S,"class","flex justify-between items-center"),u(re,"class","text-gray-300"),u(B,"class","text-purple-400 font-mono"),u(H,"class","flex justify-between items-center"),u(h,"class","space-y-4"),u(e,"class","frosted rounded-lg p-6")},m(se,pe){le(se,e,pe),t(e,l),Ae(r,l,null),t(l,s),t(l,a),t(e,n),t(e,h),t(h,m),t(m,d),t(m,D),t(m,V),t(V,y),t(V,U),t(h,w),t(h,R),t(R,J),t(R,O),t(R,L),t(L,x),t(L,P),t(h,$),t(h,S),t(S,N),t(S,C),t(S,b),t(b,z),t(b,F),t(h,ee),t(h,H),t(H,re),t(H,A),t(H,B),t(B,Q),ne=!0},p(se,pe){var Ce,_e,xe,Ve,Ne,je,we,fe,X,oe,Fe,Se,ze,Je;(!ne||pe[0]&2)&&T!==(T=(((Ve=(xe=(_e=(Ce=se[1].results)==null?void 0:Ce.Surveyor)==null?void 0:_e.throughput)==null?void 0:xe.send_mbps)==null?void 0:Ve.toFixed(1))||"0")+"")&&ae(y,T),(!ne||pe[0]&2)&&j!==(j=(((fe=(we=(je=(Ne=se[1].results)==null?void 0:Ne.Surveyor)==null?void 0:je.throughput)==null?void 0:we.recv_mbps)==null?void 0:fe.toFixed(1))||"0")+"")&&ae(x,j),(!ne||pe[0]&2)&&v!==(v=(((Fe=(oe=(X=se[1].results)==null?void 0:X.Surveyor)==null?void 0:oe.throughput)==null?void 0:Fe.duration_seconds)||"0")+"")&&ae(z,v),(!ne||pe[0]&2)&&K!==(K=(Je=(ze=(Se=se[1].results)==null?void 0:Se.Surveyor)==null?void 0:ze.throughput)!=null&&Je.pq_secured?"PQ-Secured":"Standard")&&ae(Q,K)},i(se){ne||(M(r.$$.fragment,se),ne=!0)},o(se){G(r.$$.fragment,se),ne=!1},d(se){se&&p(e),Re(r)}}}function qt(i){var De,Ge,Ze,se,pe,Ce,_e,xe,Ve,Ne,je,we,fe,X,oe,Fe,Se,ze,Je,et;let e,l,r,s,a,o="Latency Test",n,h,m,d,_="Average",D,V,T=(((se=(Ze=(Ge=(De=i[1].results)==null?void 0:De.Surveyor)==null?void 0:Ge.latency)==null?void 0:Ze.avg_ms)==null?void 0:se.toFixed(1))||"0")+"",y,U,w,R,J,q="Minimum",O,L,j=(((xe=(_e=(Ce=(pe=i[1].results)==null?void 0:pe.Surveyor)==null?void 0:Ce.latency)==null?void 0:_e.min_ms)==null?void 0:xe.toFixed(1))||"0")+"",x,P,$,S,N,E="Maximum",C,b,v=(((we=(je=(Ne=(Ve=i[1].results)==null?void 0:Ve.Surveyor)==null?void 0:Ne.latency)==null?void 0:je.max_ms)==null?void 0:we.toFixed(1))||"0")+"",z,F,ee,H,re,Y="Jitter",A,B,K=(((Fe=(oe=(X=(fe=i[1].results)==null?void 0:fe.Surveyor)==null?void 0:X.latency)==null?void 0:oe.jitter_ms)==null?void 0:Fe.toFixed(1))||"0")+"",Q,ne,he,be,ve,ye="Packet Loss",me,ue,Le=(((et=(Je=(ze=(Se=i[1].results)==null?void 0:Se.Surveyor)==null?void 0:ze.latency)==null?void 0:Je.packet_loss_percent)==null?void 0:et.toFixed(1))||"0")+"",Ie,We,Me,ce;return r=new Gt({props:{class:"w-5 h-5 text-cyan-400"}}),{c(){e=c("div"),l=c("h4"),Te(r.$$.fragment),s=k(),a=c("span"),a.textContent=o,n=k(),h=c("div"),m=c("div"),d=c("span"),d.textContent=_,D=k(),V=c("span"),y=W(T),U=W("ms"),w=k(),R=c("div"),J=c("span"),J.textContent=q,O=k(),L=c("span"),x=W(j),P=W("ms"),$=k(),S=c("div"),N=c("span"),N.textContent=E,C=k(),b=c("span"),z=W(v),F=W("ms"),ee=k(),H=c("div"),re=c("span"),re.textContent=Y,A=k(),B=c("span"),Q=W(K),ne=W("ms"),he=k(),be=c("div"),ve=c("span"),ve.textContent=ye,me=k(),ue=c("span"),Ie=W(Le),We=W("%"),this.h()},l(ie){e=f(ie,"DIV",{class:!0});var de=g(e);l=f(de,"H4",{class:!0});var Ee=g(l);Oe(r.$$.fragment,Ee),s=I(Ee),a=f(Ee,"SPAN",{"data-svelte-h":!0}),te(a)!=="svelte-jtxxfw"&&(a.textContent=o),Ee.forEach(p),n=I(de),h=f(de,"DIV",{class:!0});var ge=g(h);m=f(ge,"DIV",{class:!0});var Be=g(m);d=f(Be,"SPAN",{class:!0,"data-svelte-h":!0}),te(d)!=="svelte-b5bap1"&&(d.textContent=_),D=I(Be),V=f(Be,"SPAN",{class:!0});var qe=g(V);y=Z(qe,T),U=Z(qe,"ms"),qe.forEach(p),Be.forEach(p),w=I(ge),R=f(ge,"DIV",{class:!0});var Qe=g(R);J=f(Qe,"SPAN",{class:!0,"data-svelte-h":!0}),te(J)!=="svelte-11d8mvo"&&(J.textContent=q),O=I(Qe),L=f(Qe,"SPAN",{class:!0});var He=g(L);x=Z(He,j),P=Z(He,"ms"),He.forEach(p),Qe.forEach(p),$=I(ge),S=f(ge,"DIV",{class:!0});var Ue=g(S);N=f(Ue,"SPAN",{class:!0,"data-svelte-h":!0}),te(N)!=="svelte-k1agoi"&&(N.textContent=E),C=I(Ue),b=f(Ue,"SPAN",{class:!0});var Ye=g(b);z=Z(Ye,v),F=Z(Ye,"ms"),Ye.forEach(p),Ue.forEach(p),ee=I(ge),H=f(ge,"DIV",{class:!0});var tt=g(H);re=f(tt,"SPAN",{class:!0,"data-svelte-h":!0}),te(re)!=="svelte-moqywe"&&(re.textContent=Y),A=I(tt),B=f(tt,"SPAN",{class:!0});var st=g(B);Q=Z(st,K),ne=Z(st,"ms"),st.forEach(p),tt.forEach(p),he=I(ge),be=f(ge,"DIV",{class:!0});var lt=g(be);ve=f(lt,"SPAN",{class:!0,"data-svelte-h":!0}),te(ve)!=="svelte-1atrpjd"&&(ve.textContent=ye),me=I(lt),ue=f(lt,"SPAN",{class:!0});var rt=g(ue);Ie=Z(rt,Le),We=Z(rt,"%"),rt.forEach(p),lt.forEach(p),ge.forEach(p),de.forEach(p),this.h()},h(){var ie,de,Ee;u(l,"class","text-lg font-semibold text-white mb-4 flex items-center space-x-2"),u(d,"class","text-gray-300"),u(V,"class","text-cyan-400 font-mono"),u(m,"class","flex justify-between items-center"),u(J,"class","text-gray-300"),u(L,"class","text-green-400 font-mono"),u(R,"class","flex justify-between items-center"),u(N,"class","text-gray-300"),u(b,"class","text-red-400 font-mono"),u(S,"class","flex justify-between items-center"),u(re,"class","text-gray-300"),u(B,"class","text-yellow-400 font-mono"),u(H,"class","flex justify-between items-center"),u(ve,"class","text-gray-300"),u(ue,"class",Me="text-"+((((Ee=(de=(ie=i[1].results)==null?void 0:ie.Surveyor)==null?void 0:de.latency)==null?void 0:Ee.packet_loss_percent)||0)>0?"red":"green")+"-400 font-mono"),u(be,"class","flex justify-between items-center"),u(h,"class","space-y-4"),u(e,"class","frosted rounded-lg p-6")},m(ie,de){le(ie,e,de),t(e,l),Ae(r,l,null),t(l,s),t(l,a),t(e,n),t(e,h),t(h,m),t(m,d),t(m,D),t(m,V),t(V,y),t(V,U),t(h,w),t(h,R),t(R,J),t(R,O),t(R,L),t(L,x),t(L,P),t(h,$),t(h,S),t(S,N),t(S,C),t(S,b),t(b,z),t(b,F),t(h,ee),t(h,H),t(H,re),t(H,A),t(H,B),t(B,Q),t(B,ne),t(h,he),t(h,be),t(be,ve),t(be,me),t(be,ue),t(ue,Ie),t(ue,We),ce=!0},p(ie,de){var Ee,ge,Be,qe,Qe,He,Ue,Ye,tt,st,lt,rt,vt,_t,mt,gt,bt,yt,xt,St,Ct,wt,Et;(!ce||de[0]&2)&&T!==(T=(((qe=(Be=(ge=(Ee=ie[1].results)==null?void 0:Ee.Surveyor)==null?void 0:ge.latency)==null?void 0:Be.avg_ms)==null?void 0:qe.toFixed(1))||"0")+"")&&ae(y,T),(!ce||de[0]&2)&&j!==(j=(((Ye=(Ue=(He=(Qe=ie[1].results)==null?void 0:Qe.Surveyor)==null?void 0:He.latency)==null?void 0:Ue.min_ms)==null?void 0:Ye.toFixed(1))||"0")+"")&&ae(x,j),(!ce||de[0]&2)&&v!==(v=(((rt=(lt=(st=(tt=ie[1].results)==null?void 0:tt.Surveyor)==null?void 0:st.latency)==null?void 0:lt.max_ms)==null?void 0:rt.toFixed(1))||"0")+"")&&ae(z,v),(!ce||de[0]&2)&&K!==(K=(((gt=(mt=(_t=(vt=ie[1].results)==null?void 0:vt.Surveyor)==null?void 0:_t.latency)==null?void 0:mt.jitter_ms)==null?void 0:gt.toFixed(1))||"0")+"")&&ae(Q,K),(!ce||de[0]&2)&&Le!==(Le=(((St=(xt=(yt=(bt=ie[1].results)==null?void 0:bt.Surveyor)==null?void 0:yt.latency)==null?void 0:xt.packet_loss_percent)==null?void 0:St.toFixed(1))||"0")+"")&&ae(Ie,Le),(!ce||de[0]&2&&Me!==(Me="text-"+((((Et=(wt=(Ct=ie[1].results)==null?void 0:Ct.Surveyor)==null?void 0:wt.latency)==null?void 0:Et.packet_loss_percent)||0)>0?"red":"green")+"-400 font-mono"))&&u(ue,"class",Me)},i(ie){ce||(M(r.$$.fragment,ie),ce=!0)},o(ie){G(r.$$.fragment,ie),ce=!1},d(ie){ie&&p(e),Re(r)}}}function Ht(i){let e,l,r,s="New Surveyor Scan",a,o,n,h,m="Target Host/IP",d,_,D,V,T,y,U,w,R="Use port range instead of specific ports",J,q,O,L,j,x="Timeout (seconds)",P,$,S,N,E,C="Max Concurrent",b,v,z,F,ee,H,re,Y,A="Include throughput test",B,K,Q,ne,he,be="Include latency test",ve,ye,me,ue,Le,Ie,We="Results will be post-quantum signed and logged",Me,ce,De,Ge="Cancel",Ze,se,pe=i[3]?"Starting...":"Start Scan",Ce,_e,xe,Ve,Ne;function je(X,oe){return X[4].portRange.enabled?dl:fl}let we=je(i),fe=we(i);return ue=new ft({props:{class:"w-4 h-4"}}),{c(){e=c("div"),l=c("div"),r=c("h3"),r.textContent=s,a=k(),o=c("div"),n=c("div"),h=c("label"),h.textContent=m,d=k(),_=c("input"),D=k(),V=c("div"),T=c("label"),y=c("input"),U=k(),w=c("span"),w.textContent=R,J=k(),fe.c(),q=k(),O=c("div"),L=c("div"),j=c("label"),j.textContent=x,P=k(),$=c("input"),S=k(),N=c("div"),E=c("label"),E.textContent=C,b=k(),v=c("input"),z=k(),F=c("div"),ee=c("label"),H=c("input"),re=k(),Y=c("span"),Y.textContent=A,B=k(),K=c("label"),Q=c("input"),ne=k(),he=c("span"),he.textContent=be,ve=k(),ye=c("div"),me=c("div"),Te(ue.$$.fragment),Le=k(),Ie=c("span"),Ie.textContent=We,Me=k(),ce=c("div"),De=c("button"),De.textContent=Ge,Ze=k(),se=c("button"),Ce=W(pe),this.h()},l(X){e=f(X,"DIV",{class:!0});var oe=g(e);l=f(oe,"DIV",{class:!0});var Fe=g(l);r=f(Fe,"H3",{class:!0,"data-svelte-h":!0}),te(r)!=="svelte-qcmhda"&&(r.textContent=s),a=I(Fe),o=f(Fe,"DIV",{class:!0});var Se=g(o);n=f(Se,"DIV",{});var ze=g(n);h=f(ze,"LABEL",{class:!0,"data-svelte-h":!0}),te(h)!=="svelte-1demtee"&&(h.textContent=m),d=I(ze),_=f(ze,"INPUT",{placeholder:!0,class:!0}),ze.forEach(p),D=I(Se),V=f(Se,"DIV",{});var Je=g(V);T=f(Je,"LABEL",{class:!0});var et=g(T);y=f(et,"INPUT",{type:!0,class:!0}),U=I(et),w=f(et,"SPAN",{class:!0,"data-svelte-h":!0}),te(w)!=="svelte-1mromoq"&&(w.textContent=R),et.forEach(p),J=I(Je),fe.l(Je),Je.forEach(p),q=I(Se),O=f(Se,"DIV",{class:!0});var ie=g(O);L=f(ie,"DIV",{});var de=g(L);j=f(de,"LABEL",{class:!0,"data-svelte-h":!0}),te(j)!=="svelte-xfjgbk"&&(j.textContent=x),P=I(de),$=f(de,"INPUT",{type:!0,min:!0,max:!0,class:!0}),de.forEach(p),S=I(ie),N=f(ie,"DIV",{});var Ee=g(N);E=f(Ee,"LABEL",{class:!0,"data-svelte-h":!0}),te(E)!=="svelte-tfgj5i"&&(E.textContent=C),b=I(Ee),v=f(Ee,"INPUT",{type:!0,min:!0,max:!0,class:!0}),Ee.forEach(p),ie.forEach(p),z=I(Se),F=f(Se,"DIV",{class:!0});var ge=g(F);ee=f(ge,"LABEL",{class:!0});var Be=g(ee);H=f(Be,"INPUT",{type:!0,class:!0}),re=I(Be),Y=f(Be,"SPAN",{class:!0,"data-svelte-h":!0}),te(Y)!=="svelte-1aphc8u"&&(Y.textContent=A),Be.forEach(p),B=I(ge),K=f(ge,"LABEL",{class:!0});var qe=g(K);Q=f(qe,"INPUT",{type:!0,class:!0}),ne=I(qe),he=f(qe,"SPAN",{class:!0,"data-svelte-h":!0}),te(he)!=="svelte-1vdkyu2"&&(he.textContent=be),qe.forEach(p),ge.forEach(p),ve=I(Se),ye=f(Se,"DIV",{class:!0});var Qe=g(ye);me=f(Qe,"DIV",{class:!0});var He=g(me);Oe(ue.$$.fragment,He),Le=I(He),Ie=f(He,"SPAN",{"data-svelte-h":!0}),te(Ie)!=="svelte-hnhz3o"&&(Ie.textContent=We),He.forEach(p),Qe.forEach(p),Se.forEach(p),Me=I(Fe),ce=f(Fe,"DIV",{class:!0});var Ue=g(ce);De=f(Ue,"BUTTON",{class:!0,"data-svelte-h":!0}),te(De)!=="svelte-1igrqdl"&&(De.textContent=Ge),Ze=I(Ue),se=f(Ue,"BUTTON",{class:!0});var Ye=g(se);Ce=Z(Ye,pe),Ye.forEach(p),Ue.forEach(p),Fe.forEach(p),oe.forEach(p),this.h()},h(){u(r,"class","text-lg font-semibold text-white mb-4"),u(h,"class","block text-sm font-medium text-gray-300 mb-1"),u(_,"placeholder","10.0.0.1 or example.com"),u(_,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:border-cyan-500 focus:outline-none"),u(y,"type","checkbox"),u(y,"class","rounded border-gray-600 bg-gray-800 text-cyan-500 focus:ring-cyan-500"),u(w,"class","text-gray-300"),u(T,"class","flex items-center space-x-2 text-sm mb-2"),u(j,"class","block text-sm font-medium text-gray-300 mb-1"),u($,"type","number"),u($,"min","10"),u($,"max","300"),u($,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),u(E,"class","block text-sm font-medium text-gray-300 mb-1"),u(v,"type","number"),u(v,"min","1"),u(v,"max","200"),u(v,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),u(O,"class","grid grid-cols-2 gap-4"),u(H,"type","checkbox"),u(H,"class","rounded border-gray-600 bg-gray-800 text-cyan-500 focus:ring-cyan-500"),u(Y,"class","text-gray-300"),u(ee,"class","flex items-center space-x-2 text-sm"),u(Q,"type","checkbox"),u(Q,"class","rounded border-gray-600 bg-gray-800 text-cyan-500 focus:ring-cyan-500"),u(he,"class","text-gray-300"),u(K,"class","flex items-center space-x-2 text-sm"),u(F,"class","space-y-2"),u(me,"class","flex items-center space-x-2 text-blue-400 text-sm"),u(ye,"class","bg-blue-500/10 border border-blue-500/30 rounded-lg p-3"),u(o,"class","space-y-4"),u(De,"class","px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors"),se.disabled=_e=!i[4].target.trim()||i[3],u(se,"class","px-4 py-2 bg-cyan-500 hover:bg-cyan-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),u(ce,"class","flex justify-end space-x-3 mt-6"),u(l,"class","bg-gray-900 border border-gray-700 rounded-lg p-6 w-[500px] max-w-full mx-4 max-h-[80vh] overflow-y-auto"),u(e,"class","fixed inset-0 bg-black/50 flex items-center justify-center z-50")},m(X,oe){le(X,e,oe),t(e,l),t(l,r),t(l,a),t(l,o),t(o,n),t(n,h),t(n,d),t(n,_),Xe(_,i[4].target),t(o,D),t(o,V),t(V,T),t(T,y),y.checked=i[4].portRange.enabled,t(T,U),t(T,w),t(V,J),fe.m(V,null),t(o,q),t(o,O),t(O,L),t(L,j),t(L,P),t(L,$),Xe($,i[4].timeoutSeconds),t(O,S),t(O,N),t(N,E),t(N,b),t(N,v),Xe(v,i[4].maxConcurrent),t(o,z),t(o,F),t(F,ee),t(ee,H),H.checked=i[4].includeThroughput,t(ee,re),t(ee,Y),t(F,B),t(F,K),t(K,Q),Q.checked=i[4].includeLatency,t(K,ne),t(K,he),t(o,ve),t(o,ye),t(ye,me),Ae(ue,me,null),t(me,Le),t(me,Ie),t(l,Me),t(l,ce),t(ce,De),t(ce,Ze),t(ce,se),t(se,Ce),xe=!0,Ve||(Ne=[ke(_,"input",i[14]),ke(y,"change",i[15]),ke($,"input",i[19]),ke(v,"input",i[20]),ke(H,"change",i[21]),ke(Q,"change",i[22]),ke(De,"click",i[23]),ke(se,"click",i[6])],Ve=!0)},p(X,oe){oe[0]&16&&_.value!==X[4].target&&Xe(_,X[4].target),oe[0]&16&&(y.checked=X[4].portRange.enabled),we===(we=je(X))&&fe?fe.p(X,oe):(fe.d(1),fe=we(X),fe&&(fe.c(),fe.m(V,null))),oe[0]&16&&Ke($.value)!==X[4].timeoutSeconds&&Xe($,X[4].timeoutSeconds),oe[0]&16&&Ke(v.value)!==X[4].maxConcurrent&&Xe(v,X[4].maxConcurrent),oe[0]&16&&(H.checked=X[4].includeThroughput),oe[0]&16&&(Q.checked=X[4].includeLatency),(!xe||oe[0]&8)&&pe!==(pe=X[3]?"Starting...":"Start Scan")&&ae(Ce,pe),(!xe||oe[0]&24&&_e!==(_e=!X[4].target.trim()||X[3]))&&(se.disabled=_e)},i(X){xe||(M(ue.$$.fragment,X),xe=!0)},o(X){G(ue.$$.fragment,X),xe=!1},d(X){X&&p(e),fe.d(),Re(ue),Ve=!1,pt(Ne)}}}function fl(i){let e,l,r="Specific Ports (comma-separated)",s,a,o,n,h;return{c(){e=c("div"),l=c("label"),l.textContent=r,s=k(),a=c("input"),this.h()},l(m){e=f(m,"DIV",{});var d=g(e);l=f(d,"LABEL",{class:!0,"data-svelte-h":!0}),te(l)!=="svelte-r2r6bj"&&(l.textContent=r),s=I(d),a=f(d,"INPUT",{placeholder:!0,class:!0}),d.forEach(p),this.h()},h(){u(l,"class","block text-sm font-medium text-gray-300 mb-1"),a.value=o=i[4].ports.join(", "),u(a,"placeholder","22, 80, 443, 53, 25"),u(a,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:border-cyan-500 focus:outline-none")},m(m,d){le(m,e,d),t(e,l),t(e,s),t(e,a),n||(h=ke(a,"input",i[18]),n=!0)},p(m,d){d[0]&16&&o!==(o=m[4].ports.join(", "))&&a.value!==o&&(a.value=o)},d(m){m&&p(e),n=!1,h()}}}function dl(i){let e,l,r,s="Start Port",a,o,n,h,m,d="End Port",_,D,V,T;return{c(){e=c("div"),l=c("div"),r=c("label"),r.textContent=s,a=k(),o=c("input"),n=k(),h=c("div"),m=c("label"),m.textContent=d,_=k(),D=c("input"),this.h()},l(y){e=f(y,"DIV",{class:!0});var U=g(e);l=f(U,"DIV",{});var w=g(l);r=f(w,"LABEL",{class:!0,"data-svelte-h":!0}),te(r)!=="svelte-1o06vuo"&&(r.textContent=s),a=I(w),o=f(w,"INPUT",{type:!0,min:!0,max:!0,class:!0}),w.forEach(p),n=I(U),h=f(U,"DIV",{});var R=g(h);m=f(R,"LABEL",{class:!0,"data-svelte-h":!0}),te(m)!=="svelte-drcg5j"&&(m.textContent=d),_=I(R),D=f(R,"INPUT",{type:!0,min:!0,max:!0,class:!0}),R.forEach(p),U.forEach(p),this.h()},h(){u(r,"class","block text-sm font-medium text-gray-300 mb-1"),u(o,"type","number"),u(o,"min","1"),u(o,"max","65535"),u(o,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),u(m,"class","block text-sm font-medium text-gray-300 mb-1"),u(D,"type","number"),u(D,"min","1"),u(D,"max","65535"),u(D,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),u(e,"class","grid grid-cols-2 gap-4")},m(y,U){le(y,e,U),t(e,l),t(l,r),t(l,a),t(l,o),Xe(o,i[4].portRange.start),t(e,n),t(e,h),t(h,m),t(h,_),t(h,D),Xe(D,i[4].portRange.end),V||(T=[ke(o,"input",i[16]),ke(D,"input",i[17])],V=!0)},p(y,U){U[0]&16&&Ke(o.value)!==y[4].portRange.start&&Xe(o,y[4].portRange.start),U[0]&16&&Ke(D.value)!==y[4].portRange.end&&Xe(D,y[4].portRange.end)},d(y){y&&p(e),V=!1,pt(T)}}}function pl(i){let e,l,r,s,a,o,n,h,m="Surveyor",d,_,D,V,T,y,U,w,R="Post-Quantum Secured",J,q,O,L,j,x,P,$,S,N,E,C;o=new ht({props:{class:"w-5 h-5 text-cyan-400"}}),D=new el({props:{size:16}}),y=new ft({props:{class:"w-4 h-4 text-green-400"}});let b=ot(i[0]),v=[];for(let A=0;A<b.length;A+=1)v[A]=Nt($t(i,b,A));const z=A=>G(v[A],1,1,()=>{v[A]=null});let F=i[0].length===0&&Tt();const ee=[nl,al],H=[];function re(A,B){return A[1]?0:1}x=re(i),P=H[x]=ee[x](i);let Y=i[2]&&Ht(i);return{c(){e=c("div"),l=c("div"),r=c("div"),s=c("div"),a=c("div"),Te(o.$$.fragment),n=k(),h=c("h2"),h.textContent=m,d=k(),_=c("button"),Te(D.$$.fragment),V=k(),T=c("div"),Te(y.$$.fragment),U=k(),w=c("span"),w.textContent=R,J=k(),q=c("div");for(let A=0;A<v.length;A+=1)v[A].c();O=k(),F&&F.c(),L=k(),j=c("div"),P.c(),$=k(),Y&&Y.c(),S=ut(),this.h()},l(A){e=f(A,"DIV",{class:!0});var B=g(e);l=f(B,"DIV",{class:!0});var K=g(l);r=f(K,"DIV",{class:!0});var Q=g(r);s=f(Q,"DIV",{class:!0});var ne=g(s);a=f(ne,"DIV",{class:!0});var he=g(a);Oe(o.$$.fragment,he),n=I(he),h=f(he,"H2",{class:!0,"data-svelte-h":!0}),te(h)!=="svelte-1f56jhz"&&(h.textContent=m),he.forEach(p),d=I(ne),_=f(ne,"BUTTON",{class:!0,title:!0});var be=g(_);Oe(D.$$.fragment,be),be.forEach(p),ne.forEach(p),V=I(Q),T=f(Q,"DIV",{class:!0});var ve=g(T);Oe(y.$$.fragment,ve),U=I(ve),w=f(ve,"SPAN",{"data-svelte-h":!0}),te(w)!=="svelte-4r02vj"&&(w.textContent=R),ve.forEach(p),Q.forEach(p),J=I(K),q=f(K,"DIV",{class:!0});var ye=g(q);for(let ue=0;ue<v.length;ue+=1)v[ue].l(ye);O=I(ye),F&&F.l(ye),ye.forEach(p),K.forEach(p),L=I(B),j=f(B,"DIV",{class:!0});var me=g(j);P.l(me),me.forEach(p),B.forEach(p),$=I(A),Y&&Y.l(A),S=ut(),this.h()},h(){u(h,"class","text-lg font-semibold text-white"),u(a,"class","flex items-center space-x-2"),u(_,"class","p-2 rounded-lg bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 transition-colors"),u(_,"title","New Scan"),u(s,"class","flex items-center justify-between mb-4"),u(T,"class","flex items-center space-x-2 text-sm text-gray-400"),u(r,"class","p-4 border-b border-gray-800/50"),u(q,"class","flex-1 overflow-y-auto p-4 space-y-2"),u(l,"class","w-80 frosted border-r border-gray-800/50 flex flex-col"),u(j,"class","flex-1 flex flex-col"),u(e,"class","h-full flex")},m(A,B){le(A,e,B),t(e,l),t(l,r),t(r,s),t(s,a),Ae(o,a,null),t(a,n),t(a,h),t(s,d),t(s,_),Ae(D,_,null),t(r,V),t(r,T),Ae(y,T,null),t(T,U),t(T,w),t(l,J),t(l,q);for(let K=0;K<v.length;K+=1)v[K]&&v[K].m(q,null);t(q,O),F&&F.m(q,null),t(e,L),t(e,j),H[x].m(j,null),le(A,$,B),Y&&Y.m(A,B),le(A,S,B),N=!0,E||(C=ke(_,"click",i[10]),E=!0)},p(A,B){if(B[0]&259){b=ot(A[0]);let Q;for(Q=0;Q<b.length;Q+=1){const ne=$t(A,b,Q);v[Q]?(v[Q].p(ne,B),M(v[Q],1)):(v[Q]=Nt(ne),v[Q].c(),M(v[Q],1),v[Q].m(q,O))}for(Pe(),Q=b.length;Q<v.length;Q+=1)z(Q);$e()}A[0].length===0?F?B[0]&1&&M(F,1):(F=Tt(),F.c(),M(F,1),F.m(q,null)):F&&(Pe(),G(F,1,1,()=>{F=null}),$e());let K=x;x=re(A),x===K?H[x].p(A,B):(Pe(),G(H[K],1,1,()=>{H[K]=null}),$e(),P=H[x],P?P.p(A,B):(P=H[x]=ee[x](A),P.c()),M(P,1),P.m(j,null)),A[2]?Y?(Y.p(A,B),B[0]&4&&M(Y,1)):(Y=Ht(A),Y.c(),M(Y,1),Y.m(S.parentNode,S)):Y&&(Pe(),G(Y,1,1,()=>{Y=null}),$e())},i(A){if(!N){M(o.$$.fragment,A),M(D.$$.fragment,A),M(y.$$.fragment,A);for(let B=0;B<b.length;B+=1)M(v[B]);M(F),M(P),M(Y),N=!0}},o(A){G(o.$$.fragment,A),G(D.$$.fragment,A),G(y.$$.fragment,A),v=v.filter(Boolean);for(let B=0;B<v.length;B+=1)G(v[B]);G(F),G(P),G(Y),N=!1},d(A){A&&(p(e),p($),p(S)),Re(o),Re(D),Re(y),dt(v,A),F&&F.d(),H[x].d(),Y&&Y.d(A),E=!1,C()}}}function at(i){switch(i){case"Completed":return"text-green-400";case"Failed":return"text-red-400";case"PolicyDenied":return"text-yellow-400";case"Running":return"text-cyan-400";default:return"text-gray-400"}}function Ot(i){switch(i){case"Open":return"text-green-400";case"Closed":return"text-red-400";case"Filtered":return"text-yellow-400";case"Timeout":return"text-gray-400";default:return"text-gray-400"}}function hl(i,e,l){let r=[],s=null,a=!1,o=!1,n={target:"",ports:[22,80,443,53,25,110,143,993,995],portRange:{enabled:!1,start:1,end:1e3},includeThroughput:!0,includeLatency:!0,timeoutSeconds:60,maxConcurrent:50},h=!1;Jt(async()=>(await m(),await Kt("tool-progress",b=>{const v=b.payload;v.tool_type==="Surveyor"&&D(v)})));async function m(){try{const C=await it("tools_list_runs");l(0,r=C.filter(b=>b.tool_type==="Surveyor"))}catch(C){console.error("Failed to load runs:",C)}}async function d(){try{l(3,o=!0);const C={ports:n.portRange.enabled?[]:n.ports,port_range:n.portRange.enabled?[n.portRange.start,n.portRange.end]:null,include_throughput:n.includeThroughput,include_latency:n.includeLatency,timeout_seconds:n.timeoutSeconds,max_concurrent:n.maxConcurrent},b=await it("tools_run_surveyor",{target:n.target,options:C});await m(),l(2,a=!1),l(1,s=r.find(v=>v.id===b)||null),l(4,n={target:"",ports:[22,80,443,53,25,110,143,993,995],portRange:{enabled:!1,start:1,end:1e3},includeThroughput:!0,includeLatency:!0,timeoutSeconds:60,maxConcurrent:50}),_(b)}catch(C){console.error("Failed to start Surveyor scan:",C),alert(`Failed to start scan: ${C}`)}finally{l(3,o=!1)}}async function _(C){const b=setInterval(async()=>{try{const v=await it("tools_get_run_status",{runId:C});l(0,r=r.map(z=>z.id===C?v:z)),s&&s.id===C&&l(1,s=v),(v.status==="Completed"||v.status==="Failed"||v.status==="PolicyDenied")&&clearInterval(b)}catch(v){console.error("Failed to poll run status:",v),clearInterval(b)}},1e3)}function D(C){l(0,r=r.map(b=>b.id===C.run_id?{...b,progress:C.progress,logs:C.logs}:b)),s&&s.id===C.run_id&&l(1,s={...s,progress:C.progress,logs:C.logs})}async function V(C,b){try{const v=await it("tools_export_results",{runId:C,format:b}),z=new Blob([v],{type:"application/json"}),F=URL.createObjectURL(z),ee=document.createElement("a");ee.href=F,ee.download=`surveyor-${C}.${b}`,ee.click(),URL.revokeObjectURL(F)}catch(v){console.error("Failed to export results:",v),alert(`Export failed: ${v}`)}}function T(C){switch(C){case"Completed":return Wt;case"Failed":return ll;case"PolicyDenied":return ft;case"Running":return It;default:return tl}}function y(C){switch(C==null?void 0:C.toLowerCase()){case"ssh":return ft;case"http":case"https":return Zt;case"dns":return ht;default:return It}}const U=()=>l(2,a=!0),w=C=>l(1,s=C),R=()=>l(5,h=!h),J=()=>s&&V(s.id,"json");function q(){n.target=this.value,l(4,n)}function O(){n.portRange.enabled=this.checked,l(4,n)}function L(){n.portRange.start=Ke(this.value),l(4,n)}function j(){n.portRange.end=Ke(this.value),l(4,n)}const x=C=>{const v=C.currentTarget.value||"";l(4,n.ports=v.split(",").map(z=>parseInt(z.trim())).filter(z=>!isNaN(z)),n)};function P(){n.timeoutSeconds=Ke(this.value),l(4,n)}function $(){n.maxConcurrent=Ke(this.value),l(4,n)}function S(){n.includeThroughput=this.checked,l(4,n)}function N(){n.includeLatency=this.checked,l(4,n)}return[r,s,a,o,n,h,d,V,T,y,U,w,R,J,q,O,L,j,x,P,$,S,N,()=>l(2,a=!1)]}class El extends Qt{constructor(e){super(),Xt(this,e,hl,pl,zt,{},null,[-1,-1])}}export{El as default};
