import{s as Ke,a as $,f as v,l as H,c as A,g,h as m,O as te,d as _,m as U,j as p,k as pe,i as G,x as a,M as ie,E as Me,n as Q,J as ue,q as _e,y as We}from"./scheduler.621791d8.js";import{S as Ye,i as Ze,b as le,d as ce,m as re,g as ae,t as K,c as oe,a as z,e as ne}from"./index.de4558f1.js";import{r as ze,M as et,N as Ge,G as tt,j as st,k as lt,c as Xe,A as Je,n as Qe,e as Y}from"./2.a2c3ccf5.js";import{i as we}from"./settings.f97860d3.js";import{X as rt}from"./circle-x.e49946f8.js";import{C as nt}from"./clock.ed1fd7a8.js";function xe(n,e,t){const s=n.slice();return s[31]=e[t],s}function Ee(n,e,t){const s=n.slice();return s[34]=e[t],s}function De(n,e,t){const s=n.slice();return s[37]=e[t],s}function Ie(n,e,t){const s=n.slice();return s[25]=e[t],s}function Pe(n,e,t){const s=n.slice();return s[28]=e[t],s}function Ve(n,e,t){const s=n.slice();return s[22]=e[t],s}function Ce(n){let e,t,s,l,u,r,i="Running OSI Layer Tests",d,o,c,h,f,k,C,T,N,I=Math.round(n[6])+"",q,O;return{c(){e=v("div"),t=v("div"),s=v("div"),l=v("div"),u=$(),r=v("h3"),r.textContent=i,d=$(),o=v("p"),c=H(n[7]),h=$(),f=v("div"),k=v("div"),C=$(),T=v("p"),N=H("Progress: "),q=H(I),O=H("%"),this.h()},l(x){e=g(x,"DIV",{class:!0});var P=m(e);t=g(P,"DIV",{class:!0});var w=m(t);s=g(w,"DIV",{class:!0});var V=m(s);l=g(V,"DIV",{class:!0}),m(l).forEach(_),u=A(V),r=g(V,"H3",{class:!0,"data-svelte-h":!0}),te(r)!=="svelte-1jgqty7"&&(r.textContent=i),d=A(V),o=g(V,"P",{class:!0});var y=m(o);c=U(y,n[7]),y.forEach(_),h=A(V),f=g(V,"DIV",{class:!0});var b=m(f);k=g(b,"DIV",{class:!0,style:!0}),m(k).forEach(_),b.forEach(_),C=A(V),T=g(V,"P",{class:!0});var E=m(T);N=U(E,"Progress: "),q=U(E,I),O=U(E,"%"),E.forEach(_),V.forEach(_),w.forEach(_),P.forEach(_),this.h()},h(){p(l,"class","w-16 h-16 border-4 border-cyan-400/30 border-t-cyan-400 rounded-full animate-spin mx-auto mb-4"),p(r,"class","text-xl font-bold text-white mb-2"),p(o,"class","text-cyan-400 mb-4"),p(k,"class","bg-gradient-to-r from-cyan-400 to-pink-500 h-2 rounded-full transition-all duration-300"),pe(k,"width",n[6]+"%"),p(f,"class","w-full bg-gray-700 rounded-full h-2 mb-2"),p(T,"class","text-gray-400 text-sm"),p(s,"class","text-center"),p(t,"class","frosted rounded-xl p-8 max-w-md w-full mx-4 svelte-1q10wko"),p(e,"class","fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50")},m(x,P){G(x,e,P),a(e,t),a(t,s),a(s,l),a(s,u),a(s,r),a(s,d),a(s,o),a(o,c),a(s,h),a(s,f),a(f,k),a(s,C),a(s,T),a(T,N),a(T,q),a(T,O)},p(x,P){P[0]&128&&Q(c,x[7]),P[0]&64&&pe(k,"width",x[6]+"%"),P[0]&64&&I!==(I=Math.round(x[6])+"")&&Q(q,I)},d(x){x&&_(e)}}}function at(n){let e,t,s,l,u,r=n[4]&&Te(n);const i=[dt,ct],d=[];function o(c,h){return c[5].length>0?0:1}return s=o(n),l=d[s]=i[s](n),{c(){e=v("div"),r&&r.c(),t=$(),l.c(),this.h()},l(c){e=g(c,"DIV",{class:!0});var h=m(e);r&&r.l(h),t=A(h),l.l(h),h.forEach(_),this.h()},h(){p(e,"class","space-y-6 pb-6")},m(c,h){G(c,e,h),r&&r.m(e,null),a(e,t),d[s].m(e,null),u=!0},p(c,h){c[4]?r?(r.p(c,h),h[0]&16&&z(r,1)):(r=Te(c),r.c(),z(r,1),r.m(e,t)):r&&(ae(),K(r,1,1,()=>{r=null}),oe());let f=s;s=o(c),s===f?d[s].p(c,h):(ae(),K(d[f],1,1,()=>{d[f]=null}),oe(),l=d[s],l?l.p(c,h):(l=d[s]=i[s](c),l.c()),z(l,1),l.m(e,null))},i(c){u||(z(r),z(l),u=!0)},o(c){K(r),K(l),u=!1},d(c){c&&_(e),r&&r.d(),d[s].d()}}}function ot(n){let e,t,s=Y(n[1]),l=[];for(let r=0;r<s.length;r+=1)l[r]=Oe(Ie(n,s,r));const u=r=>K(l[r],1,1,()=>{l[r]=null});return{c(){e=v("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){e=g(r,"DIV",{class:!0});var i=m(e);for(let d=0;d<l.length;d+=1)l[d].l(i);i.forEach(_),this.h()},h(){p(e,"class","space-y-4 pb-6")},m(r,i){G(r,e,i);for(let d=0;d<l.length;d+=1)l[d]&&l[d].m(e,null);t=!0},p(r,i){if(i[0]&16898){s=Y(r[1]);let d;for(d=0;d<s.length;d+=1){const o=Ie(r,s,d);l[d]?(l[d].p(o,i),z(l[d],1)):(l[d]=Oe(o),l[d].c(),z(l[d],1),l[d].m(e,null))}for(ae(),d=s.length;d<l.length;d+=1)u(d);oe()}},i(r){if(!t){for(let i=0;i<s.length;i+=1)z(l[i]);t=!0}},o(r){l=l.filter(Boolean);for(let i=0;i<l.length;i+=1)K(l[i]);t=!1},d(r){r&&_(e),ue(l,r)}}}function it(n){let e,t,s,l,u="Select All Layers",r,i,d="Clear Selection",o,c,h=n[2]?"Running Tests...":"Run Tests",f,k,C,T,N,I,q,O,x=n[0].length>0&&He(n),P=Y(n[9]),w=[];for(let y=0;y<P.length;y+=1)w[y]=Be(Ve(n,P,y));const V=y=>K(w[y],1,1,()=>{w[y]=null});return{c(){e=v("div"),t=v("div"),s=v("div"),l=v("button"),l.textContent=u,r=$(),i=v("button"),i.textContent=d,o=$(),c=v("button"),f=H(h),C=$(),x&&x.c(),T=$(),N=v("div");for(let y=0;y<w.length;y+=1)w[y].c();this.h()},l(y){e=g(y,"DIV",{class:!0});var b=m(e);t=g(b,"DIV",{class:!0});var E=m(t);s=g(E,"DIV",{class:!0});var D=m(s);l=g(D,"BUTTON",{class:!0,"data-svelte-h":!0}),te(l)!=="svelte-cp65ez"&&(l.textContent=u),r=A(D),i=g(D,"BUTTON",{class:!0,"data-svelte-h":!0}),te(i)!=="svelte-146mpdb"&&(i.textContent=d),D.forEach(_),o=A(E),c=g(E,"BUTTON",{class:!0});var L=m(c);f=U(L,h),L.forEach(_),E.forEach(_),C=A(b),x&&x.l(b),b.forEach(_),T=A(y),N=g(y,"DIV",{class:!0});var S=m(N);for(let j=0;j<w.length;j+=1)w[j].l(S);S.forEach(_),this.h()},h(){p(l,"class","px-4 py-2 bg-cyan-500/20 border border-cyan-500/50 rounded-lg hover:bg-cyan-500/30 transition-colors text-cyan-400 font-medium"),p(i,"class","px-4 py-2 bg-gray-500/20 border border-gray-500/50 rounded-lg hover:bg-gray-500/30 transition-colors text-gray-400 font-medium"),p(s,"class","flex flex-wrap gap-3"),c.disabled=k=n[0].length===0||n[2],p(c,"class","px-6 py-2 bg-gradient-to-r from-pink-500 to-cyan-500 rounded-lg hover:from-pink-600 hover:to-cyan-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold"),p(t,"class","flex flex-wrap items-center justify-between gap-4"),p(e,"class","frosted rounded-lg p-4 mb-6 svelte-1q10wko"),p(N,"class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pb-6")},m(y,b){G(y,e,b),a(e,t),a(t,s),a(s,l),a(s,r),a(s,i),a(t,o),a(t,c),a(c,f),a(e,C),x&&x.m(e,null),G(y,T,b),G(y,N,b);for(let E=0;E<w.length;E+=1)w[E]&&w[E].m(N,null);I=!0,q||(O=[ie(l,"click",n[12]),ie(i,"click",n[13]),ie(c,"click",n[10])],q=!0)},p(y,b){if((!I||b[0]&4)&&h!==(h=y[2]?"Running Tests...":"Run Tests")&&Q(f,h),(!I||b[0]&5&&k!==(k=y[0].length===0||y[2]))&&(c.disabled=k),y[0].length>0?x?x.p(y,b):(x=He(y),x.c(),x.m(e,null)):x&&(x.d(1),x=null),b[0]&2561){P=Y(y[9]);let E;for(E=0;E<P.length;E+=1){const D=Ve(y,P,E);w[E]?(w[E].p(D,b),z(w[E],1)):(w[E]=Be(D),w[E].c(),z(w[E],1),w[E].m(N,null))}for(ae(),E=P.length;E<w.length;E+=1)V(E);oe()}},i(y){if(!I){for(let b=0;b<P.length;b+=1)z(w[b]);I=!0}},o(y){w=w.filter(Boolean);for(let b=0;b<w.length;b+=1)K(w[b]);I=!1},d(y){y&&(_(e),_(T),_(N)),x&&x.d(),ue(w,y),q=!1,Me(O)}}}function Te(n){let e,t,s,l,u,r,i;s=new Ge({props:{class:"w-6 h-6 mr-2 text-cyan-400"}});let d=Y(n[4].interfaces),o=[];for(let c=0;c<d.length;c+=1)o[c]=$e(Ee(n,d,c));return{c(){e=v("div"),t=v("h3"),le(s.$$.fragment),l=H(`\r
              Network Interface Analysis`),u=$(),r=v("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){e=g(c,"DIV",{class:!0});var h=m(e);t=g(h,"H3",{class:!0});var f=m(t);ce(s.$$.fragment,f),l=U(f,`\r
              Network Interface Analysis`),f.forEach(_),u=A(h),r=g(h,"DIV",{class:!0});var k=m(r);for(let C=0;C<o.length;C+=1)o[C].l(k);k.forEach(_),h.forEach(_),this.h()},h(){p(t,"class","text-xl font-bold text-white mb-4 flex items-center"),p(r,"class","grid grid-cols-1 md:grid-cols-2 gap-4"),p(e,"class","frosted rounded-lg p-6 svelte-1q10wko")},m(c,h){G(c,e,h),a(e,t),re(s,t,null),a(t,l),a(e,u),a(e,r);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(r,null);i=!0},p(c,h){if(h[0]&16){d=Y(c[4].interfaces);let f;for(f=0;f<d.length;f+=1){const k=Ee(c,d,f);o[f]?o[f].p(k,h):(o[f]=$e(k),o[f].c(),o[f].m(r,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=d.length}},i(c){i||(z(s.$$.fragment,c),i=!0)},o(c){K(s.$$.fragment,c),i=!1},d(c){c&&_(e),ne(s),ue(o,c)}}}function Se(n){let e,t,s="IP Addresses:",l,u=Y(n[34].addresses),r=[];for(let i=0;i<u.length;i+=1)r[i]=Le(De(n,u,i));return{c(){e=v("div"),t=v("p"),t.textContent=s,l=$();for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l(i){e=g(i,"DIV",{class:!0});var d=m(e);t=g(d,"P",{class:!0,"data-svelte-h":!0}),te(t)!=="svelte-xt88n2"&&(t.textContent=s),l=A(d);for(let o=0;o<r.length;o+=1)r[o].l(d);d.forEach(_),this.h()},h(){p(t,"class","text-gray-400 text-sm"),p(e,"class","space-y-1")},m(i,d){G(i,e,d),a(e,t),a(e,l);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null)},p(i,d){if(d[0]&16){u=Y(i[34].addresses);let o;for(o=0;o<u.length;o+=1){const c=De(i,u,o);r[o]?r[o].p(c,d):(r[o]=Le(c),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=u.length}},d(i){i&&_(e),ue(r,i)}}}function Le(n){let e,t=n[37]+"",s;return{c(){e=v("p"),s=H(t),this.h()},l(l){e=g(l,"P",{class:!0});var u=m(e);s=U(u,t),u.forEach(_),this.h()},h(){p(e,"class","text-cyan-400 text-sm font-mono")},m(l,u){G(l,e,u),a(e,s)},p(l,u){u[0]&16&&t!==(t=l[37]+"")&&Q(s,t)},d(l){l&&_(e)}}}function Ne(n){let e,t="VPN";return{c(){e=v("span"),e.textContent=t,this.h()},l(s){e=g(s,"SPAN",{class:!0,"data-svelte-h":!0}),te(e)!=="svelte-zcc5ob"&&(e.textContent=t),this.h()},h(){p(e,"class","px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs")},m(s,l){G(s,e,l)},d(s){s&&_(e)}}}function $e(n){let e,t,s,l=n[34].name+"",u,r,i,d=n[34].status+"",o,c,h,f,k,C,T=n[34].type+"",N,I,q,O,x=n[34].addresses.length>0&&Se(n),P=n[34].isVPN&&Ne();return{c(){e=v("div"),t=v("div"),s=v("h4"),u=H(l),r=$(),i=v("span"),o=H(d),h=$(),x&&x.c(),f=$(),k=v("div"),C=v("span"),N=H(T),I=$(),P&&P.c(),q=$(),this.h()},l(w){e=g(w,"DIV",{class:!0});var V=m(e);t=g(V,"DIV",{class:!0});var y=m(t);s=g(y,"H4",{class:!0});var b=m(s);u=U(b,l),b.forEach(_),r=A(y),i=g(y,"SPAN",{class:!0});var E=m(i);o=U(E,d),E.forEach(_),y.forEach(_),h=A(V),x&&x.l(V),f=A(V),k=g(V,"DIV",{class:!0});var D=m(k);C=g(D,"SPAN",{class:!0});var L=m(C);N=U(L,T),L.forEach(_),I=A(D),P&&P.l(D),D.forEach(_),q=A(V),V.forEach(_),this.h()},h(){p(s,"class","font-semibold text-white"),p(i,"class",c="px-2 py-1 rounded text-xs font-medium "+(n[34].status==="UP"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400")),p(t,"class","flex items-center justify-between mb-3"),p(C,"class","px-2 py-1 bg-gray-500/20 text-gray-400 rounded text-xs"),p(k,"class","mt-3 flex flex-wrap gap-2"),p(e,"class",O="bg-black/20 rounded-lg p-4 border "+(n[34].status==="UP"?"border-green-500/50":"border-red-500/50"))},m(w,V){G(w,e,V),a(e,t),a(t,s),a(s,u),a(t,r),a(t,i),a(i,o),a(e,h),x&&x.m(e,null),a(e,f),a(e,k),a(k,C),a(C,N),a(k,I),P&&P.m(k,null),a(e,q)},p(w,V){V[0]&16&&l!==(l=w[34].name+"")&&Q(u,l),V[0]&16&&d!==(d=w[34].status+"")&&Q(o,d),V[0]&16&&c!==(c="px-2 py-1 rounded text-xs font-medium "+(w[34].status==="UP"?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"))&&p(i,"class",c),w[34].addresses.length>0?x?x.p(w,V):(x=Se(w),x.c(),x.m(e,f)):x&&(x.d(1),x=null),V[0]&16&&T!==(T=w[34].type+"")&&Q(N,T),w[34].isVPN?P||(P=Ne(),P.c(),P.m(k,null)):P&&(P.d(1),P=null),V[0]&16&&O!==(O="bg-black/20 rounded-lg p-4 border "+(w[34].status==="UP"?"border-green-500/50":"border-red-500/50"))&&p(e,"class",O)},d(w){w&&_(e),x&&x.d(),P&&P.d()}}}function ct(n){let e,t,s,l,u="No Security Issues Found",r,i,d="All analyzed layers appear to be secure based on current tests.",o;return t=new Xe({props:{class:"w-16 h-16 text-green-400 mx-auto mb-4"}}),{c(){e=v("div"),le(t.$$.fragment),s=$(),l=v("h3"),l.textContent=u,r=$(),i=v("p"),i.textContent=d,this.h()},l(c){e=g(c,"DIV",{class:!0});var h=m(e);ce(t.$$.fragment,h),s=A(h),l=g(h,"H3",{class:!0,"data-svelte-h":!0}),te(l)!=="svelte-8d54rq"&&(l.textContent=u),r=A(h),i=g(h,"P",{class:!0,"data-svelte-h":!0}),te(i)!=="svelte-yslnt6"&&(i.textContent=d),h.forEach(_),this.h()},h(){p(l,"class","text-xl font-bold text-white mb-2"),p(i,"class","text-gray-400"),p(e,"class","frosted rounded-lg p-8 text-center svelte-1q10wko")},m(c,h){G(c,e,h),re(t,e,null),a(e,s),a(e,l),a(e,r),a(e,i),o=!0},p:We,i(c){o||(z(t.$$.fragment,c),o=!0)},o(c){K(t.$$.fragment,c),o=!1},d(c){c&&_(e),ne(t)}}}function dt(n){let e,t,s,l,u,r,i;s=new Je({props:{class:"w-6 h-6 mr-2 text-red-400"}});let d=Y(n[5]),o=[];for(let c=0;c<d.length;c+=1)o[c]=Ae(xe(n,d,c));return{c(){e=v("div"),t=v("h3"),le(s.$$.fragment),l=H(`\r
              Security Findings`),u=$(),r=v("div");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){e=g(c,"DIV",{class:!0});var h=m(e);t=g(h,"H3",{class:!0});var f=m(t);ce(s.$$.fragment,f),l=U(f,`\r
              Security Findings`),f.forEach(_),u=A(h),r=g(h,"DIV",{class:!0});var k=m(r);for(let C=0;C<o.length;C+=1)o[C].l(k);k.forEach(_),h.forEach(_),this.h()},h(){p(t,"class","text-xl font-bold text-white mb-4 flex items-center"),p(r,"class","space-y-4"),p(e,"class","frosted rounded-lg p-6 svelte-1q10wko")},m(c,h){G(c,e,h),a(e,t),re(s,t,null),a(t,l),a(e,u),a(e,r);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(r,null);i=!0},p(c,h){if(h[0]&32){d=Y(c[5]);let f;for(f=0;f<d.length;f+=1){const k=xe(c,d,f);o[f]?o[f].p(k,h):(o[f]=Ae(k),o[f].c(),o[f].m(r,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=d.length}},i(c){i||(z(s.$$.fragment,c),i=!0)},o(c){K(s.$$.fragment,c),i=!1},d(c){c&&_(e),ne(s),ue(o,c)}}}function Ae(n){let e,t,s,l=n[31].type+"",u,r,i,d=n[31].severity+"",o,c,h,f=n[31].details+"",k,C,T,N,I,q="Recommendation:",O,x=n[31].recommendation+"",P,w;return{c(){e=v("div"),t=v("div"),s=v("h4"),u=H(l),r=$(),i=v("span"),o=H(d),c=$(),h=v("p"),k=H(f),C=$(),T=v("div"),N=v("p"),I=v("strong"),I.textContent=q,O=$(),P=H(x),w=$(),this.h()},l(V){e=g(V,"DIV",{class:!0});var y=m(e);t=g(y,"DIV",{class:!0});var b=m(t);s=g(b,"H4",{class:!0});var E=m(s);u=U(E,l),E.forEach(_),r=A(b),i=g(b,"SPAN",{class:!0});var D=m(i);o=U(D,d),D.forEach(_),b.forEach(_),c=A(y),h=g(y,"P",{class:!0});var L=m(h);k=U(L,f),L.forEach(_),C=A(y),T=g(y,"DIV",{class:!0});var S=m(T);N=g(S,"P",{class:!0});var j=m(N);I=g(j,"STRONG",{"data-svelte-h":!0}),te(I)!=="svelte-1ckpdxv"&&(I.textContent=q),O=A(j),P=U(j,x),j.forEach(_),S.forEach(_),w=A(y),y.forEach(_),this.h()},h(){p(s,"class","font-semibold text-red-400"),p(i,"class","px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs font-medium"),p(t,"class","flex items-start justify-between mb-2"),p(h,"class","text-gray-300 mb-3"),p(N,"class","text-gray-400 text-sm"),p(T,"class","bg-black/20 rounded p-3"),p(e,"class","bg-red-500/10 border border-red-500/50 rounded-lg p-4")},m(V,y){G(V,e,y),a(e,t),a(t,s),a(s,u),a(t,r),a(t,i),a(i,o),a(e,c),a(e,h),a(h,k),a(e,C),a(e,T),a(T,N),a(N,I),a(N,O),a(N,P),a(e,w)},p(V,y){y[0]&32&&l!==(l=V[31].type+"")&&Q(u,l),y[0]&32&&d!==(d=V[31].severity+"")&&Q(o,d),y[0]&32&&f!==(f=V[31].details+"")&&Q(k,f),y[0]&32&&x!==(x=V[31].recommendation+"")&&Q(P,x)},d(V){V&&_(e)}}}function ft(n){let e,t=n[25].message+"",s;return{c(){e=v("p"),s=H(t),this.h()},l(l){e=g(l,"P",{class:!0});var u=m(e);s=U(u,t),u.forEach(_),this.h()},h(){p(e,"class","text-gray-300 mb-4")},m(l,u){G(l,e,u),a(e,s)},p(l,u){u[0]&2&&t!==(t=l[25].message+"")&&Q(s,t)},d(l){l&&_(e)}}}function ut(n){let e,t,s=n[25].error+"",l;return{c(){e=v("div"),t=v("p"),l=H(s),this.h()},l(u){e=g(u,"DIV",{class:!0});var r=m(e);t=g(r,"P",{class:!0});var i=m(t);l=U(i,s),i.forEach(_),r.forEach(_),this.h()},h(){p(t,"class","text-red-400"),p(e,"class","bg-red-500/10 border border-red-500/50 rounded-lg p-4 mb-4")},m(u,r){G(u,e,r),a(e,t),a(t,l)},p(u,r){r[0]&2&&s!==(s=u[25].error+"")&&Q(l,s)},d(u){u&&_(e)}}}function qe(n){let e,t,s="Detailed Results:",l,u=Y(n[25].sub_results),r=[];for(let i=0;i<u.length;i+=1)r[i]=Re(Pe(n,u,i));return{c(){e=v("div"),t=v("h4"),t.textContent=s,l=$();for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l(i){e=g(i,"DIV",{class:!0});var d=m(e);t=g(d,"H4",{class:!0,"data-svelte-h":!0}),te(t)!=="svelte-16wngg9"&&(t.textContent=s),l=A(d);for(let o=0;o<r.length;o+=1)r[o].l(d);d.forEach(_),this.h()},h(){p(t,"class","font-semibold text-gray-300"),p(e,"class","space-y-3")},m(i,d){G(i,e,d),a(e,t),a(e,l);for(let o=0;o<r.length;o+=1)r[o]&&r[o].m(e,null)},p(i,d){if(d[0]&2){u=Y(i[25].sub_results);let o;for(o=0;o<u.length;o+=1){const c=Pe(i,u,o);r[o]?r[o].p(c,d):(r[o]=Re(c),r[o].c(),r[o].m(e,null))}for(;o<r.length;o+=1)r[o].d(1);r.length=u.length}},d(i){i&&_(e),ue(r,i)}}}function Re(n){let e,t,s,l=n[28].name+"",u,r,i,d=n[28].status+"",o,c,h,f,k=n[28].message+"",C,T,N;return{c(){e=v("div"),t=v("div"),s=v("h5"),u=H(l),r=$(),i=v("span"),o=H(d),h=$(),f=v("p"),C=H(k),T=$(),this.h()},l(I){e=g(I,"DIV",{class:!0});var q=m(e);t=g(q,"DIV",{class:!0});var O=m(t);s=g(O,"H5",{class:!0});var x=m(s);u=U(x,l),x.forEach(_),r=A(O),i=g(O,"SPAN",{class:!0});var P=m(i);o=U(P,d),P.forEach(_),O.forEach(_),h=A(q),f=g(q,"P",{class:!0});var w=m(f);C=U(w,k),w.forEach(_),T=A(q),q.forEach(_),this.h()},h(){p(s,"class","font-medium text-white"),p(i,"class",c="text-sm "+(n[28].status==="Passed"?"text-green-400":n[28].status==="Failed"?"text-red-400":"text-yellow-400")),p(t,"class","flex items-center justify-between mb-2"),p(f,"class","text-gray-400 text-sm"),p(e,"class",N="bg-black/20 rounded-lg p-4 border-l-4 "+(n[28].status==="Passed"?"border-green-500":n[28].status==="Failed"?"border-red-500":"border-yellow-500"))},m(I,q){G(I,e,q),a(e,t),a(t,s),a(s,u),a(t,r),a(t,i),a(i,o),a(e,h),a(e,f),a(f,C),a(e,T)},p(I,q){q[0]&2&&l!==(l=I[28].name+"")&&Q(u,l),q[0]&2&&d!==(d=I[28].status+"")&&Q(o,d),q[0]&2&&c!==(c="text-sm "+(I[28].status==="Passed"?"text-green-400":I[28].status==="Failed"?"text-red-400":"text-yellow-400"))&&p(i,"class",c),q[0]&2&&k!==(k=I[28].message+"")&&Q(C,k),q[0]&2&&N!==(N="bg-black/20 rounded-lg p-4 border-l-4 "+(I[28].status==="Passed"?"border-green-500":I[28].status==="Failed"?"border-red-500":"border-yellow-500"))&&p(e,"class",N)},d(I){I&&_(e)}}}function Oe(n){let e,t,s,l,u=n[25].layer+"",r,i,d=n[9].find(w)?.name+"",o,c,h,f,k,C,T=n[25].status+"",N,I,q,O,x,P;function w(...S){return n[19](n[25],...S)}var V=n[14](n[25].status);function y(S,j){return{props:{class:"w-5 h-5 "+Fe(S[25].status)}}}V&&(f=_e(V,y(n)));function b(S,j){if(S[25].error)return ut;if(S[25].message)return ft}let E=b(n),D=E&&E(n),L=n[25].sub_results&&qe(n);return{c(){e=v("div"),t=v("div"),s=v("h3"),l=H("Layer "),r=H(u),i=H(": "),o=H(d),c=$(),h=v("div"),f&&le(f.$$.fragment),k=$(),C=v("span"),N=H(T),q=$(),D&&D.c(),O=$(),L&&L.c(),x=$(),this.h()},l(S){e=g(S,"DIV",{class:!0});var j=m(e);t=g(j,"DIV",{class:!0});var R=m(t);s=g(R,"H3",{class:!0});var Z=m(s);l=U(Z,"Layer "),r=U(Z,u),i=U(Z,": "),o=U(Z,d),Z.forEach(_),c=A(R),h=g(R,"DIV",{class:!0});var X=m(h);f&&ce(f.$$.fragment,X),k=A(X),C=g(X,"SPAN",{class:!0});var F=m(C);N=U(F,T),F.forEach(_),X.forEach(_),R.forEach(_),q=A(j),D&&D.l(j),O=A(j),L&&L.l(j),x=A(j),j.forEach(_),this.h()},h(){p(s,"class","text-xl font-bold text-white"),p(C,"class",I="px-3 py-1 rounded-full text-sm font-medium "+(n[25].status.toLowerCase()==="passed"?"bg-green-500/20 text-green-400 border border-green-500/50":n[25].status.toLowerCase()==="failed"?"bg-red-500/20 text-red-400 border border-red-500/50":"bg-yellow-500/20 text-yellow-400 border border-yellow-500/50")),p(h,"class","flex items-center space-x-2"),p(t,"class","flex items-center justify-between mb-4"),p(e,"class","frosted rounded-lg p-6 svelte-1q10wko")},m(S,j){G(S,e,j),a(e,t),a(t,s),a(s,l),a(s,r),a(s,i),a(s,o),a(t,c),a(t,h),f&&re(f,h,null),a(h,k),a(h,C),a(C,N),a(e,q),D&&D.m(e,null),a(e,O),L&&L.m(e,null),a(e,x),P=!0},p(S,j){if(n=S,(!P||j[0]&2)&&u!==(u=n[25].layer+"")&&Q(r,u),(!P||j[0]&2)&&d!==(d=n[9].find(w)?.name+"")&&Q(o,d),j[0]&2&&V!==(V=n[14](n[25].status))){if(f){ae();const R=f;K(R.$$.fragment,1,0,()=>{ne(R,1)}),oe()}V?(f=_e(V,y(n)),le(f.$$.fragment),z(f.$$.fragment,1),re(f,h,k)):f=null}else if(V){const R={};j[0]&2&&(R.class="w-5 h-5 "+Fe(n[25].status)),f.$set(R)}(!P||j[0]&2)&&T!==(T=n[25].status+"")&&Q(N,T),(!P||j[0]&2&&I!==(I="px-3 py-1 rounded-full text-sm font-medium "+(n[25].status.toLowerCase()==="passed"?"bg-green-500/20 text-green-400 border border-green-500/50":n[25].status.toLowerCase()==="failed"?"bg-red-500/20 text-red-400 border border-red-500/50":"bg-yellow-500/20 text-yellow-400 border border-yellow-500/50")))&&p(C,"class",I),E===(E=b(n))&&D?D.p(n,j):(D&&D.d(1),D=E&&E(n),D&&(D.c(),D.m(e,O))),n[25].sub_results?L?L.p(n,j):(L=qe(n),L.c(),L.m(e,x)):L&&(L.d(1),L=null)},i(S){P||(f&&z(f.$$.fragment,S),P=!0)},o(S){f&&K(f.$$.fragment,S),P=!1},d(S){S&&_(e),f&&ne(f),D&&D.d(),L&&L.d()}}}function He(n){let e,t,s=n[0].sort().join(", ")+"",l;return{c(){e=v("div"),t=H("Selected layers: "),l=H(s),this.h()},l(u){e=g(u,"DIV",{class:!0});var r=m(e);t=U(r,"Selected layers: "),l=U(r,s),r.forEach(_),this.h()},h(){p(e,"class","mt-3 text-sm text-gray-400")},m(u,r){G(u,e,r),a(e,t),a(e,l)},p(u,r){r[0]&1&&s!==(s=u[0].sort().join(", ")+"")&&Q(l,s)},d(u){u&&_(e)}}}function Ue(n){let e,t,s,l;return t=new Qe({props:{class:"w-4 h-4 mr-2"}}),{c(){e=v("div"),le(t.$$.fragment),s=H(`\r
                Selected for testing`),this.h()},l(u){e=g(u,"DIV",{class:!0});var r=m(e);ce(t.$$.fragment,r),s=U(r,`\r
                Selected for testing`),r.forEach(_),this.h()},h(){p(e,"class","mt-4 flex items-center text-cyan-400 text-sm")},m(u,r){G(u,e,r),re(t,e,null),a(e,s),l=!0},i(u){l||(z(t.$$.fragment,u),l=!0)},o(u){K(t.$$.fragment,u),l=!1},d(u){u&&_(e),ne(t)}}}function Be(n){let e,t,s,l,u,r,i,d,o=n[22].id+"",c,h,f=n[22].name+"",k,C,T,N=n[22].description+"",I,q,O,x=n[22].details+"",P,w,V=n[0].includes(n[22].id),y,b,E,D,L;var S=n[22].icon;function j(X,F){return{props:{class:"w-8 h-8 "+(X[0].includes(X[22].id)?"text-cyan-400":"text-gray-400")}}}S&&(l=_e(S,j(n)));let R=V&&Ue();function Z(){return n[18](n[22])}return{c(){e=v("button"),t=v("div"),s=v("div"),l&&le(l.$$.fragment),u=$(),r=v("div"),i=v("h3"),d=H("Layer "),c=H(o),h=H(": "),k=H(f),C=$(),T=v("p"),I=H(N),q=$(),O=v("p"),P=H(x),w=$(),R&&R.c(),y=$(),this.h()},l(X){e=g(X,"BUTTON",{class:!0});var F=m(e);t=g(F,"DIV",{class:!0});var W=m(t);s=g(W,"DIV",{class:!0});var ee=m(s);l&&ce(l.$$.fragment,ee),ee.forEach(_),u=A(W),r=g(W,"DIV",{class:!0});var se=m(r);i=g(se,"H3",{class:!0});var J=m(i);d=U(J,"Layer "),c=U(J,o),h=U(J,": "),k=U(J,f),J.forEach(_),C=A(se),T=g(se,"P",{class:!0});var B=m(T);I=U(B,N),B.forEach(_),q=A(se),O=g(se,"P",{class:!0});var M=m(O);P=U(M,x),M.forEach(_),se.forEach(_),W.forEach(_),w=A(F),R&&R.l(F),y=A(F),F.forEach(_),this.h()},h(){p(s,"class","flex-shrink-0"),p(i,"class","font-bold text-white mb-1"),p(T,"class","text-gray-400 text-sm mb-2"),p(O,"class","text-gray-500 text-xs"),p(r,"class","flex-1 min-w-0 svelte-1q10wko"),p(t,"class","flex items-start space-x-4"),p(e,"class",b="frosted rounded-lg p-6 text-left transition-all hover:border-cyan-500/50 "+(n[0].includes(n[22].id)?"border-cyan-500 bg-cyan-500/10":"border-gray-700/50 hover:bg-white/5")+" svelte-1q10wko")},m(X,F){G(X,e,F),a(e,t),a(t,s),l&&re(l,s,null),a(t,u),a(t,r),a(r,i),a(i,d),a(i,c),a(i,h),a(i,k),a(r,C),a(r,T),a(T,I),a(r,q),a(r,O),a(O,P),a(e,w),R&&R.m(e,null),a(e,y),E=!0,D||(L=ie(e,"click",Z),D=!0)},p(X,F){if(n=X,S!==(S=n[22].icon)){if(l){ae();const W=l;K(W.$$.fragment,1,0,()=>{ne(W,1)}),oe()}S?(l=_e(S,j(n)),le(l.$$.fragment),z(l.$$.fragment,1),re(l,s,null)):l=null}else if(S){const W={};F[0]&1&&(W.class="w-8 h-8 "+(n[0].includes(n[22].id)?"text-cyan-400":"text-gray-400")),l.$set(W)}F[0]&1&&(V=n[0].includes(n[22].id)),V?R?F[0]&1&&z(R,1):(R=Ue(),R.c(),z(R,1),R.m(e,y)):R&&(ae(),K(R,1,1,()=>{R=null}),oe()),(!E||F[0]&1&&b!==(b="frosted rounded-lg p-6 text-left transition-all hover:border-cyan-500/50 "+(n[0].includes(n[22].id)?"border-cyan-500 bg-cyan-500/10":"border-gray-700/50 hover:bg-white/5")+" svelte-1q10wko"))&&p(e,"class",b)},i(X){E||(l&&z(l.$$.fragment,X),z(R),E=!0)},o(X){l&&K(l.$$.fragment,X),K(R),E=!1},d(X){X&&_(e),l&&ne(l),R&&R.d(),D=!1,L()}}}function je(n){let e,t,s,l,u,r,i,d,o="Open Report";return{c(){e=v("div"),t=v("div"),s=v("p"),l=H("Report saved to: "),u=v("span"),r=H(n[3]),i=$(),d=v("button"),d.textContent=o,this.h()},l(c){e=g(c,"DIV",{class:!0});var h=m(e);t=g(h,"DIV",{class:!0});var f=m(t);s=g(f,"P",{class:!0});var k=m(s);l=U(k,"Report saved to: "),u=g(k,"SPAN",{class:!0});var C=m(u);r=U(C,n[3]),C.forEach(_),k.forEach(_),i=A(f),d=g(f,"BUTTON",{class:!0,"data-svelte-h":!0}),te(d)!=="svelte-x8cx10"&&(d.textContent=o),f.forEach(_),h.forEach(_),this.h()},h(){p(u,"class","text-cyan-400 font-mono"),p(s,"class","text-gray-400"),p(d,"class","px-4 py-2 bg-cyan-500/20 border border-cyan-500/50 rounded-lg hover:bg-cyan-500/30 transition-colors text-cyan-400 text-sm"),p(t,"class","flex items-center justify-between"),p(e,"class","frosted border-t border-gray-700/50 p-4 svelte-1q10wko")},m(c,h){G(c,e,h),a(e,t),a(t,s),a(s,l),a(s,u),a(u,r),a(t,i),a(t,d)},p(c,h){h[0]&8&&Q(r,c[3])},d(c){c&&_(e)}}}function ht(n){let e,t,s,l,u,r='<h1 class="text-3xl font-bold bg-gradient-to-r from-cyan-400 to-pink-500 bg-clip-text text-transparent">Layers</h1> <p class="text-gray-400 mt-1">OSI Layer Network Analysis &amp; Security Testing</p>',i,d,o,c,h,f,k,C,T,N,I,q,O,x,P,w,V,y,b,E,D,L,S,j,R,Z,X,F=n[2]&&Ce(n);o=new ze({props:{class:"w-8 h-8 text-cyan-400"}});const W=[it,ot,at],ee=[];function se(B,M){return B[8]==="layers"?0:B[8]==="results"?1:B[8]==="security"?2:-1}~(L=se(n))&&(S=ee[L]=W[L](n));let J=n[3]&&je(n);return{c(){F&&F.c(),e=$(),t=v("div"),s=v("div"),l=v("div"),u=v("div"),u.innerHTML=r,i=$(),d=v("div"),le(o.$$.fragment),c=$(),h=v("div"),f=v("nav"),k=v("button"),C=H("Layer Selection"),N=$(),I=v("button"),q=H("Test Results"),P=$(),w=v("button"),V=H("Security Analysis"),E=$(),D=v("div"),S&&S.c(),j=$(),J&&J.c(),this.h()},l(B){F&&F.l(B),e=A(B),t=g(B,"DIV",{class:!0});var M=m(t);s=g(M,"DIV",{class:!0});var de=m(s);l=g(de,"DIV",{class:!0});var he=m(l);u=g(he,"DIV",{"data-svelte-h":!0}),te(u)!=="svelte-1xasv47"&&(u.innerHTML=r),i=A(he),d=g(he,"DIV",{class:!0});var ve=m(d);ce(o.$$.fragment,ve),ve.forEach(_),he.forEach(_),de.forEach(_),c=A(M),h=g(M,"DIV",{class:!0});var ge=m(h);f=g(ge,"NAV",{class:!0});var fe=m(f);k=g(fe,"BUTTON",{class:!0});var me=m(k);C=U(me,"Layer Selection"),me.forEach(_),N=A(fe),I=g(fe,"BUTTON",{class:!0});var be=m(I);q=U(be,"Test Results"),be.forEach(_),P=A(fe),w=g(fe,"BUTTON",{class:!0});var ye=m(w);V=U(ye,"Security Analysis"),ye.forEach(_),fe.forEach(_),ge.forEach(_),E=A(M),D=g(M,"DIV",{class:!0,style:!0});var ke=m(D);S&&S.l(ke),ke.forEach(_),j=A(M),J&&J.l(M),M.forEach(_),this.h()},h(){p(d,"class","flex items-center space-x-2"),p(l,"class","flex items-center justify-between"),p(s,"class","frosted border-b border-gray-700/50 p-6 svelte-1q10wko"),p(k,"class",T="py-4 px-2 border-b-2 font-medium text-sm transition-colors "+(n[8]==="layers"?"border-cyan-400 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-300")),p(I,"class",O="py-4 px-2 border-b-2 font-medium text-sm transition-colors "+(n[8]==="results"?"border-cyan-400 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-300")),I.disabled=x=n[1].length===0,p(w,"class",y="py-4 px-2 border-b-2 font-medium text-sm transition-colors "+(n[8]==="security"?"border-cyan-400 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-300")),w.disabled=b=n[5].length===0,p(f,"class","flex space-x-8 px-6"),p(h,"class","frosted border-b border-gray-700/50 svelte-1q10wko"),p(D,"class","flex-1 overflow-y-scroll p-6 svelte-1q10wko"),pe(D,"max-height","calc(100vh - 200px)"),p(t,"class","h-screen flex flex-col bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900")},m(B,M){F&&F.m(B,M),G(B,e,M),G(B,t,M),a(t,s),a(s,l),a(l,u),a(l,i),a(l,d),re(o,d,null),a(t,c),a(t,h),a(h,f),a(f,k),a(k,C),a(f,N),a(f,I),a(I,q),a(f,P),a(f,w),a(w,V),a(t,E),a(t,D),~L&&ee[L].m(D,null),a(t,j),J&&J.m(t,null),R=!0,Z||(X=[ie(k,"click",n[15]),ie(I,"click",n[16]),ie(w,"click",n[17])],Z=!0)},p(B,M){B[2]?F?F.p(B,M):(F=Ce(B),F.c(),F.m(e.parentNode,e)):F&&(F.d(1),F=null),(!R||M[0]&256&&T!==(T="py-4 px-2 border-b-2 font-medium text-sm transition-colors "+(B[8]==="layers"?"border-cyan-400 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-300")))&&p(k,"class",T),(!R||M[0]&256&&O!==(O="py-4 px-2 border-b-2 font-medium text-sm transition-colors "+(B[8]==="results"?"border-cyan-400 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-300")))&&p(I,"class",O),(!R||M[0]&2&&x!==(x=B[1].length===0))&&(I.disabled=x),(!R||M[0]&256&&y!==(y="py-4 px-2 border-b-2 font-medium text-sm transition-colors "+(B[8]==="security"?"border-cyan-400 text-cyan-400":"border-transparent text-gray-400 hover:text-gray-300")))&&p(w,"class",y),(!R||M[0]&32&&b!==(b=B[5].length===0))&&(w.disabled=b);let de=L;L=se(B),L===de?~L&&ee[L].p(B,M):(S&&(ae(),K(ee[de],1,1,()=>{ee[de]=null}),oe()),~L?(S=ee[L],S?S.p(B,M):(S=ee[L]=W[L](B),S.c()),z(S,1),S.m(D,null)):S=null),B[3]?J?J.p(B,M):(J=je(B),J.c(),J.m(t,null)):J&&(J.d(1),J=null)},i(B){R||(z(o.$$.fragment,B),z(S),R=!0)},o(B){K(o.$$.fragment,B),K(S),R=!1},d(B){B&&(_(e),_(t)),F&&F.d(B),ne(o),~L&&ee[L].d(),J&&J.d(),Z=!1,Me(X)}}}function _t(n){return[21,23,25,53,137,139,445,3389].includes(n)}function pt(n){return{21:"Consider using SFTP (port 22) instead of FTP",23:"Disable Telnet and use SSH instead",25:"Secure SMTP with TLS or use submission port 587",53:"Ensure DNS is properly configured and consider DNS-over-TLS",137:"Disable NetBIOS if not required",139:"Disable NetBIOS if not required",445:"Ensure SMB is properly configured and updated",3389:"Use RDP over VPN and enable Network Level Authentication"}[n]||"Consider closing this port if not required"}function Fe(n){switch(n.toLowerCase()){case"passed":return"text-green-400";case"failed":return"text-red-400";case"warning":return"text-yellow-400";default:return"text-gray-400"}}function vt(n,e,t){let s=[],l=[],u=!1,r="",i=null,d=[],o=0,c="",h="layers";const f=[{id:1,name:"Physical Layer",description:"Hardware transmission and physical connectivity",icon:et,details:"Tests network interfaces, cable connections, and physical hardware"},{id:2,name:"Data Link Layer",description:"Framing, error control, and MAC addressing",icon:Ge,details:"Analyzes Ethernet frames, switch operations, and local network protocols"},{id:3,name:"Network Layer",description:"Routing, addressing, and packet forwarding",icon:tt,details:"Tests IP routing, subnetting, and network path analysis"},{id:4,name:"Transport Layer",description:"End-to-end connections and reliability",icon:st,details:"Examines TCP/UDP protocols, port scanning, and connection management"},{id:5,name:"Session Layer",description:"Session management and control",icon:lt,details:"Tests session establishment, maintenance, and termination"},{id:6,name:"Presentation Layer",description:"Data formatting, encryption, and compression",icon:Xe,details:"Analyzes data encryption, compression, and format conversion"},{id:7,name:"Application Layer",description:"User interface and application protocols",icon:ze,details:"Tests HTTP, FTP, SMTP, DNS, and other application protocols"}];async function k(){if(s.length!==0){t(2,u=!0),t(1,l=[]),t(6,o=0);try{for(const b of s){const E=f.find(L=>L.id===b);t(7,c=`Layer ${b}: ${E?.name}`),t(6,o=s.indexOf(b)/s.length*100);const D=await we("layers_run_test",{layerId:b});D&&l.push(D)}t(6,o=100),t(3,r=await we("layers_get_report_path")),C(),T()}catch(b){console.error("Test execution failed:",b),t(1,l=s.map(E=>({layer:E,status:"Failed",message:"Test execution error",error:b.toString()})))}finally{t(2,u=!1),t(6,o=0),t(7,c="")}}}function C(){const b=l.find(D=>D.layer===1),E=l.find(D=>D.layer===2);b?.sub_results&&E?.sub_results&&t(4,i={interfaces:b.sub_results.map(D=>({name:D.name.replace("Interface ","").replace(" Connection",""),status:D.status,addresses:D.diagnostics?.addresses||[],type:D.diagnostics?.type||"Unknown",isVPN:D.diagnostics?.is_vpn||!1,metrics:{txBytes:D.diagnostics?.tx_bytes||0,rxBytes:D.diagnostics?.rx_bytes||0,signalStrength:D.diagnostics?.signal_strength,linkQuality:D.diagnostics?.link_quality}}))})}function T(){t(5,d=[]),l.forEach(b=>{b.diagnostics?.open_ports&&b.diagnostics.open_ports.forEach(E=>{_t(E)&&d.push({severity:"High",type:"Open Vulnerable Port",details:`Port ${E} is open and potentially vulnerable`,recommendation:pt(E)})})})}function N(b){s.indexOf(b)===-1?t(0,s=[...s,b]):t(0,s=s.filter(D=>D!==b))}function I(){t(0,s=f.map(b=>b.id))}function q(){t(0,s=[]),t(1,l=[]),t(3,r=""),t(4,i=null),t(5,d=[])}function O(b){switch(b.toLowerCase()){case"passed":return Qe;case"failed":return rt;case"warning":return Je;default:return nt}}return[s,l,u,r,i,d,o,c,h,f,k,N,I,q,O,()=>t(8,h="layers"),()=>t(8,h="results"),()=>t(8,h="security"),b=>N(b.id),(b,E)=>E.id===b.layer]}class xt extends Ye{constructor(e){super(),Ze(this,e,vt,ht,Ke,{},null,[-1,-1])}}export{xt as default};
