import{s as ll,F as mt,L as At,r as al,u as il,v as cl,w as ul,f as c,a as I,l as se,e as st,g as u,h as g,d as f,c as S,O as pe,m as re,j as i,i as ce,x as s,M as be,n as Ie,J as We,E as rt,o as dl,q as Tt,P as ke,W as gt,p as fl,y as Ye,S as vt,T as lt,k as je,ab as hl,ac as Nt}from"./scheduler.621791d8.js";import{S as sl,i as rl,b as xe,d as De,m as Ce,a as W,t as oe,e as Ee,g as Le,c as Ue}from"./index.de4558f1.js";import{I as pl,g as gl,a as _l,m as pt,b as _t,p as ml,e as Ae,B as bt,D as yt,X as vl,A as bl,j as yl,E as ol}from"./2.a2c3ccf5.js";import{i as Pe}from"./settings.f97860d3.js";/* empty css                        */import{T as nl}from"./test-tube.9ceecfb6.js";import{C as wl}from"./clock.ed1fd7a8.js";import{R as kt}from"./refresh-cw.b945715f.js";import{T as wt}from"./trending-up.650de755.js";import{R as kl}from"./rotate-ccw.63b51a7b.js";function xl(r){let e;const t=r[2].default,l=al(t,r,r[3],null);return{c(){l&&l.c()},l(a){l&&l.l(a)},m(a,n){l&&l.m(a,n),e=!0},p(a,n){l&&l.p&&(!e||n&8)&&il(l,t,a,a[3],e?ul(t,a[3],n,null):cl(a[3]),null)},i(a){e||(W(l,a),e=!0)},o(a){oe(l,a),e=!1},d(a){l&&l.d(a)}}}function Cl(r){let e,t;const l=[{name:"folder-open"},r[1],{iconNode:r[0]}];let a={$$slots:{default:[xl]},$$scope:{ctx:r}};for(let n=0;n<l.length;n+=1)a=mt(a,l[n]);return e=new pl({props:a}),{c(){xe(e.$$.fragment)},l(n){De(e.$$.fragment,n)},m(n,o){Ce(e,n,o),t=!0},p(n,[o]){const h=o&3?gl(l,[l[0],o&2&&_l(n[1]),o&1&&{iconNode:n[0]}]):{};o&8&&(h.$$scope={dirty:o,ctx:n}),e.$set(h)},i(n){t||(W(e.$$.fragment,n),t=!0)},o(n){oe(e.$$.fragment,n),t=!1},d(n){Ee(e,n)}}}function El(r,e,t){let{$$slots:l={},$$scope:a}=e;const n=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2"}]];return r.$$set=o=>{t(1,e=mt(mt({},e),At(o))),"$$scope"in o&&t(3,a=o.$$scope)},e=At(e),[n,e,l,a]}class Dl extends sl{constructor(e){super(),rl(this,e,El,Cl,ll,{})}}const $t=Dl;function Rt(r,e,t){const l=r.slice();return l[87]=e[t],l}function Ot(r,e,t){const l=r.slice();return l[79]=e[t],l}function Lt(r,e,t){const l=r.slice();return l[82]=e[t],l}function Ut(r,e,t){const l=r.slice();return l[82]=e[t],l}function Mt(r,e,t){const l=r.slice();return l[70]=e[t],l}function Ht(r,e,t){const l=r.slice();return l[73]=e[t],l}function Bt(r,e,t){const l=r.slice();return l[76]=e[t],l}function Ft(r,e,t){const l=r.slice();return l[90]=e[t],l}function jt(r){let e,t,l,a,n=r[90].name+"",o,h,d,C,p,b;var v=r[90].icon;function _(y,x){return{props:{class:"w-4 h-4"}}}v&&(t=Tt(v,_()));function w(){return r[38](r[90])}return{c(){e=c("button"),t&&xe(t.$$.fragment),l=I(),a=c("span"),o=se(n),h=I(),this.h()},l(y){e=u(y,"BUTTON",{class:!0});var x=g(e);t&&De(t.$$.fragment,x),l=S(x),a=u(x,"SPAN",{class:!0});var k=g(a);o=re(k,n),k.forEach(f),h=S(x),x.forEach(f),this.h()},h(){i(a,"class","text-sm font-medium"),i(e,"class",d="flex items-center space-x-2 px-4 py-2 rounded-t-lg transition-colors "+(r[0]===r[90].id?"bg-cyan-500/20 border-t border-l border-r border-cyan-500/30 text-cyan-400":"text-gray-400 hover:text-white hover:bg-gray-800/30"))},m(y,x){ce(y,e,x),t&&Ce(t,e,null),s(e,l),s(e,a),s(a,o),s(e,h),C=!0,p||(b=be(e,"click",w),p=!0)},p(y,x){if(r=y,v!==(v=r[90].icon)){if(t){Le();const k=t;oe(k.$$.fragment,1,0,()=>{Ee(k,1)}),Ue()}v?(t=Tt(v,_()),xe(t.$$.fragment),W(t.$$.fragment,1),Ce(t,e,l)):t=null}(!C||x[0]&1&&d!==(d="flex items-center space-x-2 px-4 py-2 rounded-t-lg transition-colors "+(r[0]===r[90].id?"bg-cyan-500/20 border-t border-l border-r border-cyan-500/30 text-cyan-400":"text-gray-400 hover:text-white hover:bg-gray-800/30")))&&i(e,"class",d)},i(y){C||(t&&W(t.$$.fragment,y),C=!0)},o(y){t&&oe(t.$$.fragment,y),C=!1},d(y){y&&f(e),t&&Ee(t),p=!1,b()}}}function Il(r){let e,t,l,a;const n=[Nl,Tl,Al,Pl],o=[];function h(d,C){return d[0]==="config"?0:d[0]==="overview"?1:d[0]==="results"?2:d[0]==="export"?3:-1}return~(e=h(r))&&(t=o[e]=n[e](r)),{c(){t&&t.c(),l=st()},l(d){t&&t.l(d),l=st()},m(d,C){~e&&o[e].m(d,C),ce(d,l,C),a=!0},p(d,C){let p=e;e=h(d),e===p?~e&&o[e].p(d,C):(t&&(Le(),oe(o[p],1,1,()=>{o[p]=null}),Ue()),~e?(t=o[e],t?t.p(d,C):(t=o[e]=n[e](d),t.c()),W(t,1),t.m(l.parentNode,l)):t=null)},i(d){a||(W(t),a=!0)},o(d){oe(t),a=!1},d(d){d&&f(l),~e&&o[e].d(d)}}}function Sl(r){let e,t,l,a,n,o,h="Error",d,C,p,b;return a=new bl({props:{class:"w-5 h-5 text-red-400"}}),{c(){e=c("div"),t=c("div"),l=c("div"),xe(a.$$.fragment),n=I(),o=c("span"),o.textContent=h,d=I(),C=c("p"),p=se(r[2]),this.h()},l(v){e=u(v,"DIV",{class:!0});var _=g(e);t=u(_,"DIV",{class:!0});var w=g(t);l=u(w,"DIV",{class:!0});var y=g(l);De(a.$$.fragment,y),n=S(y),o=u(y,"SPAN",{class:!0,"data-svelte-h":!0}),pe(o)!=="svelte-5jc4em"&&(o.textContent=h),y.forEach(f),d=S(w),C=u(w,"P",{class:!0});var x=g(C);p=re(x,r[2]),x.forEach(f),w.forEach(f),_.forEach(f),this.h()},h(){i(o,"class","text-red-400 font-medium"),i(l,"class","flex items-center space-x-2"),i(C,"class","text-gray-300 mt-2"),i(t,"class","bg-red-500/10 border border-red-500/30 rounded-lg p-4"),i(e,"class","p-6")},m(v,_){ce(v,e,_),s(e,t),s(t,l),Ce(a,l,null),s(l,n),s(l,o),s(t,d),s(t,C),s(C,p),b=!0},p(v,_){(!b||_[0]&4)&&Ie(p,v[2])},i(v){b||(W(a.$$.fragment,v),b=!0)},o(v){oe(a.$$.fragment,v),b=!1},d(v){v&&f(e),Ee(a)}}}function Vl(r){let e,t,l,a,n,o="Analyzing PAN-OS policies...",h;return l=new kt({props:{class:"w-6 h-6 text-cyan-400 animate-spin"}}),{c(){e=c("div"),t=c("div"),xe(l.$$.fragment),a=I(),n=c("span"),n.textContent=o,this.h()},l(d){e=u(d,"DIV",{class:!0});var C=g(e);t=u(C,"DIV",{class:!0});var p=g(t);De(l.$$.fragment,p),a=S(p),n=u(p,"SPAN",{class:!0,"data-svelte-h":!0}),pe(n)!=="svelte-1b79ll"&&(n.textContent=o),p.forEach(f),C.forEach(f),this.h()},h(){i(n,"class","text-gray-300"),i(t,"class","flex items-center space-x-3"),i(e,"class","flex items-center justify-center h-64")},m(d,C){ce(d,e,C),s(e,t),Ce(l,t,null),s(t,a),s(t,n),h=!0},p:Ye,i(d){h||(W(l.$$.fragment,d),h=!0)},o(d){oe(l.$$.fragment,d),h=!1},d(d){d&&f(e),Ee(l)}}}function Pl(r){let e,t,l,a="Export Options",n,o,h,d,C="Export Format",p,b,v,_,w='<label class="block text-sm font-medium text-gray-300 mb-2">Include Data</label> <div class="space-y-2"><label class="flex items-center space-x-2"><input type="checkbox" checked="" class="text-cyan-500 bg-gray-800 border-gray-600 focus:ring-cyan-500"/> <span class="text-gray-300">Policy Rules</span></label> <label class="flex items-center space-x-2"><input type="checkbox" checked="" class="text-cyan-500 bg-gray-800 border-gray-600 focus:ring-cyan-500"/> <span class="text-gray-300">Analysis Results</span></label> <label class="flex items-center space-x-2"><input type="checkbox" checked="" class="text-cyan-500 bg-gray-800 border-gray-600 focus:ring-cyan-500"/> <span class="text-gray-300">Recommendations</span></label></div>',y,x,k,$,V,j,B=Ae(r[25]),P=[];for(let E=0;E<B.length;E+=1)P[E]=zt(Rt(r,B,E));const M=[Rl,$l],R=[];function A(E,O){return E[19]?0:1}return x=A(r),k=R[x]=M[x](r),{c(){e=c("div"),t=c("div"),l=c("h3"),l.textContent=a,n=I(),o=c("div"),h=c("div"),d=c("label"),d.textContent=C,p=I(),b=c("select");for(let E=0;E<P.length;E+=1)P[E].c();v=I(),_=c("div"),_.innerHTML=w,y=I(),k.c(),this.h()},l(E){e=u(E,"DIV",{class:!0});var O=g(e);t=u(O,"DIV",{class:!0});var H=g(t);l=u(H,"H3",{class:!0,"data-svelte-h":!0}),pe(l)!=="svelte-14hg8m"&&(l.textContent=a),n=S(H),o=u(H,"DIV",{class:!0});var L=g(o);h=u(L,"DIV",{});var F=g(h);d=u(F,"LABEL",{class:!0,"data-svelte-h":!0}),pe(d)!=="svelte-d7yixl"&&(d.textContent=C),p=S(F),b=u(F,"SELECT",{class:!0});var G=g(b);for(let ie=0;ie<P.length;ie+=1)P[ie].l(G);G.forEach(f),F.forEach(f),v=S(L),_=u(L,"DIV",{"data-svelte-h":!0}),pe(_)!=="svelte-2rzxz2"&&(_.innerHTML=w),L.forEach(f),y=S(H),k.l(H),H.forEach(f),O.forEach(f),this.h()},h(){i(l,"class","text-lg font-semibold text-white mb-4"),i(d,"class","block text-sm font-medium text-gray-300 mb-2"),i(b,"class","w-full px-3 py-2 bg-black/30 border border-gray-700 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),r[17]===void 0&&vt(()=>r[56].call(b)),i(o,"class","grid grid-cols-1 lg:grid-cols-2 gap-6"),i(t,"class","bg-black/40 border border-gray-700/50 rounded-lg p-6"),i(e,"class","p-6 space-y-6")},m(E,O){ce(E,e,O),s(e,t),s(t,l),s(t,n),s(t,o),s(o,h),s(h,d),s(h,p),s(h,b);for(let H=0;H<P.length;H+=1)P[H]&&P[H].m(b,null);lt(b,r[17],!0),s(o,v),s(o,_),s(t,y),R[x].m(t,null),$=!0,V||(j=be(b,"change",r[56]),V=!0)},p(E,O){if(O[0]&33554432){B=Ae(E[25]);let L;for(L=0;L<B.length;L+=1){const F=Rt(E,B,L);P[L]?P[L].p(F,O):(P[L]=zt(F),P[L].c(),P[L].m(b,null))}for(;L<P.length;L+=1)P[L].d(1);P.length=B.length}O[0]&33685504&&lt(b,E[17]);let H=x;x=A(E),x===H?R[x].p(E,O):(Le(),oe(R[H],1,1,()=>{R[H]=null}),Ue(),k=R[x],k?k.p(E,O):(k=R[x]=M[x](E),k.c()),W(k,1),k.m(t,null))},i(E){$||(W(k),$=!0)},o(E){oe(k),$=!1},d(E){E&&f(e),We(P,E),R[x].d(),V=!1,j()}}}function Al(r){let e,t,l,a,n,o,h,d,C,p,b,v="All Status",_,w="Unused (0 hits)",y,x="Active (>0 hits)",k,$="Disabled",V,j,B,P="All Actions",M,R="Allow",A,E="Deny",O,H="Drop",L,F,G,ie,Q,X,T,ee,K,D,te,N,Z,le,ue,Y=Math.min((r[20]-1)*Qe+1,r[14].length)+"",ge,_e,we=Math.min(r[20]*Qe,r[14].length)+"",de,q,ne=r[14].length+"",me,ae,Te,Se,Ve,ze,Ne,Me,$e,qe,He,Ze,Be,Ge,Re,Fe,et,Oe,ot,ct;o=new pt({props:{class:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 transform -translate-y-1/2"}}),G=new kl({props:{class:"w-4 h-4"}});let Ke=Ae(r[29]),m=[];for(let z=0;z<Ke.length;z+=1)m[z]=qt(Ut(r,Ke,z));let J=Ae(r[24]),U=[];for(let z=0;z<J.length;z+=1)U[z]=Gt(Ot(r,J,z));return{c(){e=c("div"),t=c("div"),l=c("div"),a=c("div"),n=c("div"),xe(o.$$.fragment),h=I(),d=c("input"),C=I(),p=c("select"),b=c("option"),b.textContent=v,_=c("option"),_.textContent=w,y=c("option"),y.textContent=x,k=c("option"),k.textContent=$,V=I(),j=c("select"),B=c("option"),B.textContent=P,M=c("option"),M.textContent=R,A=c("option"),A.textContent=E,O=c("option"),O.textContent=H,L=I(),F=c("button"),xe(G.$$.fragment),ie=I(),Q=c("div"),X=c("div"),T=c("table"),ee=c("thead"),K=c("tr");for(let z=0;z<m.length;z+=1)m[z].c();D=I(),te=c("tbody");for(let z=0;z<U.length;z+=1)U[z].c();N=I(),Z=c("div"),le=c("div"),ue=se("Showing "),ge=se(Y),_e=se(" to "),de=se(we),q=se(" of "),me=se(ne),ae=se(" rules"),Te=I(),Se=c("div"),Ve=c("button"),ze=se("Previous"),Me=I(),$e=c("span"),qe=se("Page "),He=se(r[20]),Ze=se(" of "),Be=se(r[21]),Ge=I(),Re=c("button"),Fe=se("Next"),this.h()},l(z){e=u(z,"DIV",{class:!0});var he=g(e);t=u(he,"DIV",{class:!0});var fe=g(t);l=u(fe,"DIV",{class:!0});var ve=g(l);a=u(ve,"DIV",{class:!0});var xt=g(a);n=u(xt,"DIV",{class:!0});var ut=g(n);De(o.$$.fragment,ut),h=S(ut),d=u(ut,"INPUT",{placeholder:!0,class:!0}),ut.forEach(f),xt.forEach(f),C=S(ve),p=u(ve,"SELECT",{class:!0});var nt=g(p);b=u(nt,"OPTION",{"data-svelte-h":!0}),pe(b)!=="svelte-6joivz"&&(b.textContent=v),_=u(nt,"OPTION",{"data-svelte-h":!0}),pe(_)!=="svelte-1p5m7md"&&(_.textContent=w),y=u(nt,"OPTION",{"data-svelte-h":!0}),pe(y)!=="svelte-za31s3"&&(y.textContent=x),k=u(nt,"OPTION",{"data-svelte-h":!0}),pe(k)!=="svelte-erceb2"&&(k.textContent=$),nt.forEach(f),V=S(ve),j=u(ve,"SELECT",{class:!0});var at=g(j);B=u(at,"OPTION",{"data-svelte-h":!0}),pe(B)!=="svelte-cy3cz0"&&(B.textContent=P),M=u(at,"OPTION",{"data-svelte-h":!0}),pe(M)!=="svelte-1uempdw"&&(M.textContent=R),A=u(at,"OPTION",{"data-svelte-h":!0}),pe(A)!=="svelte-1db5bva"&&(A.textContent=E),O=u(at,"OPTION",{"data-svelte-h":!0}),pe(O)!=="svelte-xczdba"&&(O.textContent=H),at.forEach(f),L=S(ve),F=u(ve,"BUTTON",{class:!0});var Ct=g(F);De(G.$$.fragment,Ct),Ct.forEach(f),ve.forEach(f),fe.forEach(f),ie=S(he),Q=u(he,"DIV",{class:!0});var dt=g(Q);X=u(dt,"DIV",{class:!0,style:!0});var Et=g(X);T=u(Et,"TABLE",{class:!0,style:!0});var ft=g(T);ee=u(ft,"THEAD",{class:!0});var Dt=g(ee);K=u(Dt,"TR",{});var It=g(K);for(let Je=0;Je<m.length;Je+=1)m[Je].l(It);It.forEach(f),Dt.forEach(f),D=S(ft),te=u(ft,"TBODY",{class:!0});var St=g(te);for(let Je=0;Je<U.length;Je+=1)U[Je].l(St);St.forEach(f),ft.forEach(f),Et.forEach(f),N=S(dt),Z=u(dt,"DIV",{class:!0});var ht=g(Z);le=u(ht,"DIV",{class:!0});var Xe=g(le);ue=re(Xe,"Showing "),ge=re(Xe,Y),_e=re(Xe," to "),de=re(Xe,we),q=re(Xe," of "),me=re(Xe,ne),ae=re(Xe," rules"),Xe.forEach(f),Te=S(ht),Se=u(ht,"DIV",{class:!0});var tt=g(Se);Ve=u(tt,"BUTTON",{class:!0});var Vt=g(Ve);ze=re(Vt,"Previous"),Vt.forEach(f),Me=S(tt),$e=u(tt,"SPAN",{class:!0});var it=g($e);qe=re(it,"Page "),He=re(it,r[20]),Ze=re(it," of "),Be=re(it,r[21]),it.forEach(f),Ge=S(tt),Re=u(tt,"BUTTON",{class:!0});var Pt=g(Re);Fe=re(Pt,"Next"),Pt.forEach(f),tt.forEach(f),ht.forEach(f),dt.forEach(f),he.forEach(f),this.h()},h(){i(d,"placeholder","Search rules..."),i(d,"class","w-full pl-10 pr-4 py-2 bg-black/30 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-cyan-500 focus:outline-none"),i(n,"class","relative"),i(a,"class","flex-1 min-w-64"),b.__value="",ke(b,b.__value),_.__value="unused",ke(_,_.__value),y.__value="active",ke(y,y.__value),k.__value="disabled",ke(k,k.__value),i(p,"class","px-3 py-2 bg-black/30 border border-gray-700 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),r[22]===void 0&&vt(()=>r[50].call(p)),B.__value="",ke(B,B.__value),M.__value="allow",ke(M,M.__value),A.__value="deny",ke(A,A.__value),O.__value="drop",ke(O,O.__value),i(j,"class","px-3 py-2 bg-black/30 border border-gray-700 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),r[23]===void 0&&vt(()=>r[51].call(j)),i(F,"class","px-3 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg text-white transition-colors"),i(l,"class","flex flex-wrap items-center gap-4"),i(t,"class","bg-black/40 border border-gray-700/50 rounded-lg p-4"),i(ee,"class","bg-gray-800/50 sticky top-0"),i(te,"class","divide-y divide-gray-700/50"),i(T,"class","min-w-max"),je(T,"width","max-content"),i(X,"class","overflow-auto max-h-[500px] max-w-full border border-gray-700/30 rounded-lg svelte-1ielrec"),je(X,"overflow-x","auto"),je(X,"overflow-y","auto"),i(le,"class","text-sm text-gray-400"),Ve.disabled=Ne=r[20]===1,i(Ve,"class","px-3 py-1 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-800 disabled:cursor-not-allowed rounded text-white text-sm transition-colors"),i($e,"class","px-3 py-1 text-gray-300 text-sm"),Re.disabled=et=r[20]===r[21],i(Re,"class","px-3 py-1 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-800 disabled:cursor-not-allowed rounded text-white text-sm transition-colors"),i(Se,"class","flex space-x-2"),i(Z,"class","px-4 py-3 border-t border-gray-700/50 flex items-center justify-between"),i(Q,"class","bg-black/40 border border-gray-700/50 rounded-lg"),i(e,"class","p-6 space-y-6")},m(z,he){ce(z,e,he),s(e,t),s(t,l),s(l,a),s(a,n),Ce(o,n,null),s(n,h),s(n,d),ke(d,r[15]),s(l,C),s(l,p),s(p,b),s(p,_),s(p,y),s(p,k),lt(p,r[22],!0),s(l,V),s(l,j),s(j,B),s(j,M),s(j,A),s(j,O),lt(j,r[23],!0),s(l,L),s(l,F),Ce(G,F,null),s(e,ie),s(e,Q),s(Q,X),s(X,T),s(T,ee),s(ee,K);for(let fe=0;fe<m.length;fe+=1)m[fe]&&m[fe].m(K,null);s(T,D),s(T,te);for(let fe=0;fe<U.length;fe+=1)U[fe]&&U[fe].m(te,null);r[53](X),s(Q,N),s(Q,Z),s(Z,le),s(le,ue),s(le,ge),s(le,_e),s(le,de),s(le,q),s(le,me),s(le,ae),s(Z,Te),s(Z,Se),s(Se,Ve),s(Ve,ze),s(Se,Me),s(Se,$e),s($e,qe),s($e,He),s($e,Ze),s($e,Be),s(Se,Ge),s(Se,Re),s(Re,Fe),Oe=!0,ot||(ct=[be(d,"input",r[49]),be(p,"change",r[50]),be(j,"change",r[51]),be(F,"click",r[52]),be(Ve,"click",r[54]),be(Re,"click",r[55])],ot=!0)},p(z,he){if(he[0]&32768&&d.value!==z[15]&&ke(d,z[15]),he[0]&4194304&&lt(p,z[22]),he[0]&8388608&&lt(j,z[23]),he[0]&536870912){Ke=Ae(z[29]);let fe;for(fe=0;fe<Ke.length;fe+=1){const ve=Ut(z,Ke,fe);m[fe]?m[fe].p(ve,he):(m[fe]=qt(ve),m[fe].c(),m[fe].m(K,null))}for(;fe<m.length;fe+=1)m[fe].d(1);m.length=Ke.length}if(he[0]&553648128){J=Ae(z[24]);let fe;for(fe=0;fe<J.length;fe+=1){const ve=Ot(z,J,fe);U[fe]?U[fe].p(ve,he):(U[fe]=Gt(ve),U[fe].c(),U[fe].m(te,null))}for(;fe<U.length;fe+=1)U[fe].d(1);U.length=J.length}(!Oe||he[0]&1064960)&&Y!==(Y=Math.min((z[20]-1)*Qe+1,z[14].length)+"")&&Ie(ge,Y),(!Oe||he[0]&1064960)&&we!==(we=Math.min(z[20]*Qe,z[14].length)+"")&&Ie(de,we),(!Oe||he[0]&16384)&&ne!==(ne=z[14].length+"")&&Ie(me,ne),(!Oe||he[0]&1048576&&Ne!==(Ne=z[20]===1))&&(Ve.disabled=Ne),(!Oe||he[0]&1048576)&&Ie(He,z[20]),(!Oe||he[0]&2097152)&&Ie(Be,z[21]),(!Oe||he[0]&3145728&&et!==(et=z[20]===z[21]))&&(Re.disabled=et)},i(z){Oe||(W(o.$$.fragment,z),W(G.$$.fragment,z),Oe=!0)},o(z){oe(o.$$.fragment,z),oe(G.$$.fragment,z),Oe=!1},d(z){z&&f(e),Ee(o),Ee(G),We(m,z),We(U,z),r[53](null),ot=!1,rt(ct)}}}function Tl(r){let e,t,l,a;const n=[ql,zl],o=[];function h(d,C){return d[16].length>0?0:1}return t=h(r),l=o[t]=n[t](r),{c(){e=c("div"),l.c(),this.h()},l(d){e=u(d,"DIV",{class:!0});var C=g(e);l.l(C),C.forEach(f),this.h()},h(){i(e,"class","p-6 space-y-6")},m(d,C){ce(d,e,C),o[t].m(e,null),a=!0},p(d,C){let p=t;t=h(d),t===p?o[t].p(d,C):(Le(),oe(o[p],1,1,()=>{o[p]=null}),Ue(),l=o[t],l?l.p(d,C):(l=o[t]=n[t](d),l.c()),W(l,1),l.m(e,null))},i(d){a||(W(l),a=!0)},o(d){oe(l),a=!1},d(d){d&&f(e),o[t].d()}}}function Nl(r){let e,t,l,a="Analysis Mode",n,o,h,d,C,p,b="API Connection",v,_,w,y,x,k="CSV Import",$,V,j,B,P,M,R=r[6]==="API Connection"&&Jt(r),A=r[6]==="CSV Import"&&Qt(r);return B=hl(r[40][0]),{c(){e=c("div"),t=c("div"),l=c("h3"),l.textContent=a,n=I(),o=c("div"),h=c("label"),d=c("input"),C=I(),p=c("span"),p.textContent=b,v=I(),_=c("label"),w=c("input"),y=I(),x=c("span"),x.textContent=k,$=I(),R&&R.c(),V=I(),A&&A.c(),this.h()},l(E){e=u(E,"DIV",{class:!0});var O=g(e);t=u(O,"DIV",{class:!0});var H=g(t);l=u(H,"H3",{class:!0,"data-svelte-h":!0}),pe(l)!=="svelte-1srbcen"&&(l.textContent=a),n=S(H),o=u(H,"DIV",{class:!0});var L=g(o);h=u(L,"LABEL",{class:!0});var F=g(h);d=u(F,"INPUT",{type:!0,class:!0}),C=S(F),p=u(F,"SPAN",{class:!0,"data-svelte-h":!0}),pe(p)!=="svelte-f8xj1c"&&(p.textContent=b),F.forEach(f),v=S(L),_=u(L,"LABEL",{class:!0});var G=g(_);w=u(G,"INPUT",{type:!0,class:!0}),y=S(G),x=u(G,"SPAN",{class:!0,"data-svelte-h":!0}),pe(x)!=="svelte-1wgtm6h"&&(x.textContent=k),G.forEach(f),L.forEach(f),H.forEach(f),$=S(O),R&&R.l(O),V=S(O),A&&A.l(O),O.forEach(f),this.h()},h(){i(l,"class","text-lg font-semibold text-white mb-4"),i(d,"type","radio"),d.__value="API Connection",ke(d,d.__value),i(d,"class","text-cyan-500 bg-gray-800 border-gray-600 focus:ring-cyan-500"),i(p,"class","text-gray-300"),i(h,"class","flex items-center space-x-2 cursor-pointer"),i(w,"type","radio"),w.__value="CSV Import",ke(w,w.__value),i(w,"class","text-cyan-500 bg-gray-800 border-gray-600 focus:ring-cyan-500"),i(x,"class","text-gray-300"),i(_,"class","flex items-center space-x-2 cursor-pointer"),i(o,"class","flex space-x-4"),i(t,"class","bg-black/40 border border-gray-700/50 rounded-lg p-6"),i(e,"class","p-6 space-y-6"),B.p(d,w)},m(E,O){ce(E,e,O),s(e,t),s(t,l),s(t,n),s(t,o),s(o,h),s(h,d),d.checked=d.__value===r[6],s(h,C),s(h,p),s(o,v),s(o,_),s(_,w),w.checked=w.__value===r[6],s(_,y),s(_,x),s(e,$),R&&R.m(e,null),s(e,V),A&&A.m(e,null),j=!0,P||(M=[be(d,"change",r[39]),be(w,"change",r[41])],P=!0)},p(E,O){O[0]&64&&(d.checked=d.__value===E[6]),O[0]&64&&(w.checked=w.__value===E[6]),E[6]==="API Connection"?R?(R.p(E,O),O[0]&64&&W(R,1)):(R=Jt(E),R.c(),W(R,1),R.m(e,V)):R&&(Le(),oe(R,1,1,()=>{R=null}),Ue()),E[6]==="CSV Import"?A?(A.p(E,O),O[0]&64&&W(A,1)):(A=Qt(E),A.c(),W(A,1),A.m(e,null)):A&&(Le(),oe(A,1,1,()=>{A=null}),Ue())},i(E){j||(W(R),W(A),j=!0)},o(E){oe(R),oe(A),j=!1},d(E){E&&f(e),R&&R.d(),A&&A.d(),B.r(),P=!1,rt(M)}}}function zt(r){let e,t=r[87]+"",l;return{c(){e=c("option"),l=se(t),this.h()},l(a){e=u(a,"OPTION",{});var n=g(e);l=re(n,t),n.forEach(f),this.h()},h(){e.__value=r[87],ke(e,e.__value)},m(a,n){ce(a,e,n),s(e,l)},p:Ye,d(a){a&&f(e)}}}function $l(r){let e,t,l,a,n,o,h,d,C;return l=new yt({props:{class:"w-4 h-4 mr-2 inline"}}),{c(){e=c("div"),t=c("button"),xe(l.$$.fragment),a=se(`\r
                  Export `),n=se(r[17]),this.h()},l(p){e=u(p,"DIV",{class:!0});var b=g(e);t=u(b,"BUTTON",{class:!0});var v=g(t);De(l.$$.fragment,v),a=re(v,`\r
                  Export `),n=re(v,r[17]),v.forEach(f),b.forEach(f),this.h()},h(){t.disabled=o=!r[13].length,i(t,"class","px-6 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors"),i(e,"class","mt-6")},m(p,b){ce(p,e,b),s(e,t),Ce(l,t,null),s(t,a),s(t,n),h=!0,d||(C=be(t,"click",r[31]),d=!0)},p(p,b){(!h||b[0]&131072)&&Ie(n,p[17]),(!h||b[0]&8192&&o!==(o=!p[13].length))&&(t.disabled=o)},i(p){h||(W(l.$$.fragment,p),h=!0)},o(p){oe(l.$$.fragment,p),h=!1},d(p){p&&f(e),Ee(l),d=!1,C()}}}function Rl(r){let e,t,l,a="Exporting...",n,o,h,d,C,p,b;return{c(){e=c("div"),t=c("div"),l=c("span"),l.textContent=a,n=I(),o=c("span"),h=se(r[18]),d=se("%"),C=I(),p=c("div"),b=c("div"),this.h()},l(v){e=u(v,"DIV",{class:!0});var _=g(e);t=u(_,"DIV",{class:!0});var w=g(t);l=u(w,"SPAN",{class:!0,"data-svelte-h":!0}),pe(l)!=="svelte-lymfme"&&(l.textContent=a),n=S(w),o=u(w,"SPAN",{class:!0});var y=g(o);h=re(y,r[18]),d=re(y,"%"),y.forEach(f),w.forEach(f),C=S(_),p=u(_,"DIV",{class:!0});var x=g(p);b=u(x,"DIV",{class:!0,style:!0}),g(b).forEach(f),x.forEach(f),_.forEach(f),this.h()},h(){i(l,"class","text-sm text-gray-300"),i(o,"class","text-sm text-gray-300"),i(t,"class","flex items-center justify-between mb-2"),i(b,"class","bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-300"),je(b,"width",r[18]+"%"),i(p,"class","w-full bg-gray-700 rounded-full h-2"),i(e,"class","mt-6")},m(v,_){ce(v,e,_),s(e,t),s(t,l),s(t,n),s(t,o),s(o,h),s(o,d),s(e,C),s(e,p),s(p,b)},p(v,_){_[0]&262144&&Ie(h,v[18]),_[0]&262144&&je(b,"width",v[18]+"%")},i:Ye,o:Ye,d(v){v&&f(e)}}}function qt(r){let e,t=r[82].label+"",l,a;return{c(){e=c("th"),l=se(t),a=I(),this.h()},l(n){e=u(n,"TH",{class:!0,style:!0});var o=g(e);l=re(o,t),a=S(o),o.forEach(f),this.h()},h(){i(e,"class","px-2 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider whitespace-nowrap"),je(e,"min-width",r[82].width)},m(n,o){ce(n,e,o),s(e,l),s(e,a)},p:Ye,d(n){n&&f(e)}}}function Ol(r){let e=(r[79][r[82].key]||"")+"",t;return{c(){t=se(e)},l(l){t=re(l,e)},m(l,a){ce(l,t,a)},p(l,a){a[0]&16777216&&e!==(e=(l[79][l[82].key]||"")+"")&&Ie(t,e)},d(l){l&&f(t)}}}function Ll(r){let e;function t(n,o){return n[79][n[82].key]?jl:Fl}let l=t(r),a=l(r);return{c(){e=c("div"),a.c(),this.h()},l(n){e=u(n,"DIV",{class:!0});var o=g(e);a.l(o),o.forEach(f),this.h()},h(){i(e,"class","max-w-xs")},m(n,o){ce(n,e,o),a.m(e,null)},p(n,o){l===(l=t(n))&&a?a.p(n,o):(a.d(1),a=l(n),a&&(a.c(),a.m(e,null)))},d(n){n&&f(e),a.d()}}}function Ul(r){let e=(r[79][r[82].key]?new Date(r[79][r[82].key]).toLocaleDateString():"Never")+"",t;return{c(){t=se(e)},l(l){t=re(l,e)},m(l,a){ce(l,t,a)},p(l,a){a[0]&16777216&&e!==(e=(l[79][l[82].key]?new Date(l[79][l[82].key]).toLocaleDateString():"Never")+"")&&Ie(t,e)},d(l){l&&f(t)}}}function Ml(r){let e,t=r[79][r[82].key]?"Yes":"No",l,a;return{c(){e=c("span"),l=se(t),this.h()},l(n){e=u(n,"SPAN",{class:!0});var o=g(e);l=re(o,t),o.forEach(f),this.h()},h(){i(e,"class",a=r[79][r[82].key]?"text-red-400":"text-green-400")},m(n,o){ce(n,e,o),s(e,l)},p(n,o){o[0]&16777216&&t!==(t=n[79][n[82].key]?"Yes":"No")&&Ie(l,t),o[0]&16777216&&a!==(a=n[79][n[82].key]?"text-red-400":"text-green-400")&&i(e,"class",a)},d(n){n&&f(e)}}}function Hl(r){let e,t=(r[79][r[82].key]||0).toLocaleString()+"",l,a;return{c(){e=c("span"),l=se(t),this.h()},l(n){e=u(n,"SPAN",{class:!0});var o=g(e);l=re(o,t),o.forEach(f),this.h()},h(){i(e,"class",a=(r[79][r[82].key]||0)===0?"text-yellow-400":"text-green-400")},m(n,o){ce(n,e,o),s(e,l)},p(n,o){o[0]&16777216&&t!==(t=(n[79][n[82].key]||0).toLocaleString()+"")&&Ie(l,t),o[0]&16777216&&a!==(a=(n[79][n[82].key]||0)===0?"text-yellow-400":"text-green-400")&&i(e,"class",a)},d(n){n&&f(e)}}}function Bl(r){let e,t=(r[79][r[82].key]||"")+"",l,a;return{c(){e=c("span"),l=se(t),this.h()},l(n){e=u(n,"SPAN",{class:!0});var o=g(e);l=re(o,t),o.forEach(f),this.h()},h(){i(e,"class",a=Nt(tl(r[79][r[82].key]||""))+" svelte-1ielrec")},m(n,o){ce(n,e,o),s(e,l)},p(n,o){o[0]&16777216&&t!==(t=(n[79][n[82].key]||"")+"")&&Ie(l,t),o[0]&16777216&&a!==(a=Nt(tl(n[79][n[82].key]||""))+" svelte-1ielrec")&&i(e,"class",a)},d(n){n&&f(e)}}}function Fl(r){let e,t="No recommendation";return{c(){e=c("span"),e.textContent=t,this.h()},l(l){e=u(l,"SPAN",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1uer58c"&&(e.textContent=t),this.h()},h(){i(e,"class","text-gray-500")},m(l,a){ce(l,e,a)},p:Ye,d(l){l&&f(e)}}}function jl(r){let e,t=(r[79][r[82].key].length>50?r[79][r[82].key].substring(0,50)+"...":r[79][r[82].key])+"",l,a,n;return{c(){e=c("span"),l=se(t),this.h()},l(o){e=u(o,"SPAN",{class:!0,title:!0});var h=g(e);l=re(h,t),h.forEach(f),this.h()},h(){i(e,"class",a=r[79][r[82].key].includes("Disable:")?"text-yellow-400":r[79][r[82].key].includes("Shadowed by")?"text-red-400":r[79][r[82].key].includes("Merge-candidate")?"text-green-400":"text-gray-300"),i(e,"title",n=r[79][r[82].key])},m(o,h){ce(o,e,h),s(e,l)},p(o,h){h[0]&16777216&&t!==(t=(o[79][o[82].key].length>50?o[79][o[82].key].substring(0,50)+"...":o[79][o[82].key])+"")&&Ie(l,t),h[0]&16777216&&a!==(a=o[79][o[82].key].includes("Disable:")?"text-yellow-400":o[79][o[82].key].includes("Shadowed by")?"text-red-400":o[79][o[82].key].includes("Merge-candidate")?"text-green-400":"text-gray-300")&&i(e,"class",a),h[0]&16777216&&n!==(n=o[79][o[82].key])&&i(e,"title",n)},d(o){o&&f(e)}}}function Zt(r){let e;function t(n,o){return n[82].key==="action"?Bl:n[82].key==="ruleUsageHitCount"?Hl:n[82].key==="disabled"||n[82].key==="logStart"||n[82].key==="logEnd"||n[82].key==="negateSrc"||n[82].key==="negateDst"?Ml:n[82].key==="ruleUsageLastHit"||n[82].key==="ruleUsageFirstHit"||n[82].key==="modified"||n[82].key==="created"?Ul:n[82].key==="recommendation"?Ll:Ol}let a=t(r)(r);return{c(){e=c("td"),a.c(),this.h()},l(n){e=u(n,"TD",{class:!0,style:!0});var o=g(e);a.l(o),o.forEach(f),this.h()},h(){i(e,"class","px-2 py-3 text-xs text-gray-300 whitespace-nowrap"),je(e,"min-width",r[82].width)},m(n,o){ce(n,e,o),a.m(e,null)},p(n,o){a.p(n,o)},d(n){n&&f(e),a.d()}}}function Gt(r){let e,t,l,a=Ae(r[29]),n=[];for(let o=0;o<a.length;o+=1)n[o]=Zt(Lt(r,a,o));return{c(){e=c("tr");for(let o=0;o<n.length;o+=1)n[o].c();t=I(),this.h()},l(o){e=u(o,"TR",{class:!0});var h=g(e);for(let d=0;d<n.length;d+=1)n[d].l(h);t=S(h),h.forEach(f),this.h()},h(){i(e,"class",l="hover:bg-gray-800/30 transition-colors "+(r[79].disabled?"opacity-50":""))},m(o,h){ce(o,e,h);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(e,null);s(e,t)},p(o,h){if(h[0]&553648128){a=Ae(o[29]);let d;for(d=0;d<a.length;d+=1){const C=Lt(o,a,d);n[d]?n[d].p(C,h):(n[d]=Zt(C),n[d].c(),n[d].m(e,t))}for(;d<n.length;d+=1)n[d].d(1);n.length=a.length}h[0]&16777216&&l!==(l="hover:bg-gray-800/30 transition-colors "+(o[79].disabled?"opacity-50":""))&&i(e,"class",l)},d(o){o&&f(e),We(n,o)}}}function zl(r){let e,t,l,a,n,o="No overview data available",h,d,C="Import a CSV file to see detailed analysis metrics",p,b,v;l=new yl({props:{class:"w-12 h-12 text-gray-500 mx-auto mb-4"}});let _=r[11].lastAnalysis&&Kt(r);return{c(){e=c("div"),t=c("div"),xe(l.$$.fragment),a=I(),n=c("p"),n.textContent=o,h=I(),d=c("p"),d.textContent=C,p=I(),_&&_.c(),b=st(),this.h()},l(w){e=u(w,"DIV",{class:!0});var y=g(e);t=u(y,"DIV",{class:!0});var x=g(t);De(l.$$.fragment,x),a=S(x),n=u(x,"P",{class:!0,"data-svelte-h":!0}),pe(n)!=="svelte-151h83k"&&(n.textContent=o),h=S(x),d=u(x,"P",{class:!0,"data-svelte-h":!0}),pe(d)!=="svelte-11cytwd"&&(d.textContent=C),x.forEach(f),y.forEach(f),p=S(w),_&&_.l(w),b=st(),this.h()},h(){i(n,"class","text-gray-400 mb-2"),i(d,"class","text-sm text-gray-500"),i(t,"class","text-center py-8"),i(e,"class","bg-black/40 border border-gray-700/50 rounded-lg p-6")},m(w,y){ce(w,e,y),s(e,t),Ce(l,t,null),s(t,a),s(t,n),s(t,h),s(t,d),ce(w,p,y),_&&_.m(w,y),ce(w,b,y),v=!0},p(w,y){w[11].lastAnalysis?_?(_.p(w,y),y[0]&2048&&W(_,1)):(_=Kt(w),_.c(),W(_,1),_.m(b.parentNode,b)):_&&(Le(),oe(_,1,1,()=>{_=null}),Ue())},i(w){v||(W(l.$$.fragment,w),W(_),v=!0)},o(w){oe(l.$$.fragment,w),oe(_),v=!1},d(w){w&&(f(e),f(p),f(b)),Ee(l),_&&_.d(w)}}}function ql(r){let e,t,l,a,n,o,h,d,C="Rule Hit Count Distribution",p,b,v,_,w,y="Rule Action Distribution",x,k,$,V,j,B,P,M,R,A,E,O,H='<tr><th class="px-4 py-3 text-left text-sm font-medium text-gray-300 border-r border-gray-700/30">Category</th> <th class="px-4 py-3 text-left text-sm font-medium text-gray-300 border-r border-gray-700/30">Metric</th> <th class="px-4 py-3 text-left text-sm font-medium text-gray-300 border-r border-gray-700/30">Value</th> <th class="px-4 py-3 text-left text-sm font-medium text-gray-300">Description</th></tr>',L,F,G;l=new wt({props:{class:"w-5 h-5 text-cyan-400 mr-2"}});let ie=Ae(r[35]()),Q=[];for(let D=0;D<ie.length;D+=1)Q[D]=Xt(Bt(r,ie,D));let X=Ae(r[36]()),T=[];for(let D=0;D<X.length;D+=1)T[D]=Wt(Ht(r,X,D));P=new bt({props:{class:"w-5 h-5 text-cyan-400 mr-2"}});let ee=Ae(r[16]),K=[];for(let D=0;D<ee.length;D+=1)K[D]=Yt(Mt(r,ee,D));return{c(){e=c("div"),t=c("h3"),xe(l.$$.fragment),a=se(`\r
                Traffic Analysis`),n=I(),o=c("div"),h=c("div"),d=c("h4"),d.textContent=C,p=I(),b=c("div");for(let D=0;D<Q.length;D+=1)Q[D].c();v=I(),_=c("div"),w=c("h4"),w.textContent=y,x=I(),k=c("div");for(let D=0;D<T.length;D+=1)T[D].c();$=I(),V=c("div"),j=c("div"),B=c("h3"),xe(P.$$.fragment),M=se(`\r
                  Policy Analysis Overview`),R=I(),A=c("div"),E=c("table"),O=c("thead"),O.innerHTML=H,L=I(),F=c("tbody");for(let D=0;D<K.length;D+=1)K[D].c();this.h()},l(D){e=u(D,"DIV",{class:!0});var te=g(e);t=u(te,"H3",{class:!0});var N=g(t);De(l.$$.fragment,N),a=re(N,`\r
                Traffic Analysis`),N.forEach(f),n=S(te),o=u(te,"DIV",{class:!0});var Z=g(o);h=u(Z,"DIV",{class:!0});var le=g(h);d=u(le,"H4",{class:!0,"data-svelte-h":!0}),pe(d)!=="svelte-72d751"&&(d.textContent=C),p=S(le),b=u(le,"DIV",{class:!0});var ue=g(b);for(let ae=0;ae<Q.length;ae+=1)Q[ae].l(ue);ue.forEach(f),le.forEach(f),v=S(Z),_=u(Z,"DIV",{class:!0});var Y=g(_);w=u(Y,"H4",{class:!0,"data-svelte-h":!0}),pe(w)!=="svelte-12jlk1l"&&(w.textContent=y),x=S(Y),k=u(Y,"DIV",{class:!0});var ge=g(k);for(let ae=0;ae<T.length;ae+=1)T[ae].l(ge);ge.forEach(f),Y.forEach(f),Z.forEach(f),te.forEach(f),$=S(D),V=u(D,"DIV",{class:!0});var _e=g(V);j=u(_e,"DIV",{class:!0});var we=g(j);B=u(we,"H3",{class:!0});var de=g(B);De(P.$$.fragment,de),M=re(de,`\r
                  Policy Analysis Overview`),de.forEach(f),we.forEach(f),R=S(_e),A=u(_e,"DIV",{class:!0});var q=g(A);E=u(q,"TABLE",{class:!0});var ne=g(E);O=u(ne,"THEAD",{class:!0,"data-svelte-h":!0}),pe(O)!=="svelte-s6smlz"&&(O.innerHTML=H),L=S(ne),F=u(ne,"TBODY",{class:!0});var me=g(F);for(let ae=0;ae<K.length;ae+=1)K[ae].l(me);me.forEach(f),ne.forEach(f),q.forEach(f),_e.forEach(f),this.h()},h(){i(t,"class","text-lg font-semibold text-white mb-4 flex items-center"),i(d,"class","text-md font-medium text-white mb-3"),i(b,"class","space-y-2"),i(h,"class","bg-gray-800/30 rounded-lg p-4"),i(w,"class","text-md font-medium text-white mb-3"),i(k,"class","space-y-2"),i(_,"class","bg-gray-800/30 rounded-lg p-4"),i(o,"class","grid grid-cols-1 lg:grid-cols-2 gap-6"),i(e,"class","bg-black/40 border border-gray-700/50 rounded-lg p-6"),i(B,"class","text-lg font-semibold text-white flex items-center"),i(j,"class","p-4 border-b border-gray-700/30"),i(O,"class","bg-gray-800/50 sticky top-0"),i(F,"class","divide-y divide-gray-700/30"),i(E,"class","w-full"),i(A,"class","overflow-auto max-h-[600px] svelte-1ielrec"),i(V,"class","bg-black/40 border border-gray-700/50 rounded-lg")},m(D,te){ce(D,e,te),s(e,t),Ce(l,t,null),s(t,a),s(e,n),s(e,o),s(o,h),s(h,d),s(h,p),s(h,b);for(let N=0;N<Q.length;N+=1)Q[N]&&Q[N].m(b,null);s(o,v),s(o,_),s(_,w),s(_,x),s(_,k);for(let N=0;N<T.length;N+=1)T[N]&&T[N].m(k,null);ce(D,$,te),ce(D,V,te),s(V,j),s(j,B),Ce(P,B,null),s(B,M),s(V,R),s(V,A),s(A,E),s(E,O),s(E,L),s(E,F);for(let N=0;N<K.length;N+=1)K[N]&&K[N].m(F,null);G=!0},p(D,te){if(te[1]&16){ie=Ae(D[35]());let N;for(N=0;N<ie.length;N+=1){const Z=Bt(D,ie,N);Q[N]?Q[N].p(Z,te):(Q[N]=Xt(Z),Q[N].c(),Q[N].m(b,null))}for(;N<Q.length;N+=1)Q[N].d(1);Q.length=ie.length}if(te[1]&32){X=Ae(D[36]());let N;for(N=0;N<X.length;N+=1){const Z=Ht(D,X,N);T[N]?T[N].p(Z,te):(T[N]=Wt(Z),T[N].c(),T[N].m(k,null))}for(;N<T.length;N+=1)T[N].d(1);T.length=X.length}if(te[0]&65536){ee=Ae(D[16]);let N;for(N=0;N<ee.length;N+=1){const Z=Mt(D,ee,N);K[N]?K[N].p(Z,te):(K[N]=Yt(Z),K[N].c(),K[N].m(F,null))}for(;N<K.length;N+=1)K[N].d(1);K.length=ee.length}},i(D){G||(W(l.$$.fragment,D),W(P.$$.fragment,D),G=!0)},o(D){oe(l.$$.fragment,D),oe(P.$$.fragment,D),G=!1},d(D){D&&(f(e),f($),f(V)),Ee(l),We(Q,D),We(T,D),Ee(P),We(K,D)}}}function Kt(r){let e,t,l,a,n,o,h,d,C="Last Analysis",p,b,v=new Date(r[11].lastAnalysis).toLocaleString()+"",_,w,y,x,k="Analysis Mode",$,V,j,B,P,M,R="Data Source",A,E,O=r[6]==="CSV Import"?"CSV File":"API Connection",H,L;return l=new wl({props:{class:"w-5 h-5 text-cyan-400 mr-2"}}),{c(){e=c("div"),t=c("h3"),xe(l.$$.fragment),a=se(`\r
                  Analysis Information`),n=I(),o=c("div"),h=c("div"),d=c("p"),d.textContent=C,p=I(),b=c("p"),_=se(v),w=I(),y=c("div"),x=c("p"),x.textContent=k,$=I(),V=c("p"),j=se(r[6]),B=I(),P=c("div"),M=c("p"),M.textContent=R,A=I(),E=c("p"),H=se(O),this.h()},l(F){e=u(F,"DIV",{class:!0});var G=g(e);t=u(G,"H3",{class:!0});var ie=g(t);De(l.$$.fragment,ie),a=re(ie,`\r
                  Analysis Information`),ie.forEach(f),n=S(G),o=u(G,"DIV",{class:!0});var Q=g(o);h=u(Q,"DIV",{});var X=g(h);d=u(X,"P",{class:!0,"data-svelte-h":!0}),pe(d)!=="svelte-14ohspp"&&(d.textContent=C),p=S(X),b=u(X,"P",{class:!0});var T=g(b);_=re(T,v),T.forEach(f),X.forEach(f),w=S(Q),y=u(Q,"DIV",{});var ee=g(y);x=u(ee,"P",{class:!0,"data-svelte-h":!0}),pe(x)!=="svelte-n0gn8q"&&(x.textContent=k),$=S(ee),V=u(ee,"P",{class:!0});var K=g(V);j=re(K,r[6]),K.forEach(f),ee.forEach(f),B=S(Q),P=u(Q,"DIV",{});var D=g(P);M=u(D,"P",{class:!0,"data-svelte-h":!0}),pe(M)!=="svelte-13g2d6u"&&(M.textContent=R),A=S(D),E=u(D,"P",{class:!0});var te=g(E);H=re(te,O),te.forEach(f),D.forEach(f),Q.forEach(f),G.forEach(f),this.h()},h(){i(t,"class","text-lg font-semibold text-white mb-4 flex items-center"),i(d,"class","text-sm text-gray-400"),i(b,"class","text-white font-medium"),i(x,"class","text-sm text-gray-400"),i(V,"class","text-white font-medium"),i(M,"class","text-sm text-gray-400"),i(E,"class","text-white font-medium"),i(o,"class","grid grid-cols-1 md:grid-cols-3 gap-4"),i(e,"class","bg-black/40 border border-gray-700/50 rounded-lg p-6")},m(F,G){ce(F,e,G),s(e,t),Ce(l,t,null),s(t,a),s(e,n),s(e,o),s(o,h),s(h,d),s(h,p),s(h,b),s(b,_),s(o,w),s(o,y),s(y,x),s(y,$),s(y,V),s(V,j),s(o,B),s(o,P),s(P,M),s(P,A),s(P,E),s(E,H),L=!0},p(F,G){(!L||G[0]&2048)&&v!==(v=new Date(F[11].lastAnalysis).toLocaleString()+"")&&Ie(_,v),(!L||G[0]&64)&&Ie(j,F[6]),(!L||G[0]&64)&&O!==(O=F[6]==="CSV Import"?"CSV File":"API Connection")&&Ie(H,O)},i(F){L||(W(l.$$.fragment,F),L=!0)},o(F){oe(l.$$.fragment,F),L=!1},d(F){F&&f(e),Ee(l)}}}function Xt(r){let e,t,l=r[76].label+"",a,n,o,h,d,C,p,b=r[76].count+"",v,_;return{c(){e=c("div"),t=c("span"),a=se(l),n=I(),o=c("div"),h=c("div"),d=c("div"),C=I(),p=c("span"),v=se(b),_=I(),this.h()},l(w){e=u(w,"DIV",{class:!0});var y=g(e);t=u(y,"SPAN",{class:!0});var x=g(t);a=re(x,l),x.forEach(f),n=S(y),o=u(y,"DIV",{class:!0});var k=g(o);h=u(k,"DIV",{class:!0});var $=g(h);d=u($,"DIV",{class:!0,style:!0}),g(d).forEach(f),$.forEach(f),C=S(k),p=u(k,"SPAN",{class:!0});var V=g(p);v=re(V,b),V.forEach(f),k.forEach(f),_=S(y),y.forEach(f),this.h()},h(){i(t,"class","text-sm text-gray-300"),i(d,"class","bg-gradient-to-r from-cyan-500 to-blue-500 h-2 rounded-full transition-all duration-300"),je(d,"width",r[76].percentage+"%"),i(h,"class","w-32 bg-gray-700 rounded-full h-2"),i(p,"class","text-sm text-white font-medium w-12 text-right"),i(o,"class","flex items-center space-x-2"),i(e,"class","flex items-center justify-between")},m(w,y){ce(w,e,y),s(e,t),s(t,a),s(e,n),s(e,o),s(o,h),s(h,d),s(o,C),s(o,p),s(p,v),s(e,_)},p:Ye,d(w){w&&f(e)}}}function Wt(r){let e,t,l=r[73].label+"",a,n,o,h,d,C,p,b=r[73].count+"",v,_;return{c(){e=c("div"),t=c("span"),a=se(l),n=I(),o=c("div"),h=c("div"),d=c("div"),C=I(),p=c("span"),v=se(b),_=I(),this.h()},l(w){e=u(w,"DIV",{class:!0});var y=g(e);t=u(y,"SPAN",{class:!0});var x=g(t);a=re(x,l),x.forEach(f),n=S(y),o=u(y,"DIV",{class:!0});var k=g(o);h=u(k,"DIV",{class:!0});var $=g(h);d=u($,"DIV",{class:!0,style:!0}),g(d).forEach(f),$.forEach(f),C=S(k),p=u(k,"SPAN",{class:!0});var V=g(p);v=re(V,b),V.forEach(f),k.forEach(f),_=S(y),y.forEach(f),this.h()},h(){i(t,"class","text-sm text-gray-300"),i(d,"class","h-2 rounded-full transition-all duration-300 "+r[73].color+" svelte-1ielrec"),je(d,"width",r[73].percentage+"%"),i(h,"class","w-32 bg-gray-700 rounded-full h-2"),i(p,"class","text-sm text-white font-medium w-12 text-right"),i(o,"class","flex items-center space-x-2"),i(e,"class","flex items-center justify-between")},m(w,y){ce(w,e,y),s(e,t),s(t,a),s(e,n),s(e,o),s(o,h),s(h,d),s(o,C),s(o,p),s(p,v),s(e,_)},p:Ye,d(w){w&&f(e)}}}function Yt(r){let e,t,l=r[70].category+"",a,n,o,h=r[70].metric+"",d,C,p,b=r[70].value+"",v,_,w,y=r[70].description+"",x,k;return{c(){e=c("tr"),t=c("td"),a=se(l),n=I(),o=c("td"),d=se(h),C=I(),p=c("td"),v=se(b),_=I(),w=c("td"),x=se(y),k=I(),this.h()},l($){e=u($,"TR",{class:!0});var V=g(e);t=u(V,"TD",{class:!0});var j=g(t);a=re(j,l),j.forEach(f),n=S(V),o=u(V,"TD",{class:!0});var B=g(o);d=re(B,h),B.forEach(f),C=S(V),p=u(V,"TD",{class:!0});var P=g(p);v=re(P,b),P.forEach(f),_=S(V),w=u(V,"TD",{class:!0});var M=g(w);x=re(M,y),M.forEach(f),k=S(V),V.forEach(f),this.h()},h(){i(t,"class","px-4 py-3 text-sm font-medium text-gray-300 border-r border-gray-700/30 bg-gray-800/20"),i(o,"class","px-4 py-3 text-sm text-gray-300 border-r border-gray-700/30"),i(p,"class","px-4 py-3 text-sm font-bold text-white border-r border-gray-700/30"),i(w,"class","px-4 py-3 text-sm text-gray-400"),i(e,"class","hover:bg-gray-800/20 transition-colors")},m($,V){ce($,e,V),s(e,t),s(t,a),s(e,n),s(e,o),s(o,d),s(e,C),s(e,p),s(p,v),s(e,_),s(e,w),s(w,x),s(e,k)},p($,V){V[0]&65536&&l!==(l=$[70].category+"")&&Ie(a,l),V[0]&65536&&h!==(h=$[70].metric+"")&&Ie(d,h),V[0]&65536&&b!==(b=$[70].value+"")&&Ie(v,b),V[0]&65536&&y!==(y=$[70].description+"")&&Ie(x,y)},d($){$&&f(e)}}}function Jt(r){let e,t,l="API Configuration",a,n,o,h,d="API URL / Host",C,p,b,v,_,w="API Key",y,x,k,$,V,j,B,P,M,R,A,E,O,H,L,F,G,ie,Q,X;function T(Y,ge){return Y[9]?Gl:Zl}let ee=T(r),K=ee(r);const D=[Xl,Kl],te=[];function N(Y,ge){return Y[9]?0:1}V=N(r),j=te[V]=D[V](r);const Z=[Yl,Wl],le=[];function ue(Y,ge){return Y[5]?0:1}return R=ue(r),A=le[R]=Z[R](r),L=new pt({props:{class:"w-4 h-4 mr-2 inline"}}),{c(){e=c("div"),t=c("h3"),t.textContent=l,a=I(),n=c("div"),o=c("div"),h=c("label"),h.textContent=d,C=I(),p=c("input"),b=I(),v=c("div"),_=c("label"),_.textContent=w,y=I(),x=c("div"),K.c(),k=I(),$=c("button"),j.c(),B=I(),P=c("div"),M=c("button"),A.c(),O=I(),H=c("button"),xe(L.$$.fragment),F=se(`\r
                  Fetch & Analyze`),this.h()},l(Y){e=u(Y,"DIV",{class:!0});var ge=g(e);t=u(ge,"H3",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-dnd4fa"&&(t.textContent=l),a=S(ge),n=u(ge,"DIV",{class:!0});var _e=g(n);o=u(_e,"DIV",{});var we=g(o);h=u(we,"LABEL",{class:!0,"data-svelte-h":!0}),pe(h)!=="svelte-dvoosg"&&(h.textContent=d),C=S(we),p=u(we,"INPUT",{placeholder:!0,class:!0}),we.forEach(f),b=S(_e),v=u(_e,"DIV",{class:!0});var de=g(v);_=u(de,"LABEL",{class:!0,"data-svelte-h":!0}),pe(_)!=="svelte-6kbqzj"&&(_.textContent=w),y=S(de),x=u(de,"DIV",{class:!0});var q=g(x);K.l(q),k=S(q),$=u(q,"BUTTON",{class:!0});var ne=g($);j.l(ne),ne.forEach(f),q.forEach(f),de.forEach(f),_e.forEach(f),B=S(ge),P=u(ge,"DIV",{class:!0});var me=g(P);M=u(me,"BUTTON",{class:!0});var ae=g(M);A.l(ae),ae.forEach(f),O=S(me),H=u(me,"BUTTON",{class:!0});var Te=g(H);De(L.$$.fragment,Te),F=re(Te,`\r
                  Fetch & Analyze`),Te.forEach(f),me.forEach(f),ge.forEach(f),this.h()},h(){i(t,"class","text-lg font-semibold text-white mb-4"),i(h,"class","block text-sm font-medium text-gray-300 mb-2"),i(p,"placeholder","fw-mgmt.example.com"),i(p,"class","w-full px-3 py-2 bg-black/30 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-cyan-500 focus:outline-none"),i(_,"class","block text-sm font-medium text-gray-300 mb-2"),i($,"class","absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white"),i(x,"class","relative"),i(v,"class","lg:col-span-2"),i(n,"class","grid grid-cols-1 lg:grid-cols-2 gap-4"),M.disabled=E=r[5]||!r[7].url||!r[7].key,i(M,"class","px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors"),H.disabled=G=r[1]||r[10]!=="connected",i(H,"class","px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors"),i(P,"class","flex space-x-3 mt-6"),i(e,"class","bg-black/40 border border-gray-700/50 rounded-lg p-6")},m(Y,ge){ce(Y,e,ge),s(e,t),s(e,a),s(e,n),s(n,o),s(o,h),s(o,C),s(o,p),ke(p,r[7].url),s(n,b),s(n,v),s(v,_),s(v,y),s(v,x),K.m(x,null),s(x,k),s(x,$),te[V].m($,null),s(e,B),s(e,P),s(P,M),le[R].m(M,null),s(P,O),s(P,H),Ce(L,H,null),s(H,F),ie=!0,Q||(X=[be(p,"input",r[42]),be($,"click",r[45]),be(M,"click",r[30]),be(H,"click",r[28])],Q=!0)},p(Y,ge){ge[0]&128&&p.value!==Y[7].url&&ke(p,Y[7].url),ee===(ee=T(Y))&&K?K.p(Y,ge):(K.d(1),K=ee(Y),K&&(K.c(),K.m(x,k)));let _e=V;V=N(Y),V!==_e&&(Le(),oe(te[_e],1,1,()=>{te[_e]=null}),Ue(),j=te[V],j||(j=te[V]=D[V](Y),j.c()),W(j,1),j.m($,null));let we=R;R=ue(Y),R!==we&&(Le(),oe(le[we],1,1,()=>{le[we]=null}),Ue(),A=le[R],A||(A=le[R]=Z[R](Y),A.c()),W(A,1),A.m(M,null)),(!ie||ge[0]&160&&E!==(E=Y[5]||!Y[7].url||!Y[7].key))&&(M.disabled=E),(!ie||ge[0]&1026&&G!==(G=Y[1]||Y[10]!=="connected"))&&(H.disabled=G)},i(Y){ie||(W(j),W(A),W(L.$$.fragment,Y),ie=!0)},o(Y){oe(j),oe(A),oe(L.$$.fragment,Y),ie=!1},d(Y){Y&&f(e),K.d(),te[V].d(),le[R].d(),Ee(L),Q=!1,rt(X)}}}function Zl(r){let e,t,l;return{c(){e=c("input"),this.h()},l(a){e=u(a,"INPUT",{type:!0,placeholder:!0,class:!0}),this.h()},h(){i(e,"type","password"),i(e,"placeholder","Enter your API key..."),i(e,"class","w-full px-3 py-2 pr-10 bg-black/30 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-cyan-500 focus:outline-none")},m(a,n){ce(a,e,n),ke(e,r[7].key),t||(l=be(e,"input",r[44]),t=!0)},p(a,n){n[0]&128&&e.value!==a[7].key&&ke(e,a[7].key)},d(a){a&&f(e),t=!1,l()}}}function Gl(r){let e,t,l;return{c(){e=c("input"),this.h()},l(a){e=u(a,"INPUT",{type:!0,placeholder:!0,class:!0}),this.h()},h(){i(e,"type","text"),i(e,"placeholder","Enter your API key..."),i(e,"class","w-full px-3 py-2 pr-10 bg-black/30 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-cyan-500 focus:outline-none")},m(a,n){ce(a,e,n),ke(e,r[7].key),t||(l=be(e,"input",r[43]),t=!0)},p(a,n){n[0]&128&&e.value!==a[7].key&&ke(e,a[7].key)},d(a){a&&f(e),t=!1,l()}}}function Kl(r){let e,t;return e=new ol({props:{class:"w-4 h-4"}}),{c(){xe(e.$$.fragment)},l(l){De(e.$$.fragment,l)},m(l,a){Ce(e,l,a),t=!0},i(l){t||(W(e.$$.fragment,l),t=!0)},o(l){oe(e.$$.fragment,l),t=!1},d(l){Ee(e,l)}}}function Xl(r){let e,t;return e=new ol({props:{class:"w-4 h-4"}}),{c(){xe(e.$$.fragment)},l(l){De(e.$$.fragment,l)},m(l,a){Ce(e,l,a),t=!0},i(l){t||(W(e.$$.fragment,l),t=!0)},o(l){oe(e.$$.fragment,l),t=!1},d(l){Ee(e,l)}}}function Wl(r){let e,t,l;return e=new nl({props:{class:"w-4 h-4 mr-2 inline"}}),{c(){xe(e.$$.fragment),t=se(`\r
                    Test Connection`)},l(a){De(e.$$.fragment,a),t=re(a,`\r
                    Test Connection`)},m(a,n){Ce(e,a,n),ce(a,t,n),l=!0},i(a){l||(W(e.$$.fragment,a),l=!0)},o(a){oe(e.$$.fragment,a),l=!1},d(a){a&&f(t),Ee(e,a)}}}function Yl(r){let e,t,l;return e=new kt({props:{class:"w-4 h-4 mr-2 inline animate-spin"}}),{c(){xe(e.$$.fragment),t=se(`\r
                    Testing...`)},l(a){De(e.$$.fragment,a),t=re(a,`\r
                    Testing...`)},m(a,n){Ce(e,a,n),ce(a,t,n),l=!0},i(a){l||(W(e.$$.fragment,a),l=!0)},o(a){oe(e.$$.fragment,a),l=!1},d(a){a&&f(t),Ee(e,a)}}}function Qt(r){let e,t,l="CSV Import Configuration",a,n,o,h,d="CSV File",C,p,b,v,_,w,y,x,k,$,V="Output Directory",j,B,P,M,R,A,E,O,H,L,F,G,ie,Q,X,T,ee,K,D,te,N;return w=new $t({props:{class:"w-4 h-4 mr-2 inline"}}),A=new $t({props:{class:"w-4 h-4 mr-2 inline"}}),F=new pt({props:{class:"w-4 h-4 mr-2 inline"}}),T=new nl({props:{class:"w-4 h-4 mr-2 inline"}}),{c(){e=c("div"),t=c("h3"),t.textContent=l,a=I(),n=c("div"),o=c("div"),h=c("label"),h.textContent=d,C=I(),p=c("div"),b=c("input"),v=I(),_=c("button"),xe(w.$$.fragment),y=se(`\r
                      Browse`),x=I(),k=c("div"),$=c("label"),$.textContent=V,j=I(),B=c("div"),P=c("input"),M=I(),R=c("button"),xe(A.$$.fragment),E=se(`\r
                      Browse`),O=I(),H=c("div"),L=c("button"),xe(F.$$.fragment),G=se(`\r
                  Import & Analyze`),Q=I(),X=c("button"),xe(T.$$.fragment),ee=se(`\r
                  Debug CSV`),this.h()},l(Z){e=u(Z,"DIV",{class:!0});var le=g(e);t=u(le,"H3",{class:!0,"data-svelte-h":!0}),pe(t)!=="svelte-1sbgoeh"&&(t.textContent=l),a=S(le),n=u(le,"DIV",{class:!0});var ue=g(n);o=u(ue,"DIV",{});var Y=g(o);h=u(Y,"LABEL",{class:!0,"data-svelte-h":!0}),pe(h)!=="svelte-13tzivk"&&(h.textContent=d),C=S(Y),p=u(Y,"DIV",{class:!0});var ge=g(p);b=u(ge,"INPUT",{placeholder:!0,class:!0}),v=S(ge),_=u(ge,"BUTTON",{class:!0});var _e=g(_);De(w.$$.fragment,_e),y=re(_e,`\r
                      Browse`),_e.forEach(f),ge.forEach(f),Y.forEach(f),x=S(ue),k=u(ue,"DIV",{});var we=g(k);$=u(we,"LABEL",{class:!0,"data-svelte-h":!0}),pe($)!=="svelte-kdxujs"&&($.textContent=V),j=S(we),B=u(we,"DIV",{class:!0});var de=g(B);P=u(de,"INPUT",{placeholder:!0,class:!0}),M=S(de),R=u(de,"BUTTON",{class:!0});var q=g(R);De(A.$$.fragment,q),E=re(q,`\r
                      Browse`),q.forEach(f),de.forEach(f),we.forEach(f),ue.forEach(f),O=S(le),H=u(le,"DIV",{class:!0});var ne=g(H);L=u(ne,"BUTTON",{class:!0});var me=g(L);De(F.$$.fragment,me),G=re(me,`\r
                  Import & Analyze`),me.forEach(f),Q=S(ne),X=u(ne,"BUTTON",{class:!0});var ae=g(X);De(T.$$.fragment,ae),ee=re(ae,`\r
                  Debug CSV`),ae.forEach(f),ne.forEach(f),le.forEach(f),this.h()},h(){i(t,"class","text-lg font-semibold text-white mb-4"),i(h,"class","block text-sm font-medium text-gray-300 mb-2"),i(b,"placeholder","Select CSV file..."),b.readOnly=!0,i(b,"class","flex-1 px-3 py-2 bg-black/30 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-cyan-500 focus:outline-none"),i(_,"class","px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg text-white font-medium transition-colors"),i(p,"class","flex space-x-2"),i($,"class","block text-sm font-medium text-gray-300 mb-2"),i(P,"placeholder","Select output directory..."),P.readOnly=!0,i(P,"class","flex-1 px-3 py-2 bg-black/30 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-cyan-500 focus:outline-none"),i(R,"class","px-4 py-2 bg-gray-600 hover:bg-gray-700 rounded-lg text-white font-medium transition-colors"),i(B,"class","flex space-x-2"),i(n,"class","space-y-4"),L.disabled=ie=r[1]||!r[8].file,i(L,"class","px-4 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors"),X.disabled=K=!r[8].file,i(X,"class","px-4 py-2 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-500 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors"),i(H,"class","flex space-x-3 mt-6"),i(e,"class","bg-black/40 border border-gray-700/50 rounded-lg p-6")},m(Z,le){ce(Z,e,le),s(e,t),s(e,a),s(e,n),s(n,o),s(o,h),s(o,C),s(o,p),s(p,b),ke(b,r[8].file),s(p,v),s(p,_),Ce(w,_,null),s(_,y),s(n,x),s(n,k),s(k,$),s(k,j),s(k,B),s(B,P),ke(P,r[8].outputDir),s(B,M),s(B,R),Ce(A,R,null),s(R,E),s(e,O),s(e,H),s(H,L),Ce(F,L,null),s(L,G),s(H,Q),s(H,X),Ce(T,X,null),s(X,ee),D=!0,te||(N=[be(b,"input",r[46]),be(_,"click",r[32]),be(P,"input",r[47]),be(R,"click",r[33]),be(L,"click",r[34]),be(X,"click",r[48])],te=!0)},p(Z,le){le[0]&256&&b.value!==Z[8].file&&ke(b,Z[8].file),le[0]&256&&P.value!==Z[8].outputDir&&ke(P,Z[8].outputDir),(!D||le[0]&258&&ie!==(ie=Z[1]||!Z[8].file))&&(L.disabled=ie),(!D||le[0]&256&&K!==(K=!Z[8].file))&&(X.disabled=K)},i(Z){D||(W(w.$$.fragment,Z),W(A.$$.fragment,Z),W(F.$$.fragment,Z),W(T.$$.fragment,Z),D=!0)},o(Z){oe(w.$$.fragment,Z),oe(A.$$.fragment,Z),oe(F.$$.fragment,Z),oe(T.$$.fragment,Z),D=!1},d(Z){Z&&f(e),Ee(w),Ee(A),Ee(F),Ee(T),te=!1,rt(N)}}}function el(r){let e,t,l,a,n="API Settings",o,h,d,C,p,b,v,_="Firewall URL",w,y,x,k,$,V="API Key",j,B,P,M,R,A,E,O,H="Cancel",L,F,G;d=new vl({props:{class:"w-5 h-5 text-gray-400"}});function ie(T,ee){return T[5]?Ql:Jl}let Q=ie(r),X=Q(r);return{c(){e=c("div"),t=c("div"),l=c("div"),a=c("h3"),a.textContent=n,o=I(),h=c("button"),xe(d.$$.fragment),C=I(),p=c("div"),b=c("div"),v=c("label"),v.textContent=_,w=I(),y=c("input"),x=I(),k=c("div"),$=c("label"),$.textContent=V,j=I(),B=c("input"),P=I(),M=c("div"),R=c("button"),X.c(),E=I(),O=c("button"),O.textContent=H,this.h()},l(T){e=u(T,"DIV",{class:!0});var ee=g(e);t=u(ee,"DIV",{class:!0});var K=g(t);l=u(K,"DIV",{class:!0});var D=g(l);a=u(D,"H3",{class:!0,"data-svelte-h":!0}),pe(a)!=="svelte-vo4q4l"&&(a.textContent=n),o=S(D),h=u(D,"BUTTON",{class:!0});var te=g(h);De(d.$$.fragment,te),te.forEach(f),D.forEach(f),C=S(K),p=u(K,"DIV",{class:!0});var N=g(p);b=u(N,"DIV",{});var Z=g(b);v=u(Z,"LABEL",{class:!0,"data-svelte-h":!0}),pe(v)!=="svelte-1lrjcvv"&&(v.textContent=_),w=S(Z),y=u(Z,"INPUT",{type:!0,placeholder:!0,class:!0}),Z.forEach(f),x=S(N),k=u(N,"DIV",{});var le=g(k);$=u(le,"LABEL",{class:!0,"data-svelte-h":!0}),pe($)!=="svelte-6kbqzj"&&($.textContent=V),j=S(le),B=u(le,"INPUT",{type:!0,placeholder:!0,class:!0}),le.forEach(f),P=S(N),M=u(N,"DIV",{class:!0});var ue=g(M);R=u(ue,"BUTTON",{class:!0});var Y=g(R);X.l(Y),Y.forEach(f),E=S(ue),O=u(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),pe(O)!=="svelte-1fiweyo"&&(O.textContent=H),ue.forEach(f),N.forEach(f),K.forEach(f),ee.forEach(f),this.h()},h(){i(a,"class","text-lg font-semibold text-white"),i(h,"class","p-1 rounded-lg hover:bg-gray-800 transition-colors"),i(l,"class","flex items-center justify-between mb-4"),i(v,"class","block text-sm font-medium text-gray-300 mb-2"),i(y,"type","text"),i(y,"placeholder","https://fw-mgmt.example.com"),i(y,"class","w-full px-3 py-2 bg-black/30 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-cyan-500 focus:outline-none"),i($,"class","block text-sm font-medium text-gray-300 mb-2"),i(B,"type","password"),i(B,"placeholder","Enter your API key..."),i(B,"class","w-full px-3 py-2 bg-black/30 border border-gray-700 rounded-lg text-white placeholder-gray-400 focus:border-cyan-500 focus:outline-none"),R.disabled=A=r[5]||!r[3].url||!r[3].key,i(R,"class","flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg text-white font-medium transition-colors"),i(O,"class","px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white font-medium transition-colors"),i(M,"class","flex space-x-3 pt-4"),i(p,"class","space-y-4"),i(t,"class","bg-gray-900 border border-gray-700 rounded-lg p-6 w-full max-w-md mx-4"),i(e,"class","fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50")},m(T,ee){ce(T,e,ee),s(e,t),s(t,l),s(l,a),s(l,o),s(l,h),Ce(d,h,null),s(t,C),s(t,p),s(p,b),s(b,v),s(b,w),s(b,y),ke(y,r[3].url),s(p,x),s(p,k),s(k,$),s(k,j),s(k,B),ke(B,r[3].key),s(p,P),s(p,M),s(M,R),X.m(R,null),s(M,E),s(M,O),L=!0,F||(G=[be(h,"click",r[57]),be(y,"input",r[58]),be(B,"input",r[59]),be(R,"click",r[30]),be(O,"click",r[60])],F=!0)},p(T,ee){ee[0]&8&&y.value!==T[3].url&&ke(y,T[3].url),ee[0]&8&&B.value!==T[3].key&&ke(B,T[3].key),Q!==(Q=ie(T))&&(X.d(1),X=Q(T),X&&(X.c(),X.m(R,null))),(!L||ee[0]&40&&A!==(A=T[5]||!T[3].url||!T[3].key))&&(R.disabled=A)},i(T){L||(W(d.$$.fragment,T),L=!0)},o(T){oe(d.$$.fragment,T),L=!1},d(T){T&&f(e),Ee(d),X.d(),F=!1,rt(G)}}}function Jl(r){let e;return{c(){e=se("Test Connection")},l(t){e=re(t,"Test Connection")},m(t,l){ce(t,e,l)},d(t){t&&f(e)}}}function Ql(r){let e,t='<div class="w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"></div> <span>Testing...</span>';return{c(){e=c("div"),e.innerHTML=t,this.h()},l(l){e=u(l,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1i0z9fj"&&(e.innerHTML=t),this.h()},h(){i(e,"class","flex items-center justify-center space-x-2")},m(l,a){ce(l,e,a)},d(l){l&&f(e)}}}function es(r){let e,t,l,a,n,o,h,d,C,p,b='<h1 class="text-2xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">Pan Evaluator</h1> <p class="text-gray-400 text-sm">PAN-OS Policy Analysis &amp; Optimization</p>',v,_,w,y,x,k,$,V=r[3].status==="connected"?"Connected":"Disconnected",j,B,P,M,R,A,E,O,H,L,F,G,ie,Q,X,T,ee,K,D,te,N,Z;d=new pt({props:{class:"w-6 h-6 text-purple-400"}}),M=new _t({props:{class:"w-5 h-5 text-gray-400"}}),E=new ml({props:{class:"w-5 h-5 text-gray-400"}}),L=new kt({props:{class:"w-5 h-5 text-gray-400"}});let le=Ae([{id:"config",name:"Configuration",icon:_t},{id:"overview",name:"Overview",icon:wt},{id:"results",name:"Results",icon:bt},{id:"export",name:"Export",icon:yt}]),ue=[];for(let q=0;q<4;q+=1)ue[q]=jt(Ft(r,le,q));const Y=q=>oe(ue[q],1,1,()=>{ue[q]=null}),ge=[Vl,Sl,Il],_e=[];function we(q,ne){return q[1]?0:q[2]?1:2}T=we(r),ee=_e[T]=ge[T](r);let de=r[4]&&el(r);return{c(){e=c("div"),t=c("div"),l=c("div"),a=c("div"),n=c("div"),o=c("div"),h=c("div"),xe(d.$$.fragment),C=I(),p=c("div"),p.innerHTML=b,v=I(),_=c("div"),w=c("div"),y=c("div"),k=I(),$=c("span"),j=se(V),B=I(),P=c("button"),xe(M.$$.fragment),R=I(),A=c("button"),xe(E.$$.fragment),O=I(),H=c("button"),xe(L.$$.fragment),F=I(),G=c("div"),ie=c("nav");for(let q=0;q<4;q+=1)ue[q].c();Q=I(),X=c("div"),ee.c(),K=I(),de&&de.c(),D=st(),this.h()},l(q){e=u(q,"DIV",{class:!0});var ne=g(e);t=u(ne,"DIV",{class:!0});var me=g(t);l=u(me,"DIV",{class:!0});var ae=g(l);a=u(ae,"DIV",{class:!0});var Te=g(a);n=u(Te,"DIV",{class:!0});var Se=g(n);o=u(Se,"DIV",{class:!0});var Ve=g(o);h=u(Ve,"DIV",{class:!0});var ze=g(h);De(d.$$.fragment,ze),ze.forEach(f),C=S(Ve),p=u(Ve,"DIV",{"data-svelte-h":!0}),pe(p)!=="svelte-u94mty"&&(p.innerHTML=b),Ve.forEach(f),v=S(Se),_=u(Se,"DIV",{class:!0});var Ne=g(_);w=u(Ne,"DIV",{class:!0});var Me=g(w);y=u(Me,"DIV",{class:!0}),g(y).forEach(f),k=S(Me),$=u(Me,"SPAN",{class:!0});var $e=g($);j=re($e,V),$e.forEach(f),Me.forEach(f),B=S(Ne),P=u(Ne,"BUTTON",{class:!0,title:!0});var qe=g(P);De(M.$$.fragment,qe),qe.forEach(f),R=S(Ne),A=u(Ne,"BUTTON",{class:!0});var He=g(A);De(E.$$.fragment,He),He.forEach(f),O=S(Ne),H=u(Ne,"BUTTON",{class:!0});var Ze=g(H);De(L.$$.fragment,Ze),Ze.forEach(f),Ne.forEach(f),Se.forEach(f),Te.forEach(f),F=S(ae),G=u(ae,"DIV",{class:!0});var Be=g(G);ie=u(Be,"NAV",{class:!0});var Ge=g(ie);for(let Fe=0;Fe<4;Fe+=1)ue[Fe].l(Ge);Ge.forEach(f),Be.forEach(f),ae.forEach(f),Q=S(me),X=u(me,"DIV",{class:!0});var Re=g(X);ee.l(Re),Re.forEach(f),me.forEach(f),ne.forEach(f),K=S(q),de&&de.l(q),D=st(),this.h()},h(){i(h,"class","p-2 rounded-lg bg-gradient-to-r from-purple-500/20 to-pink-500/20 border border-purple-500/30"),i(o,"class","flex items-center space-x-3"),i(y,"class",x="w-2 h-2 rounded-full "+(r[3].status==="connected"?"bg-green-400":"bg-red-400")),i($,"class","text-sm text-gray-300"),i(w,"class","flex items-center space-x-2 px-3 py-1 rounded-full bg-black/30 border border-gray-700"),i(P,"class","p-2 rounded-lg bg-gray-800/50 border border-gray-700 hover:border-cyan-500/50 transition-colors"),i(P,"title","API Settings"),i(A,"class","p-2 rounded-lg bg-gray-800/50 border border-gray-700 hover:border-cyan-500/50 transition-colors"),i(H,"class","p-2 rounded-lg bg-gray-800/50 border border-gray-700 hover:border-cyan-500/50 transition-colors"),i(_,"class","flex items-center space-x-3"),i(n,"class","flex items-center justify-between"),i(a,"class","px-6 py-4"),i(ie,"class","flex space-x-1"),i(G,"class","px-6"),i(l,"class","border-b border-cyan-500/20 bg-black/40 backdrop-blur-sm"),i(X,"class","flex-1 overflow-auto svelte-1ielrec"),i(t,"class","h-full overflow-auto svelte-1ielrec"),i(e,"class","h-full w-full bg-gradient-to-br from-gray-900 via-black to-gray-800 text-white overflow-hidden")},m(q,ne){ce(q,e,ne),s(e,t),s(t,l),s(l,a),s(a,n),s(n,o),s(o,h),Ce(d,h,null),s(o,C),s(o,p),s(n,v),s(n,_),s(_,w),s(w,y),s(w,k),s(w,$),s($,j),s(_,B),s(_,P),Ce(M,P,null),s(_,R),s(_,A),Ce(E,A,null),s(_,O),s(_,H),Ce(L,H,null),s(l,F),s(l,G),s(G,ie);for(let me=0;me<4;me+=1)ue[me]&&ue[me].m(ie,null);s(t,Q),s(t,X),_e[T].m(X,null),ce(q,K,ne),de&&de.m(q,ne),ce(q,D,ne),te=!0,N||(Z=[be(P,"click",r[37]),be(A,"click",r[27]),be(H,"click",r[26])],N=!0)},p(q,ne){if((!te||ne[0]&8&&x!==(x="w-2 h-2 rounded-full "+(q[3].status==="connected"?"bg-green-400":"bg-red-400")))&&i(y,"class",x),(!te||ne[0]&8)&&V!==(V=q[3].status==="connected"?"Connected":"Disconnected")&&Ie(j,V),ne[0]&1){le=Ae([{id:"config",name:"Configuration",icon:_t},{id:"overview",name:"Overview",icon:wt},{id:"results",name:"Results",icon:bt},{id:"export",name:"Export",icon:yt}]);let ae;for(ae=0;ae<4;ae+=1){const Te=Ft(q,le,ae);ue[ae]?(ue[ae].p(Te,ne),W(ue[ae],1)):(ue[ae]=jt(Te),ue[ae].c(),W(ue[ae],1),ue[ae].m(ie,null))}for(Le(),ae=4;ae<4;ae+=1)Y(ae);Ue()}let me=T;T=we(q),T===me?_e[T].p(q,ne):(Le(),oe(_e[me],1,1,()=>{_e[me]=null}),Ue(),ee=_e[T],ee?ee.p(q,ne):(ee=_e[T]=ge[T](q),ee.c()),W(ee,1),ee.m(X,null)),q[4]?de?(de.p(q,ne),ne[0]&16&&W(de,1)):(de=el(q),de.c(),W(de,1),de.m(D.parentNode,D)):de&&(Le(),oe(de,1,1,()=>{de=null}),Ue())},i(q){if(!te){W(d.$$.fragment,q),W(M.$$.fragment,q),W(E.$$.fragment,q),W(L.$$.fragment,q);for(let ne=0;ne<4;ne+=1)W(ue[ne]);W(ee),W(de),te=!0}},o(q){oe(d.$$.fragment,q),oe(M.$$.fragment,q),oe(E.$$.fragment,q),oe(L.$$.fragment,q),ue=ue.filter(Boolean);for(let ne=0;ne<4;ne+=1)oe(ue[ne]);oe(ee),oe(de),te=!1},d(q){q&&(f(e),f(K),f(D)),Ee(d),Ee(M),Ee(E),Ee(L),We(ue,q),_e[T].d(),de&&de.d(q),N=!1,rt(Z)}}}let Qe=50;function ts(r){return r.slice(0,Math.floor(r.length*.05)).map((e,t)=>({shadowedRule:e.name,shadowedPosition:e.position,shadowingRule:`Rule_${(e.position-1).toString().padStart(3,"0")}`,shadowingPosition:e.position-1,reason:"Earlier rule fully covers later rule",recommendation:"Consider merging or removing after review"}))}function ls(r){const e=[];for(let t=0;t<Math.floor(r.length*.08);t++){const l=t*3;l+2<r.length&&e.push({proposedName:`Merged_Rule_Group_${t+1}`,sourceRules:[r[l].name,r[l+1].name,r[l+2].name],positions:[r[l].position,r[l+1].position,r[l+2].position],confidence:Math.random()>.5?"High":"Medium",orderSensitive:Math.random()>.7,recommendation:"Merge candidate - identical qualifiers detected"})}return e}function ye(r,e="info"){console.log(`[${e.toUpperCase()}] ${r}`)}function tl(r){switch(r?.toLowerCase()){case"allow":return"text-green-400";case"deny":case"drop":return"text-red-400";default:return"text-gray-400"}}function ss(r,e,t){let l,a="config",n=!1,o=null,h={url:"",key:"",status:"disconnected"},d=!1,C=!1,p="API Connection",b={url:"fw-mgmt.example.com",key:""},v={file:"",outputDir:""},_=!1,w="unknown",y={totalRules:0,unusedRules:0,shadowedRules:0,mergeProposals:0,lastAnalysis:null},x,k=[],$=[],V=[],j=[],B=[],P="",M=[],R=["CSV","XLSX","HTML","PDF"],A="XLSX",E=0,O=!1,H=1,L=1,F="",G="";dl(()=>{ie()});function ie(){const m=localStorage.getItem("pan-evaluator-config");if(m)try{const J=JSON.parse(m);t(6,p=J.analysisMode||"API Connection"),t(7,b={...b,...J.apiConfig}),t(8,v={...v,...J.csvConfig})}catch(J){console.error("Failed to load configuration:",J)}}function Q(){const m={analysisMode:p,apiConfig:b,csvConfig:v,lastSaved:new Date().toISOString()};localStorage.setItem("pan-evaluator-config",JSON.stringify(m)),ye("Configuration saved successfully","success")}async function X(){if(p==="API Connection"&&w!=="connected"){ye("Please test API connection first","error");return}if(p==="CSV Import"&&!v.file){ye("Please select a CSV file","error");return}t(1,n=!0),t(2,o=null);try{await new Promise(m=>setTimeout(m,3e3)),K(),t(11,y={totalRules:k.length,unusedRules:k.filter(m=>(m.ruleUsageHitCount||0)===0).length,shadowedRules:Math.floor(k.length*.05),mergeProposals:Math.floor(k.length*.08),lastAnalysis:new Date().toISOString()}),x&&k.length>0&&setTimeout(()=>{t(12,x.scrollTop=0,x),t(0,a="results")},100),$=k.filter(m=>(m.ruleUsageHitCount||0)===0),V=ts(k),j=ls(k),D(),t(0,a="results"),ye("Analysis completed successfully","success")}catch(m){t(2,o=`Analysis failed: ${m.message}`),ye(o,"error")}finally{t(1,n=!1)}}const T=[{key:"position",label:"Position",width:"80px"},{key:"name",label:"Name",width:"150px"},{key:"tags",label:"Tags",width:"100px"},{key:"ruleType",label:"Type",width:"100px"},{key:"fromZone",label:"Source Zone",width:"120px"},{key:"sourceAddress",label:"Source Address",width:"150px"},{key:"sourceUser",label:"Source User",width:"120px"},{key:"sourceDevice",label:"Source Device",width:"120px"},{key:"toZone",label:"Destination Zone",width:"120px"},{key:"destinationAddress",label:"Destination Address",width:"150px"},{key:"destinationDevice",label:"Destination Device",width:"120px"},{key:"application",label:"Application",width:"120px"},{key:"service",label:"Service",width:"120px"},{key:"action",label:"Action",width:"80px"},{key:"profile",label:"Profile",width:"120px"},{key:"options",label:"Options",width:"100px"},{key:"ruleUsageHitCount",label:"Rule Usage Hit Count",width:"140px"},{key:"ruleUsageLastHit",label:"Rule Usage Last Hit",width:"140px"},{key:"ruleUsageFirstHit",label:"Rule Usage First Hit",width:"140px"},{key:"ruleUsageAppsSeen",label:"Rule Usage Apps Seen",width:"140px"},{key:"daysWithNoNewApps",label:"Days With No New Apps",width:"140px"},{key:"modified",label:"Modified",width:"120px"},{key:"created",label:"Created",width:"120px"},{key:"urlCategories",label:"URL Categories",width:"120px"},{key:"schedule",label:"Schedule",width:"100px"},{key:"logSetting",label:"Log Setting",width:"120px"},{key:"logStart",label:"Log Start",width:"80px"},{key:"logEnd",label:"Log End",width:"80px"},{key:"disabled",label:"Disabled",width:"80px"},{key:"negateSrc",label:"Negate Src",width:"80px"},{key:"negateDst",label:"Negate Dst",width:"80px"},{key:"prePost",label:"Pre/Post",width:"80px"},{key:"recommendation",label:"Recommendation",width:"300px"}];async function ee(){if(!h.url||!h.key){t(2,o="Please provide both URL and API key");return}try{t(5,C=!0),t(2,o=null);const m=await Pe("test_pan_api_connection",{config:{url:h.url,key:h.key,timeout:30}});m.success?(t(3,h.status="connected",h),t(10,w="connected"),t(4,d=!1),ye("Successfully connected to PAN-OS API","success")):(t(3,h.status="error",h),t(10,w="error"),t(2,o=m.error||"Connection failed"),ye(`Connection failed: ${m.error}`,"error"))}catch(m){t(3,h.status="error",h),t(10,w="error"),t(2,o=`Connection failed: ${m}`),ye(`Connection failed: ${m}`,"error")}finally{t(5,C=!1)}}async function K(){try{t(1,n=!0),t(2,o=null);const m=await Pe("fetch_pan_security_rules",{config:{url:h.url,key:h.key,timeout:60}});console.log("Fetched rules from API:",m);try{const J=await Pe("fetch_pan_rule_usage",{config:{url:h.url,key:h.key,timeout:60}});console.log("Fetched usage statistics:",J)}catch(J){console.warn("Failed to fetch usage statistics:",J)}if(m.rules&&m.rules.length>0){const J=await Pe("analyze_policy_rules",{rules_data:m.rules});t(16,M=J.overview||[]),t(13,k=J.rules||[]),t(14,B=k),t(11,y={totalRules:J.summary?.total_rules||m.rules.length,unusedRules:J.summary?.unused_count||0,shadowedRules:J.summary?.shadow_count||0,mergeProposals:J.summary?.merge_count||0,lastAnalysis:new Date().toISOString()}),$=J.analysis?.unused_rules||[],V=J.analysis?.shadow_findings||[],j=J.analysis?.merge_proposals||[],D(),ye(`Successfully loaded ${k.length} rules from firewall`,"success")}else ye("No rules found in firewall response","error")}catch(m){t(2,o=`Failed to load policy data: ${m}`),console.error("Error loading policy data:",m),ye(`Failed to load policy data: ${m}`,"error")}finally{t(1,n=!1)}}function D(){t(21,L=Math.ceil(B.length/Qe)),H>L&&t(20,H=1)}function te(){t(14,B=k.filter(m=>{const J=!P||m.name.toLowerCase().includes(P.toLowerCase())||m.source.toLowerCase().includes(P.toLowerCase())||m.destination.toLowerCase().includes(P.toLowerCase()),U=!F||F==="unused"&&m.hitCount===0||F==="active"&&m.hitCount>0||F==="disabled"&&m.disabled,z=!G||m.action===G;return J&&U&&z})),D(),t(20,H=1)}function N(){const m=(H-1)*Qe,J=m+Qe;return B.slice(m,J)}async function Z(){if(!k.length){ye("No analysis data to export","error");return}t(19,O=!0),t(18,E=0);try{const m={overview:M,rules:k,analysis:{unused_rules:$,shadow_findings:V,merge_proposals:j}};t(18,E=20),await new Promise(U=>setTimeout(U,200));const J=await Pe("export_analysis_results",{data:m,format:A,output_path:null});t(18,E=80),await new Promise(U=>setTimeout(U,200)),t(18,E=100),await new Promise(U=>setTimeout(U,200)),ye(`Results exported successfully to: ${J}`,"success");try{await Pe("shell_open",{path:J})}catch(U){console.warn("Could not open file location:",U)}}catch(m){console.error("Export error:",m),ye(`Export failed: ${m.message||m}`,"error")}finally{t(19,O=!1),t(18,E=0)}}async function le(){try{console.log("Attempting to open file dialog...");const m=await Pe("open_file_dialog");console.log("File dialog result:",m),m?(t(8,v.file=m,v),ye("CSV file selected successfully","success"),console.log("Selected file path:",m),console.log("Parsing CSV headers..."),await Y(m)):(console.log("No file selected"),ye("No file selected","info"))}catch(m){console.error("Error selecting CSV file:",m),ye(`Failed to select CSV file: ${m.message||m}`,"error")}}async function ue(){try{const m=await Pe("open_directory_dialog");m&&(t(8,v.outputDir=m,v),ye("Output directory selected successfully","success"))}catch(m){console.error("Error selecting output directory:",m),ye("Failed to select output directory","error")}}async function Y(m){try{console.log("Parsing headers for file:",m);const J=await Pe("parse_csv_headers",{file_path:m});console.log("Received headers:",J);const U=["","Name","Tags","Type","Source Zone","Source Address","Source User","Source Device","Destination Zone","Destination Address","Destination Device","Application","Service","Action","Profile","Options","Rule Usage Hit Count","Rule Usage Last Hit","Rule Usage First Hit","Rule Usage Apps Seen","Days With No New Apps","Modified","Created"],z=U.filter(he=>!J.includes(he));return console.log("Required columns:",U),console.log("Missing columns:",z),z.length>0?(ye(`CSV missing required columns: ${z.join(", ")}`,"error"),t(8,v.file="",v),!1):(ye(`CSV validated - ${J.length} columns found`,"success"),!0)}catch(J){return console.error("Error parsing CSV headers:",J),ye(`Failed to parse CSV file: ${J?.message||J}`,"error"),t(8,v.file="",v),!1}}async function ge(){if(!v.file){ye("Please select a CSV file first","error");return}try{t(1,n=!0),console.log("Starting CSV import for file:",v.file);try{await Pe("ghostlog_log_entry",{module:"pan-evaluator",severity:"Info",event:"csv-import-start-frontend",message:`User initiated CSV import for file: ${v.file}`})}catch(U){console.warn("Failed to log to GhostLog:",U)}console.log("Calling parse_csv_file with expected columns:",T.map(U=>U.key));const m=await Pe("parse_csv_file",{file_path:v.file,expected_columns:T.map(U=>U.key)});if(console.log("Parse result received:",m),console.log("Parse result type:",typeof m),console.log("Parse result keys:",Object.keys(m||{})),m.overview&&m.overview.length>0){t(16,M=m.overview),t(13,k=m.rules),t(14,B=m.rules);const U=M.find(ve=>ve.metric==="Total Rules"),z=M.find(ve=>ve.metric==="Zero Hit Rules"),he=M.find(ve=>ve.metric==="Shadowed Rules"),fe=M.find(ve=>ve.metric==="Merge Groups");t(11,y={totalRules:U?parseInt(U.value):m.rules.length,unusedRules:z?parseInt(z.value):0,shadowedRules:he?parseInt(he.value):0,mergeProposals:fe?parseInt(fe.value):0,lastAnalysis:new Date().toISOString()}),$=m.rules.filter(ve=>ve.recommendation&&ve.recommendation.includes("Disable: 0 hits")),V=m.rules.filter(ve=>ve.recommendation&&ve.recommendation.includes("Shadowed by")),j=m.rules.filter(ve=>ve.recommendation&&ve.recommendation.includes("Merge-candidate"))}else{console.log(" Detected raw PAN-OS export format, performing sophisticated analysis...");const U=await Pe("analyze_policy_rules",{rules_data:m.rules});console.log("Comprehensive analysis result:",U),U.overview&&(t(16,M=U.overview),console.log(` Generated ${M.length} comprehensive overview metrics`)),U.rules&&(t(13,k=U.rules),t(14,B=k),console.log(` Processed ${k.length} rules with recommendations`)),U.summary?(t(11,y={totalRules:U.summary.total_rules||m.rules.length,unusedRules:U.summary.unused_count||0,shadowedRules:U.summary.shadow_count||0,mergeProposals:U.summary.merge_count||0,lastAnalysis:new Date().toISOString()}),console.log(" Analysis summary:"),console.log(`  - Total rules: ${y.totalRules}`),console.log(`  - Unused rules (0 hits): ${y.unusedRules}`),console.log(`  - Shadowed rules: ${y.shadowedRules}`),console.log(`  - Merge opportunities: ${y.mergeProposals}`)):t(11,y={totalRules:U.total_rules||m.rules.length,unusedRules:U.unused_rules||0,shadowedRules:U.shadowed_rules||0,mergeProposals:U.merge_proposals||0,lastAnalysis:new Date().toISOString()}),U.analysis?($=U.analysis.unused_rules||[],V=U.analysis.shadow_findings||[],j=U.analysis.merge_proposals||[],console.log(" Detailed analysis extracted:"),console.log(`  - Unused rule objects: ${$.length}`),console.log(`  - Shadow finding objects: ${V.length}`),console.log(`  - Merge proposal objects: ${j.length}`)):($=U.unused_rules_details||[],V=U.shadowed_rules_details||[],j=U.merge_proposals_details||[])}x&&k.length>0&&setTimeout(()=>{t(12,x.scrollTop=0,x),t(0,a="results")},100),D(),console.log("=== Comprehensive analysis completed successfully ==="),console.log("Analysis includes:"),console.log("   Shadow rule detection (earlier rules making later rules unreachable)"),console.log("   Merge opportunity analysis (rules with identical non-broadening attributes)"),console.log("   Order sensitivity analysis (intervening deny rules)"),console.log("   Zero-hit rule identification (unused rules)"),console.log("   Comprehensive overview metrics (system, actions, hit counts, diversity)"),console.log("   Security policy optimization recommendations");const J=$.length+V.length+j.length;ye(`Successfully analyzed ${k.length} rules with ${J} optimization opportunities`,"success");try{await Pe("ghostlog_log_entry",{module:"pan-evaluator",severity:"Info",event:"csv-analysis-complete-frontend",message:`CSV analysis completed successfully: ${k.length} rules analyzed, ${J} optimization opportunities found`})}catch(U){console.warn("Failed to log success to GhostLog:",U)}}catch(m){console.error("Error loading CSV data:",m),console.error("Error details:",{message:m.message,stack:m.stack,name:m.name,cause:m.cause}),ye(`CSV analysis failed: ${m?.message||m}`,"error");try{await Pe("ghostlog_log_entry",{module:"pan-evaluator",severity:"Error",event:"csv-analysis-error-frontend",message:`CSV analysis failed: ${m?.message||m}. Stack: ${m?.stack||"No stack trace"}`})}catch(J){console.warn("Failed to log error to GhostLog:",J)}}finally{t(1,n=!1)}}function _e(){if(!k.length)return[];const m=[{label:"Zero hits",min:0,max:0,count:0},{label:"1-10 hits",min:1,max:10,count:0},{label:"11-100 hits",min:11,max:100,count:0},{label:"101-1K hits",min:101,max:1e3,count:0},{label:"1K+ hits",min:1001,max:1/0,count:0}];k.forEach(U=>{const z=U.ruleUsageHitCount||0;for(let he of m)if(z>=he.min&&z<=he.max){he.count++;break}});const J=Math.max(...m.map(U=>U.count));return m.map(U=>({...U,percentage:J>0?U.count/J*100:0}))}function we(){if(!k.length)return[];const m={};k.forEach(z=>{const he=z.action||"unknown";m[he]=(m[he]||0)+1});const J=k.length,U={allow:"bg-gradient-to-r from-green-500 to-green-400",deny:"bg-gradient-to-r from-red-500 to-red-400",drop:"bg-gradient-to-r from-red-600 to-red-500",reject:"bg-gradient-to-r from-orange-500 to-orange-400",unknown:"bg-gradient-to-r from-gray-500 to-gray-400"};return Object.entries(m).map(([z,he])=>({label:z.charAt(0).toUpperCase()+z.slice(1),count:he,percentage:he/J*100,color:U[z]||U.unknown})).sort((z,he)=>he.count-z.count)}const de=[[]],q=()=>t(4,d=!0),ne=m=>t(0,a=m.id);function me(){p=this.__value,t(6,p)}function ae(){p=this.__value,t(6,p)}function Te(){b.url=this.value,t(7,b)}function Se(){b.key=this.value,t(7,b)}function Ve(){b.key=this.value,t(7,b)}const ze=()=>t(9,_=!_);function Ne(){v.file=this.value,t(8,v)}function Me(){v.outputDir=this.value,t(8,v)}const $e=async()=>{if(!v.file){ye("Please select a CSV file first","error");return}try{console.log("=== DEBUG: Testing CSV file parsing ==="),console.log("File path:",v.file);const m=await Pe("parse_csv_headers",{file_path:v.file});console.log("Headers:",m);const J=await Pe("parse_csv_file",{file_path:v.file,expected_columns:T.map(U=>U.key)});console.log("Full parse result:",J),ye("Debug info logged to console","info")}catch(m){console.error("Debug test failed:",m),ye(`Debug test failed: ${m?.message||m}`,"error")}};function qe(){P=this.value,t(15,P)}function He(){F=gt(this),t(22,F)}function Ze(){G=gt(this),t(23,G)}const Be=()=>{t(15,P=""),t(22,F=""),t(23,G="")};function Ge(m){fl[m?"unshift":"push"](()=>{x=m,t(12,x)})}const Re=()=>t(20,H=Math.max(1,H-1)),Fe=()=>t(20,H=Math.min(L,H+1));function et(){A=gt(this),t(17,A),t(25,R)}const Oe=()=>t(4,d=!1);function ot(){h.url=this.value,t(3,h)}function ct(){h.key=this.value,t(3,h)}const Ke=()=>t(4,d=!1);return te(),t(24,l=N()),[a,n,o,h,d,C,p,b,v,_,w,y,x,k,B,P,M,A,E,O,H,L,F,G,l,R,ie,Q,X,T,ee,Z,le,ue,ge,_e,we,q,ne,me,de,ae,Te,Se,Ve,ze,Ne,Me,$e,qe,He,Ze,Be,Ge,Re,Fe,et,Oe,ot,ct,Ke]}class ps extends sl{constructor(e){super(),rl(this,e,ss,es,ll,{},null,[-1,-1,-1])}}export{ps as default};
