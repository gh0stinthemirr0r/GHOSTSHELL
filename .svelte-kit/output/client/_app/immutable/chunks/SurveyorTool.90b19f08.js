import{s as $t,f as c,a as w,e as st,g as f,h as _,c as E,O as ee,d,j as u,i as se,x as t,M as be,J as nt,o as Vt,q as rt,l as X,m as W,n as oe,P as Ne,X as Fe,E as ot,k as ft,y as He}from"./scheduler.239bea07.js";import{S as Nt,i as Tt,b as Ce,d as De,m as we,a as O,g as xe,c as Se,t as Y,e as Ee}from"./index.83fc6ed7.js";import{j as it,c as at,e as Oe,l as dt,k as At,W as Rt,D as Lt,Z as jt,m as Ft}from"./2.f404646e.js";import{i as lt}from"./settings.0dec3c96.js";import{l as Bt}from"./event.7e3060fe.js";import{P as Ut}from"./play.08ac1df5.js";import{C as Mt}from"./clock.cf8ee7a8.js";import{X as qt}from"./circle-x.280f56e5.js";import{T as Ht}from"./target.3769b842.js";function pt(i,e,l){const a=i.slice();return a[30]=e[l],a}function ht(i,e,l){const a=i.slice();return a[27]=e[l],a}function vt(i,e,l){const a=i.slice();return a[33]=e[l],a}function _t(i){let e,l;return{c(){e=c("div"),l=c("div"),this.h()},l(a){e=f(a,"DIV",{class:!0});var s=_(e);l=f(s,"DIV",{class:!0,style:!0}),_(l).forEach(d),s.forEach(d),this.h()},h(){u(l,"class","bg-cyan-400 h-1.5 rounded-full transition-all duration-300"),ft(l,"width",i[33].progress+"%"),u(e,"class","w-full bg-gray-700 rounded-full h-1.5 mb-2")},m(a,s){se(a,e,s),t(e,l)},p(a,s){s[0]&1&&ft(l,"width",a[33].progress+"%")},d(a){a&&d(e)}}}function mt(i){let e,l,a,s,r,n,o=i[33].target+"",h,v,p,m=new Date(i[33].started_at).toLocaleTimeString()+"",I,V,T,x,M,S,y=i[33].status+"",$,D,q,A,j,F;var H=i[8](i[33].status);function R(P,C){return{props:{class:"w-4 h-4 "+qe(P[33].status)}}}H&&(s=rt(H,R(i)));let k=i[33].status==="Running"&&_t(i);function L(){return i[11](i[33])}return{c(){e=c("div"),l=c("div"),a=c("div"),s&&Ce(s.$$.fragment),r=w(),n=c("span"),h=X(o),v=w(),p=c("span"),I=X(m),V=w(),k&&k.c(),T=w(),x=c("div"),M=X("Status: "),S=c("span"),$=X(y),this.h()},l(P){e=f(P,"DIV",{class:!0});var C=_(e);l=f(C,"DIV",{class:!0});var b=_(l);a=f(b,"DIV",{class:!0});var g=_(a);s&&De(s.$$.fragment,g),r=E(g),n=f(g,"SPAN",{class:!0});var J=_(n);h=W(J,o),J.forEach(d),g.forEach(d),v=E(b),p=f(b,"SPAN",{class:!0});var B=_(p);I=W(B,m),B.forEach(d),b.forEach(d),V=E(C),k&&k.l(C),T=E(C),x=f(C,"DIV",{class:!0});var K=_(x);M=W(K,"Status: "),S=f(K,"SPAN",{class:!0});var z=_(S);$=W(z,y),z.forEach(d),K.forEach(d),C.forEach(d),this.h()},h(){u(n,"class","text-white font-medium text-sm"),u(a,"class","flex items-center space-x-2"),u(p,"class","text-xs text-gray-400"),u(l,"class","flex items-center justify-between mb-2"),u(S,"class",D=qe(i[33].status)),u(x,"class","text-xs text-gray-400"),u(e,"class",q="p-3 rounded-lg border transition-all cursor-pointer "+(i[1]?.id===i[33].id?"bg-cyan-500/10 border-cyan-500/50":"bg-black/20 border-gray-700/50 hover:border-gray-600/50"))},m(P,C){se(P,e,C),t(e,l),t(l,a),s&&we(s,a,null),t(a,r),t(a,n),t(n,h),t(l,v),t(l,p),t(p,I),t(e,V),k&&k.m(e,null),t(e,T),t(e,x),t(x,M),t(x,S),t(S,$),A=!0,j||(F=be(e,"click",L),j=!0)},p(P,C){if(i=P,C[0]&1&&H!==(H=i[8](i[33].status))){if(s){xe();const b=s;Y(b.$$.fragment,1,0,()=>{Ee(b,1)}),Se()}H?(s=rt(H,R(i)),Ce(s.$$.fragment),O(s.$$.fragment,1),we(s,a,r)):s=null}else if(H){const b={};C[0]&1&&(b.class="w-4 h-4 "+qe(i[33].status)),s.$set(b)}(!A||C[0]&1)&&o!==(o=i[33].target+"")&&oe(h,o),(!A||C[0]&1)&&m!==(m=new Date(i[33].started_at).toLocaleTimeString()+"")&&oe(I,m),i[33].status==="Running"?k?k.p(i,C):(k=_t(i),k.c(),k.m(e,T)):k&&(k.d(1),k=null),(!A||C[0]&1)&&y!==(y=i[33].status+"")&&oe($,y),(!A||C[0]&1&&D!==(D=qe(i[33].status)))&&u(S,"class",D),(!A||C[0]&3&&q!==(q="p-3 rounded-lg border transition-all cursor-pointer "+(i[1]?.id===i[33].id?"bg-cyan-500/10 border-cyan-500/50":"bg-black/20 border-gray-700/50 hover:border-gray-600/50")))&&u(e,"class",q)},i(P){A||(s&&O(s.$$.fragment,P),A=!0)},o(P){s&&Y(s.$$.fragment,P),A=!1},d(P){P&&d(e),s&&Ee(s),k&&k.d(),j=!1,F()}}}function gt(i){let e,l,a,s,r="No scans yet",n,o,h="Start your first network survey",v;return l=new it({props:{class:"w-12 h-12 mx-auto mb-4 opacity-50"}}),{c(){e=c("div"),Ce(l.$$.fragment),a=w(),s=c("p"),s.textContent=r,n=w(),o=c("p"),o.textContent=h,this.h()},l(p){e=f(p,"DIV",{class:!0});var m=_(e);De(l.$$.fragment,m),a=E(m),s=f(m,"P",{"data-svelte-h":!0}),ee(s)!=="svelte-set971"&&(s.textContent=r),n=E(m),o=f(m,"P",{class:!0,"data-svelte-h":!0}),ee(o)!=="svelte-ejrdy8"&&(o.textContent=h),m.forEach(d),this.h()},h(){u(o,"class","text-sm"),u(e,"class","text-center text-gray-400 py-8")},m(p,m){se(p,e,m),we(l,e,null),t(e,a),t(e,s),t(e,n),t(e,o),v=!0},i(p){v||(O(l.$$.fragment,p),v=!0)},o(p){Y(l.$$.fragment,p),v=!1},d(p){p&&d(e),Ee(l)}}}function Ot(i){let e,l,a,s,r,n="No Scan Selected",o,h,v="Select a scan from the sidebar or start a new one",p;return a=new Ht({props:{class:"w-16 h-16 mx-auto mb-4 opacity-50"}}),{c(){e=c("div"),l=c("div"),Ce(a.$$.fragment),s=w(),r=c("h3"),r.textContent=n,o=w(),h=c("p"),h.textContent=v,this.h()},l(m){e=f(m,"DIV",{class:!0});var I=_(e);l=f(I,"DIV",{class:!0});var V=_(l);De(a.$$.fragment,V),s=E(V),r=f(V,"H3",{class:!0,"data-svelte-h":!0}),ee(r)!=="svelte-wx0lyl"&&(r.textContent=n),o=E(V),h=f(V,"P",{"data-svelte-h":!0}),ee(h)!=="svelte-xhrs6d"&&(h.textContent=v),V.forEach(d),I.forEach(d),this.h()},h(){u(r,"class","text-xl font-semibold mb-2"),u(l,"class","text-center"),u(e,"class","flex-1 flex items-center justify-center text-gray-400")},m(m,I){se(m,e,I),t(e,l),we(a,l,null),t(l,s),t(l,r),t(l,o),t(l,h),p=!0},p:He,i(m){p||(O(a.$$.fragment,m),p=!0)},o(m){Y(a.$$.fragment,m),p=!1},d(m){m&&d(e),Ee(a)}}}function zt(i){let e,l,a,s,r=i[1].target+"",n,o,h,v,p,m=new Date(i[1].started_at).toLocaleString()+"",I,V,T,x,M=i[1].status+"",S,y,$,D,q,A,j,F,H,R=i[1].completed_at&&bt(i),k=i[1].results&&yt(i);const L=[Qt,Jt],P=[];function C(b,g){return b[5]&&b[1].results?0:1}return j=C(i),F=P[j]=L[j](i),{c(){e=c("div"),l=c("div"),a=c("div"),s=c("h3"),n=X(r),o=w(),h=c("div"),v=c("span"),p=X("Started: "),I=X(m),V=w(),R&&R.c(),T=w(),x=c("span"),S=X(M),$=w(),D=c("div"),k&&k.c(),q=w(),A=c("div"),F.c(),this.h()},l(b){e=f(b,"DIV",{class:!0});var g=_(e);l=f(g,"DIV",{class:!0});var J=_(l);a=f(J,"DIV",{});var B=_(a);s=f(B,"H3",{class:!0});var K=_(s);n=W(K,r),K.forEach(d),o=E(B),h=f(B,"DIV",{class:!0});var z=_(h);v=f(z,"SPAN",{});var ae=_(v);p=W(ae,"Started: "),I=W(ae,m),ae.forEach(d),V=E(z),R&&R.l(z),T=E(z),x=f(z,"SPAN",{class:!0});var Z=_(x);S=W(Z,M),Z.forEach(d),z.forEach(d),B.forEach(d),$=E(J),D=f(J,"DIV",{class:!0});var N=_(D);k&&k.l(N),N.forEach(d),J.forEach(d),g.forEach(d),q=E(b),A=f(b,"DIV",{class:!0});var U=_(A);F.l(U),U.forEach(d),this.h()},h(){u(s,"class","text-xl font-semibold text-white mb-1"),u(x,"class",y=qe(i[1].status)),u(h,"class","flex items-center space-x-4 text-sm text-gray-400"),u(D,"class","flex items-center space-x-2"),u(l,"class","flex items-center justify-between"),u(e,"class","frosted border-b border-gray-800/50 p-4"),u(A,"class","flex-1 overflow-hidden")},m(b,g){se(b,e,g),t(e,l),t(l,a),t(a,s),t(s,n),t(a,o),t(a,h),t(h,v),t(v,p),t(v,I),t(h,V),R&&R.m(h,null),t(h,T),t(h,x),t(x,S),t(l,$),t(l,D),k&&k.m(D,null),se(b,q,g),se(b,A,g),P[j].m(A,null),H=!0},p(b,g){(!H||g[0]&2)&&r!==(r=b[1].target+"")&&oe(n,r),(!H||g[0]&2)&&m!==(m=new Date(b[1].started_at).toLocaleString()+"")&&oe(I,m),b[1].completed_at?R?R.p(b,g):(R=bt(b),R.c(),R.m(h,T)):R&&(R.d(1),R=null),(!H||g[0]&2)&&M!==(M=b[1].status+"")&&oe(S,M),(!H||g[0]&2&&y!==(y=qe(b[1].status)))&&u(x,"class",y),b[1].results?k?(k.p(b,g),g[0]&2&&O(k,1)):(k=yt(b),k.c(),O(k,1),k.m(D,null)):k&&(xe(),Y(k,1,1,()=>{k=null}),Se());let J=j;j=C(b),j===J?P[j].p(b,g):(xe(),Y(P[J],1,1,()=>{P[J]=null}),Se(),F=P[j],F?F.p(b,g):(F=P[j]=L[j](b),F.c()),O(F,1),F.m(A,null))},i(b){H||(O(k),O(F),H=!0)},o(b){Y(k),Y(F),H=!1},d(b){b&&(d(e),d(q),d(A)),R&&R.d(),k&&k.d(),P[j].d()}}}function bt(i){let e,l,a=new Date(i[1].completed_at).toLocaleString()+"",s;return{c(){e=c("span"),l=X("Completed: "),s=X(a)},l(r){e=f(r,"SPAN",{});var n=_(e);l=W(n,"Completed: "),s=W(n,a),n.forEach(d)},m(r,n){se(r,e,n),t(e,l),t(e,s)},p(r,n){n[0]&2&&a!==(a=new Date(r[1].completed_at).toLocaleString()+"")&&oe(s,a)},d(r){r&&d(e)}}}function yt(i){let e,l=i[5]?"Terminal View":"Intel Panel",a,s,r,n,o,h,v;return n=new Lt({props:{size:16}}),{c(){e=c("button"),a=X(l),s=w(),r=c("button"),Ce(n.$$.fragment),this.h()},l(p){e=f(p,"BUTTON",{class:!0});var m=_(e);a=W(m,l),m.forEach(d),s=E(p),r=f(p,"BUTTON",{class:!0,title:!0});var I=_(r);De(n.$$.fragment,I),I.forEach(d),this.h()},h(){u(e,"class","px-3 py-2 bg-purple-500/20 hover:bg-purple-500/30 border border-purple-500/50 rounded-lg text-purple-400 text-sm transition-colors"),u(r,"class","p-2 rounded-lg bg-green-500/20 hover:bg-green-500/30 text-green-400 transition-colors"),u(r,"title","Export JSON")},m(p,m){se(p,e,m),t(e,a),se(p,s,m),se(p,r,m),we(n,r,null),o=!0,h||(v=[be(e,"click",i[12]),be(r,"click",i[13])],h=!0)},p(p,m){(!o||m[0]&32)&&l!==(l=p[5]?"Terminal View":"Intel Panel")&&oe(a,l)},i(p){o||(O(n.$$.fragment,p),o=!0)},o(p){Y(n.$$.fragment,p),o=!1},d(p){p&&(d(e),d(s),d(r)),Ee(n),h=!1,ot(v)}}}function Jt(i){let e,l,a,s=Oe(i[1].logs),r=[];for(let o=0;o<s.length;o+=1)r[o]=xt(pt(i,s,o));let n=i[1].status==="Running"&&St(i);return{c(){e=c("div"),l=c("div");for(let o=0;o<r.length;o+=1)r[o].c();a=w(),n&&n.c(),this.h()},l(o){e=f(o,"DIV",{class:!0});var h=_(e);l=f(h,"DIV",{class:!0});var v=_(l);for(let p=0;p<r.length;p+=1)r[p].l(v);a=E(v),n&&n.l(v),v.forEach(d),h.forEach(d),this.h()},h(){u(l,"class","flex-1 overflow-y-auto p-4 bg-black/10 font-mono text-sm"),u(e,"class","h-full flex flex-col")},m(o,h){se(o,e,h),t(e,l);for(let v=0;v<r.length;v+=1)r[v]&&r[v].m(l,null);t(l,a),n&&n.m(l,null)},p(o,h){if(h[0]&2){s=Oe(o[1].logs);let v;for(v=0;v<s.length;v+=1){const p=pt(o,s,v);r[v]?r[v].p(p,h):(r[v]=xt(p),r[v].c(),r[v].m(l,a))}for(;v<r.length;v+=1)r[v].d(1);r.length=s.length}o[1].status==="Running"?n?n.p(o,h):(n=St(o),n.c(),n.m(l,null)):n&&(n.d(1),n=null)},i:He,o:He,d(o){o&&d(e),nt(r,o),n&&n.d()}}}function Qt(i){let e,l,a,s=i[1].results?.Surveyor&&Ct(i);return{c(){e=c("div"),l=c("div"),s&&s.c(),this.h()},l(r){e=f(r,"DIV",{class:!0});var n=_(e);l=f(n,"DIV",{class:!0});var o=_(l);s&&s.l(o),o.forEach(d),n.forEach(d),this.h()},h(){u(l,"class","space-y-6"),u(e,"class","h-full overflow-y-auto p-6")},m(r,n){se(r,e,n),t(e,l),s&&s.m(l,null),a=!0},p(r,n){r[1].results?.Surveyor?s?(s.p(r,n),n[0]&2&&O(s,1)):(s=Ct(r),s.c(),O(s,1),s.m(l,null)):s&&(xe(),Y(s,1,1,()=>{s=null}),Se())},i(r){a||(O(s),a=!0)},o(r){Y(s),a=!1},d(r){r&&d(e),s&&s.d()}}}function xt(i){let e,l=i[30]+"",a;return{c(){e=c("div"),a=X(l),this.h()},l(s){e=f(s,"DIV",{class:!0});var r=_(e);a=W(r,l),r.forEach(d),this.h()},h(){u(e,"class","text-gray-300 mb-1")},m(s,r){se(s,e,r),t(e,a)},p(s,r){r[0]&2&&l!==(l=s[30]+"")&&oe(a,l)},d(s){s&&d(e)}}}function St(i){let e,l,a=Math.round(i[1].progress)+"",s,r;return{c(){e=c("div"),l=X("Scanning... "),s=X(a),r=X("% complete"),this.h()},l(n){e=f(n,"DIV",{class:!0});var o=_(e);l=W(o,"Scanning... "),s=W(o,a),r=W(o,"% complete"),o.forEach(d),this.h()},h(){u(e,"class","text-cyan-400 animate-pulse")},m(n,o){se(n,e,o),t(e,l),t(e,s),t(e,r)},p(n,o){o[0]&2&&a!==(a=Math.round(n[1].progress)+"")&&oe(s,a)},d(n){n&&d(e)}}}function Ct(i){let e,l,a="Port Scan Results",s,r,n,o,h='<tr class="border-b border-gray-700"><th class="text-left py-2 text-gray-300">Port</th> <th class="text-left py-2 text-gray-300">Protocol</th> <th class="text-left py-2 text-gray-300">Status</th> <th class="text-left py-2 text-gray-300">Service</th> <th class="text-left py-2 text-gray-300">Version</th></tr>',v,p,m,I,V,T=Oe(i[1].results?.Surveyor?.ports||[]),x=[];for(let y=0;y<T.length;y+=1)x[y]=wt(ht(i,T,y));const M=y=>Y(x[y],1,1,()=>{x[y]=null});let S=(i[1].results?.Surveyor?.throughput||i[1].results?.Surveyor?.latency)&&Et(i);return{c(){e=c("div"),l=c("h4"),l.textContent=a,s=w(),r=c("div"),n=c("table"),o=c("thead"),o.innerHTML=h,v=w(),p=c("tbody");for(let y=0;y<x.length;y+=1)x[y].c();m=w(),S&&S.c(),I=st(),this.h()},l(y){e=f(y,"DIV",{class:!0});var $=_(e);l=f($,"H4",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-1dydr26"&&(l.textContent=a),s=E($),r=f($,"DIV",{class:!0});var D=_(r);n=f(D,"TABLE",{class:!0});var q=_(n);o=f(q,"THEAD",{"data-svelte-h":!0}),ee(o)!=="svelte-qy3ptf"&&(o.innerHTML=h),v=E(q),p=f(q,"TBODY",{});var A=_(p);for(let j=0;j<x.length;j+=1)x[j].l(A);A.forEach(d),q.forEach(d),D.forEach(d),$.forEach(d),m=E(y),S&&S.l(y),I=st(),this.h()},h(){u(l,"class","text-lg font-semibold text-white mb-4"),u(n,"class","w-full text-sm"),u(r,"class","overflow-x-auto"),u(e,"class","frosted rounded-lg p-6")},m(y,$){se(y,e,$),t(e,l),t(e,s),t(e,r),t(r,n),t(n,o),t(n,v),t(n,p);for(let D=0;D<x.length;D+=1)x[D]&&x[D].m(p,null);se(y,m,$),S&&S.m(y,$),se(y,I,$),V=!0},p(y,$){if($[0]&514){T=Oe(y[1].results?.Surveyor?.ports||[]);let D;for(D=0;D<T.length;D+=1){const q=ht(y,T,D);x[D]?(x[D].p(q,$),O(x[D],1)):(x[D]=wt(q),x[D].c(),O(x[D],1),x[D].m(p,null))}for(xe(),D=T.length;D<x.length;D+=1)M(D);Se()}y[1].results?.Surveyor?.throughput||y[1].results?.Surveyor?.latency?S?(S.p(y,$),$[0]&2&&O(S,1)):(S=Et(y),S.c(),O(S,1),S.m(I.parentNode,I)):S&&(xe(),Y(S,1,1,()=>{S=null}),Se())},i(y){if(!V){for(let $=0;$<T.length;$+=1)O(x[$]);O(S),V=!0}},o(y){x=x.filter(Boolean);for(let $=0;$<x.length;$+=1)Y(x[$]);Y(S),V=!1},d(y){y&&(d(e),d(m),d(I)),nt(x,y),S&&S.d(y)}}}function Xt(i){let e,l="Unknown";return{c(){e=c("span"),e.textContent=l,this.h()},l(a){e=f(a,"SPAN",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-14twc8g"&&(e.textContent=l),this.h()},h(){u(e,"class","text-gray-500")},m(a,s){se(a,e,s)},p:He,i:He,o:He,d(a){a&&d(e)}}}function Wt(i){let e,l,a,s,r=i[27].service+"",n,o;var h=i[9](i[27].service);function v(p,m){return{props:{class:"w-4 h-4 text-cyan-400"}}}return h&&(l=rt(h,v())),{c(){e=c("div"),l&&Ce(l.$$.fragment),a=w(),s=c("span"),n=X(r),this.h()},l(p){e=f(p,"DIV",{class:!0});var m=_(e);l&&De(l.$$.fragment,m),a=E(m),s=f(m,"SPAN",{class:!0});var I=_(s);n=W(I,r),I.forEach(d),m.forEach(d),this.h()},h(){u(s,"class","text-gray-300"),u(e,"class","flex items-center space-x-2")},m(p,m){se(p,e,m),l&&we(l,e,null),t(e,a),t(e,s),t(s,n),o=!0},p(p,m){if(m[0]&2&&h!==(h=p[9](p[27].service))){if(l){xe();const I=l;Y(I.$$.fragment,1,0,()=>{Ee(I,1)}),Se()}h?(l=rt(h,v()),Ce(l.$$.fragment),O(l.$$.fragment,1),we(l,e,a)):l=null}(!o||m[0]&2)&&r!==(r=p[27].service+"")&&oe(n,r)},i(p){o||(l&&O(l.$$.fragment,p),o=!0)},o(p){l&&Y(l.$$.fragment,p),o=!1},d(p){p&&d(e),l&&Ee(l)}}}function wt(i){let e,l,a=i[27].port+"",s,r,n,o=i[27].protocol+"",h,v,p,m,I=i[27].status+"",V,T,x,M,S,y,$,D,q=(i[27].version||"-")+"",A,j,F;const H=[Wt,Xt],R=[];function k(L,P){return L[27].service?0:1}return S=k(i),y=R[S]=H[S](i),{c(){e=c("tr"),l=c("td"),s=X(a),r=w(),n=c("td"),h=X(o),v=w(),p=c("td"),m=c("span"),V=X(I),x=w(),M=c("td"),y.c(),$=w(),D=c("td"),A=X(q),j=w(),this.h()},l(L){e=f(L,"TR",{class:!0});var P=_(e);l=f(P,"TD",{class:!0});var C=_(l);s=W(C,a),C.forEach(d),r=E(P),n=f(P,"TD",{class:!0});var b=_(n);h=W(b,o),b.forEach(d),v=E(P),p=f(P,"TD",{class:!0});var g=_(p);m=f(g,"SPAN",{class:!0});var J=_(m);V=W(J,I),J.forEach(d),g.forEach(d),x=E(P),M=f(P,"TD",{class:!0});var B=_(M);y.l(B),B.forEach(d),$=E(P),D=f(P,"TD",{class:!0});var K=_(D);A=W(K,q),K.forEach(d),j=E(P),P.forEach(d),this.h()},h(){u(l,"class","py-2 text-white font-mono"),u(n,"class","py-2 text-gray-300"),u(m,"class",T=Pt(i[27].status)),u(p,"class","py-2"),u(M,"class","py-2"),u(D,"class","py-2 text-gray-300 font-mono text-xs"),u(e,"class","border-b border-gray-800/50")},m(L,P){se(L,e,P),t(e,l),t(l,s),t(e,r),t(e,n),t(n,h),t(e,v),t(e,p),t(p,m),t(m,V),t(e,x),t(e,M),R[S].m(M,null),t(e,$),t(e,D),t(D,A),t(e,j),F=!0},p(L,P){(!F||P[0]&2)&&a!==(a=L[27].port+"")&&oe(s,a),(!F||P[0]&2)&&o!==(o=L[27].protocol+"")&&oe(h,o),(!F||P[0]&2)&&I!==(I=L[27].status+"")&&oe(V,I),(!F||P[0]&2&&T!==(T=Pt(L[27].status)))&&u(m,"class",T);let C=S;S=k(L),S===C?R[S].p(L,P):(xe(),Y(R[C],1,1,()=>{R[C]=null}),Se(),y=R[S],y?y.p(L,P):(y=R[S]=H[S](L),y.c()),O(y,1),y.m(M,null)),(!F||P[0]&2)&&q!==(q=(L[27].version||"-")+"")&&oe(A,q)},i(L){F||(O(y),F=!0)},o(L){Y(y),F=!1},d(L){L&&d(e),R[S].d()}}}function Et(i){let e,l,a,s=i[1].results?.Surveyor?.throughput&&kt(i),r=i[1].results?.Surveyor?.latency&&It(i);return{c(){e=c("div"),s&&s.c(),l=w(),r&&r.c(),this.h()},l(n){e=f(n,"DIV",{class:!0});var o=_(e);s&&s.l(o),l=E(o),r&&r.l(o),o.forEach(d),this.h()},h(){u(e,"class","grid grid-cols-1 md:grid-cols-2 gap-6")},m(n,o){se(n,e,o),s&&s.m(e,null),t(e,l),r&&r.m(e,null),a=!0},p(n,o){n[1].results?.Surveyor?.throughput?s?(s.p(n,o),o[0]&2&&O(s,1)):(s=kt(n),s.c(),O(s,1),s.m(e,l)):s&&(xe(),Y(s,1,1,()=>{s=null}),Se()),n[1].results?.Surveyor?.latency?r?(r.p(n,o),o[0]&2&&O(r,1)):(r=It(n),r.c(),O(r,1),r.m(e,null)):r&&(xe(),Y(r,1,1,()=>{r=null}),Se())},i(n){a||(O(s),O(r),a=!0)},o(n){Y(s),Y(r),a=!1},d(n){n&&d(e),s&&s.d(),r&&r.d()}}}function kt(i){let e,l,a,s,r,n="Throughput Test",o,h,v,p,m="Send Speed",I,V,T=(i[1].results?.Surveyor?.throughput?.send_mbps?.toFixed(1)||"0")+"",x,M,S,y,$,D="Receive Speed",q,A,j=(i[1].results?.Surveyor?.throughput?.recv_mbps?.toFixed(1)||"0")+"",F,H,R,k,L,P="Duration",C,b,g=(i[1].results?.Surveyor?.throughput?.duration_seconds||"0")+"",J,B,K,z,ae,Z="Security",N,U,G=i[1].results?.Surveyor?.throughput?.pq_secured?"PQ-Secured":"Standard",Q,ie;return a=new jt({props:{class:"w-5 h-5 text-yellow-400"}}),{c(){e=c("div"),l=c("h4"),Ce(a.$$.fragment),s=w(),r=c("span"),r.textContent=n,o=w(),h=c("div"),v=c("div"),p=c("span"),p.textContent=m,I=w(),V=c("span"),x=X(T),M=X(" Mbps"),S=w(),y=c("div"),$=c("span"),$.textContent=D,q=w(),A=c("span"),F=X(j),H=X(" Mbps"),R=w(),k=c("div"),L=c("span"),L.textContent=P,C=w(),b=c("span"),J=X(g),B=X("s"),K=w(),z=c("div"),ae=c("span"),ae.textContent=Z,N=w(),U=c("span"),Q=X(G),this.h()},l(te){e=f(te,"DIV",{class:!0});var ne=_(e);l=f(ne,"H4",{class:!0});var de=_(l);De(a.$$.fragment,de),s=E(de),r=f(de,"SPAN",{"data-svelte-h":!0}),ee(r)!=="svelte-1weh6uw"&&(r.textContent=n),de.forEach(d),o=E(ne),h=f(ne,"DIV",{class:!0});var fe=_(h);v=f(fe,"DIV",{class:!0});var pe=_(v);p=f(pe,"SPAN",{class:!0,"data-svelte-h":!0}),ee(p)!=="svelte-183dg0l"&&(p.textContent=m),I=E(pe),V=f(pe,"SPAN",{class:!0});var ue=_(V);x=W(ue,T),M=W(ue," Mbps"),ue.forEach(d),pe.forEach(d),S=E(fe),y=f(fe,"DIV",{class:!0});var ye=_(y);$=f(ye,"SPAN",{class:!0,"data-svelte-h":!0}),ee($)!=="svelte-9q3jie"&&($.textContent=D),q=E(ye),A=f(ye,"SPAN",{class:!0});var me=_(A);F=W(me,j),H=W(me," Mbps"),me.forEach(d),ye.forEach(d),R=E(fe),k=f(fe,"DIV",{class:!0});var Ie=_(k);L=f(Ie,"SPAN",{class:!0,"data-svelte-h":!0}),ee(L)!=="svelte-12jf0co"&&(L.textContent=P),C=E(Ie),b=f(Ie,"SPAN",{class:!0});var ke=_(b);J=W(ke,g),B=W(ke,"s"),ke.forEach(d),Ie.forEach(d),K=E(fe),z=f(fe,"DIV",{class:!0});var ce=_(z);ae=f(ce,"SPAN",{class:!0,"data-svelte-h":!0}),ee(ae)!=="svelte-24xqvy"&&(ae.textContent=Z),N=E(ce),U=f(ce,"SPAN",{class:!0});var re=_(U);Q=W(re,G),re.forEach(d),ce.forEach(d),fe.forEach(d),ne.forEach(d),this.h()},h(){u(l,"class","text-lg font-semibold text-white mb-4 flex items-center space-x-2"),u(p,"class","text-gray-300"),u(V,"class","text-green-400 font-mono"),u(v,"class","flex justify-between items-center"),u($,"class","text-gray-300"),u(A,"class","text-blue-400 font-mono"),u(y,"class","flex justify-between items-center"),u(L,"class","text-gray-300"),u(b,"class","text-gray-400 font-mono"),u(k,"class","flex justify-between items-center"),u(ae,"class","text-gray-300"),u(U,"class","text-purple-400 font-mono"),u(z,"class","flex justify-between items-center"),u(h,"class","space-y-4"),u(e,"class","frosted rounded-lg p-6")},m(te,ne){se(te,e,ne),t(e,l),we(a,l,null),t(l,s),t(l,r),t(e,o),t(e,h),t(h,v),t(v,p),t(v,I),t(v,V),t(V,x),t(V,M),t(h,S),t(h,y),t(y,$),t(y,q),t(y,A),t(A,F),t(A,H),t(h,R),t(h,k),t(k,L),t(k,C),t(k,b),t(b,J),t(b,B),t(h,K),t(h,z),t(z,ae),t(z,N),t(z,U),t(U,Q),ie=!0},p(te,ne){(!ie||ne[0]&2)&&T!==(T=(te[1].results?.Surveyor?.throughput?.send_mbps?.toFixed(1)||"0")+"")&&oe(x,T),(!ie||ne[0]&2)&&j!==(j=(te[1].results?.Surveyor?.throughput?.recv_mbps?.toFixed(1)||"0")+"")&&oe(F,j),(!ie||ne[0]&2)&&g!==(g=(te[1].results?.Surveyor?.throughput?.duration_seconds||"0")+"")&&oe(J,g),(!ie||ne[0]&2)&&G!==(G=te[1].results?.Surveyor?.throughput?.pq_secured?"PQ-Secured":"Standard")&&oe(Q,G)},i(te){ie||(O(a.$$.fragment,te),ie=!0)},o(te){Y(a.$$.fragment,te),ie=!1},d(te){te&&d(e),Ee(a)}}}function It(i){let e,l,a,s,r,n="Latency Test",o,h,v,p,m="Average",I,V,T=(i[1].results?.Surveyor?.latency?.avg_ms?.toFixed(1)||"0")+"",x,M,S,y,$,D="Minimum",q,A,j=(i[1].results?.Surveyor?.latency?.min_ms?.toFixed(1)||"0")+"",F,H,R,k,L,P="Maximum",C,b,g=(i[1].results?.Surveyor?.latency?.max_ms?.toFixed(1)||"0")+"",J,B,K,z,ae,Z="Jitter",N,U,G=(i[1].results?.Surveyor?.latency?.jitter_ms?.toFixed(1)||"0")+"",Q,ie,te,ne,de,fe="Packet Loss",pe,ue,ye=(i[1].results?.Surveyor?.latency?.packet_loss_percent?.toFixed(1)||"0")+"",me,Ie,ke,ce;return a=new Ft({props:{class:"w-5 h-5 text-cyan-400"}}),{c(){e=c("div"),l=c("h4"),Ce(a.$$.fragment),s=w(),r=c("span"),r.textContent=n,o=w(),h=c("div"),v=c("div"),p=c("span"),p.textContent=m,I=w(),V=c("span"),x=X(T),M=X("ms"),S=w(),y=c("div"),$=c("span"),$.textContent=D,q=w(),A=c("span"),F=X(j),H=X("ms"),R=w(),k=c("div"),L=c("span"),L.textContent=P,C=w(),b=c("span"),J=X(g),B=X("ms"),K=w(),z=c("div"),ae=c("span"),ae.textContent=Z,N=w(),U=c("span"),Q=X(G),ie=X("ms"),te=w(),ne=c("div"),de=c("span"),de.textContent=fe,pe=w(),ue=c("span"),me=X(ye),Ie=X("%"),this.h()},l(re){e=f(re,"DIV",{class:!0});var ve=_(e);l=f(ve,"H4",{class:!0});var Ae=_(l);De(a.$$.fragment,Ae),s=E(Ae),r=f(Ae,"SPAN",{"data-svelte-h":!0}),ee(r)!=="svelte-jtxxfw"&&(r.textContent=n),Ae.forEach(d),o=E(ve),h=f(ve,"DIV",{class:!0});var he=_(h);v=f(he,"DIV",{class:!0});var Pe=_(v);p=f(Pe,"SPAN",{class:!0,"data-svelte-h":!0}),ee(p)!=="svelte-b5bap1"&&(p.textContent=m),I=E(Pe),V=f(Pe,"SPAN",{class:!0});var Re=_(V);x=W(Re,T),M=W(Re,"ms"),Re.forEach(d),Pe.forEach(d),S=E(he),y=f(he,"DIV",{class:!0});var Te=_(y);$=f(Te,"SPAN",{class:!0,"data-svelte-h":!0}),ee($)!=="svelte-11d8mvo"&&($.textContent=D),q=E(Te),A=f(Te,"SPAN",{class:!0});var $e=_(A);F=W($e,j),H=W($e,"ms"),$e.forEach(d),Te.forEach(d),R=E(he),k=f(he,"DIV",{class:!0});var Le=_(k);L=f(Le,"SPAN",{class:!0,"data-svelte-h":!0}),ee(L)!=="svelte-k1agoi"&&(L.textContent=P),C=E(Le),b=f(Le,"SPAN",{class:!0});var Ue=_(b);J=W(Ue,g),B=W(Ue,"ms"),Ue.forEach(d),Le.forEach(d),K=E(he),z=f(he,"DIV",{class:!0});var Be=_(z);ae=f(Be,"SPAN",{class:!0,"data-svelte-h":!0}),ee(ae)!=="svelte-moqywe"&&(ae.textContent=Z),N=E(Be),U=f(Be,"SPAN",{class:!0});var je=_(U);Q=W(je,G),ie=W(je,"ms"),je.forEach(d),Be.forEach(d),te=E(he),ne=f(he,"DIV",{class:!0});var _e=_(ne);de=f(_e,"SPAN",{class:!0,"data-svelte-h":!0}),ee(de)!=="svelte-1atrpjd"&&(de.textContent=fe),pe=E(_e),ue=f(_e,"SPAN",{class:!0});var le=_(ue);me=W(le,ye),Ie=W(le,"%"),le.forEach(d),_e.forEach(d),he.forEach(d),ve.forEach(d),this.h()},h(){u(l,"class","text-lg font-semibold text-white mb-4 flex items-center space-x-2"),u(p,"class","text-gray-300"),u(V,"class","text-cyan-400 font-mono"),u(v,"class","flex justify-between items-center"),u($,"class","text-gray-300"),u(A,"class","text-green-400 font-mono"),u(y,"class","flex justify-between items-center"),u(L,"class","text-gray-300"),u(b,"class","text-red-400 font-mono"),u(k,"class","flex justify-between items-center"),u(ae,"class","text-gray-300"),u(U,"class","text-yellow-400 font-mono"),u(z,"class","flex justify-between items-center"),u(de,"class","text-gray-300"),u(ue,"class",ke="text-"+((i[1].results?.Surveyor?.latency?.packet_loss_percent||0)>0?"red":"green")+"-400 font-mono"),u(ne,"class","flex justify-between items-center"),u(h,"class","space-y-4"),u(e,"class","frosted rounded-lg p-6")},m(re,ve){se(re,e,ve),t(e,l),we(a,l,null),t(l,s),t(l,r),t(e,o),t(e,h),t(h,v),t(v,p),t(v,I),t(v,V),t(V,x),t(V,M),t(h,S),t(h,y),t(y,$),t(y,q),t(y,A),t(A,F),t(A,H),t(h,R),t(h,k),t(k,L),t(k,C),t(k,b),t(b,J),t(b,B),t(h,K),t(h,z),t(z,ae),t(z,N),t(z,U),t(U,Q),t(U,ie),t(h,te),t(h,ne),t(ne,de),t(ne,pe),t(ne,ue),t(ue,me),t(ue,Ie),ce=!0},p(re,ve){(!ce||ve[0]&2)&&T!==(T=(re[1].results?.Surveyor?.latency?.avg_ms?.toFixed(1)||"0")+"")&&oe(x,T),(!ce||ve[0]&2)&&j!==(j=(re[1].results?.Surveyor?.latency?.min_ms?.toFixed(1)||"0")+"")&&oe(F,j),(!ce||ve[0]&2)&&g!==(g=(re[1].results?.Surveyor?.latency?.max_ms?.toFixed(1)||"0")+"")&&oe(J,g),(!ce||ve[0]&2)&&G!==(G=(re[1].results?.Surveyor?.latency?.jitter_ms?.toFixed(1)||"0")+"")&&oe(Q,G),(!ce||ve[0]&2)&&ye!==(ye=(re[1].results?.Surveyor?.latency?.packet_loss_percent?.toFixed(1)||"0")+"")&&oe(me,ye),(!ce||ve[0]&2&&ke!==(ke="text-"+((re[1].results?.Surveyor?.latency?.packet_loss_percent||0)>0?"red":"green")+"-400 font-mono"))&&u(ue,"class",ke)},i(re){ce||(O(a.$$.fragment,re),ce=!0)},o(re){Y(a.$$.fragment,re),ce=!1},d(re){re&&d(e),Ee(a)}}}function Dt(i){let e,l,a,s="New Surveyor Scan",r,n,o,h,v="Target Host/IP",p,m,I,V,T,x,M,S,y="Use port range instead of specific ports",$,D,q,A,j,F="Timeout (seconds)",H,R,k,L,P,C="Max Concurrent",b,g,J,B,K,z,ae,Z,N="Include throughput test",U,G,Q,ie,te,ne="Include latency test",de,fe,pe,ue,ye,me,Ie="Results will be post-quantum signed and logged",ke,ce,re,ve="Cancel",Ae,he,Pe=i[3]?"Starting...":"Start Scan",Re,Te,$e,Le,Ue;function Be(le,ge){return le[4].portRange.enabled?Yt:Zt}let je=Be(i),_e=je(i);return ue=new at({props:{class:"w-4 h-4"}}),{c(){e=c("div"),l=c("div"),a=c("h3"),a.textContent=s,r=w(),n=c("div"),o=c("div"),h=c("label"),h.textContent=v,p=w(),m=c("input"),I=w(),V=c("div"),T=c("label"),x=c("input"),M=w(),S=c("span"),S.textContent=y,$=w(),_e.c(),D=w(),q=c("div"),A=c("div"),j=c("label"),j.textContent=F,H=w(),R=c("input"),k=w(),L=c("div"),P=c("label"),P.textContent=C,b=w(),g=c("input"),J=w(),B=c("div"),K=c("label"),z=c("input"),ae=w(),Z=c("span"),Z.textContent=N,U=w(),G=c("label"),Q=c("input"),ie=w(),te=c("span"),te.textContent=ne,de=w(),fe=c("div"),pe=c("div"),Ce(ue.$$.fragment),ye=w(),me=c("span"),me.textContent=Ie,ke=w(),ce=c("div"),re=c("button"),re.textContent=ve,Ae=w(),he=c("button"),Re=X(Pe),this.h()},l(le){e=f(le,"DIV",{class:!0});var ge=_(e);l=f(ge,"DIV",{class:!0});var Me=_(l);a=f(Me,"H3",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-qcmhda"&&(a.textContent=s),r=E(Me),n=f(Me,"DIV",{class:!0});var Ve=_(n);o=f(Ve,"DIV",{});var ze=_(o);h=f(ze,"LABEL",{class:!0,"data-svelte-h":!0}),ee(h)!=="svelte-1demtee"&&(h.textContent=v),p=E(ze),m=f(ze,"INPUT",{placeholder:!0,class:!0}),ze.forEach(d),I=E(Ve),V=f(Ve,"DIV",{});var Je=_(V);T=f(Je,"LABEL",{class:!0});var Qe=_(T);x=f(Qe,"INPUT",{type:!0,class:!0}),M=E(Qe),S=f(Qe,"SPAN",{class:!0,"data-svelte-h":!0}),ee(S)!=="svelte-1mromoq"&&(S.textContent=y),Qe.forEach(d),$=E(Je),_e.l(Je),Je.forEach(d),D=E(Ve),q=f(Ve,"DIV",{class:!0});var Xe=_(q);A=f(Xe,"DIV",{});var We=_(A);j=f(We,"LABEL",{class:!0,"data-svelte-h":!0}),ee(j)!=="svelte-xfjgbk"&&(j.textContent=F),H=E(We),R=f(We,"INPUT",{type:!0,min:!0,max:!0,class:!0}),We.forEach(d),k=E(Xe),L=f(Xe,"DIV",{});var Ze=_(L);P=f(Ze,"LABEL",{class:!0,"data-svelte-h":!0}),ee(P)!=="svelte-tfgj5i"&&(P.textContent=C),b=E(Ze),g=f(Ze,"INPUT",{type:!0,min:!0,max:!0,class:!0}),Ze.forEach(d),Xe.forEach(d),J=E(Ve),B=f(Ve,"DIV",{class:!0});var Ye=_(B);K=f(Ye,"LABEL",{class:!0});var Ge=_(K);z=f(Ge,"INPUT",{type:!0,class:!0}),ae=E(Ge),Z=f(Ge,"SPAN",{class:!0,"data-svelte-h":!0}),ee(Z)!=="svelte-1aphc8u"&&(Z.textContent=N),Ge.forEach(d),U=E(Ye),G=f(Ye,"LABEL",{class:!0});var Ke=_(G);Q=f(Ke,"INPUT",{type:!0,class:!0}),ie=E(Ke),te=f(Ke,"SPAN",{class:!0,"data-svelte-h":!0}),ee(te)!=="svelte-1vdkyu2"&&(te.textContent=ne),Ke.forEach(d),Ye.forEach(d),de=E(Ve),fe=f(Ve,"DIV",{class:!0});var ut=_(fe);pe=f(ut,"DIV",{class:!0});var et=_(pe);De(ue.$$.fragment,et),ye=E(et),me=f(et,"SPAN",{"data-svelte-h":!0}),ee(me)!=="svelte-hnhz3o"&&(me.textContent=Ie),et.forEach(d),ut.forEach(d),Ve.forEach(d),ke=E(Me),ce=f(Me,"DIV",{class:!0});var tt=_(ce);re=f(tt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(re)!=="svelte-1igrqdl"&&(re.textContent=ve),Ae=E(tt),he=f(tt,"BUTTON",{class:!0});var ct=_(he);Re=W(ct,Pe),ct.forEach(d),tt.forEach(d),Me.forEach(d),ge.forEach(d),this.h()},h(){u(a,"class","text-lg font-semibold text-white mb-4"),u(h,"class","block text-sm font-medium text-gray-300 mb-1"),u(m,"placeholder","10.0.0.1 or example.com"),u(m,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:border-cyan-500 focus:outline-none"),u(x,"type","checkbox"),u(x,"class","rounded border-gray-600 bg-gray-800 text-cyan-500 focus:ring-cyan-500"),u(S,"class","text-gray-300"),u(T,"class","flex items-center space-x-2 text-sm mb-2"),u(j,"class","block text-sm font-medium text-gray-300 mb-1"),u(R,"type","number"),u(R,"min","10"),u(R,"max","300"),u(R,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),u(P,"class","block text-sm font-medium text-gray-300 mb-1"),u(g,"type","number"),u(g,"min","1"),u(g,"max","200"),u(g,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),u(q,"class","grid grid-cols-2 gap-4"),u(z,"type","checkbox"),u(z,"class","rounded border-gray-600 bg-gray-800 text-cyan-500 focus:ring-cyan-500"),u(Z,"class","text-gray-300"),u(K,"class","flex items-center space-x-2 text-sm"),u(Q,"type","checkbox"),u(Q,"class","rounded border-gray-600 bg-gray-800 text-cyan-500 focus:ring-cyan-500"),u(te,"class","text-gray-300"),u(G,"class","flex items-center space-x-2 text-sm"),u(B,"class","space-y-2"),u(pe,"class","flex items-center space-x-2 text-blue-400 text-sm"),u(fe,"class","bg-blue-500/10 border border-blue-500/30 rounded-lg p-3"),u(n,"class","space-y-4"),u(re,"class","px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors"),he.disabled=Te=!i[4].target.trim()||i[3],u(he,"class","px-4 py-2 bg-cyan-500 hover:bg-cyan-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),u(ce,"class","flex justify-end space-x-3 mt-6"),u(l,"class","bg-gray-900 border border-gray-700 rounded-lg p-6 w-[500px] max-w-full mx-4 max-h-[80vh] overflow-y-auto"),u(e,"class","fixed inset-0 bg-black/50 flex items-center justify-center z-50")},m(le,ge){se(le,e,ge),t(e,l),t(l,a),t(l,r),t(l,n),t(n,o),t(o,h),t(o,p),t(o,m),Ne(m,i[4].target),t(n,I),t(n,V),t(V,T),t(T,x),x.checked=i[4].portRange.enabled,t(T,M),t(T,S),t(V,$),_e.m(V,null),t(n,D),t(n,q),t(q,A),t(A,j),t(A,H),t(A,R),Ne(R,i[4].timeoutSeconds),t(q,k),t(q,L),t(L,P),t(L,b),t(L,g),Ne(g,i[4].maxConcurrent),t(n,J),t(n,B),t(B,K),t(K,z),z.checked=i[4].includeThroughput,t(K,ae),t(K,Z),t(B,U),t(B,G),t(G,Q),Q.checked=i[4].includeLatency,t(G,ie),t(G,te),t(n,de),t(n,fe),t(fe,pe),we(ue,pe,null),t(pe,ye),t(pe,me),t(l,ke),t(l,ce),t(ce,re),t(ce,Ae),t(ce,he),t(he,Re),$e=!0,Le||(Ue=[be(m,"input",i[14]),be(x,"change",i[15]),be(R,"input",i[19]),be(g,"input",i[20]),be(z,"change",i[21]),be(Q,"change",i[22]),be(re,"click",i[23]),be(he,"click",i[6])],Le=!0)},p(le,ge){ge[0]&16&&m.value!==le[4].target&&Ne(m,le[4].target),ge[0]&16&&(x.checked=le[4].portRange.enabled),je===(je=Be(le))&&_e?_e.p(le,ge):(_e.d(1),_e=je(le),_e&&(_e.c(),_e.m(V,null))),ge[0]&16&&Fe(R.value)!==le[4].timeoutSeconds&&Ne(R,le[4].timeoutSeconds),ge[0]&16&&Fe(g.value)!==le[4].maxConcurrent&&Ne(g,le[4].maxConcurrent),ge[0]&16&&(z.checked=le[4].includeThroughput),ge[0]&16&&(Q.checked=le[4].includeLatency),(!$e||ge[0]&8)&&Pe!==(Pe=le[3]?"Starting...":"Start Scan")&&oe(Re,Pe),(!$e||ge[0]&24&&Te!==(Te=!le[4].target.trim()||le[3]))&&(he.disabled=Te)},i(le){$e||(O(ue.$$.fragment,le),$e=!0)},o(le){Y(ue.$$.fragment,le),$e=!1},d(le){le&&d(e),_e.d(),Ee(ue),Le=!1,ot(Ue)}}}function Zt(i){let e,l,a="Specific Ports (comma-separated)",s,r,n,o,h;return{c(){e=c("div"),l=c("label"),l.textContent=a,s=w(),r=c("input"),this.h()},l(v){e=f(v,"DIV",{});var p=_(e);l=f(p,"LABEL",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-r2r6bj"&&(l.textContent=a),s=E(p),r=f(p,"INPUT",{placeholder:!0,class:!0}),p.forEach(d),this.h()},h(){u(l,"class","block text-sm font-medium text-gray-300 mb-1"),r.value=n=i[4].ports.join(", "),u(r,"placeholder","22, 80, 443, 53, 25"),u(r,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-500 focus:border-cyan-500 focus:outline-none")},m(v,p){se(v,e,p),t(e,l),t(e,s),t(e,r),o||(h=be(r,"input",i[18]),o=!0)},p(v,p){p[0]&16&&n!==(n=v[4].ports.join(", "))&&r.value!==n&&(r.value=n)},d(v){v&&d(e),o=!1,h()}}}function Yt(i){let e,l,a,s="Start Port",r,n,o,h,v,p="End Port",m,I,V,T;return{c(){e=c("div"),l=c("div"),a=c("label"),a.textContent=s,r=w(),n=c("input"),o=w(),h=c("div"),v=c("label"),v.textContent=p,m=w(),I=c("input"),this.h()},l(x){e=f(x,"DIV",{class:!0});var M=_(e);l=f(M,"DIV",{});var S=_(l);a=f(S,"LABEL",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-1o06vuo"&&(a.textContent=s),r=E(S),n=f(S,"INPUT",{type:!0,min:!0,max:!0,class:!0}),S.forEach(d),o=E(M),h=f(M,"DIV",{});var y=_(h);v=f(y,"LABEL",{class:!0,"data-svelte-h":!0}),ee(v)!=="svelte-drcg5j"&&(v.textContent=p),m=E(y),I=f(y,"INPUT",{type:!0,min:!0,max:!0,class:!0}),y.forEach(d),M.forEach(d),this.h()},h(){u(a,"class","block text-sm font-medium text-gray-300 mb-1"),u(n,"type","number"),u(n,"min","1"),u(n,"max","65535"),u(n,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),u(v,"class","block text-sm font-medium text-gray-300 mb-1"),u(I,"type","number"),u(I,"min","1"),u(I,"max","65535"),u(I,"class","w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:border-cyan-500 focus:outline-none"),u(e,"class","grid grid-cols-2 gap-4")},m(x,M){se(x,e,M),t(e,l),t(l,a),t(l,r),t(l,n),Ne(n,i[4].portRange.start),t(e,o),t(e,h),t(h,v),t(h,m),t(h,I),Ne(I,i[4].portRange.end),V||(T=[be(n,"input",i[16]),be(I,"input",i[17])],V=!0)},p(x,M){M[0]&16&&Fe(n.value)!==x[4].portRange.start&&Ne(n,x[4].portRange.start),M[0]&16&&Fe(I.value)!==x[4].portRange.end&&Ne(I,x[4].portRange.end)},d(x){x&&d(e),V=!1,ot(T)}}}function Gt(i){let e,l,a,s,r,n,o,h,v="Surveyor",p,m,I,V,T,x,M,S,y="Post-Quantum Secured",$,D,q,A,j,F,H,R,k,L,P,C;n=new it({props:{class:"w-5 h-5 text-cyan-400"}}),I=new Ut({props:{size:16}}),x=new at({props:{class:"w-4 h-4 text-green-400"}});let b=Oe(i[0]),g=[];for(let N=0;N<b.length;N+=1)g[N]=mt(vt(i,b,N));const J=N=>Y(g[N],1,1,()=>{g[N]=null});let B=i[0].length===0&&gt();const K=[zt,Ot],z=[];function ae(N,U){return N[1]?0:1}F=ae(i),H=z[F]=K[F](i);let Z=i[2]&&Dt(i);return{c(){e=c("div"),l=c("div"),a=c("div"),s=c("div"),r=c("div"),Ce(n.$$.fragment),o=w(),h=c("h2"),h.textContent=v,p=w(),m=c("button"),Ce(I.$$.fragment),V=w(),T=c("div"),Ce(x.$$.fragment),M=w(),S=c("span"),S.textContent=y,$=w(),D=c("div");for(let N=0;N<g.length;N+=1)g[N].c();q=w(),B&&B.c(),A=w(),j=c("div"),H.c(),R=w(),Z&&Z.c(),k=st(),this.h()},l(N){e=f(N,"DIV",{class:!0});var U=_(e);l=f(U,"DIV",{class:!0});var G=_(l);a=f(G,"DIV",{class:!0});var Q=_(a);s=f(Q,"DIV",{class:!0});var ie=_(s);r=f(ie,"DIV",{class:!0});var te=_(r);De(n.$$.fragment,te),o=E(te),h=f(te,"H2",{class:!0,"data-svelte-h":!0}),ee(h)!=="svelte-1f56jhz"&&(h.textContent=v),te.forEach(d),p=E(ie),m=f(ie,"BUTTON",{class:!0,title:!0});var ne=_(m);De(I.$$.fragment,ne),ne.forEach(d),ie.forEach(d),V=E(Q),T=f(Q,"DIV",{class:!0});var de=_(T);De(x.$$.fragment,de),M=E(de),S=f(de,"SPAN",{"data-svelte-h":!0}),ee(S)!=="svelte-4r02vj"&&(S.textContent=y),de.forEach(d),Q.forEach(d),$=E(G),D=f(G,"DIV",{class:!0});var fe=_(D);for(let ue=0;ue<g.length;ue+=1)g[ue].l(fe);q=E(fe),B&&B.l(fe),fe.forEach(d),G.forEach(d),A=E(U),j=f(U,"DIV",{class:!0});var pe=_(j);H.l(pe),pe.forEach(d),U.forEach(d),R=E(N),Z&&Z.l(N),k=st(),this.h()},h(){u(h,"class","text-lg font-semibold text-white"),u(r,"class","flex items-center space-x-2"),u(m,"class","p-2 rounded-lg bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 transition-colors"),u(m,"title","New Scan"),u(s,"class","flex items-center justify-between mb-4"),u(T,"class","flex items-center space-x-2 text-sm text-gray-400"),u(a,"class","p-4 border-b border-gray-800/50"),u(D,"class","flex-1 overflow-y-auto p-4 space-y-2"),u(l,"class","w-80 frosted border-r border-gray-800/50 flex flex-col"),u(j,"class","flex-1 flex flex-col"),u(e,"class","h-full flex")},m(N,U){se(N,e,U),t(e,l),t(l,a),t(a,s),t(s,r),we(n,r,null),t(r,o),t(r,h),t(s,p),t(s,m),we(I,m,null),t(a,V),t(a,T),we(x,T,null),t(T,M),t(T,S),t(l,$),t(l,D);for(let G=0;G<g.length;G+=1)g[G]&&g[G].m(D,null);t(D,q),B&&B.m(D,null),t(e,A),t(e,j),z[F].m(j,null),se(N,R,U),Z&&Z.m(N,U),se(N,k,U),L=!0,P||(C=be(m,"click",i[10]),P=!0)},p(N,U){if(U[0]&259){b=Oe(N[0]);let Q;for(Q=0;Q<b.length;Q+=1){const ie=vt(N,b,Q);g[Q]?(g[Q].p(ie,U),O(g[Q],1)):(g[Q]=mt(ie),g[Q].c(),O(g[Q],1),g[Q].m(D,q))}for(xe(),Q=b.length;Q<g.length;Q+=1)J(Q);Se()}N[0].length===0?B?U[0]&1&&O(B,1):(B=gt(),B.c(),O(B,1),B.m(D,null)):B&&(xe(),Y(B,1,1,()=>{B=null}),Se());let G=F;F=ae(N),F===G?z[F].p(N,U):(xe(),Y(z[G],1,1,()=>{z[G]=null}),Se(),H=z[F],H?H.p(N,U):(H=z[F]=K[F](N),H.c()),O(H,1),H.m(j,null)),N[2]?Z?(Z.p(N,U),U[0]&4&&O(Z,1)):(Z=Dt(N),Z.c(),O(Z,1),Z.m(k.parentNode,k)):Z&&(xe(),Y(Z,1,1,()=>{Z=null}),Se())},i(N){if(!L){O(n.$$.fragment,N),O(I.$$.fragment,N),O(x.$$.fragment,N);for(let U=0;U<b.length;U+=1)O(g[U]);O(B),O(H),O(Z),L=!0}},o(N){Y(n.$$.fragment,N),Y(I.$$.fragment,N),Y(x.$$.fragment,N),g=g.filter(Boolean);for(let U=0;U<g.length;U+=1)Y(g[U]);Y(B),Y(H),Y(Z),L=!1},d(N){N&&(d(e),d(R),d(k)),Ee(n),Ee(I),Ee(x),nt(g,N),B&&B.d(),z[F].d(),Z&&Z.d(N),P=!1,C()}}}function qe(i){switch(i){case"Completed":return"text-green-400";case"Failed":return"text-red-400";case"PolicyDenied":return"text-yellow-400";case"Running":return"text-cyan-400";default:return"text-gray-400"}}function Pt(i){switch(i){case"Open":return"text-green-400";case"Closed":return"text-red-400";case"Filtered":return"text-yellow-400";case"Timeout":return"text-gray-400";default:return"text-gray-400"}}function Kt(i,e,l){let a=[],s=null,r=!1,n=!1,o={target:"",ports:[22,80,443,53,25,110,143,993,995],portRange:{enabled:!1,start:1,end:1e3},includeThroughput:!0,includeLatency:!0,timeoutSeconds:60,maxConcurrent:50},h=!1;Vt(async()=>(await v(),await Bt("tool-progress",b=>{const g=b.payload;g.tool_type==="Surveyor"&&I(g)})));async function v(){try{const C=await lt("tools_list_runs");l(0,a=C.filter(b=>b.tool_type==="Surveyor"))}catch(C){console.error("Failed to load runs:",C)}}async function p(){try{l(3,n=!0);const C={ports:o.portRange.enabled?[]:o.ports,port_range:o.portRange.enabled?[o.portRange.start,o.portRange.end]:null,include_throughput:o.includeThroughput,include_latency:o.includeLatency,timeout_seconds:o.timeoutSeconds,max_concurrent:o.maxConcurrent},b=await lt("tools_run_surveyor",{target:o.target,options:C});await v(),l(2,r=!1),l(1,s=a.find(g=>g.id===b)||null),l(4,o={target:"",ports:[22,80,443,53,25,110,143,993,995],portRange:{enabled:!1,start:1,end:1e3},includeThroughput:!0,includeLatency:!0,timeoutSeconds:60,maxConcurrent:50}),m(b)}catch(C){console.error("Failed to start Surveyor scan:",C),alert(`Failed to start scan: ${C}`)}finally{l(3,n=!1)}}async function m(C){const b=setInterval(async()=>{try{const g=await lt("tools_get_run_status",{runId:C});l(0,a=a.map(J=>J.id===C?g:J)),s&&s.id===C&&l(1,s=g),(g.status==="Completed"||g.status==="Failed"||g.status==="PolicyDenied")&&clearInterval(b)}catch(g){console.error("Failed to poll run status:",g),clearInterval(b)}},1e3)}function I(C){l(0,a=a.map(b=>b.id===C.run_id?{...b,progress:C.progress,logs:C.logs}:b)),s&&s.id===C.run_id&&l(1,s={...s,progress:C.progress,logs:C.logs})}async function V(C,b){try{const g=await lt("tools_export_results",{runId:C,format:b}),J=new Blob([g],{type:"application/json"}),B=URL.createObjectURL(J),K=document.createElement("a");K.href=B,K.download=`surveyor-${C}.${b}`,K.click(),URL.revokeObjectURL(B)}catch(g){console.error("Failed to export results:",g),alert(`Export failed: ${g}`)}}function T(C){switch(C){case"Completed":return At;case"Failed":return qt;case"PolicyDenied":return at;case"Running":return dt;default:return Mt}}function x(C){switch(C?.toLowerCase()){case"ssh":return at;case"http":case"https":return Rt;case"dns":return it;default:return dt}}const M=()=>l(2,r=!0),S=C=>l(1,s=C),y=()=>l(5,h=!h),$=()=>s&&V(s.id,"json");function D(){o.target=this.value,l(4,o)}function q(){o.portRange.enabled=this.checked,l(4,o)}function A(){o.portRange.start=Fe(this.value),l(4,o)}function j(){o.portRange.end=Fe(this.value),l(4,o)}const F=C=>{const g=C.currentTarget.value||"";l(4,o.ports=g.split(",").map(J=>parseInt(J.trim())).filter(J=>!isNaN(J)),o)};function H(){o.timeoutSeconds=Fe(this.value),l(4,o)}function R(){o.maxConcurrent=Fe(this.value),l(4,o)}function k(){o.includeThroughput=this.checked,l(4,o)}function L(){o.includeLatency=this.checked,l(4,o)}return[a,s,r,n,o,h,p,V,T,x,M,S,y,$,D,q,A,j,F,H,R,k,L,()=>l(2,r=!1)]}class ul extends Nt{constructor(e){super(),Tt(this,e,Kt,Gt,$t,{},null,[-1,-1])}}export{ul as default};
